
\chapter{Décomposition en somme de carrés.}

Nous commençons par donner les premiers exemples d'anneaux d'entiers de corps quadratiques, à savoir $\Z[i],\Z[i\sqrt{2}]$, et $\Z[\omega]$ (où $\omega = e^{\frac{2i\pi}{3}}$). Nous étudierons dans les chapitres suivants des anneaux d'entiers plus généraux.

Ce traitement à part est dû au fait que ces anneaux sont euclidiens pour la norme usuelle des nombres complexes, et donc principaux et factoriels. Ils permettront de donner les premiers résultats sur la décomposition des nombres premiers sous la forme $x^2 +y^2, x^2 + 2 y^2$ ou $x^2 + 3 y^2$. Les  anneaux $\Z[i], \Z[\omega]$ seront indispensables à la théorie de la réciprocité cubique, et biquadratique. 

\section{Les anneaux $\Z[i], \Z[i\sqrt{2}]$.}\label{section_gauss}
$\Z[i]$ est l'ensemble des nombres complexes de la forme $a +b i$, où $a,b$ sont des entiers de $\Z$ :

$$\Z[i] = \{z \in \C\, | \, \exists a \in \Z, \exists b \in \Z, z = a + bi\}.$$

Les éléments de $\Z[i]$ s'appellent les entiers de Gauss.

$\Z[i]$ est bien un anneau (commutatif unitaire), un sous-anneau de $(\C,+,\times)$. En effet, $1 = 1 + 0 i \in \Z[i]$, et si $z,z'$ sont dans $\Z[i]$, alors $z =a +b i, z' =a' +b'i$, donc $z-z' =(a-a') +(b -b')i \in \Z[i]$, et $zz' = (a +bi)(a' +b'i) =(aa' -bb') + (ab' +ba')i \in \Z[i]$.

$\Z[i]$ est le plus petit sous-anneau de $\C$ contenant $\Z$ et $i$.

De la même façon, 

$$\Z[i\sqrt{2}] = \{z \in \C\, | \, \exists a \in \Z, \exists b \in \Z, z = a + bi\sqrt{2}\}$$
est le plus petit sous-anneau de $\C$ contenant $\Z$ et la racine $i\sqrt{2}$ de $-2$.

Comme $\Z[i] = \Z[-i]$, et $\Z[i\sqrt{2}] = \Z[-i\sqrt{2}]$, on peut désigner sans ambiguïté ces deux anneaux par $\Z[\sqrt{-1}], \Z[\sqrt{-2}]$, le choix de la racine de $-1$ ou de $-2$ n'ayant pas d'importance.

Montrons que ces deux anneaux sont euclidiens, pour la norme usuelle $\mathrm{N}(\cdot)$ des nombres complexes, définie pour tout $z \in \C$ par $\mathrm{N}(z) = |z|^2$.

\begin{prop}
\begin{enumerate}
\item[(i)] Si $z \in \C$, il existe $z_0 \in \Z[i]$ tel que $\mathrm{N}(z - z_0) < 1$.
\item[(ii)] Si $z \in \C$, il existe $z_1 \in \Z[i\sqrt{2}]$ tel que $\mathrm{N}(z - z_1) < 1$.
\end{enumerate}
\end{prop}
\begin{proof}
\be
\item[(i)]
Soit $z = a + bi \in \C$. Il existe des entiers $a_0, b_0 \in \Z$ tels que 
$$|a-a_0| < \frac{1}{2}, \quad |b-b_0|<\frac{1}{2}.$$
($a_0 = \lfloor a \rfloor$ convient si $\lfloor a \rfloor \leq a < \lfloor a \rfloor+ 1/2$, et $a_0 = \lfloor a \rfloor+ 1 = \lceil a \rceil$ convient si $\lfloor a \rfloor + 1/2 \leq a < \lfloor a \rfloor+ 1$. Idem pour $b_0$).
 Posons $z_0 = a_0 + b_0 i$. Alors $\mathrm{N}(z-z_0) = (a-a_0)^2 + (b-b_0)^2 < \frac{1}{4}+ \frac{1}{4} = \frac{1}{2} < 1$.
\item[(ii)] Tout élément $z\in \C$ peut s'écrire sous la forme $z = a + b i\sqrt{2},\ a, b \in \R$. Soient $a_0,b_0 \in \Z$ vérifiant $|a-a_0| < \frac{1}{2}, \quad |b-b_0|<\frac{1}{2}$. Posons $z_1 = a_0 + b_0 i \sqrt{2}$. Alors $\mathrm{N}(z-z_1) = (a-a_0)^2 + 2(b-b_0)^2 < \frac{1}{4}+ 2\times \frac{1}{4} = \frac{3}{4} < 1$.
\ee
\end{proof}

\begin{prop} \label{prop2}
$\Z[i]$ et $\Z[i\sqrt{2}]$ sont des anneaux euclidiens, pour la norme $\mathrm{N}(\cdot)$ de $\C$.
\end{prop}
\begin{proof}
Donnons une démonstration commune pour $A = \Z[i]$, ou $A = \Z[i\sqrt{2}]$.

Si $a,b\in A$, et $b \ne 0$, il existe d'après la proposition précédente $q \in A$ tel que $\left | \frac{a}{b} -q \right| < 1$. Posons alors $r = a - b q = b\left( \frac{a}{b} -q\right)$. Alors $r \in A$, et
$$a = bq +r, \quad 0\leq \mathrm{N}(r )< \mathrm{N}(b ).$$
Il existe donc une division euclidienne dans $A$.
\end{proof}

En conclusion, d'après le chapitre ``Anneaux'', ces anneaux sont principaux et factoriels.

Avant d' expliciter la décomposition en facteurs premiers, précisons les unités de ces anneaux. Notons $A^{\times}$ l'ensemble des unités de $A$, où $A$ est un sous-anneaux de $\C$. Alors
\begin{prop}\label{prop3}
Soit $A =\Z[i]$ (ou $A = \Z[i\sqrt{2}]$), et $A^{\times}$ l'ensemble des unités de $A$. Si $z \in A$,

 $$z \in A^{\times} \iff \mathrm{N}(z) = 1.$$
\end{prop}
\begin{proof}
Si $z\in A^\times$, alors il existe $z' \in A$ tel que $zz' = 1$, Donc $\mathrm{N}(z) \mathrm{N}(z') = 1$, où $\mathrm{N}(z), \mathrm{N}(z')$ sont des entiers naturels de $\N$. Donc $\mathrm{N}(z) = 1$.

Réciproquement, supposons $\mathrm{N}(z) = 1$, alors $z \overline{z} = 1$.

Si $A = \Z[i]$, alors $z = a+ib,\ a, b \in \Z$, donc $\overline{z} = a -i b \in A$.

Si $A = \Z[i\sqrt{2}]$, alors $z = a+ib\sqrt{2},\ a, b \in \Z$, donc $\overline{z} = a -i b\sqrt{2} \in A$.

Dans les deux cas, $z' = \overline{z} \in A$ vérifie $zz' = 1$, donc $z \in A^{\times}$.
\end{proof}
\begin{prop}
\be
\item[(i)] Les unités de $\Z[i]$ sont $1,i,i^2 = -1,i^3 = -i$.
$$\Z[i]^{\times} = \{1,i,i^2,i^2\} = \mathbb{U}_4.$$
\item[(i)] Les unités de $\Z[i\sqrt{2}]$ sont $1$ et $-1$.
$$\Z[i\sqrt{2}]^{\times} = \{1,-1\} = \mathbb{U}_2.$$
\ee
\end{prop}
\begin{proof}
\be
\item[(i)] Soit $z = a + b i \in \Z[i]$. Alors $z =a +i b \in \Z[i]^{\times}$ si et seulement si $a^2 + b^2 =1$. Comme $|a| \leq 1, |b| \leq 1$, l'ensemble des solutions de cette équation dans $\Z$ est $\{(1,0),(0,1),(-1,0),(0,-1)\}$, ce qui donne les solutions complexes $1,i,-1,-i$ de $\mathrm{N}(z) = 1$.
\item[(ii)] Soit $z = a + b i \in \Z[i\sqrt{2}]$. Alors $z =a +i b\sqrt{2} \in \Z[i\sqrt{2}]^{\times}$ si et seulement si $a^2 + 2 b^2 =1$. Alors $|b| \leq 1/2$, donc $b = 0$, et les seules solutions sont $(1,0),(-1,0)$.
\ee

\end{proof}

\section{Somme de deux carrés : une première preuve.}\label{section1_2}

Avant de donner la liste des éléments premiers dans $\Z[i]$, on peut utiliser le fait que $\Z[i]$ est principal dans une démonstration courte du théorème des deux carrés.
\begin{prop}\label{prop5}
 Soit $p$ un nombre premier congru à $1$ modulo $4$. Alors il existe un entier $a \in \Z$ tels que $p$ divise $a^2 + 1$.
 \end{prop}
 
 \begin{proof}
 Notons $\F_p$ le corps $\Z/p\Z$ à $p$ éléments. Pour tout $\alpha \in\F_p^*,$
  $$ 0 = \alpha^{p-1} - 1 =  (\alpha^{\frac{p-1}{2}}- 1)(\alpha^{\frac{p-1}{2}}+1).$$
  Comme le polynôme $x^{\frac{p-1}{2}}- 1 \in \F_p[x]$ admet au plus $\frac{p-1}{2}$ racines dans $\F_p^*$, et que le cardinal de $\F_p^*$ est $p-1$, il existe au moins un $\beta \in \F_p$ tel  que $\beta^{\frac{p-1}{2}}+1 = 0$, soit $ \left(\beta^{\frac{p-1}{4}}\right)^2+1 = 0$, où l'exposant $(p-1)/4$ est entier, puisque $p\equiv 1 \pmod 4$.
  
  Posons  $\gamma = \beta^{\frac{p-1}{4}}$. Alors $\gamma^2 + 1 = 0$.
  
  Si $a \in \mathbb{Z}$ est un représentant de $\gamma \in \F_p$, alors $p$ divise $a^2+1.$ 
 \end{proof}
 
 Donnons maintenant le théorème des deux carrés.
 
 \begin{prop}\label{prop6}
 Soit $p$ un nombre premier impair. Alors $p\equiv1 \pmod 4$ si et seulement s'il existe  un couple d'entiers $(x,y)$ tel que $p = x^2+y^2$. 
 \end{prop}

  \begin{proof}
  Soit $p$ un nombre premier impair.
  
  ($\Leftarrow$)
  Si $p=x^2+y^2$, alors $x^2 \equiv 0,1\pmod 4, y^2 \equiv 0,1\pmod 4$, donc $x^2+y^2 \equiv 0,1,2\pmod 4$. Comme $p$ est impair, $p\equiv 1 \pmod 4$.
 
   ($\Rightarrow$)  
   Soit $a$ un entier, dont l'existence est prouvée dans la proposition précédente, tel que $p \mid a^2 +1$.
   
   Soit $I$ l'idéal de $\Z[i]$ défini par
   $$I = p \Z[i] + (a+i) \Z[i] = \langle p, a+i \rangle.$$
   Montrons que $I \ne \Z[i]$, en prouvant que l'hypothèse $I = \Z[i]$ est absurde.
   
   Soit $\lambda$ un diviseur premier de $p$ dans $\Z[i]$ : un tel diviseur existe puisque $\Z[i]$ est principal.
   
   Alors $\lambda \mid p$, et $p \mid a^2 + 1 = (a+i)(a-i)$, donc $\lambda \mid (a+i)(a-i)$. L'entier de Gauss $\lambda$ étant premier, il divise soit $a+i$, soit $a-i$.
   
   Dans la premier cas, $\lambda$ divise $p$ et $a+i$. Dans le deuxième cas, $\lambda \mid a-i$, alors $a-i = \lambda \mu$, donc $a+i = \overline{\lambda} \overline{\mu}$, où $\overline{\mu} \in \Z[i]$, donc $\overline{\lambda} \mid a+i$. De plus $\overline{\lambda} \mid p$ : en effet $p = \lambda \nu$ pour un certain $\nu \in \Z[i]$, donc $p =\overline{\lambda} \overline{\nu}$. Notons que $\mathrm{N}(\lambda) = \mathrm{N}(\overline{\lambda})>1$.   
   
 Dans les deux cas, il existe $\xi \in \Z[i]$ (où $\xi = \lambda$ ou $\xi = \overline{\lambda}$) tel que $\xi \mid p, \xi \mid a+i$, et $\mathrm{N}(\xi) > 1$.
 
 Sous l'hypothèse $I = \Z[i]$, alors $1 = p \zeta + (a+i) \eta$, où $\zeta, \eta$ sont des entiers de Gauss. Alors $\xi \mid 1$, en contradiction avec $\mathrm{N}(\xi) >1$, ce qui prouve que $I \ne \Z[i]$.
 
 Comme $\Z[i]$ est principal, il existe $\pi \in \Z[i]$ tel que
 $$ p \Z[i] + (a+i) \Z[i] = \pi \Z[i].$$
 De plus $\pi$ n'est pas une unité, sinon $\pi \Z[i] = \Z[i]$. Par conséquent $\mathrm{N}(\pi) > 1$. Nous venons de prouver l'existence d'un pgcd non trivial $\pi$ de $p$ et $a+i$.
 
 Comme $p  = p\times 1 + (a+i)\times 0 \in  p \Z[i] + (a+i) \Z[i] = \pi \Z[i]$, il existe $\gamma \in \Z[i]$ tel que $p = \pi \gamma$, et donc $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$.
 
 Si $\mathrm{N}(\gamma) = 1$, alors $\gamma$ est une unité, donc $p$ et $\pi$ sont associés, et $\pi$ divise $a+i$, donc $p$ divise $a+i$, ce qui est absurde puisque $\frac{a}{p} + \frac{1}{p} i \not \in \Z[i]$. Ainsi $\mathrm{N}(\gamma) > 1$. 
 
 L'égalité $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$, où $\mathrm{N}(\pi) > 1, \mathrm{N}(\gamma)>1$, montre que
 $$ p = \mathrm{N}(\pi).$$
 Si $\pi = x + iy,\ x,y \in \Z$, alors $p=x^2 +y^2$, ce qui prouve le théorème.
 \end{proof}
 

La démonstration d'existence fournit un premier algorithme efficace pour décomposer un nombre premier $p$ en somme de deux carrés.
 
 \be
\item[$\bullet$] Première étape : trouver un entier $a$ tel que $p \mid a^2 +1$.

La démonstration de la proposition \ref{prop5} montre que la moitié (à savoir $\frac{p-1}{2}$) des éléments $\alpha$ de $\F_p^*$ vérifie $\alpha^{\frac{p-1}{2}} = 1$, l'autre moitié vérifie $\alpha^{\frac{p-1}{2}}= -1$. 

Il suffit donc de tirer au sort un élément $a, \ 1 \leq a < p$, et de calculer le moindre reste de $a^{\frac{p-1}{2}}$ modulo $p$ par une exponentiation rapide modulaire.
Si le résultat est $-1$, $a$ convient, sinon on recommence le tirage jusqu'à obtenir $-1$. Le temps d'attente d'un résultat suis une loi géométrique de paramètre $1/2$. Ce temps d'attente a donc une espérance de deux tirages.

Evidemment on ne peut garantir que cet algorithme probabiliste donne un résultat rapide, mais la probabilité que ce soit le cas est forte. On ne connait pas d'algorithme déterministe plus efficace.

\item[$\bullet$]  Trouver un pgcd de $p$ et $a+i$.

L'anneau $\Z[i]$ étant euclidien, l'algorithme d'Euclide s'applique pour obtenir un tel pgcd : on définit les suites finies $(r_n)$ d'entiers de Gauss par des divisions euclidiennes successives dans $\Z[i]$, tant que le reste $r_n$ est non nul
\begin{align*}
&r_0 = p, \quad r_1 = a+i,\\
&r_n = r_{n+1} q_{n+1} + r_{n+2},\ \mathrm{N}(r_{n+2}) < \mathrm{N}(r_{n+1})\qquad (0 \leq n \leq l)\\
&r_{l+2} = 0
 \end{align*}
 $r_{l+1} = x + iy$ donne alors un pgcd de $p$ et $a+i$, et $p = x^2 + y^2$.
  \ee
 Le programme correspondant est donné dans l'appendice.
 
 
 
 \section{Elements premiers dans $\Z[i]$.}

\begin{prop}\label{prop7}
Soit $\pi \in \Z[i]$.
Si $\mathrm{N}(\pi)$ est premier dans $\Z$, alors $\pi$ est premier dans $\Z[i]$.
\end{prop}
\begin{proof}
Supposons que $\pi = \alpha \beta$, où $\alpha, \beta$ sont dans $\Z[i]$. Par hypothèse, $p = \mathrm{N}(\pi) = \mathrm{N}(\alpha) \mathrm{N}(\beta)$ est premier dans $\Z$, $p>0$, donc $\mathrm{N}(\alpha) =1$ ou $\mathrm{N}(\beta) = 1$. D'après la proposition 3, $\alpha$ ou $\beta$ est une unité, ce qui prouve que $\pi$ est irréductible, donc premier dans $\Z[i]$, puisque $\Z[i]$ est principal.
\end{proof}

Par exemple $\mathrm{N}(2 + 3i) = 13$, donc $2+3i$ est premier. Nous allons voir que la réciproque de cette proposition est fausse.

\begin{prop}\label{prop8}
Soit $\pi$ un élément premier dans $\Z[i]$. Alors il existe un unique entier rationnel premier $p \in \N$ tel que $\pi \mid p$.
\end{prop}
\begin{proof}
Le premier $\pi$ divise l'entier naturel $n = \mathrm{N}(\pi) = \pi \overline{\pi}$. Alors $n>1$, sinon $\pi$ serait une unité. L'entier rationnel $n$ se décompose en facteurs premiers dans $\N$ sous la forme $n =p_1^{a_1}\cdots p_l^{a_l}$. Comme $\pi$ est premier, $\pi$ divise l'un des $p_i$. Si $p$ désigne un tel $p_i$, $\pi \mid p$, et $p \in \N$ est un entier rationnel premier.

Supposons que $\pi \mid p, \pi \mid q$, où $p,q$ sont des nombres premiers rationnels distincts. Alors $p,q$ sont premiers entre eux, donc il existe des entiers $u,v$ dans $\Z$ tels que $up +vq = 1$. Mais alors $\pi \mid up+vq = 1$, et $\pi$ est une unité : c'est une contradiction, qui prouve l'unité de l'entier $p$ de l'énoncé.
\end{proof}

Cette proposition montre que pour lister tous les éléments premiers de $\Z[i]$, il suffit de factoriser tous les nombres premiers rationnels. Un tel premier rationnel admet toujours au moins un diviseur premier $\pi \in \Z[i]$.

Donnons d'abord une liste d'éléments premiers :

\be
\item[$\bullet$] $\mathrm{N}(1+i) = 2$ est premier dans $\Z$, donc $1+i$ est premier, ainsi que ses associés $-1+i, -1-i, 1-i$.

\item[$\bullet$] Soit $q \equiv 3 \pmod 4$ un nombre premier dans $\Z$, $q>0$. Montrons que $q$ est irréductible dans $\Z[i]$. Dans le cas contraire, $q = \alpha \beta$, où $\alpha, \beta$ sont des entiers de Gauss vérifiant $\mathrm{N}(\alpha)>1, \mathrm{N}(\beta)>1$. Alors $q^2 = \mathrm{N}(\alpha) \mathrm{N}(\beta)$, donc $q = \mathrm{N}(\alpha)$ (nous utilisons ici l'hypothèse $q>0$). Si $\alpha = a+bi$, alors $q = a^2 + b^2$, mais $a^2 +b^2 \equiv 3 \pmod 4$ est impossible, ce qui montre que $q$ est irréductible dans $\Z[i]$. Comme $\Z[i]$ est principal, $q$ est premier dans $\Z[i]$, ainsi que ses associés $iq, i^2q,i^3q$.

Notons que si $\pi \sim q$, où $q>0, q\equiv 3 \pmod 4$, alors $\pi$ est premier dans $\Z[i]$, mais $\n(\pi) =q^2$ n'est pas premier dans $\Z$. La réciproque de la proposition \ref{norme_p} est fausse.

\item[$\bullet$] Soit $p$ un nombre premier tel que $p = \mathrm{N}(\pi),\, \pi =a + bi \in \Z[i]$ (donc $p = a^2 + b^2 \equiv 1 \pmod 4)$. Alors $\pi$ est premier dans $\Z[i]$ puisque $\mathrm{N}(\pi)$ est premier dans $\Z$.
\ee

Ces éléments seront désignés comme les éléments premiers connus dans $\Z[i]$. Montrons qu'il n'existe pas d'autres éléments premiers.

\begin{prop}\label{prop9}
Les éléments premiers dans $\Z[i]$ sont
\be
\item[(i)] 1 + i et ses associés,
\item[(ii)] les entiers rationnels $q \equiv 3 \pmod 4$, $q>0$ , premiers dans $\Z$, ainsi que leurs associés,
\item[(iii)] les éléments $\pi = a +ib$ tels que $p = \pi \overline \pi = a^2 +b^2$ soit premier dans $\Z$.
\ee
\end{prop}
\begin{proof}
Soit $\pi  = a + bi$ un élément premier dans $\Z[i]$. La proposition \ref{prop8} montre qu'il existe un nombre premier $p \in \N$ tel que $\pi \mid p$. 

Discutons les trois seuls cas possibles, $p=2, p \equiv 3 \pmod 4$, et $p\equiv 1 \pmod 4$.
\be
\item[(i)] Supposons  que $\pi \mid 2$. Comme  $2 = (1+i)(1-i) =-i(1+i)^2$, où $1+i$ est premier, et $-i$ est une unité, alors $\pi \mid 1+i$. Comme $1+i$ est premier, $\pi$ est associé à $1+i$.

\item[(ii)] Supposons que $\pi \mid p$, où $p \equiv 3 \pmod 4$. Puisque $p$ est un élément premier connu de $\Z[i]$, $\pi$ est associé à $p$.
\item[(iii)] Supposons que $\pi \mid p$, où $p \equiv 1 \pmod 4$. Alors $ p = \pi \lambda$ pour un certain $\lambda \in \Z[i]$.

 Montrons par l'absurde que $p$ n'est pas premier dans $\Z[i]$.

D'après la proposition \ref{prop5}, il existe $a \in \Z$ tel que $p \mid a^2 +1$, donc $p \mid (a+i)(a - i)$, et $p$ étant premier dans $\Z[i]$, $p \mid a +i$, ou $p \mid a-i$. Ceci est absurde puisque $\frac{a}{p} \pm \frac{1}{p} i \not \in \Z[i]$. 

Alors $\lambda$ n'est pas une unité, sinon $p$ serait associé à $\pi$ et serait donc premier. Ainsi $p = \pi \lambda$, où $\mathrm{N}(\pi)>1, \mathrm{N}(\lambda)>1$. L'égalité $p^2 = \n(\pi) \n(\lambda)$ montre que $p = \mathrm{N}(\pi) = \pi \overline \pi = a^2 +b^2$.

 
\ee 
\end{proof}

Incidemment, nous obtenons une deuxième preuve du théorème des deux carrés :

{\it
Soit $p \in \N$ un entier premier tel que $p \equiv 1 \pmod 4$, alors $p =a^2 + b^2$ est somme de deux carrés d'entiers.
}
\begin{proof}
Reprenons l'argument de la partie (iii) de la démonstration précédente :
Si $p \equiv 1 \pmod 4$, alors (proposition 5) il existe un entier $a$ tel que $p \mid a^2 +1 = (a + i)(a - i)$, mais $p \nmid a +i, p\nmid a-i$, donc $p$ n'est pas premier, a fortiori il n'est pas irréductible, donc
$$p = \alpha \beta, \text{ où }\mathrm{N}(\alpha)>1, \mathrm{N}(\beta) >1.$$
Alors $p^2 = \mathrm{N}(\alpha) \mathrm{N}(\beta)$, donc $p = \mathrm{N}(\alpha)$. Si $\alpha = a + bi$, alors $p = a^2 +b^2$.
\end{proof}
Cette démonstration ne donne pas explicitement un algorithme pour obtenir la décomposition $p = a^2 + b^2$. Un tel algorithme est donné dans la section précédente. Nous expliciterons d'autres algorithmes dans le paragraphe suivant.


 Prouvons maintenant l'unicité de la décomposition en somme de deux carrés.
 \begin{prop}\label{prop10}
 Si $p \equiv 1 \pmod 4$, il existe exactement un couple d'entiers $(a, b)$ tel que $p = a^2 +b^2$, où $0<a<b$.
 \end{prop}
 
 \begin{proof}
La proposition \ref{prop6} prouve l'existence d'entiers $x,y$ tels que $p = x^2 + y^2$. Posons $a = \min(|x|, |y|), b = \max(|x|, |y|)$. Alors $p = a^2 +b^2$, où $0 \leq a \leq b$. De plus $a = 0$ est impossible : un nombre premier ne peut être le carré de $b$, et $a = b$ est impossible, sinon $p = 2b^2$, où $b >  1,$ n'est pas premier. Donc $p =a^2 +b^2, \ 0<a<b$.


Supposons que $p = a^2 + b^2 = c^2 +d^2$, où $0<a<b$ et $0<c<d$. Posons $\pi = a+bi, \lambda =c +di$. La proposition 7 montre que $\pi, \overline{\pi}, \lambda, \overline{\lambda}$ sont premiers dans $\Z[i]$, et 
$$p = \pi \overline{\pi} = \lambda\overline{\lambda}.$$
Comme le premier $\pi$ divise $\lambda\overline{\lambda}$, $\pi$ divise $\lambda$ ou $\pi \mid \overline{\lambda}$. Ces éléments étant tous premiers, $\pi$ est associé à $\lambda$ ou $\overline{\lambda}$, soit
$$a+ib  \in \{c+id, i(c+id), - (c+id), -i (c+id), c-id,i(c-id)-(c-id),-i(c-id)\}.$$
Par conséquent $a =\pm c, b = \pm d$, ou $a = \pm d, b = \pm c$. Comme $a,b,c,d$ sont positifs $(a,b) = (c,d)$ ou $(a,b) = (d,c)$. Mais $a<b$ et $c<d$, donc $(a,b) = (c,d)$.
 \end{proof}
 Remarque : si on oublie la condition $0<x<y$, l'équation $p = x^2 +y^2$ admet 8 solutions : $(a,b), (-a,b), (a,-b), (-a,-b), (b,a),(-b,a),(a,-b),(-a,-b)$.

\bigskip 

Nous pouvons préciser les éléments premiers du type (iii) dans la proposition 9 :
\begin{prop}\label{prop11}
Soit $p \equiv 1 \pmod 4$ un premier rationnel positif. Il existe 8 diviseurs premiers de $p$ dans $\Z[i]$,  constituant deux classes d'association distinctes.
\end{prop}
\begin{proof}
Comme $p \equiv 1 \pmod 4$, le théorème des deux carrés montre que $p =a^2 + b^2 = \n(\pi) = \pi \overline{\pi}$, où $\pi =a + bi \in \Z[i]$. Les quatre associés de $\pi$ et les quatre associés de $\overline{\pi}$ sont des diviseurs de $p$. Montrons que $\pi$ et $\overline{\pi}$ ne sont pas associés. 
Comme
$$\frac{\pi}{\overline{\pi}} = \frac{a+bi}{a-bi} = \frac{(a+bi)^2}{a^2+b^2} = \frac{a^2 - b^2}{a^2+b^2} + i \frac{2ab}{a^2+b^2},$$
$\frac{\pi}{\overline{\pi}} \in \{1,-1,i,-i\}$ entraîne $a^2 -b^2 = 0$ ou $2ab = 0$, donc $a = b$ ou $a = -b$ ou $a = 0$ ou $b= 0$. Aucune de ces éventualités n'est compatible avec l'égalité $p= a^2+b^2$, où $p$ est premier impair. Ainsi $\pi$ et $\overline{\pi}$ ne sont pas associés.

De plus, tout diviseur premier $\lambda \in \Z[i]$ de $p$ vérifie $\lambda \mid \pi \overline{\pi}$, donc $\lambda \mid \pi$ ou $\lambda \mid \overline{\pi}$, et alors $\lambda\sim \pi$ ou $\lambda \sim \overline{\pi}$, et ainsi $\lambda$ est dans l'une des deux classes d'association de $\pi$ ou $\overline{\pi}$.
\end{proof}




\section{Sommes de deux carrés : la méthode d'Euler.}\label{section1_4}
 Nous allons prouver que tout nombre premier de la forme $4k+1$ est somme de deux carrés d'entiers, en suivant les étapes de la première démonstration donnée par Euler, mais en utilisant le langage des entiers de Gauss, ce qui permet de mieux comprendre les idées de cette preuve.
 
 La démonstration se fait traditionnellement, depuis Euler, en deux étapes, nommées réciprocité et descente. La proposition \ref{prop5} montre que $p \mid a^2 +1$ pour un certain entier $a \in \Z$. L'étape ``réciprocité'' est le fait que $p$ divise une somme de deux carrés $x^2 + y^2$, où $x,y$ sont premiers entre eux : il suffit de poser $x = a, y = 1$.
  
Poursuivons maintenant avec l'étape ``descente'', en commençant par le lemme suivant, dû à Euler.

\begin{prop}
Soit $n$ un entier positif, et $q$ un diviseur premier de $n$.

Si $q,n$ se décomposent en somme de deux carrés, i.e. $n = a^2 + b^2, q = c^2 +d^2$, alors $n/q$ est somme de deux carrés.
\end{prop}

\begin{proof}
$$ \frac{n}{q} = \frac{\mathrm{N}(a+bi)}{\mathrm{N}(c+di)} = \mathrm{N}\left (\frac{a+bi}{c+di}\right ) = \mathrm{N}\left (\frac{(a+bi)(c-di)}{c^2+d^2}\right ) = \mathrm{N}\left (\frac{ac+bd}{q} + i \frac{bc-ad}{q} \right),$$
 donc
 \begin{align}\label{dec1}
 \frac{n}{q} = \left (\frac{ac+bd}{q}\right )^2 + \left (\frac{bc-ad}{q}\right )^2.
 \end{align}
 
 Rien ne permet d'affirmer que $\frac{ac+bd}{q} , \frac{bc-ad}{q}$ sont des entiers, mais comme $q=\mathrm{N}(c+di) = \mathrm{N}(c-di)$, nous pouvons remplacer $d$ par $-d$, et nous obtenons aussi bien
 
 \begin{align}\label{dec2}
 \frac{n}{q}  = \left (\frac{ac-bd}{q}\right )^2 + \left (\frac{bc+ad}{q}\right )^2.
  \end{align}
  
  Montrons qu'une des deux formules (\ref{dec1}) ou (\ref{dec2}) donne une décomposition de $n/q$ en somme de carrés d'entiers.
  
  Notons $z = a +bi$, et $\pi = c +di$. D'après la proposition 7, $\pi$ est premier dans $\Z[i]$. De plus $\pi \mid \n(\pi) = q$, et $q \mid n = \mathrm{N}(z) = z \overline{z}$. L'anneau $\Z[i]$ étant principal, ceci entraîne que $\pi \mid z$, ou $\pi \mid \overline{z}$.
  
  Si $\pi \mid z$, alors $q = \pi \overline{\pi} \mid z \overline{\pi} =  (ac +bd) + i (bc -ad)$, donc  $\frac{ac +bd}{q} + i \frac{bc -ad}{q} \in \Z[i]$, ce qui montre que $q \mid ac + bd$, et $q \mid bc -ad$ : la formule (\ref{dec1}) donne la décomposition de $n/q$ en somme de deux carrés d'entiers.
  
 Si $\pi \mid \overline{z}$, alors $q = \pi \overline{\pi} \mid \overline{z} \overline{\pi} =  (ac -bd) - i (bc +ad)$, donc   $q \mid ac - bd$, et $q \mid bc +ad$ : la formule (\ref{dec2}) donne la décomposition de $n/q$ en somme de deux carrés d'entiers.

\end{proof}

Ceci donne la preuve originale du théorème des deux carrés :

{\it
 soit $p$ un nombre premier impair. Si $p\equiv1 \pmod 4$, alors il existe  un couple $(x,y)\in \N^2$ tel que $p = x^2+y^2$. 
}

  
  \begin{proof}
  
 
  Soit $p$ premier, $p\equiv 1\pmod 4$. Supposons que tout nombre premier inférieur à $p$ et congru à 1 modulo 4 soit somme de deux carrés d'entiers. Montrons qu'il en va de même pour $p$.
  
  
  Nous savons que $p$ divise $a^2+1$  pour un certain $a \in \Z$ (proposition 5). Si $A$ est le moindre reste de $a$ modulo $p$, alors $p \mid A^2 + 1$ et $-p/2<A<p/2$ .
   
  Alors $A^2+1 = p K, K \in \mathbb{N}^*$ et $A^2+1<\frac{p^2}{4}+1$, donc $K<\frac{p}{4} + \frac{1}{p} < \frac{p}{4}+1<p$.
  
  Si $K= 1$, $p = A^2+1$ est somme de deux carrés. Sinon $K$ se décompose en facteurs premiers sous la forme $K = q_1 q_2\cdots q_l$ (avec d'éventuelles répétitions).
  
  $$A^2+1=p\,q_1q_2\cdots q_l.$$
  
  
  Ici $q_i$ divise $A^2+1$, soit $-1 \equiv A^2 \pmod {q_i}$ donc $\legendre{-1}{q_i} = 1$, donc $q_i = 2$ ou $q_i \equiv 1 \pmod 4$, et $q_i\leq K <p$. On peut donc appliquer l'hypothèse de récurrence à chaque $q_i$ : 
  $q_i = a_i^2+b_i^2$ (et aussi $2 = 1^2+1^2)$. 
 
 Nous allons diviser cette égalité successivement par chacun des $q_i$.
  
 Faisons l'hypothèse suivante (pour $1\leq m\leq l$)  : supposons qu'il existe un couple $(a,b)\in\mathbb{Z}^2$ tels que  
 
 $$a^2+b^2 = p\,q_1q_2\cdots q_m,$$
 où on rappelle que $q_i <p, i=1,\cdots,m$, et que chaque $q_i$ est somme de carrés d'entiers.
 
 Au départ $l=m, a=A, b=1$ et l'hypothèse est vérifiée au rang $l$.
  
  
 Il existe deux entiers $c,d$ tels que $q_m = c^2+d^2$.
  
  Si $n=a^2+b^2$, alors $q_m\mid n$ : le lemme précédent (proposition 11) montre que $\frac{n}{q_m}$ est somme de deux carrés d'entiers, ce qui signifie qu'il existe des entiers $u,v$ tels que
  
  $$u^2+v^2 = p \,q_1 q_2\cdots q_{m-1} .$$
  On prouve ainsi successivement que les nombres $p\,q_1 q_2\cdots q_{m}, m=l,l-1,\cdots,1$ sont sommes de deux carrés. La dernière étape montre que $p = x^2+y^2$.
  
  \end{proof}
  
 {\bf Exemple} : décomposons le premier $p = 11213$ en somme de deux carrés.
  
  Comme la moitié des éléments de $(\mathbb{Z}/11213 \mathbb{Z})^*$ vérifie $ x^{\frac{p-1}{2}}+1 = 0$, on trouve rapidement, à l'aide de l'exponentiation rapide, que $\dot{2}^{\frac{p-1}{2}}+1 = 0$, et $\dot{2}^{\frac{p-1}{4}}= 1505$, donc $p  = 11213 \mid  1505^2+1 = n$.
  
  $n = 2265026 = 202 \times 11213 = 2 \times 101 \times 11213$,
  
  et $2 = 1^2+1^2, 101 = 10^2 + 1^2$.
  
  $$2 \times 11213 = \frac{n}{101} = \mathrm{N}\left(\frac{1505+i}{10+i}\right) = \mathrm{N}\left(\frac{15051}{101} + i \frac{1495}{101}\right),$$
  
  et aussi
  
    $$2 \times 11213 = \frac{n}{101} = \mathrm{N}\left(\frac{1505+i}{10-i}\right) = \mathrm{N}\left (\frac{15049}{101} + i \frac{1515}{101}\right).$$
    
    Seule la deuxième décomposition donne des entiers
    
    $$2 \times 11213 = \mathrm{N}(149 + 15 i) = 149^2 + 15^2,$$
    
    et enfin
    
    $$11213 = \mathrm{N}\left (\frac{149+15i}{1+i} \right) = \mathrm{N}(82 + 67i),$$
  
  $$11213 = 82^2 + 67^2.$$
  
  Remarque : cette démonstration suis les étapes de la première démonstration due à Euler, en utilisant les nombres complexes, ce qu'Euler voulait éviter en donnant une démonstration élémentaire.
  Cette preuve étant constructive, elle permet d'obtenir des décompositions effectives. Néanmoins elle n'est pas la plus rapide sur le plan algorithmique, puisqu'elle nécessite une factorisation en facteurs premiers, qui peut être très gourmande en temps de calcul. La variante de descente donnée dans le paragraphe suivant évite cet écueil.   
  
  \section{Autre preuve et algorithme pour la décomposition en somme de deux carrés.}\label{section1_5}
  Cet autre démonstration-algorithme vient de [Lehman].
  
  Cette proposition donne une variante de la descente donnée par Euler.
  \begin{prop}
  Soit $p \in \N$ un nombre premier impair. Supposons que l'entier $k$  soit tel qu'il existe des entiers $a,b$ vérifiant 
  $$k p = a^2 +b^2,\qquad 1<k<p.$$
  Alors il existe un entier $l$, où $1 \leq l \leq \frac{k}{2} < k$, et des entiers $c,d$ tels que $lp = c^2 +d^2$.
  \end{prop}
  \begin{proof}
  Partons de l'hypothèse $kp = a^2 +b^2$, avec $1<k<p$. Soient $m,n$ les moindres restes de $a,b$ modulo $k$ :
  $$ m \equiv a \pmod k, \quad n\equiv b \pmod k, \qquad -\frac{k}{2} \leq m < \frac{k}{2}, \quad  -\frac{k}{2} \leq n < \frac{k}{2}.$$

  
  Notons que $m,n$ ne sont pas tous deux nuls. Sinon  $k \mid a, k \mid b$, donc $k^2 \mid a^2+b^2 = kp$, ce qui entraîne que $k \mid p$, en contradiction avec les hypothèses $p$ premier et $1<k<p$.
  
  De plus $m^2 + n^2 \equiv a^2 + b^2 \equiv 0 \pmod  k$, et ainsi $k \mid m^2 +n^2$. Il existe donc un entier $l$ tel que $m^2 +n^2 = kl$. Puisque $m,n$ ne sont pas tous deux nuls, $l\geq 1$. Comme $|m| \leq \frac{k}{2}$ et $|n| \leq \frac{k}{2}$, on obtient $kl = m^2 +n^2 \leq  \frac{k^2}{4} +  \frac{k^2}{4} =  \frac{k^2}{2}$, donc $1\leq l \leq \frac{k}{2}<k$.
  
  La division des deux égalités
  \begin{align*}
    k p&=a^2 + b^2  =\mathrm{N}(a + bi),\\
   k l &= m^2 +n^2 = \mathrm{N}(m +ni),\\
  \end{align*}
  donne
  \begin{align*}
   \frac{p}{l} &=  \mathrm{N}\left( \frac{a+bi}{m+ni}\right)\\
   &= \mathrm{N}\left( \frac{(a+bi)(m-ni)}{m^2+n^2}\right)\\
   &= \mathrm{N}\left( \frac{(a+bi)(m-ni)}{kl}\right)\\
   &= \frac{1}{l^2}  \left[ \left(\frac{am +bn}{k}\right)^2 +  \left(\frac{bm -an}{k}\right)^2  \right],
   \end{align*}
   donc
   $$l p= \left(\frac{am +bn}{k}\right)^2 +  \left(\frac{bm -an}{k}\right)^2.$$
Puisque $ m \equiv a \pmod k, n\equiv b \pmod k$, nous obtenons
\begin{align*}
am +bn \equiv a^2+b^2 \equiv 0 \pmod{k},\\
bm-an \equiv ba - ab \equiv 0 \pmod{k},
\end{align*}
donc $c = \frac{am +bn}{k}$ et $d = \frac{bm -an}{k}$ sont des entiers, et ils vérifient
$$ lp = c^2 +d^2, \text{ où } 1\leq l < \frac{k}{2}<k.$$
\end{proof}

Ceci donne une nouvelle preuve du théorème des deux carrés :

{\it
Soit $p \in \N$ un entier premier tel que $p \equiv 1 \pmod 4$, alors $p =a^2 + b^2$ est somme de deux carrés d'entiers.
}

\begin{proof}
Comme $p\equiv 1 \pmod 4$, la proposition 5 donne l'existence d'un entier $a$ tel que $p \mid a^2 +1$. Si $b$ est le moindre reste de $a$ dans la division par $p$, alors $ b \equiv a \pmod{p}$ et $-\frac{p}{2} < b < \frac{p}{2}$. Alors $p \mid b^2 +1$, avec $|b| < \frac{p}{2}$.  Quitte à remplacer $b$ par $-b$, on peut supposer $b>0$. Ainsi il existe un entier $k$ tel que
$$kp = b^2 + 1,$$
et puisque $0<b< \frac{p}{2}$, $k p < \frac{p^2}{4} + 1$, donc $k <\frac{p}{4} + \frac{1}{p} <\frac{p}{4} + 1 < p$.

Si $k = 1$, $p = b^2 + 1$ est somme de deux carrés. Sinon, $kp = b^2 + 1, \ 1<k<p$, et ainsi l'hypothèse de la proposition 12 est vérifiée.

La proposition 12 donne alors un entier $k_1$ tel que $1\leq k_1 < k$ tel que $k_1 p$ est somme de deux carrés. Si $k_1 = 1$, $p$ est some de deux carrés. Sinon on continue. On construit ainsi une suite strictement décroissante $k_1> k_2> \cdots > k_n> \cdots $  d'entiers, tant qu'aucun terme de cette suite n'est égal à 1, et vérifiant tous $k_n p = a_n^2+b_n^2$ pour des entiers $a_n,b_n$. Comme il n'existe pas de suite infinie strictement décroissante d'entiers naturels, cette suite est nécessairement finie : il existe un indice $t$ tel que $k_t = 1$, et donc $p$ est somme de deux carrés.

    \end{proof}
    
  L'algorithme correspondant ne demande pas de factorisations, et il est efficace. En effet la proposition 13 montre que $k_{n+1} < \frac{k_n}{2}$. On atteint donc $k_t = 1$ en un temps $t = O(\log(n))$. Le programme correspondant à cet algorithme est donné dans l'appendice à ce chapitre.
  
  Une autre preuve du théorème des deux carrés sera donnée dans un chapitre ultérieur par la méthode de Lagrange pour obtenir une forme réduite, une avec les sommes de Jacobi, et une autre encore dans le chapitre sur la géométrie des nombres.
  
  
  
  
 \section{Représentation d'un nombre premier par la forme $x^2 + 2 y^2$.}
 Le nombre 2 se décompose sous la forme $2 = 0^2 + 2\times1^2$.
 
 Maintenant, soit $p$ un nombre premier impair. A quelle condition peut-il se décomposer sous la forme $p = x^2 + 2 y^2$ ? Donnons d'abord une condition nécessaire :
 
 Si $p = x^2 + 2y^2$, alors $p \nmid y$, sinon $p \mid y, p \mid x$, donc $p^2 \mid x^2 + 2y^2 = p$, et $p \mid 1$ : c'est absurde. Par conséquent la classe $\dot y$ de $y$ est non nulle dans $\Z/p\Z$, et $-2 = (\dot x \dot {y}^{-1})^2$, donc $\legendre{-2}{p} = 1$. Ceci équivaut d'après les caractères quadratique de $-1$ et $2$ à
 $$(-1)^{\frac{p^2-1}{8}} = (-1)^{\frac{p-1}{2}}.$$
 Résumons le tableau de ces valeurs pour chaque valeur de $p$ modulo $8$ :
 $$
 \begin{array}{c|cccc}
 p  & 1 & 3 & 5 & 7  \\
 \hline
 (-1)^{\frac{p-1}{2}} & 1 & -1 & 1 & -1\\
 (-1)^{\frac{p^2-1}{8}}& 1 & -1 & -1 & 1
 \end{array} 
 $$
 Donc 
 $$\legendre{-2}{p} = 1 \iff p \equiv 1,3 \pmod 8.$$
 
 Montrons que cette condition est suffisante
 
 \begin{prop}
 Soit $p$ un nombre premier impair . Alors
 $$\exists x \in \Z,\  \exists y \in \Z, \ p = x^2 + 2 y^2  \iff p \equiv 1 \text{ or } p \equiv 3 \pmod 8.$$
 \end{prop}

 \begin{proof}
  Il reste à prouver que la condition est suffisante. Supposons que $p \equiv 1,3 \pmod 8$. Le calcul précédent montre que $\legendre{-2}{p} = 1$, donc il existe un entier $a$ tel que $p \mid a^2 + 2$.
  
  L'anneau $\Z[i\sqrt{2}]$ étant principal (proposition \ref{prop2}), nous pouvons calquer la preuve de la proposition \ref{prop6}.
  
  Notons $\rho = i \sqrt{2}$. Soit $I$ l'idéal de $\Z[\rho]$ défini par
   $$I = p \Z[\rho] + (a+ \rho) \Z[i] = \langle p, a+\rho \rangle.$$
   Montrons que $I \ne \Z[\rho]$, en prouvant que l'hypothèse $I = \Z[\rho]$ est absurde.
   
   Soit $\lambda$ un diviseur premier de $p$ dans $\Z[\rho]$ : un tel diviseur existe puisque $\Z[\rho]$ est principal.
   
   Alors $\lambda \mid p$, et $p \mid a^2 + 2 = (a+\rho)(a-\rho)$, donc $\lambda \mid (a+\rho)(a-\rho)$. L'élément $\lambda$ étant premier, il divise soit $a+\rho$, soit $a-\rho$.
   
   Dans la premier cas, $\lambda$ divise $p$ et $a+\rho$. Dans le deuxième cas, si $\lambda \mid a-\rho$, alors $a-\rho = \lambda \mu$, donc $a+\rho= \overline{\lambda} \overline{\mu}$, où $\overline{\mu} \in \Z[\rho]$, donc $\overline{\lambda} \mid a+\rho$. De plus $\overline{\lambda} \mid p$ : en effet $p = \lambda \nu$ pour un certain $\nu \in \Z[\rho]$, donc $p =\overline{\lambda} \overline{\nu}$. Notons que $\mathrm{N}(\lambda) = \mathrm{N}(\overline{\lambda})>1$.   
   
 Dans les deux cas, il existe $\xi \in \Z[\rho]$ (où $\xi = \lambda$ ou $\xi = \overline{\lambda}$) tel que $\xi \mid p, \xi \mid a+\rho$, et $\mathrm{N}(\xi) > 1$.
 
 Sous l'hypothèse $I = \Z[\rho]$, alors $1 = p \zeta + (a+\rho) \eta$, où $\zeta, \eta$ sont dans $\Z[\rho]$. Alors $\xi \mid 1$, en contradiction avec $\mathrm{N}(\xi) >1$, ce qui prouve que $I \ne \Z[\rho]$.
 
 Comme $\Z[\rho]$ est principal, il existe $\pi \in \Z[\rho]$ tel que
 $$ p \Z[\rho] + (a+\rho) \Z[\rho] = \pi \Z[\rho].$$
 De plus $\pi$ n'est pas une unité, sinon $I = \pi \Z[\rho] = \Z[\rho]$. Par conséquent $\mathrm{N}(\pi) > 1$. Nous venons de prouver l'existence d'un pgcd non trivial $\pi$ de $p$ et $a+\rho$.
 
 Comme $p  = p\times 1 + (a+\rho)\times 0 \in  p \Z[\rho] + (a+\rho) \Z[\rho] = \pi \Z[\rho]$, il existe $\gamma \in \Z[\rho]$ tel que $p = \pi \gamma$, et donc $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$.
 
 Si $\mathrm{N}(\gamma) = 1$, alors $\gamma$ est une unité, donc $p$ et $\pi$ sont associés, et $\pi$ divise $a+\rho$, donc $p$ divise $a+ \rho$, ce qui est absurde puisque $\frac{a}{p} + \frac{1}{p} \rho \not \in \Z[\rho]$. Ainsi $\mathrm{N}(\gamma) > 1$. 
 
 L'égalité $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$, où $\mathrm{N}(\pi) > 1, \mathrm{N}(\gamma)>1$, montre que
 $$ p = \mathrm{N}(\pi).$$
 Si $\pi = x + i\sqrt{2}y,\ x,y \in \Z$, alors $p=x^2 +2y^2$, ce qui prouve le théorème.
 \end{proof}
 
\section{L'anneau $\Z[\omega]$.}

Soit $\omega = e^{2i\pi/3} = -\frac{1}{2} + i \frac{\sqrt{3}}{2}$. Alors $\omega^2 + \omega +1 = 1, \omega^3 = 1$ et $\overline{\omega} = \omega^2 = -1 - \omega$.

Notons $\Z[\omega]$ l'ensemble des nombres complexes de la forme $a +b \omega$ :
$$A = \{z \in \C\ | \ \exists a \in \Z, \ \exists b \in \Z, \ z = a + b \omega\}.$$
$A$ est le plus petit sous-anneau de $\C$ qui contient $\Z$ et $\omega$.

Si $z =a + b \omega \in \Z[\omega]$, alors $\mathrm{N}(z) = (a +b\omega)(a + b \omega^2) = a^2 -ab + b^2$.

Notons que $\Z[\omega]$ est stable par conjugaison :
$$\overline{z} = a + b \omega^2 = a + b(-1 - \omega) = (a-b) - b \omega \in \Z[\omega].$$

Montrons que cet anneau est euclidien, pour la norme usuelle des nombres complexes.
\begin{prop}
Si $z \in \C$, il existe $z_0 \in \Z[\omega]$ tel que $\mathrm{N}(z-z_0)<1$.
\end{prop}

\begin{proof} Soit $z = a +b \omega \in \Z[\omega]$. Il existe des entiers $a_0, b_0$ tels que
$$|a-a_0| < \frac{1}{2}, \quad |b-b_0|<\frac{1}{2}.$$
Alors 
\begin{align*}
\mathrm{N}(z-z_0) & = \mathrm{N}[(a-a_0) + \omega (b-b_0)]\\
&= (a-a_0)^2 -(a-a_0)(b-b_0) + (b-b_0)^2\\
&\leq |a-a_0|^2 + |a-a_0||b-b_0| + |b-b_0|^2\\
&\leq \frac{1}{4} + \frac{1}{4} + \frac{1}{4} = \frac{3}{4}
\end{align*}
\end{proof}

\begin{prop}
$\Z[\omega]$ est un anneau euclidien pour la norme $\mathrm{N}(\cdot)$ de $\C$.
\end{prop}

Même preuve que celle de la proposition \ref{prop2} :
\begin{proof}
Si $a,b\in \Z[\omega]$, et $b \ne 0$, il existe d'après la proposition précédente $q \in \Z[\omega]$ tel que $\left | \frac{a}{b} -q \right| < 1$. Posons alors $r = a - b q = b\left( \frac{a}{b} -q\right)$. Alors $r \in \Z[\omega]$, et
$$a = bq +r, \quad 0\leq \mathrm{N}(r )< \mathrm{N}(b ).$$
Il existe donc une division euclidienne dans $\Z[\omega]$.
\end{proof}

Précisons les unités de $\Z[\omega]$.


\begin{prop}
Pour tout $z \in \Z[\omega]$,
$$z \in \Z[\omega]^{\times} \iff \n(z) = 1.$$
\end{prop}

(Même démonstration que celle de la proposition \ref{prop3}, en utilisant le fait que $\Z[\omega]$ est stable par conjugaison.)

\begin{prop}
$$\Z[\omega]^{\times} = \{1,\omega,\omega^2,-1,-\omega,-\omega^2\} = \mathbb{U}_6.$$
\end{prop}

\begin{proof}
Soit $\alpha = a + b \omega$ une unité dans $\Z[\omega]$. Alors $\n(\omega) = 1$, soit $a^2 -ab + b^2 = 1$. Donc $4 = 4a^2 -4ab + 4 b^2 = (2a-b)^2 + 3b^2$. Ceci implique $3b^2 \leq 4$, donc $|b| \leq 1$. Ceci donne deux cas :
\be
\item[$\bullet$] $b = 0, 2a - b = \pm 2$.
\item[$\bullet$] $b = \pm 1, 2a - b = \pm 1$,
\ee
Alors $(a,b) \in \{(1,0),(-1,0),(1,1),(0,1),(0,-1),(-1,-1)\}$, donc $$z = a + b \omega \in \{1,-1,1+\omega, \omega,-\omega, - 1 - \omega\}.$$
Puisque $1+\omega = -\omega^2$, on obtient bien 
$$ z \in \{1,\omega,\omega^2,-1,-\omega,-\omega^2\} .$$
Réciproquement, ces 6 éléments sont de norme 1, donc sont des unités. Ils constituent le groupe des racines 6-ième de l'unité dans $\C$, engendré par $1+ \omega = - \omega^2 = e^{i\pi/3}$.
\end{proof}






\section{Représentation des nombres premiers sous la forme $x^2 + 3y^2$.}\label{section1_8}

Sachant que $\Z[\omega]$ est principal, donnons maintenant la représentation d'un nombre premier sous la forme $x^2 + 3 y^2$.

Le nombre $3$ se décompose sous la forme $3 = 0^2 + 3 \times 1^2$. Prenons maintenant un autre nombre premier.
\begin{prop}\label{prop19}
Soit p  un nombre premier différent de $3$. Alors
$$\exists x \in \Z, \ \exists y \in \Z, \ p=x^2 + 3y^2 \iff p \equiv 1 \pmod {3}.$$

\begin{proof}
\be 
\item[$(\Rightarrow)$] Si $p \ne 3$ vérifie $p =x^2 + 3 y^2,\ x,y \in \Z$, alors $p \equiv x^2 \pmod 3$, et $p\nmid x$ (sinon $p \mid x$, donc $p \mid y,\ p^2 \mid x^2 +3 y^2 = p$ : c'est absurde). Par conséquent $p\equiv 1 \pmod 3$.

\item[$(\Leftarrow)$] 
Notons que, pour tout premier impair différent de $3$, 
$$\legendre{-3}{p}  = (-1)^{\frac{p-1}{2}} \legendre{3}{p}  = (-1)^{\frac{p-1}{2}} (-1)^{\frac{3-1}{2} \frac{p-1}{2}}  \legendre{p}{3} = \legendre{p}{3}.$$
Par conséquent, $$\legendre{-3}{p} = 1 \iff  \legendre{p}{3} = 1  \iff p \equiv 1 \pmod 3.$$

Si $p\equiv 1\pmod 3$, l'équivalence précédente montre que $\legendre{-3}{p} = 1$, donc il existe un entier $a$ tel que $p \mid a^2 + 3$.

Comme $\omega =  -\frac{1}{2} + i \frac{\sqrt{3}}{2}$, alors $i\sqrt{3} = 1 + 2 \omega$, donc
$$a^2 + 3 = (a+i\sqrt{3})(a - i \sqrt{3}) = (a + 1 + 2\omega)(a+1 + 2 \omega^2).$$
Reprenons le schéma de démonstration de la proposition 14.
Soit $I$ l'idéal de $\Z[\omega]$ défini par
   $$I = p \Z[\omega] + (a+1 + 2\omega) \Z[\omega] = \langle p, a+1 + 2 \omega \rangle.$$
   Montrons que $I \ne \Z[\omega]$, en prouvant que l'hypothèse $I = \Z[\omega]$ est absurde.
   
   Soit $\lambda$ un diviseur premier de $p$ dans $\Z[\omega]$ : un tel diviseur existe puisque $\Z[\omega]$ est principal.
   
   Alors $\lambda \mid p$, et $p \mid a^2 + 3 =(a + 1 + 2\omega)(a+1 + 2 \omega^2)$, donc $\lambda \mid (a + 1 + 2\omega)(a+1 + 2 \omega^2)$. L'élément $\lambda$ étant premier, il divise soit $a+1 + 2\omega$, soit $a + 1 + 2\omega^2$.
   
   Dans la premier cas, $\lambda$ divise $p$ et $a+1+2\omega$. Dans le deuxième cas, si $\lambda \mid a+1 + 2\omega^2$, alors $a+1+2\omega^2= \lambda \mu$. Par passage aux conjugués, $a+1+2\omega= \overline{\lambda} \overline{\mu}$, où $\overline{\mu} \in \Z[\omega]$, donc $\overline{\lambda} \mid a+1+2\omega$. De plus $\overline{\lambda} \mid p$ : en effet $p = \lambda \nu$ pour un certain $\nu \in \Z[\omega]$, donc $p =\overline{\lambda} \overline{\nu}$. Notons que $\mathrm{N}(\lambda) = \mathrm{N}(\overline{\lambda})>1$.   
   
 Dans les deux cas, il existe $\xi \in \Z[\omega]$ (où $\xi = \lambda$ ou $\xi = \overline{\lambda}$) tel que $\xi \mid p, \xi \mid a+1+2\omega$, et $\mathrm{N}(\xi) > 1$.
 
 Sous l'hypothèse $I = \Z[\omega]$, alors $1 = p \zeta + (a+1+2\omega) \eta$, où $\zeta, \eta$ sont dans $\Z[\omega]$. Alors $\xi \mid 1$, en contradiction avec $\mathrm{N}(\xi) >1$, ce qui prouve que $I \ne \Z[\omega]$.
 
 Comme $\Z[\omega]$ est principal, il existe $\pi \in \Z[\omega]$ tel que
 $$ p \Z[\omega] + (a+1+2\omega) \Z[\omega] = \pi \Z[\omega].$$
 De plus $\pi$ n'est pas une unité, sinon $\pi \Z[\omega] = \Z[\omega]$. Par conséquent $\mathrm{N}(\pi) > 1$. Nous venons de prouver l'existence d'un pgcd non trivial $\pi$ de $p$ et $a+1+2\omega$.
 
 Comme $p  \in  p \Z[\omega] + (a+1+2\omega) \Z[\omega] = \pi \Z[\omega]$, il existe $\gamma \in \Z[\omega]$ tel que $p = \pi \gamma$, et donc $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$.
 
 Si $\mathrm{N}(\gamma) = 1$, alors $\gamma$ est une unité, donc $p$ et $\pi$ sont associés, et $\pi$ divise $a+1+2\omega$, donc $p$ divise $a+ 1+2\omega$, ce qui est absurde puisque $\frac{a+1}{p} + \frac{2}{p} \omega \not \in \Z[\omega]$. Ainsi $\mathrm{N}(\gamma) > 1$. 
 
 L'égalité $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$, où $\mathrm{N}(\pi) > 1, \mathrm{N}(\gamma)>1$, montre que
 $$ p = \mathrm{N}(\pi).$$
 Si $\pi = x + \omega y,\ x,y \in \Z$, alors $p=\mathrm{N}(\pi) = \mathrm{N}(\omega \pi)$, où 
 $$\pi = x + \omega y, \qquad \omega \pi = -y + (x-y)\omega.$$
 La formule $p = \mathrm{N}(\pi)$ donne  $p = x ^2 -xy + y^2$, soit $4 p = 4x^2 - 4xy + 4 y^2 =(2x-y)^2 + 3y^2$.
 
 La substitution $(x,y) \leftarrow (-y, x-y)$ donne $4 p =(-2y -x+y)^2 + 3(x-y)^2 = (x+y)^2 + 3(x-y)^2$.
 
 Comme $\mathrm{N}(x + \omega y) = x^2 -xy +y^2 =\mathrm{N}(y + \omega x)$, on peut échanger $x$ et $y$.
 
  En résumé, on obtient les trois formules équivalentes suivantes :
 \begin{align*}
 4p &= (2x - y)^2  + 3 y^2,\\
 4p &= (2y -x)^2 + 3x^2,\\
 4 p &= (x+y)^2 + 3(x-y)^2.
 \end{align*}
 
 Si $x$ impair et $y$ pair, alors $p = \left(x - \frac{y}{2}\right)^2 + 3 \left(\frac{y}{2}\right)^2$.

Si $x$ pair et $y$ impair, alors $p = \left(y - \frac{x}{2}\right)^2 + 3 \left(\frac{x}{2}\right)^2$.

Si $x,y$ sont de même parité, alors $p = \left(\frac{x+y}{2}\right)^2 + 3 \left(\frac{x-y}{2}\right)^2$.

Dans les trois cas, $p$ est de la forme $a^2 + 3 b^2$, où $a,b$ sont entiers.
\ee
\end{proof}
\end{prop}




\section{Eléments premiers dans $\Z[\omega]$.}

Les deux propositions suivantes se démontrent comme dans $\Z[i]$ à la section \ref{section_gauss}.

\begin{prop}\label{prop20}
Soit $\pi \in \Z[\omega]$. Si $\mathrm{N}(\pi)$ est premier dans $\Z$, alors $\pi$ est premier dans $\Z[\omega]$.
\end{prop}

\begin{prop}\label{prop21}
Soit $\pi$ un élément premier dans $\Z[\omega]$. Alors il existe un unique entier rationnel premier $p\in \N$ tel que $\pi \mid p$.
\end{prop}

Donnons d'abord une liste d'éléments premiers dans $\Z[\omega]$ :
\be
\item[$\bullet$] Comme $x^2+x+1 = (x-\omega)(x-\omega^2)$, $\n(1-\omega) = (1-\omega)(1-\omega^2) = 3$ est premier dans $\Z$, donc $1-\omega$ est premier dans $\Z[i]$, ainsi que ses 6 associés $1-\omega,1+2\omega,-2-\omega,-1+\omega,-1-2\omega,2+\omega$.

\item[$\bullet$] Soit $q \equiv 2 \pmod 3$ un premier rationnel, $q>0$. Montrons que $q$ est premier dans $\Z[\omega]$. Dans le cas contraire, $q = \alpha \beta$, où $\alpha, \beta \in \Z[\omega]$ vérifient $\n(\alpha)>1, \n(\beta)>1$. Alors $q^2 = \n(\alpha)\n(\beta)$, donc $\n(\alpha) = q$. Si $\alpha = a + b \omega$, alors $q = a^2 -ab +b^2$, donc $4q = (2a -b)^2 + 3b^2$, et ainsi $q \equiv (2a -b)^2 \not \equiv -1 \pmod 3$. Cette contradiction montre que $q$ est premier dans $\Z[\omega]$ (ainsi que ses associés $\pm q, \pm \omega q, \pm \omega^2 q$).

\item[$\bullet$] Soit $\pi = a + b \omega\in \Z[\omega]$ tel que $p = \n(\pi) = a^2 -ab +b^2$ est premier dans $\Z$ (donc $4 p = (2a -b)^2 + 3b^2$, ce qui montre que $p \equiv 1 \pmod 3$). Alors $\pi$ est premier dans $\Z[\omega]$ puisque $\n(\pi)$ est premier dans $\Z$.
\ee

Ces éléments seront appelés les éléments premiers connus dans $\Z[\omega]$. Montrons que cette liste est exhaustive.

\begin{prop} \label{prop22} 
Les éléments premiers dans $\Z[\omega]$ sont
\be
\item[(i)] $1 - \omega$ et ses associés,
\item[(ii)] les entiers rationnels $q \equiv 2 \pmod 3, q>0,$ premiers dans $\Z$, ainsi que leurs associés,
\item[(iii)] les éléments $\pi = a + b \omega$ tels que $ p = \pi \overline{\pi} = a^2 -ab +b^2 \equiv 1 \pmod 3$ soit premier dans $\Z$.
\ee
\end{prop}
\begin{proof}
Soit $\pi = a + b\omega$ un élément premier dans $\Z[\omega]$. La proposition \ref{prop21} montre qu'il existe un premier rationnel $p\in \N$ tel que $\pi \mid p$.
Discutons les trois seuls cas possibles, $p = 3$, $p\equiv 2 \pmod 3$, et $p \equiv 1 \pmod 3$.
\be
\item[(i)] Supposons que $\pi \mid 3$. Comme $3 = (1-\omega)(1-\omega^2) = (1+\omega) (1-\omega)^2 = -\omega^2(1- \omega)^2$, où $1-\omega$ est premier, et $-\omega^2$ est une unité, alors $\pi$ est associé à $1-\omega$.

\item[(ii)] Supposons que $\pi \mid p$, où $p \equiv 2 \pmod 3$. Comme $p$ est un élément premier connu, $\pi$ est associé à $p$.

\item[(iii)] Supposons que $\pi  = a + b \omega \mid p$, où $p \equiv 1 \pmod 4$. Alors $p = \pi \lambda$ pour un certain $\lambda \in \Z[\omega]$. Montrons par l'absurde que $p$ n'est pas premier dans $\Z[\omega]$. Comme vu dans la section \ref{section1_8}, $\legendre{-3}{p} = \legendre{p}{3} = 1$, donc il existe un entier $a$ tel que $p \mid a^2 + 3$.

Alors $p \mid a^2 + 3 = (a + 1 + 2\omega)(a+1 + 2 \omega^2)$. Ici $p$ est supposé premier,  donc $p \mid a + 1 + 2\omega$, ou $p \mid a + 1 + 2\omega^2$, en contradiction avec le fait que $\frac{a+1}{p} + \frac{2}{p} \omega \not \in \Z[\omega]$ (ni son conjugué, puisque $\Z[\omega]$ est stable par conjugaison).

Ainsi $p$ n'est pas premier, donc $\lambda$ n'est pas une unité. Par conséquent $p = \pi \lambda,$, où $\n(\pi)>1, \n(\lambda)>1$. L'égalité $p^2 = \n(\pi)(\n(\lambda)$ montre que $p = \n(\pi) = \pi \overline{\pi} = a^2 -ab +b^2$.
\ee

Remarque : si $p$ est un premier rationnel tel que $p \equiv 1 \pmod 3$, il admet un diviseur premier $\pi = a + b \omega \in \Z[\omega]$, et le (iii) prouve que $p = a^2 - ab +b^2$. D'après la fin du raisonnement de la section \ref{section1_8}, ceci montre que $p$ est de la forme $x^2 + 3y^2$, ce qui donne une nouvelle preuve de la proposition \ref{prop19}.
\end{proof}

Nous pouvons donner l'analogue de la proposition 11 dans $\Z[\omega]$ :

\begin{prop}
Soit $p \equiv 1 \pmod 3$ un premier rationnel. Il existe 12 diviseurs premiers de $p$ dans $\Z[\omega]$,  constituant deux classes d'association distinctes.
\end{prop}
\begin{proof}
Comme $p \equiv 1 \pmod 3$, la remarque précédente montre que $p = \pi \overline{\pi} = a^2 -ab + b^2$, où $\pi = a + b \omega \in \Z[\omega]$. Comme
$$\frac{\pi}{\overline{\pi}} = \frac{a+b \omega}{a+ b \omega^2} = \frac{(a+b\omega)^2}{\n(\pi)} = \frac{a^2 - b^2}{\n(\pi)} + \frac{(2a-b)b}{\n(\pi)} \omega,$$
alors $\frac{\pi}{\overline{\pi}}  \in \{1,-1,\omega,-\omega, -1 - \omega,1 +\omega\}$ entraîne $a^2 - b^2 = 0$ ou $(2a-b)b =0$ ou $a^2 - b^2 = (2a-b)b$, soit $a = b$ ou $a = -b$ ou $2a - b = 0$ ou $b=0$ ou $a= 0$ ou $2b-a =0$. L'égalité $p = a^2 -ab + b^2$, où $p$ est un premier différent de $3$, montre que $a= \pm b$ est impossible, ainsi que $a = 0$ ou $b = 0$. L'égalité $4p = (2a-b)^2 + 3b^2$ montre que $2a -b=0$ est impossible, et l'égalité $4 p = (2b -a)^2 + 3a^2$ montre que $2b -a = 0$ est impossible. Ceci montre que $\pi$ n'est pas associé à $\overline{\pi}$. 

Le reste de la démonstration se fait comme dans la proposition \ref{prop11}.
\end{proof}



\section{La forme $x^2 + n y^2$ si $n>3$.}

Nous savons que si $p \equiv 1 \pmod 4$, alors $p = x^2 + y^2$. Alors $x$ et $y$ sont de parité distinctes, sinon $p$ serait pair, donc $p = 2$, mais $2 \not \equiv 1 \pmod 4$. Quitte à échanger $x,y$, on peut supposer que $x$ est impair et $y$ pair. Donc $y = 2z, z \in \Z$, et donc $p = x^2 + 4 z^2$. Inversement, puisque $2$ ne s'exprime pas sous la forme $x^2 + 4 z^2$, si $p = x^2 + 4 z^2 = x^2 + (2z)^2$, alors $p \equiv 1 \pmod 4$.

A ce stade, nous avons prouvé les équivalence suivantes :

si $p$ est un nombre premier ($p \ne 2, p \ne 3$) alors
\begin{align*}
p = x^2 + y^2, \ x,y \in \Z \iff  p \equiv 1 \pmod 4 &\iff \legendre{-1}{p} = 1\\
p = x^2 + 2 y^2,\ x,y \in \Z \iff p \equiv 1,3 \pmod 8 &\iff \legendre{-2}{p} = 1\\
p = x^2 + 3 y^2, \ x,y \in \Z  \iff p \equiv 1 \pmod 3 &\iff \legendre{-3}{p} = 1\\
p = x^2 + 4 y^2, \ x,y \in \Z  \iff p \equiv 1 \pmod 4 &\iff \legendre{-4}{p} = 1
\end{align*}

Si on voulait généraliser, on peut bien sûr affirmer que
$$p = x^2 + n y^2 \Rightarrow \legendre{-n}{p} = 1,$$
mais l'équivalence est fausse dès $n=5$.
En effet $\legendre{-5} p = 1 \iff p\equiv 1,3, 7,9 \pmod {20}$, mais, comme l'ont remarqué Fermat et Euler, $p = x^2 + 5 y^2,\ x,y \in \Z$ équivaut à $p=1,9 \pmod {20}$, et $2p = x^2 + 5y^2$ équivaut à $p\equiv 3,7 \pmod {20}$. Par exemple $23$ ne s'écrit pas sous la forme $x^2 + 5 y^2$, mais $2 \times 23 = 46 = 1^2 + 5 \times 3^2$.

Les démonstrations précédentes ne peuvent se généraliser, car $\Z[\sqrt{-5}]$ n'est pas principal. Si $\omega = i\sqrt{5}$, alors $6 = 2 \times 3 = (1 + \omega)(1-\omega)$. On vérifie au chapitre ``Entiers d'un corps quadratique'', que $2,3 = 1 + \omega, 1- \omega$ sont des éléments premiers non associés. Cette égalité montre donc que $\Z[\sqrt{-5}]$ n'est pas factoriel, et a fortiori il n'est pas principal. Les chapitres suivants nous permettrons de traiter ce cas.
