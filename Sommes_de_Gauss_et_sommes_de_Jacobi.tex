

\chapter{Sommes de Gauss et sommes de Jacobi.}
Les résultats de ce chapitre sont adaptés de [Ireland,Rosen].
\section{Caractérisation des puissances $n$-ièmes dans un corps fini.}
\begin{prop}\label{nbsols}
Soit $\F_q$ un corps fini à $q$ éléments, et soit  $\alpha \in \F_q^*$.
\be
\item[(a)] L'équation $x^n = \alpha$ a au moins une solution si et seulement si $\alpha^{\frac{q-1}{d}} = 1$, où $d = n \wedge (q-1)$.
$$\exists x \in \F_q^*,\  x^n = \alpha \iff \alpha^{\frac{q-1}{d}} = 1 \qquad (\text{où } d = n \wedge (q-1)).$$
\item[(b)] Si l'équation $x^n = \alpha$ a une solution, elle en a exactement $d =n \wedge (q-1)$.
\ee
\end{prop}
\begin{proof}
Rappelons que, le groupe $\F_q^*$ ayant $q-1$ éléments, tout élément $\alpha$ de $\F_q^*$ vérifie $\alpha^{q-1} = 1$, et aussi que $\F_q^*$ est cyclique : appelons $g$ un générateur de ce groupe.

Alors il existe un entier $a$ tel que $\alpha = g^a$, et tout $x \in \F_q^*$ s'écrit sous la forme $x = g^y$ pour un certain entier $y$. Alors

$$x^n = \alpha \iff g^{ny} = g^a \iff g^{ny-a} = 1 \iff q-1 \mid ny -a.$$
\be
\item[(a)] 
Supposons qu'il  existe $x\in \F_q$ tel que $x^n = \alpha$. Alors il existe $y\in \Z$ tel que $q-1 \mid ny -a$. Comme  $d \mid q-1$, et $d \mid n$,  alors  $d \mid a$.

Puisque $\frac{a}{d}$ est un entier, 
$$\alpha^{\frac{q-1}{d}} = g^{a \frac{q-1}{d}} = \left(g^{q-1}\right)^{\frac{a}{d}} = 1.$$
Réciproquement, supposons que $\alpha^{\frac{q-1}{d}}  = 1$. Alors $g^{a \frac{q-1}{d}} = 1$, donc $q-1 \mid a \, \frac{q-1}{d}$, soit $d \mid a$. 
Comme $d = n \wedge (q-1)$, il existe des entiers $u,v$ tels que $un + v(q-1) = d$, donc $u \frac{n}{d} + v \frac{q-1}{d} = 1$. Alors, puisque $\frac{a}{d}$ est un entier,
\begin{align*}
\alpha &= g^a\\
&=  g^{\left(u\frac{n}{d} + v \frac{q-1}{d}\right)a}\\
&=  \left(g^{u \frac{a}{d}}\right)^n \left(g^{q-1} \right)^{v \frac{a}{d}}\\
&=\left(g^{u \frac{a}{d}}\right)^n
\end{align*}
Ainsi $x = g^{u \frac{a}{d}}$ est une solution de $x^n = \alpha$.

\item[(b)] Supposons que l'équation $x^n = \alpha$ ait une solution $x = g^y$. D'après la partie (a), avec les mêmes notations, $d$ divise $a$. Cherchons alors toutes les solutions de $x^n = \alpha$, ce qui revient à trouver tous les $y \in \Z$ tels que $q-1 \mid ny - a$ soit $\frac{n}{d} y \equiv \frac{a}{d} \pmod {\frac{q-1}{d}}$.

Si $u,v$ sont les entiers tels que $un + v(q-1) = d$, alors $u \frac{n}{d} +v \frac{q-1}{d} = 1$, donc $u \frac{n}{d} \equiv 1 \pmod {\frac{q-1}{d}}$. Ainsi
$$\frac{n}{d} y \equiv \frac{a}{d} \pmod {\frac{q-1}{d}} \iff y \equiv u \frac{a}{d} \pmod {\frac{q-1}{d}}.$$
Les solutions $x = g^y$ de $x^n = \alpha$ sont données par les valeurs  de $y$ vérifiant
$$y = u \frac{a}{d} + k \frac{q-1}{d}, \ k \in \Z.$$
Notons $y_k = u \frac{a}{d} + k \frac{q-1}{d}$, et $x_k = g^{y_k}$. Alors $y_{k+d} = u \frac{a}{d} + (k +d)  \frac{q-1}{d} \equiv y_k \pmod {q-1}$, donc $x_{k+d} = x_k$.

Les solutions de $x^n = \alpha$ sont donc $x_0,\cdots,x_{d-1}$. Vérifions que ces solutions sont distinctes. Supposons que $x_k = x_l$, où $0\leq k <d, 0\leq l <d$. Alors $g^{y_k} = g^{y_l}$, donc $q-1 \mid y_k - y_l = (k-l) \frac{q-1}{d} $, donc $d \mid (k-l)$, où $|k-l| < d$, donc $k=l$.

En conclusion, ou bien $x^n = \alpha$ n'a pas de solution, ou bien les solutions de cette équation sont les $d$ éléments distincts 
$$x = g^{ u \frac{a}{d} + k \frac{q-1}{d}},\ \qquad k = 0,1,\cdots,d-1.$$
\ee
\end{proof}

Exemple 1. Si $q = p$ est un nombre premier impair, et $p \nmid a$, on déduit de cette proposition le résultat bien connu
$$\exists x \in \Z,\  x^2 \equiv a \pmod p \iff a^{\frac{p-1}{2}}  \equiv 1 \pmod p.$$

Exemple 2. Soit $q=p^s$ une puissance d'un nombre premier $p$.

Si $q \equiv 2 \pmod 3$, et $a \in \F_q^*$, alors l'équation $x^3 = a$ a au moins une solution dans $\F_q^*$ si $a^{q-1} = 1$, ce qui est toujours vrai. Ainsi, tout $a \in \F_q$ est un cube dans $\F_q$. De plus $d = 3 \wedge (q-1) = 1$, donc $a\in\F_q^*$ est le cube d'un unique élément de $\F_q^*$. Autrement dit l'application $\F_q^* \to \F_q^*, x \mapsto x^3$ est un automorphisme de groupe de $\F_q^*$.

Si $q \equiv 1 \pmod 3$, alors l'équation $x^3 = a$ a au moins une solution dans $\F_p^*$ si $a^{\frac{q-1}{3}} = 1$, auquel cas elle admet 3 solutions.





\section{Trace et norme dans les corps finis.}
\subsection{Groupe de Galois d'un corps fini.}
La théorie de Galois d'un corps fini est particulièrement simple, et nous la développons ici, sans utiliser les théorèmes généraux de la théorie de Galois.

Soit $F = \F_q$ un corps à $q$ éléments, et $K = \F_{q^s} \supset \F_q$ une extension de $F$ à $q^s$ éléments. Alors $[K:F] = s$.

\begin{dfn}
Un automorphisme $\sigma$ du corps $K$ s'appelle un $F$-automorphisme si pour tout élément $\alpha$ de $F$, $\sigma(\alpha) = \alpha$.
L'ensemble de ces $F$-automorphismes forment un groupe, appelé groupe de Galois de $K$ sur $F$, et noté
$$G = \Gal(K/F).$$
\end{dfn}

Exemples : $1_{K}$ est un élément du groupe de Galois. Un exemple plus intéressant est l'automorphisme de Frobenius $\mathrm{F}$  (il faut distinguer $\mathrm{F} $ et $F$ !), défini par
$$
\mathrm{F}
\left\{
\begin{array}{ccl}
K & \to &K\\
\alpha & \mapsto & \alpha^q.
\end{array}
\right.
$$
Si $\alpha$ est un élément du corps $K$ alors $\mathrm{F}(\alpha) = \alpha^q \in K$. Puisque $q = p^k, k \in \N^*$, où $p$ est la caractéristique de $F$, pour tous les $\alpha, \beta \in K$, $\mathrm{F}(x+y) = (x + y)^{q} = (x + y)^{p^{k}} = x^{p^{k}} +  y^{p^{k}} = \mathrm{F}(\alpha) + \mathrm{F}(\beta)$, et $\mathrm{F}(1) = 1$, $\mathrm{F}(\alpha \beta) = (\alpha \beta)^q =\alpha^q \beta^q= \mathrm{F}(\alpha) F(\beta)$.
De plus comme tout morphisme de corps, $\mathrm{F}$ est injectif : si $\alpha \ne 0$, alors $\mathrm{F}(\alpha) \mathrm{F}(\alpha^{-1}) = \mathrm{F}(\alpha \alpha^{-1}) = \mathrm{F}(1) = 1 \ne 0$, donc $\mathrm{F}(\alpha) \ne 0$. Comme l'injection $\mathrm{F}$ applique $K$ dans $K$, où $K$ est fini, $\mathrm{F}$ est une bijection.

Si $\alpha \in F = \F_q$, alors $\alpha^q = \alpha$, donc $\mathrm{F}(\alpha) = \alpha$. Ainsi $\mathrm{F} \in \Gal(K/F)$.

Cet automorphisme suffit pour décrire le groupe $G$.

\begin{prop} Le groupe de Galois $G = \Gal(K/F)$ est un groupe cyclique d'ordre $s = [K : F]$, engendré par l'automorphisme de Frobenius $\mathrm{F}$.
\end{prop}

\begin{proof}
Soit $g$ un générateur du groupe cyclique $K^*$. Considérons un élément quelconque $\sigma \in G$. Alors $(\mathrm{F}^{-1} \circ \sigma)(g) \ne 0$, et donc $(\mathrm{F}^{-1} \circ \sigma)(g)= g^i$, pour un certain $i \in \gcro 0,  q^s - 2 \dcro$, ce qui donne $\sigma(g) = \mathrm{F}(g)^i$. Si $\alpha$ est un élément de $K^*$, alors $\alpha = g^k$, où $k$ est un entier, donc $\sigma(\alpha) = \sigma(g)^k = \mathrm{F}(g)^{ik} = \mathrm{F}(g^k)^i = \mathrm{F}^i(\alpha)$ (et $\sigma(0) = 0 = \mathrm{F}^i(0)$). Ceci prouve que $\sigma = \mathrm{F}^i$, et ainsi $G$ est cyclique, engendré par $\mathrm{F}$.

Pour tout $\alpha \in K$, $\mathrm{F}^s(\alpha) = \alpha^{q^s} =\alpha$, donc $\mathrm{F}^{s} = 1_{K}$. De plus, si $\mathrm{F}^k = 1_{K}$ pour un entier $k$, alors pour tout $\alpha \in K$, $\alpha^{q^k} = \mathrm{F}^k(\alpha) = \alpha$, en particulier $g^{q^k} = g$, donc $g^{q^k-1} = 1$, où le générateur $g$ est d'ordre $q^s - 1$, ce qui prouve que $q^s - 1 \mid q^k - 1$, donc $s \mid k$. L'ordre de $\mathrm{F}$ est donc égal à $s$, ainsi que l'ordre du groupe $G = \langle \mathrm{F} \rangle = \{1_{K}, \mathrm{F}, \ldots,\mathrm{F} ^{s-1}\}$.
\end{proof}


La proposition suivante montre que l'extension $F \subset K$ entre deux corps finis est galoisienne.
\begin{prop}\label{prop26}
Soient $F, K$ deux corps finis tels que $F \subset K$, et soit $\alpha \in K$. Notons $p(x) = \Pi_{\alpha,F} \in F[x]$ le polynôme minimal de $\alpha$ sur $F$, où $r = \deg(p) = [F[\alpha] : F]$. Alors
\be
\item[(i)] Le polynôme $p$ est scindé dans $K$, i.e. $p$ est produit de facteurs linéaires $x - \beta$, où $\beta \in K$.
\item[(ii)] Toutes les racines du polynôme $p$ sont simples.
\ee
Ainsi $p(x) = \prod_{\beta \in S}( x- \beta) = (x- \beta_1)\ldots(x- \beta_r)$, où $S = \{\beta_1,\ldots,\beta_r\} \subset K$, et les $\beta_i,\ i= 1,\ldots,r,$ sont distincts.
\end{prop}

\begin{proof} Ici $|F| = q$, et $|K| = p^s$. Notons $L = F[\alpha]$.

Comme $F \subset K$, et $\alpha \in K$, alors $F \subset L \subset K$. Alors $L$ est un corps à $q^r$ éléments, où $r = [L : F] = \deg(p)$, et $r \mid s$.

Par conséquent tout élément $\gamma \in L$ vérifie $\gamma^{q^r} = \gamma$. Puisque $\alpha \in L$, $\alpha$ est racine du polynôme $x^{q^r} - x \in F[x]$, donc son polynôme minimal $p(x)$ divise $x^{q^r} - x = \prod\limits_{ \beta \in L} (x - \beta)$.

Le polynôme $x^{q^r} - x$ ayant $q^r$ racines distincts dans $L \subset K$, il en va de même de son diviseur $p(x)$. Ainsi $p(x) = \prod\limits_{x \in S} (x- \beta)$, où $S \subset L \subset K$, ce qui montre (i) et (ii).
\end{proof}

Nous pouvons préciser les racines de $p(x)$.

\begin{prop} En gardant les conditions de la proposition {\rm \ref{prop26}}, notons $\mathrm{F}$ le $F$-automorphisme de Frobenius de $K$. Alors
$$p(x) = \Pi_{\alpha,F}(x) = \prod_{i = 0}^{r-1} (x - \mathrm{F}^i(\alpha)) = \prod_{i = 0}^{r-1} (x - \alpha^{q^i}).$$
\end{prop}

\begin{proof}Si $q  = \sum_{i=0}^d a_i x^i\in K[x]$, notons $\mathrm{F}\cdot q =  \sum_{i=0}^d \mathrm{F}(a_i) x^i$. Si $q,r \in K[x]$, $\mathrm{F} \cdot (q +r) = (\mathrm{F}\cdot q) + (\mathrm{F}\cdot r)$ et $\mathrm{F} \cdot (q r) = (\mathrm{F}\cdot q)(\mathrm{F}\cdot r)$. Alors, en appliquant $\mathrm{F}$ au polynôme $ s = \prod_{i = 0}^{r-1} (x - \mathrm{F}^i(\alpha)) $, nous obtenons, en utilisant $\alpha^{q^r} = \alpha$, soit $\mathrm{F}^r(\alpha) = \alpha$,
\begin{align*}
\mathrm{F} \cdot s &= \mathrm{F} \left( \prod_{i = 0}^{r-1} \left(x - \mathrm{F}^i(\alpha)\right)\right)\\
 &=   \prod_{i = 0}^{r-1} \mathrm{F}\cdot (x - \mathrm{F}^i(\alpha))\\
&=  \prod_{i = 0}^{r-1} (x - \mathrm{F}^{i+1}(\alpha))\\
&= \prod_{j = 1}^{r} (x - \mathrm{F}^{j}(\alpha))\qquad (j = i+1)\\
&=(x - \mathrm{F}^r(\alpha))\prod_{j = 1}^{r-1} (x - \mathrm{F}^{j}(\alpha))\\
&= (x- \alpha) \prod_{j = 1}^{r-1} (x - \mathrm{F}^j(\alpha))\\
&=\prod_{j = 0}^{r-1} (x - \mathrm{F}^j(\alpha))\\
&= s
\end{align*}
L'égalité $\mathrm{F} \cdot s = s$ montre que tous les coefficients de $s$ sont dans $F$, soit $s \in F[x]$. Puisque $s(\alpha) = 0$, le polynôme minimal $p$ divise $s$. Mais $p$ et $R$  sont de même degré $r$, et sont normalisés, donc $p = r$, ce qui prouve
$$p(x) = \Pi_{\alpha,F}(x) = \prod_{i = 0}^{r-1} (x - \mathrm{F}^i(\alpha)) = \prod_{i = 0}^{r-1} (x - \alpha^{q^i}).$$

\end{proof}



\subsection{Trace et norme.}
Considérons encore l'extension $F \subset K$ de degré $s$.

Pour chaque $\alpha \in K$, définissons l'application $m_{\alpha}$ de multiplication par $\alpha$ par
$$
m_{\alpha}
\left\{
\begin{array}{ccc}
K & \to & K\\
\gamma & \mapsto & \alpha \gamma.
\end{array}
\right.
$$
Alors $m_\alpha$ est un endomorphisme du $F$-espace vectoriel $K$.

\begin{dfn}
 $\chi_{\alpha,K/F} \in F[x]$ est le polynôme caractéristique de $m_x$ : 

$$\chi_{\alpha,K/F}(x)= \det(x\, \mathrm{Id}_L - m_\alpha),$$
et la trace et la norme de $\alpha$ sont définis par
$$\mathrm{Tr}_{K/F}(\alpha) = \mathrm{tr}(m_\alpha),\qquad \mathrm{N}_{K/F}(\alpha) = \det(m_\alpha),$$
où $\mathrm{tr}$ et $\det$, définis en algèbre linéaire, désignent la trace et la norme d'un endomorphisme.
\end{dfn}

Cette définition montre que, pour tout $\alpha \in K$, $\mathrm{Tr}_{K/F}(\alpha)$ et $\mathrm{N}_{K/F}(\alpha) $ sont des éléments de $F$.
\begin{prop}
\be
Si $a,b \in F$, et $\alpha,\beta \in K$,  
\item[(i)] 
$$
\mathrm{Tr}_{K/F}(a \alpha + b \beta)  = a \mathrm{Tr}_{K/F}(\alpha) + b \mathrm{Tr}_{K/F}(\beta).
$$
Autrement dit, la trace est $F$-linéaire.
\item[(ii)]
\begin{align*}
\mathrm{N}_{K/F}(\alpha\beta)  &= \mathrm{N}_{K/F}(\alpha) \mathrm{N}_{K/F}(\beta),\\
\mathrm{N}_{K/F}(a \alpha) &= a^s \mathrm{N}_{K/F}(\alpha),
\end{align*}
où $s = [K:F]$.
\ee
\end{prop}

\begin{proof} 
\be
\item[(i)] Notons que $m_{a\alpha + b \beta} = a m_\alpha + b m_\beta$. La linéarité de la trace donne alors
\begin{align*}
\mathrm{Tr}_{K/F}(a \alpha + b \beta) &= \mathrm{tr}(a m_\alpha + b m_\beta)\\
&= a \, \mathrm{tr}(m_\alpha) + b\,  \mathrm{tr}(m_\beta)\\
&= a \mathrm{Tr}_{K/F}(\alpha) + b \mathrm{Tr}_{K/F}(\beta).
\end{align*}
\item[(ii)] Comme $m_{\alpha \beta} = m_\alpha \circ m_\beta$,
\begin{align*}
\mathrm{N}_{K/F}(\alpha\beta) &= \det(m_{\alpha \beta})\\
&= \det(m_\alpha \circ m_\beta)\\
&= \det(m_\alpha) \det(m_\beta)\\
&= \mathrm{N}_{K/F}(\alpha) \mathrm{N}_{K/F}(\beta).
\end{align*}
En utilisant $m_{a\alpha} = a m_\alpha$ si $a \in F$,
\begin{align*}
\mathrm{N}_{K/F}(a \alpha) &= \det(m_{a \alpha})\\
&= \det(a m_\alpha)\\
&=a^s \det(m_\alpha)\\
&= a^s \mathrm{N}_{K/F}(\alpha).
\end{align*}

\ee
\end{proof}

Si $\alpha \in K$, la relation entre le polynôme minimal $\Pi_{\alpha,F}$ et le polynôme caractéristique $\chi_{\alpha,K/F}$ est donnée dans la proposition suivante.

\begin{prop}\label{prop29}
Si $\alpha \in K$, alors $\chi_{\alpha,K/F} = \Pi_{\alpha,F}^r$, où $r = [K:F(\alpha)]$.
\end{prop}

\begin{proof}
Notons $n = [F(\alpha) : F], r = [K : F(\alpha)]$. Si $(e_1,\ldots,e_r)$ est une base de $K$ sur $F(\alpha)$, comme $(1,\alpha,\ldots,\alpha^{n-1})$ est une base de $F(\alpha)$ sur $F$, le lemme télescopique montre que
$${\cal B} = (e_1,\alpha e_1,\ldots,\alpha^{n-1}e_1,\ e_2, \alpha e_2,\ldots,\alpha ^{n-1}e_2,\  \ldots,e_r,\alpha e_r,\ldots,\alpha^{n-1}e_r)$$
est une base de $K$ sur $F$.

Les sous-espaces  $E_i = \mathrm{Vect} (e_i,\ldots,\alpha^{n-1}e_i), \ i=1,\ldots r$ sont stables pour l'endomorphisme $m_\alpha$ : en effet, si on note $P(x) = \Pi_{\alpha,K}(x) = x^n + a_{n-1}x^{n-1}+ \cdots+a_0$, alors $\alpha^n = -a_0 - \cdots - a_{n-1} \alpha^{n-1}$, et
\begin{align*}
&m_{\alpha}(\alpha^i e_j) =\alpha^{i+1} e_j \  (0 \leq i \leq n-2, 1 \leq j \leq r),\\
&m_{\alpha}(\alpha^{n-1} e_j) = \alpha^n e_j = - \sum_{k=0}^{n-1} a_k \alpha^k e_j.
\end{align*}
Donc la matrice de l'application induite par $m_\alpha$ sur $E_i$ est la matrice compagnon

$$
A = 
\begin{pmatrix}
0   & 0 &  \cdots    & 0  & -a_0\\
1  &     0      &       &              &-a_1\\ 
0 &    1        &   \ddots   &              & -a_2\\
\vdots & \ddots  &   1  &    0           & \vdots\\
0 & \cdots  &      0 &            1  &- a_{n-1}
\end{pmatrix},
$$

et 
$$M = {\cal M}_{\cal B} (m_\alpha)=
\begin{pmatrix}
A & 0  & \cdots & 0\\
0 & A  & \ddots & \vdots\\
 \vdots & \ddots    &\ddots  & 0\\
0 & \cdots  & 0 & A
\end{pmatrix}.
$$

Rappelons le calcul du polynôme caractéristique de la matrice compagnon $A$ :
 $$\chi_A(x) = \det (x I_n - A) = 
\begin{vmatrix}
x  & 0 &\cdots       & 0  & a_0\\
-1  &     x      &       &              &a_1\\ 
0 &    -1        &   \ddots   &              & a_2\\
\vdots & \ddots  &   -1  &    x           & \vdots\\
0 & \cdots  &      0 &            -1  & x+a_{n-1}
\end{vmatrix}
$$

Ce déterminant se calcule par une relation de récurrence : posons
$$D_k =
\begin{vmatrix}
x  &  0&   \cdots   & 0  & a_0\\
-1  &     x      &       &              &a_1\\ 
0 &    -1        &   \ddots   &              & a_2\\
\vdots & \ddots  &   -1  &    x           & \vdots\\
0 & \cdots  &      0 &            -1  & a_k
\end{vmatrix}
$$

Le développement de $D_k$ suivant la dernière ligne donne $D_k = a_k x^k + D_{k-1}$, et par récurrence $D_k = a_kx^k+a_{k-1}x^{k-1}+ \cdots+a_0$.

Ce résultat, appliqué à la matrice $x I_n - A$ donne $\det(xI_n-A) = (x+a_{n-1})x^{n-1} + D_{n-2} =  x^n+ a_{n-1} x^{n-1}+ \cdots + a_0 = P(x)$, donc
$$\det(xI_n-M) = P(x)^r.$$
Ainsi $\chi_{\alpha,K/F}= \Pi_{\alpha,F}^r$, où $r = [K:F(\alpha)]$.
\end{proof}

\begin{prop}
Soit $F\subset K$ une extension de corps finis, avec $|F| = q, |K| = q^s$, et soit $\alpha \in K$.  Notons $G = \Gal(K/F)$ le groupe de Galois de $K$ sur $F$. Alors
\be
\item[(i)]  $\chi_{\alpha,K/F}(x) = \prod\limits_{\sigma\in G}(x - \sigma(\alpha)) = (x - \alpha)(x- \alpha^q)\cdots (x- \alpha^{q^{s-1}})$.
\item[(ii)] $\mathrm{Tr}_{K/F}(\alpha) = \sum\limits_{\sigma\in G} \sigma(\alpha) = \alpha + \alpha^q + \cdots + \alpha^{q^{s-1}}$.
\item[(iii)] $\mathrm{N}_{K/F}(\alpha) = \prod\limits_{\sigma\in G} \sigma(\alpha) = \alpha \cdot \alpha^q \cdot \  \cdots\   \cdot \alpha^{q^{s-1}}$.
\ee
\end{prop}

\begin{proof}
\be
\item[(i)] Partons de la factorisation dans $K[x]$ du polynôme minimal de $\alpha$ sur $F$:
$$\Pi_{\alpha,F}(x) = \prod_{i = 0}^{r-1}(x - \alpha^{q^i})   =  \prod_{i = 0}^{r-1}(x - \mathrm{F}^i(\alpha))\qquad ( r = [F[\alpha] : F],\  r \mid s).$$
Posons $e = [K : F[\alpha]]$, si bien que $s = er$. Tout entier $k \in \gcro 0, s\gcro$ s'écrit, par la division euclidienne de $k$ par $r$, sous la forme $k = jr + i, \ 0 \leq i < r, \ 0 \leq j < e$. Ceci justifie les égalités suivantes :
\begin{align*}
\prod_{\sigma\in G}(x - \sigma(\alpha)) &=  \prod_{k= 0}^{s-1}(x - \mathrm{F}^k(\alpha))\\
&= \prod_{j = 0}^{e-1} \prod_{i= 0}^{r-1} (x - \mathrm{F}^{j r + i}(\alpha))\\
&=\prod_{j = 0}^{e-1} \prod_{i= 0}^{r-1} (x - \mathrm{F}^{ i}(\alpha))\qquad (\text{car } F^r(\alpha) = \alpha)\\
&= \prod_{j = 0}^{e-1} \Pi_{\alpha,F}(x) \\
&=  \Pi_{\alpha,F}^e\\
&= \chi_{\alpha,K/F}(x), 
\end{align*}
la dernière égalité venant de la proposition \ref{prop29}. Ceci prouve (i).

\item[(ii),(iii)] Le développement de $\chi_{\alpha,K/F}(x) $ donne, par définition de la trace et de la norme d'un nombre algébrique :
$$\chi_{\alpha,K/F}(x) = x^n - \mathrm{Tr}_{K/F}(\alpha) x^{n-1} + \cdots + (-1)^n \mathrm{N}_{K/F}(\alpha)\quad (n = [K:F]),$$
et le développement de la formule de la partie (i) donne
$$\chi_{\alpha,K/F}(x) = x^n - \left(\sum\limits_{\sigma\in G} \sigma(\alpha)\right) x^{n-1} + \cdots + (-1)^n \prod\limits_{\sigma\in G} \sigma(\alpha).$$
Ainsi
$$\mathrm{Tr}_{K/F}(\alpha) = \sum\limits_{\sigma\in G} \sigma(\alpha) = \alpha + \alpha^q + \cdots + \alpha^{q^{s-1}}.$$
$$\mathrm{N}_{K/F}(\alpha) = \prod\limits_{\sigma\in G} \sigma(\alpha) = \alpha \cdot \alpha^q \cdot \  \cdots\   \cdot \alpha^{q^{s-1}}.$$
\ee
\end{proof}

Donnons quelques propriétés de la trace et de la norme.
\begin{prop}\label{trace_surjective}
\be
\item[(i)] L'application $\mathrm{Tr} = \mathrm{Tr}_{K/F} : K \to F$ est surjective.
\item[(ii)] La restriction
$$\varphi
\left\{
\begin{array}{ccl}
K^* & \to & F^*\\
\alpha & \mapsto & \mathrm{N}_{K/F}(\alpha)
\end{array}
\right.
$$
est surjective.
\ee
\end{prop}
\begin{proof}
\be 
\item[(i)]Le polynôme $p (x) = x + x^q + \cdots + x^{q^{s-1}}$, de degré $q^{s-1}$, a au plus $q^{s-1}$ racines. Comme $|K| = q^s$, il existe un élément $\alpha \in K$ tel que $p(\alpha) \ne 0$. Alors $c = \mathrm{Tr}(\alpha) = p(\alpha) \ne 0$. Si $b \in F$, alors $\mathrm{Tr}(c^{-1} b \alpha) = c^{-1} b \mathrm{Tr}(\alpha) = b$, ce qui prouve la surjectivité de $\mathrm{Tr}_{K/F} : K \to F$.

\item[(ii)] Notons d'abord que $\alpha \ne 0$ entraîne $\mathrm{N}_{K/F}(\alpha)  = \alpha \cdot \alpha^q \cdot \  \cdots\   \cdot \alpha^{q^{s-1}} \ne 0$, ce qui montre que $\varphi$ est correctement défini.


L'application $\varphi$ est un homomorphisme de groupes. Précisons son noyau. Si $\alpha \in K$,
\begin{align*}
\alpha \in \ker(\varphi) &\iff 1 = \alpha \cdot \alpha^q\cdot \ \cdots\  \cdot \alpha^{q^{s-1}}\\
&\iff 1 = \alpha^{1+q+\cdots + q^{s-1}} = \alpha^{\frac{q^s-1}{q-1}}.
\end{align*}

Puisque $\frac{q^s-1}{q-1}$ divise $q^s - 1 = |K|$, la proposition \ref{nbsols} du chapitre ``Sommes de Gauss et somme de Jacobi'' montre que l'équation $ \alpha^{\frac{q^s-1}{q-1}} = 1$ a exactement $\frac{q^s-1}{q-1} = (\frac{q^s-1}{q-1}) \wedge (q^s - 1)$ solutions. Ainsi
$$|\ker(\varphi)| = \frac{q^s-1}{q-1}.$$
Le premier théorème d'isomorphisme donne alors $|\mathrm{im}(\varphi)| = |K^*|/ |\ker(\varphi)| = q-1$. Ainsi $|\mathrm{im}(\varphi)|  =|F^*|$, avec $\mathrm{im}(\varphi) \subset F^*$, donc $\mathrm{im}(\varphi) = F^*$, ce qui prouve que l'application $\varphi$ est surjective.
\ee
\end{proof}

\begin{prop}
Soient $F \subset E \subset K$ trois corps finis, et $\alpha \in K$. Alors
\be
\item[(i)] $\mathrm{Tr}_{K/F}(\alpha) = \mathrm{Tr}_{E/F}(\mathrm{Tr}_{K/E}(\alpha))$,
\item[(ii)] $\mathrm{N}_{K/F}(\alpha) = \mathrm{N}_{E/F}(\mathrm{N}_{K/E}(\alpha))$.
\ee
\end{prop}

\begin{proof}
Posons $d = [E:F], m = [K:E]$, et $n = [K:F]$. Alors $n = dm$. Si $q = |F|$, alors $q_1 = |E| = q^d$ et $|K| = q^n$. De plus
$$\mathrm{Tr}_{K/E}(\alpha) = \alpha + \alpha^{q_1}+ \cdots + \alpha^{q_1^{m-1}}.$$

Alors
\begin{align*}
\mathrm{Tr}_{E/F}(\mathrm{Tr}_{K/E}(\alpha)) &=\sum_{i=0}^d \mathrm{Tr}_{K/E}(\alpha)^{q^i}\\
&=\sum_{i=0}^d \sum_{j=0}^{m-1} \alpha^{q_1^j q^i}\\
&=\sum_{i=0}^d \sum_{j=0}^{m-1} \alpha^{q^{dj+i}}\\
&= \sum_{k=0}^{n-1} \alpha^{q^k}\\
&= \mathrm{Tr}_{K/F}(\alpha).
\end{align*}
Nous avons utilisé le fait que tout entier $k \in \gcro 0,n \gcro$ s'écrit de façon unique sous la forme $k = dj + i, 0\leq i < d, 0 \leq j < m$.

En remplaçant les sommes par des produits, nous obtenons la même démonstration pour les normes.
\end{proof}

La connaissance du polynôme minimal de $\alpha \in K$ suffit pour calculer sa trace et sa norme sur $F$. Précisons.


\begin{prop} Soit $F \subset K$ une extension de corps finis, et soit $\alpha \in K$, et $E = F[\alpha]$. Notons $n = [K : F], d = [E:F]$, et
$$f(x) = x^d -c_1 x^{d-1}+ \cdots + (-1)^d c_d$$
le polynôme minimal de $\alpha$ sur $F$. Alors
\be
\item[(i)] $\mathrm{Tr}_{K/F}(\alpha) = \frac{n}{d} c_1,$
\item[(ii)] $\mathrm{N}_{K/F}(\alpha) = c_d ^{n/d}.$
\ee

\end{prop}
\begin{proof} Notons $e = n/d$. La proposition \ref{prop29} donne $\chi_{\alpha,K/F}(x) = f(x)^e$, où $\chi_{\alpha,K/F}(x) $ est le polynôme caractéristique de $\alpha \in K$ sur $F$.
Alors
\begin{align*}
\chi_{\alpha,K/F}(x) &=(x^d -c_1 x^{d-1}+ \cdots + (-1)^d c_d)^e\\
&=x^n -ec_1x^{n-1} + \cdots + (-1)^{n} c_d^e.
\end{align*}
La comparaison avec
$$\chi_{\alpha,K/F}(x) = x^n - \mathrm{Tr}_{K/F}(\alpha) x^{n-1} + \cdots + (-1)^n \mathrm{N}_{K/F}(\alpha)$$
montre que $\mathrm{Tr}_{K/F}(\alpha) = ec_1, \mathrm{N}(\alpha) = c_d^e$, ce qu'il fallait prouver.
\end{proof}








\section{Caractères multiplicatifs.}\label{caracteres}
Soit $q = p^s$ une puissance d'un nombre premier $p$, et $\F_q$ un corps de cardinal $q$.

Un caractère multiplicatif sur $\F_q^*$ est un homomorphisme de groupe $\chi$ du groupe multiplicatif $\F_q^*$ dans le groupe $\C^*$. Il vérifie ainsi, pour tous les éléments $a,b$ de $\F_q^*$, la relation
$$\chi(ab) = \chi(a) \chi(b).$$

{\bf Exemple 1.} Nous savons que pour tout $a \in \Z$, pour tout $b \in \Z$, $a \equiv b \pmod p$ entraîne $\legendre{a}{p} = \legendre{b}{p}$, et aussi $\legendre{ab}{p} = \legendre{a}{p}\legendre{b}{p}$. L'application 
$$
\chi
\left \{
\begin{array}{ccc}
\F_p^* &\to &\C^*\\
{[}a{]}_p & \mapsto &\legendre{a}{p}
\end{array}
\right.
$$
est donc bien définie, et c'est un caractère sur $\F_p^*$.

\medskip
{\bf Exemple 2.} L'application $\varepsilon$ définie pour tout $a \in \F_q^*$ par $\varepsilon(a) = 1$ est un caractère.

\medskip
Il est commode de prolonger ces applications sur $\F_q$ tout entier en posant $\chi(0) = 0$ si $\chi \ne \varepsilon$, et $\varepsilon(0) = 1$. Nous dirons alors que $\chi$ est un caractère sur $\F_q$.

Un caractère étant d'abord un homomorphisme de groupes, il vérifie donc

\be
\item[(a)] $\chi(1) = 1$,
\item[(b)] $\chi(a^{-1}) = \chi(a)^{-1}$, pour tout $a \in \F_q^*$.
\ee

De plus, tout caractère vérifie la proposition suivante. 
\begin{prop}
Soit $\chi$ un caractère sur $\F_q^*$.

Pour tout $a\in \F_q^*$, $\chi(a)$ est une racine $q-1$-ième de l'unité.
\end{prop}
\begin{proof}
Soit $a \in \F_q^*$. Alors $a^{q-1} = 1$, donc $\chi(a)^{q-1} = \chi(a^{q-1}) = \chi(1) = 1.$
\end{proof}
Le caractère $\chi$ induit donc un homomorphisme de $\F_q^*$ sur le groupe $\U_{q-1} \subset \U$ des racines $(q-1)$-ièmes de l'unité.

Si $z \in \U$, alors $|z| = 1$, donc $z^{-1} = \overline{z}$, et ainsi
$$\chi(a^{-1}) = \overline{\chi(a)}.$$

\begin{prop}\label{somme_chi}
Soit $\chi$ un caractère multiplicatif sur $\F_q$. 
\be
\item[(a)] Si $\chi \ne \varepsilon$, alors $\sum\limits_{t\in \F_q} \chi(t) = 0$.
\item[(b)] Si $\chi = \varepsilon$, alors $\sum\limits_{t\in \F_q} \varepsilon(t) = q$.
\ee
\end{prop}
\begin{proof}
\be
\item[(a)] Comme $\chi \ne \varepsilon$, il existe $a \in \F_q^*$ tel que $\chi(a) \ne 1$. 

Posons $S = \sum\limits_{t\in \F_q} \chi(t).$ Alors, puisque l'application $t \mapsto at$ est une permutation des éléments de $\F_q^*$,
\begin{align*}
\chi(a) S &= \sum_{t \in \F_q} \chi(a) \chi(t)\\
&= \sum_{t \in \F_q} \chi(at) \\
&=  \sum_{s \in \F_q} \chi(s) \qquad (s =at)\\
&= S
\end{align*}
Ainsi $(\chi(a) - 1) S = 0$, où $\chi(a) \ne 1$, donc $S = 0$.
\item[(b)] Si $\chi = \varepsilon$, alors $\sum\limits_{t\in \F_q} \varepsilon(t) = \sum\limits_{t\in \F_q} 1 = |\F_q| = q.$
\ee
\end{proof}

L'ensemble des caractères sur $\F_q^*$ est l'ensemble $\mathrm{Hom}(\F_q^*, \C^*)$. Il forme donc un groupe pour la loi $(\chi, \lambda) \mapsto \chi \lambda$, où $\chi \lambda$ est défini par
$$(\chi \lambda)(a) = \chi(a) \lambda(a), \text{ pour tout }a \in \F_p^*.$$
Remarquons que cette relation reste vraie si $a = 0$.

L'élément neutre est $\varepsilon$, et le symétrique d'un caractère $\chi$ dans ce groupe est le caractère $\chi^{-1}$ vérifiant, pour tout $a \in \F_q^*$, $\chi^{-1}(a) = (\chi(a))^{-1}$.

Notons maintenant $C = \mathrm{Hom}(\F_q^*, \C^*)$ le groupe des caractères sur $\F_q^*$.

\begin{prop}\label{cyclique}
Le groupe $C$ des caractères sur $\F_q^*$ est un groupe cyclique d'ordre $q-1$.
\end{prop}
\begin{proof}
Nous savons que $\F_q^*$ est cyclique. Soit $g$ un générateur de ce groupe, si bien que tout $a \in \F_q^*$ est une puissance de $g$.

$\chi$ est entièrement déterminé par la valeur de $\chi(g)$ : si $a \in \F_q^*$, alors $a = g^l, \ l\in \N$, donc $\chi(a) = \chi(g)^l$. Comme $\chi(g) \in \U_{q-1}$, où $|\U_{q-1}| = q-1$, il existe au plus $q-1$ caractères, soit $|C| \leq q-1$.

Il existe un (et un seul) caractère $\lambda$ tel que $\lambda(g) = e^{2i \frac{\pi}{q-1}}$. En effet, l'application $\lambda$ telle que $\lambda(g^k) = e^{2i k\frac{\pi}{q-1}}$ est bien définie, et c'est un caractère :
\be
\item[$\bullet$] si $a = g^k = g^l$, alors $k \equiv l \pmod{q-1}$, soit $ l = k +s (q-1), s \in \Z$, donc 
$$ e^{2i l \frac{\pi}{q-1}} = e^{2i (k + s(q-1))\frac{\pi}{q-1}} =e^{2i k \frac{\pi}{q-1}}  e^{2i \pi s } = e^{2i k \frac{\pi}{q-1}},$$
\item[$\bullet$] si $a, b \in \F_q^*$, il existe des entiers $k,l$ tels que $a =g^k, b = g^l$, et
$$\lambda(ab ) = \lambda(g^{k+l}) =  e^{2i (k+l) \frac{\pi}{q-1}} =  e^{2i k\frac{\pi}{q-1}}  e^{2i l\frac{\pi}{q-1}} = \lambda(a) \lambda(b).$$
\ee

Montrons que $\lambda$ est d'ordre $q-1$ dans le groupe des caractères. D'abord, pour tout $a = g^k \in \F_q^*$, $\lambda^{q-1}(a) = e^{2ik\pi} = 1$, donc $\lambda^{q-1} = \varepsilon$. 

Inversement, si $\lambda^n = \varepsilon$, alors $\lambda^n(g) = \varepsilon(g) = 1$, donc $\lambda(g^n) = 1$, soit $e^{2i n\frac{\pi}{q-1}} = 1$, ce qui impose $\frac{n}{q-1} \in \Z$, donc $q-1 \mid n$. 

Ceci prouve que l'ordre de $\lambda$ est $q-1$, et donc $|C| \geq q-1$. Ainsi $|C| =q-1$ , et $\lambda$ est un générateur de ce groupe.
\end{proof}
Retenons l'expression d'un tel générateur. Nous avons prouvé la proposition suivante.

\begin{prop}\label{generator}
Si $g$ est un générateur de $\F_q^*$, il existe un et un seul caractère $\lambda$ tel que $\lambda(g) =  e^{2i \frac{\pi}{q-1}}$, et $\lambda$ est un générateur du groupe des caractères $C$.
\end{prop}

A titre de corollaire de la proposition~\ref{cyclique}, nous avons le résultat suivant.
\begin{prop}\label{ordre_n}
Si $n$ divise $q-1$, alors il existe exactement $n$ caractères $\chi$ vérifiant $\chi^n = \varepsilon$.

Ces caractères forment un sous-groupe $C_n$ de $C$, cyclique et d'ordre $n$.
\end{prop}

\begin{proof}
Ceci est une conséquence du fait que $C$ est cyclique. Rappelons une démonstration de ce fait. 

Si $\lambda$ est un générateur de $C$, d'ordre $q-1$, alors tout caractère $\chi$ est de la forme $\chi = \lambda^k, k \in \Z$, donc $\chi^n = \varepsilon$ équivaut à $\lambda^{kn} = \varepsilon$, soit $q-1 \mid kn$, ou encore $\frac{q-1}{n} \mid k$. Les solutions de $\chi^n = 1$ sont donc de la forme $\lambda^{j\frac{q-1}{n}}$, où on peut prendre $0 \leq j < n$, puisque $\lambda^{(j+n) \frac{q-1}{n}} = \lambda^{j\frac{q-1}{n}}$.


L'ensemble des solutions de $\chi^n = \varepsilon$ est donc  donc l'ensemble $$C_n = \{\varepsilon, \lambda^{\frac{q-1}{n}}, \lambda^{2\frac{q-1}{n}}, \ldots,  \lambda^{(n-1)\frac{q-1}{n}}\},$$ et ces solutions sont distinctes, puisque $\lambda^{j\frac{q-1}{n}} = \lambda^{l\frac{q-1}{n}}$, où $0\leq j<n, 0 \leq l < n$,  implique $\lambda^{(j- l)\frac{q-1}{n}} = 1$, donc $q-1 \mid (j- l)\frac{q-1}{n}$, soit $n \mid j-l$, où $|j-l|<n$, donc $j = l$. Ainsi $|C_n| = n$, et $C_n$ est cyclique, engendré par $\lambda^{\frac{q-1}{n}}$.


\end{proof}

Nous pouvons préciser la condition pour qu'existent des caractères d'ordre $n$.
\begin{prop}\label{existence_caractere}
Il existe un caractère d'ordre $n$ sur $\F_q$ si et seulement si $q\equiv 1 \pmod n$.
\end{prop}
\begin{proof}
Supposons que $q\equiv 1 \pmod n$. La proposition~\ref{ordre_n} montre que $C_n$ est cyclique d'ordre $n$, donc admet un générateur d'ordre $n$, qui est dans $C$. 

Réciproquement, s'il existe un caractère $\chi$ d'ordre $n$, alors le sous-groupe engendré par $\chi$ est d'ordre $n$, et le théorème de Lagrange montre que $n \mid q-1$.
\end{proof}

La proposition suivante sert de lemme  à la proposition~\ref{somme_nulle}.
\begin{prop}
Si $a \in \F_q^*$, et $a \ne 1$, alors il existe un caractère $\lambda$ sur $\F_q$ tel que $\lambda(a) \ne 1$.
\end{prop}
\begin{proof}
Soit $g$ un générateur de $\F_q^*$, et $\lambda$ le caractère défini dans la proposition~\ref{generator}. Puisque $a \in \F_q^*$, il existe un entier $k$ tel que $a = g^k$, et comme $a \ne 1$, $q-1 \nmid k$.

Alors $\lambda(a) = \lambda(g^k) = e^{2i k\frac{\pi}{q-1}} \ne 1$, puisque $\frac{k}{q-1} \not \in \Z$.
\end{proof}

\begin{prop}\label{somme_nulle}
Si $a \in \F_q^*$, et $a \ne 1$, alors $\sum\limits_{\chi \in C} \chi(a) = 0$.
\end{prop}

\begin{proof}
D'après le lemme précédent, il existe un caractère $\lambda$ tel que $\lambda(a) \ne 1$. Soit $S = \sum\limits_{\chi \in C} \chi(a)$. Alors, puisque l'application $\chi \mapsto \lambda \chi$ est une bijection de $C$ sur $C$,
\begin{align*}
\lambda(a) S &=   \sum_{\chi \in C} \lambda(a) \chi(a)\\
&= \sum_{\chi \in C} (\lambda \chi)(a) \\
&= \sum_{\mu \in C} \mu(a)\qquad (\mu = \lambda \chi)\\
&= S.
\end{align*}
Puisque $\lambda(a) \ne 1$, nous en concluons que $S = 0$.
\end{proof}

Les caractères sont utiles pour connaître le nombre de solutions de l'équation $x^n = a$ dans $\F_q$, comme nous allons le voir dans les trois propositions suivantes.

\begin{prop}
Si $a \in \F_q^*$, $n \mid q-1$ et $x^n = a$ n'est pas résoluble dans $\F_q$, alors il existe un caractère $\chi$ tel que
\be
\item[(a)] $\chi^n =\varepsilon.$
\item[(b)] $\chi(a) \ne 1.$
\ee
\end{prop}
(Notons que la réciproque est vraie : en supposant (a), si $x^n = a,\ x \in \F_q^*$, alors $\chi(a) = \chi(x^n) = (\chi(x))^n = \chi^n(x) = \varepsilon(x) = 1$, donc (a) et (b) impliquent l'impossibilité de l'égalité $x^n = a$ dans $\F_q$.)

\begin{proof}
Soit $g$ un générateur de $\F_q^*$, et $\lambda$ le générateur de $C$ associé, donné par la proposition~\ref{generator} : l'ordre de $\lambda$ est donc $q-1$. En utilisant $n \mid q-1$, définissons $\chi = \lambda^{\frac{q-1}{n}}$. Alors $\chi^n = \lambda^{q-1} = \varepsilon$, et ainsi (a) est vérifié.

Il existe un entier $l$ tel que $a = g^l$. En raisonnant par l'absurde, si $n \mid l$, alors $l = kn,\ k \in \Z$, donc $(g^k)^n = g^l = a$, et l'équation $x^n = a$ admettrait une solution $x = g^k$. Par conséquent, $n \nmid l$.

$$\chi(g)  = \lambda^{\frac{q-1}{n}}(g) = \lambda(g)^{\frac{q-1}{n}} = \left( e^{2i\frac{\pi}{q-1}}\right)^{\frac{q-1}{n}} = e^{2i \frac{\pi}{n}},$$ donc

$$\chi(a) = \chi(g^l) = e^{2i\pi \frac{l}{n}}, $$
où $n \nmid l$, donc $\chi(a) \ne 1$, et (b) est vérifié.
\end{proof}

Si $a \in \F_q$, Notons $N(x^n =a)$ le nombre de solutions de l'équation $x^n = a$ dans $\F_q$.

A titre d'exemple, supposons que  $q=p$ est premier. Vérifions alors que $N(x^2 =a) = 1 + \legendre{a}{p}$, en faisant trois cas : si $a$ est un carré de $\F_p^*$, alors $\legendre{a}{p} = 1$, et $N(x^2 = a) = 2 =  1 + \legendre{a}{p}$, et dans le cas contraire $\legendre{a}{p} = -1$, donc $N(x^2 = a) = 0 = 1 + \legendre{a}{p}$. Enfin, si $a=0$, $1 + \legendre{a}{p} = 1 = N(x^2 = 0)$.

Comme $\varepsilon$ et le caractère de Legendre sont les seuls caractères dont l'ordre divise 2, on peut encore écrire cette formule sous la forme
$$N(x^2 = a) = \sum_{\chi^2 = \varepsilon} \chi(a).$$

Généralisons cette formule.

\begin{prop}\label{nbRacs}
Si $n \mid q-1$, et $a \in \F_q$,
$$N(x^n =a) = \sum_{\chi^n = \varepsilon} \chi(a).$$
\end{prop}

\begin{proof}
La somme de l'énoncé s'effectue sur le groupe $C_n$ des caractères $\chi$ tel que $\chi^n = \varepsilon$, ce qui revient à dire que l'ordre de $\chi$ divise $n$. Comme $n$ divise $|C| = q-1$, la proposition ~\ref{ordre_n} montre que $|C_n| = n$ : il existe exactement $n$ tels caractères. 

\be
\item[$\bullet$] Si $a = 0$, $ \varepsilon(0) = 1$, et $\chi(0) = 0$ si $\chi \ne \varepsilon$, donc $\sum\limits_{\chi^n = \varepsilon} \chi(a) = 1 = N(x^n=a)$.

\item[$\bullet$]Si $a \ne 0$, et si de plus $x^n =a$ est résoluble, alors il existe un élément $b \in \F_p^*$ tel que $b^n = a$. Si $\chi^n =\varepsilon$, alors $\chi(a) = \chi(b^n) = \chi(b)^n = \chi^n(b) = \varepsilon(b) = 1$. Ainsi $\sum\limits_{\chi^n= \varepsilon} \chi(a) =|C_n| =  n$. Comme $n \mid q-1$, alors $d = n \wedge (q-1) = n$ est d'après la proposition~\ref{nbsols} le nombre de solutions de l'équation $x^n =a$. Dans ce cas $$\sum\limits_{\chi^n = \varepsilon} \chi(a)= n = N(x^n=a).$$

\item[$\bullet$]Si $a \ne 0$ et si $x^n =a$ n'est pas résoluble, alors nous devons prouver $\sum\limits_{\chi^n = \varepsilon} \chi(a) = 0$. Notons $S = \sum\limits_{\chi^n = \varepsilon} \chi(a) $. D'après la proposition précédente, il existe un caractère $\rho$ tel que $\rho^n = \varepsilon$ et $\rho(a) \ne 1$. 

Comme l'application $\chi \mapsto \rho \chi$ est une permutation de $C_n$,
\begin{align*}
\rho(a) S &= \sum_{\chi^n = \varepsilon} \rho(a) \chi(a)\\
&=  \sum_{\chi^n = \varepsilon} (\rho \chi)(a) \\
&=  \sum_{\mu^n = \varepsilon} \mu(a) \qquad (\mu = \rho \chi)\\
&= S
\end{align*}
Puisque $\rho(a) \ne 1$, $S = 0$.
\ee
\end{proof}

Remarque : si $\chi$ est un caractère d'ordre $n$, il engendre le sous-groupe $C_n$ de $C$ des caractères dont l'ordre divise $n$, et donc la formule précédente peut s'écrire
$$N(x^n =a) = \sum_{i=0}^{n-1} \chi^i(a).$$

Si on oublie l'hypothèse $n\mid q-1$, nous obtenons :
\begin{prop}\label{pgcd}
Soit $q = p^s$ une puissance d'un nombre premier, et $d = n \wedge (q-1)$. Si $a \in \F_q$, alors
\be
\item[(a)] $$N(x^n = a) = N(x^d=a).$$
\item[(b)] $$N(x^n = a) = \sum_{\chi^d = \varepsilon} \chi(a).$$
\ee
\end{prop}
\begin{proof}
Soit $d$ le pgcd de $n$ et $p-1$.
\be
\item[(a)]
   \be
   \item[$\bullet$] Si $a = 0$, $0$ est la seule solution des équations $x^m = a$ ou $x^d = a$, donc $N(x^n=a) = N(x^d = a) = 1$.
   \item[$\bullet$] Si $a\in \F_q^*$ et si $x^n = a$ a une solution, d'après la proposition~\ref{nbsols}(b), le nombre de solutions de $x^n = a$ est $n \wedge (q-1) = d$, et le nombre de solutions de $x^d = a$ est $d \wedge (q-1) = d$. Ainsi $N(x^n =a) = N(x^d=a) = d$.
   \item[$\bullet$] Si $a\in \F_q^*$ et si $x^n = a$ n'a pas de solution, alors la proposition 1(a) montre que $a^{\frac{q-1}{d}} \ne 1$. Comme $d = d \wedge (q-1)$, la même proposition montre que $x^d = a$ n'a pas de solution. Ainsi $N(x^n =a) = N(x^d =a) =0$.
   \ee
\item[(b)] Comme $d \mid q-1$, la proposition précédente donne
$$N(x^n = a) = N(x^d =a) = \sum_{\chi^d = \varepsilon} \chi(a).$$
\ee
\end{proof}


\begin{prop}\label{existence_racine}
Supposons que $q \equiv 1 \pmod n$. Soit $\chi$ un caractère d'ordre $n$ sur $\F_q^*$, et $a \in \F_q^*$. Alors
$$\exists x \in \F_q^*,\ x^n = a \iff \chi(a) = 1.$$
\end{prop}
\begin{proof}
La proposition~\ref{existence_caractere} montre que l'existence d'un tel caractère $\chi$ sur $\F_q^*$ équivaut à $q\equiv 1 \pmod n$.

($\Rightarrow$) Si $x^n = a$, où $x \in \F_q^*$, alors $\chi(a) = \chi(x^n)=\chi(x)^n =\chi^n(x) = \varepsilon(x) = 1$.

($\Leftarrow$) Supposons $\chi(a) = 1$. Soit $g$ un générateur de $\F_q^*$. Alors il existe un entier $l$ tel que $a = g^l$. Notons $\lambda$ le générateur (d'ordre $q-1$) du groupe des caractères donné par la proposition~\ref{existence_caractere}, caractérisé par $\lambda(g) = e^{\frac{2i\pi}{q-1}}$. Alors $\chi = \lambda^k$ pour un certain entier $k$.

Rappelons que l'ordre de $\lambda^k$ est donné par
$$\mathrm{ord}(\lambda^k) = \frac{q-1}{(q-1) \wedge k}.$$
En effet, notons $d = (q-1) \wedge k$. Alors $\frac{q-1}{d} \wedge \frac{k}{d}= 1$. Pour tout $m \in \Z$,
$$\left(\lambda^k\right)^m = 1 \iff q-1 \mid km \iff \frac{q-1}{d} \mid \frac{k}{d} m \iff \frac{q-1}{d} \mid m.$$
Ainsi $n = \mathrm{ord}(\chi) = \frac{q-1}{d}$, où $d = (q-1) \wedge k$. Par conséquent, en utilisant $\frac{q-1}{d} \wedge \frac{k}{d} = 1$,
\begin{align*}
\chi(a) = 1 & \iff \lambda^k(a) = 1\\
&\iff e^{\frac{2i\pi k l}{q-1}} = 1\\
&\iff q-1 \mid kl\\
&\iff \frac{q-1}{d} \mid \frac{k}{d} l\\
&\iff \frac{q-1}{d} \mid l\\
& \iff n \mid l
\end{align*}
L'hypothèse $\chi(a) = 1$ montre donc que $l = q n$, pour un certain entier $q$, et donc $a = g^l = (g^q)^n$. Si on pose $x= g^q \in \F_q^*$, alors $a = x^n$ est bien une puissance $n$-ième dans $\F_q^*$.
\end{proof}



\section{Sommes de Gauss.}
Définissons d'abord la somme de Gauss associée à un caractère $\chi$ sur $\F_p$, où $p$ est premier.  Notons $\zeta = e^{\frac{2i\pi}{p}}$, et posons, pour $a \in \F_p$, 
\begin{align}\label{defGauss}
g_a(\chi) = \sum_{t \in \F_p} \chi(t) \zeta^{at}.
\end{align}
($\zeta^{u}$ a bien un sens si $u \in \F_p$ : en effet, si $a,b \in \Z$ sont des représentants de $u \in \F_p$, alors $b = a + k p,\ k \in \Z$, donc $\zeta^{b} = \zeta^a (\zeta^p)^k = \zeta^a$.)

$g_a(\chi)$ s'appelle la somme de Gauss sur $\F_p$, relative au caractère $\chi$.

Par exemple, si $\chi$ est le caractère quadratique relatif au nombre premier $p$,  $g_a(\chi) = \sum\limits_{t \in \F_p}\legendre{t}{p} \zeta^{at}$. Ce sont ces sommes de Gauss que nous avions utilisées dans la preuve du théorème de réciprocité quadratique.

Généralisons maintenant les sommes de Gauss aux caractères $\chi$ sur $\F_q$, où $q = p^n$ est une puissance du nombre premier $p$. \`A cette fin, notons que l'application $\psi : \F_p \to \C^*$ définie par $\psi(\alpha) = \zeta_p^\alpha$ vérifie $\psi(\alpha + \beta) = \psi(\alpha)\psi(\beta)$, et donc $\psi : \F_p \to \C^*$ est un homomorphisme de groupes, du groupe $(\F_p,+)$ dans $(\C^*,\times)$.

Recherchons maintenant les homomorphismes de $\F_q$ dans $\C^*$.

\begin{prop}\label{homomorphisme_psi}
Soit $\psi : \F_q \to \C^*$, où $q =p^n$, $p$ premier.  

Alors $\psi$ est un homomorphisme de $(\F_q,+)$ dans $(\C^*,\times)$ si et seulement s'il existe $\gamma \in \F_q$ tel que
\begin{align}\label{homomorphisme}
\forall x \in \F_q,\ \psi(x) = \zeta^{\mathrm{tr}(\gamma x)},
\end{align}
où $\zeta = e^{\frac{2i\pi}{p}}$, et $\mathrm{tr}(x) = \mathrm{Tr}_{\F_q/\F_p}(x)\ (x \in \F_q)$.
\end{prop}

\begin{proof}
Soit $\psi$ est un homomorphisme de $(\F_q,+)$ dans $(\C^*,\times)$. Alors $\psi(0) = 1$, et $\psi(a \alpha) = \psi(\alpha)^a$, pour tout $\alpha \in \F_q$ et tout $a \in \Z$.

Soit $(\omega_1,\ldots,\omega_n)$ une base de $\F_q = \F_{p^n}$ sur $\F_p$. La caractéristique du corps $\F_q$ étant égale à $p$,
$$\psi(\omega_k)^p = \psi(p \omega_k) = \psi(0) = 1\qquad (1\leq k \leq n).$$
Ainsi $\psi(\omega_k)$ est une racine $p$-ième de l'unité, de la forme
\begin{align}\label{psi}
\psi(\omega_k) &= \zeta^{c_k},\qquad c_k\in \{0,,\ldots,p-1\}.
\end{align}
Puisque $\zeta^{c_k} = \zeta^{c_k + lp}$, on peut donner un sens à $\zeta^{[c_k]}$, où $[c_k]$ est la classe de $c_k$ modulo $p$. Alors $\psi(\omega_k) = \zeta^{[c_k]}$.

Considérons l'application
$$
\varphi
\left\{
\begin{array}{ccl}
\F_q & \to & (\F_p)^n\\
\alpha & \mapsto & (\mathrm{tr}(\alpha \omega_1),\ldots, \mathrm{tr}(\alpha \omega_n)).
\end{array}
\right.
$$
où $\mathrm{tr}$ désigne l'application $\mathrm{Tr}_{\F_q/\F_p}$.

Montrons que l'application $\F_p$-linéaire $\varphi$ est bijective.

Si $\alpha \in \ker(\varphi)$, alors $\mathrm{tr}(\alpha \omega_1) =\ldots =  \mathrm{tr}(\alpha \omega_n) = 0$. Si $y$ est un élément arbitraire de $\F_q$, alors $y = b_1\omega_1 + \cdots + b_n \omega_n$, où $b_1,\ldots,b_n \in \F_p$. Alors $\mathrm{tr}(\alpha y) = b_1 \mathrm{tr}(\alpha \omega_1)+ \cdots + b_n\mathrm{tr}(\alpha \omega_n) = 0$, ce qui donne
$$\forall y \in \F_q,\ \mathrm{tr}(\alpha y) = 0.$$
En raisonnant par l'absurde, supposons que $\alpha \ne 0$. Puisque l'application $\mathrm{tr} = \mathrm{Tr}_{\F_q/\F_p} : \F_q \to \F_p$ est surjective (Proposition~\ref{trace_surjective}), il existe un élément $\delta \in \F_q$ tel que $\mathrm{\delta} = 1$. Pour $y = \delta \alpha^{-1}$, alors $0 = \mathrm{tr}(\alpha y) = \mathrm{tr}(\delta) = 1$. C'est une contradiction, donc $\alpha = 0$. Ceci montre que $\ker(\varphi) = \{0\}$.

De plus $\dim_{\F_p}(\F_q) = \dim_{\F_p} (\F_p)^n = n$, donc $\varphi$ est une bijection. La surjectivité de $\varphi$ montre qu'il existe $\gamma \in \F_q$ tel que
\begin{align}\label{psi2}
\mathrm{tr}(\gamma \omega_k )= [c_k],\qquad k= 1,\ldots,n.
\end{align}
Si $x$ est un élément arbitraire de $\F_q$, nous pouvons écrire $x$ sous la forme $x = a_1 \omega_1 + \cdots + a_n \omega_n$, où $a_1,\ldots,a_k \in \F_p$. En utilisant les égalités (\ref{psi}) et (\ref{psi2}), nous obtenons 
\begin{align*}
\psi(x) &= \psi( a_1 \omega_1 + \cdots + a_n \omega_n)\\
&=\psi(\omega_1)^{a_1} \cdots \psi(\omega_n)^{a_n}\\
&=\zeta^{a_1 \mathrm{tr}(\gamma \omega_1) + \cdots + a_n \mathrm{tr}(\gamma\omega_n)}\\
&=\zeta^{\mathrm{tr}(\gamma x)}.
\end{align*}
Réciproquement, vérifions que, $\gamma \in \F_q$ étant donné, l'application $\psi : \F_q \to \C^*$ défini par $\psi(x) = \zeta^{\mathrm{tr}(\gamma x)}$ est bien un homomorphisme de groupes.

Si $x,y \in \F_q$, alors
$$\psi(x+y) = \zeta^{\mathrm{tr}(\gamma(x+y))} = \zeta^{\mathrm{tr}(\gamma x) + \mathrm{tr}(\gamma x)}  = \zeta^{\mathrm{tr}(\gamma x)}\zeta^{\mathrm{tr}(\gamma y)} = \psi(x) \psi(y).$$
\end{proof}
Notons maintenant $\psi$ l'homomorphisme défini par $\psi(x) = \zeta^{\mathrm{tr}(x)},\ x \in \F_q$. Donnons quelques propriétés de $\psi$.

\begin{prop}\label{proprietes_psi}
L'application $\psi : \F_q \to \C^*$ définie par $\psi(x) = \zeta^{\mathrm{tr}(x)}$ vérifie
\be
\item[(a)] $\psi(\alpha + \beta) = \psi(\alpha) \psi(\beta)\ (\alpha, \beta \in \F_q)$.
\item[(b)]  Il existe un $\alpha \in \F_q$ tel que $\psi(\alpha) \ne 1$.
\item[(c)] $\sum\limits_{\alpha \in \F_q} \psi(\alpha) = 0.$
\ee
\end{prop}
\begin{proof}
\item[(a)] Cette relation a été prouvée dans la proposition~\ref{homomorphisme_psi}.
\item[(b)] L'application $\mathrm{tr} = \mathrm{Tr}_{\F_q/\F_p} : \F_q \to \F_p$ est surjective (Proposition~\ref{trace_surjective}). Par conséquent, il existe $\alpha \in \F_q$ tel que $\mathrm{tr}(\alpha) = 1$. Alors $\psi(\alpha) = \zeta \ne 1$.
\item[(c)] Soit $S = \sum\limits_{\alpha \in \F_q} \psi(\alpha) $, et $\beta \in \F_q$ tel que $\psi(\beta) \ne 1$. Alors
$$\psi(\beta) S = \sum_{\alpha \in \F_q} \psi(\beta) \psi(\alpha) =  \sum_{\alpha \in \F_q} \psi(\beta + \alpha) = \sum\limits_{\gamma \in \F_q} \psi(\gamma)= S,$$
donc $S=0$.
\end{proof}

\begin{prop}\label{fourier}
Si $\alpha, x, y \in \F_q$, alors
$$\frac{1}{q} \sum_{\alpha \in \F_q} \psi(\alpha(x-y)) = \delta(x,y),$$
où $\delta(x,y) = 1$ si $x=y$ et $0$ sinon.
\end{prop}

\begin{proof}
Si $x=y$, alors
$$ \sum_{\alpha \in \F_q} \psi(\alpha(x-y)) =  \sum_{\alpha \in \F_q} \psi(0) = q.$$
Si $x \ne y$, alors le changement d'indice $\beta = \alpha(x-y)$, où $x-y \ne 0$, donne
$$ \sum_{\alpha \in \F_q} \psi(\alpha(x-y)) = \sum_{\beta \in \F_q} \psi(\beta) = 0,$$
d'après la proposition~\ref{proprietes_psi}(c).
\end{proof}


La définition~\ref{defGauss} se généralise aux caractères sur $\F_q$, où $q = p^s$, sous la forme
\begin{align}\label{gen}
g_\alpha(\chi) = \sum_{t \in \F_q} \chi(t) \psi(\alpha t) = \sum_{t \in \F_q} \chi(t) \zeta^{\mathrm{tr}(\alpha t)}, \qquad\text{où } \zeta = e^{\frac{2i\pi}{p}}, \mathrm{tr} = \mathrm{Tr}_{\F_q/\F_p}.
\end{align}

Si $q=p$ est premier, et $\alpha = a \in \F_p$, alors $\mathrm{tr}(ay) = at$, et nous obtenons bien $g_a(\chi) =\sum\limits_{t \in \F_p} \chi(t) \zeta^{at}$ ce qui montre que (\ref{gen}) généralise bien la définition (\ref{defGauss}).



\medskip
Précisons quelques valeurs de $g_\alpha(\chi)$.
\begin{prop} \label{valeurs_g}
Soit $\alpha \in \F_q$, et $\chi$ un caractère sur $\F_q$.
\be 
\item[(a)] Si $\alpha\ne 0$ et $\chi = \varepsilon$, alors $g_\alpha(\varepsilon) = 0$.
\item[(b)] Si $\alpha = 0$ et $\chi = \varepsilon$, alors $g_0(\varepsilon) = q$.
\item[(c)] Si $\alpha = 0$ et $\chi \ne \varepsilon$, alors $g_0(\chi) = 0$.

\ee
\end{prop}
\begin{proof}
\be
\item[(a)] Ici $\alpha \ne 0$. En utilisant la proposition~\ref{proprietes_psi}(c), nous obtenons
\begin{align*}
g_\alpha(\varepsilon) &= \sum_{t \in \F_q} \varepsilon(t) \zeta^{\mathrm{tr}(\alpha t)}\\
&= \sum_{t\in \F_q} \zeta^{\mathrm{tr}(\alpha t)}\\
&= \sum_{u \in \F_q} \zeta^{\mathrm{tr}(u)} \qquad (u = \alpha t)\\
&=  \sum_{u \in \F_q} \psi(u)\\
&= 0
\end{align*}
\item[(b)] Comme $\alpha = 0$, $$g_0(\varepsilon) = \sum_{t\in \F_q} \varepsilon(t) =  \sum_{t\in \F_q}  1 = q.$$
\item[(c)] Si $\chi \ne \varepsilon$, la proposition~\ref{somme_chi} donne
$$g_0(\chi) = \sum_{t\in \F_q} \chi(t) = 0.$$
\ee
\end{proof}

\begin{prop}\label{prop50}
Si $\alpha \in \F_q^*$, alors $g_\alpha(\chi)  = \chi(\alpha^{-1}) g_1(\chi) = \overline{\chi(\alpha)} g_1(\chi)$.
\end{prop}
\begin{proof}
Si $\alpha \in \F_q^*$,
\begin{align*}
\chi(\alpha) g_\alpha(\chi) &=\sum_{t \in \F_q} \chi(\alpha)\chi(t) \psi(\alpha t)\\
&=\sum_{t \in \F_q} \chi(\alpha t) \psi(\alpha t)\\
&= \sum_{s \in \F_q} \chi(s) \psi( s)\qquad (s =\alpha t)\\
&= g(\chi).
\end{align*}
Puisque $|\chi(\alpha)| = 1$, $\chi(\alpha)^{-1} = \overline{\chi(\alpha)}$, alors
$$g_\alpha(\chi) = \overline{\chi(\alpha)} g(\chi).$$
\end{proof}
Nous noterons par la suite $g(\chi) = g_1(\chi)$.

\begin{prop}\label{module}
Si $\chi \ne \varepsilon$ est un caractère sur $\F_q$, alors $|g(\chi)| = \sqrt{q}$.
\end{prop}
\begin{proof}

Nous évaluons la somme $S = \sum\limits_{a \in \F_q} g_a(\chi) \overline{g_a(\chi)}$ de deux façons.

\begin{enumerate}
\item[$\bullet$]  Comme $\chi \ne \varepsilon$, la proposition~\ref{valeurs_g}(c) donne $g_0(\chi) = 0$. Si $a \in \F_q^*$, alors $g_a(\chi) = \chi(a^{-1}) g(\chi)$ (proposition~\ref{prop50}), et $\overline{g_a(\chi)} = \overline{\chi(a^{-1})} \overline{g(\chi)} = \chi(a) \overline{g(\chi)}$. Par conséquent,
\begin{align*}
S&= \sum_{a \in \F_q^*} \chi(a^{-1}) g(\chi)  \chi(a) \overline{g(\chi)}\\
&= \sum_{a \in \F_q^*} |g(\chi)|^2\\
&= (q-1) |g(\chi)|^2
\end{align*}
\item[$\bullet$] De plus, puisque $\psi(a(x-y)) = \psi(ax) \psi(ay)^{-1} = \psi(ax) \overline{\psi(ay)}$,
 $$g_a(\chi) \overline{g_a(\chi)} = \sum_{x \in \F_q} \sum_{y \in \F_q} \chi(x) \overline{\chi(y)} \psi(a(x-y)).$$
Par conséquent,
\begin{align*}
S &= \sum_{a\in \F_q}  \sum_{x \in \F_q} \sum_{y \in \F_q} \chi(x) \overline{\chi(y)} \psi(a(x-y))\\
&=  \sum_{x \in \F_q} \sum_{y \in \F_q}\chi(x) \overline{\chi(y)} \left(  \sum_{a\in \F_q}\psi(a(x-y))\right)
\end{align*}
D'après la proposition~\ref{fourier},
\begin{align*}
 \sum_{a\in \F_q} \psi(a(x-y)) &= q \delta(x,y),
  \end{align*}
donc,
 \begin{align*}
 S &=  q \sum_{x \in \F_q} \sum_{y \in \F_q}\chi(x) \overline{\chi(y)}  \delta(x,y) \\
 &= q \sum_{x \in \F_q} \chi(x) \overline{\chi(x)}\\
 \end{align*}
Puisque $\chi(x) \overline{\chi(x)} = 1$ si $x \ne 0$, et $\chi(x) \overline{\chi(x)} = 0$ si $x = 0$, nous obtenons
 $$S = q(q-1).$$
\end{enumerate}
La comparaison de ces deux résultats donne
$$(q-1) |g(\chi)|^2 = (q-1)q,$$
donc $$  |g(\chi)| = \sqrt{q}.$$
\end{proof}

Exprimons le lien entre $\overline{g(\chi)}$ et $g(\overline{\chi})$. Ici $\overline{\chi}$ est le caractère qui envoie tout $a \in \F_q$ sur $\overline{\chi(a)} = \chi(a)^{-1} = \chi^{-1}(a)$, donc $\overline{\chi} = \chi^{-1}$.
\begin{prop}\label{conjugue}
Si $\chi$ est un caractère sur $\F_q$, alors
$$\overline{g(\chi)} = \chi(-1) g(\overline{\chi}).$$
\end{prop}
\begin{proof}
 Puisque $(-1)^2 = 1$, $(\chi(-1))^2 = 1$, donc $\chi(-1) = \pm 1$ est réel, et ainsi $\overline{\chi(-1)} = \chi(-1)$. Ceci donne
\begin{align*}
\overline{g(\chi)} &= \sum_{t \in \F_q} \overline{\chi(t)} \zeta_p^{-\mathrm{tr}( t)}\\
&=\sum_{t \in \F_q} \overline{\chi(-1) \chi(-t)}  \zeta_p^{-\mathrm{tr}( t)}\\
&=\chi(-1) \sum_{t \in \F_q} \overline{ \chi(-t)}  \zeta_p^{\mathrm{tr}( -t)}\\
&=\chi(-1) \sum_{s \in \F_q} \overline{ \chi(s)}  \zeta_p^{\mathrm{tr}( s)}\qquad (s = -t)\\
&=\chi(-1) g(\overline{\chi}).\\
\end{align*}
\end{proof}

Remarque : si $\lambda$ est le caractère de Legendre défini par $\lambda(a) = \legendre{a}{p}$, alors $\lambda$ est d'ordre 2, donc $\lambda = \lambda^{-1} = \overline{\lambda}$. Ainsi
$$g(\lambda)^2 = g(\lambda)g(\overline{\lambda}) = \lambda(-1) g(\lambda) \overline{g(\lambda)} = \lambda(-1)p = (-1)^{\frac{p-1}{2}} p.$$
On retrouve ainsi le calcul de $g^2 =  (-1)^{\frac{p-1}{2}} p$ dans le chapitre "Loi de réciprocité quadratique".




\section{Sommes de Jacobi.}

Les sommes de Jacobi interviennent naturellement dans le calcul du nombre de points de courbes algébriques sur $\F_q$. Notons $N(x^3 + y^3 = 1)$ le nombre de solutions $(x,y) \in \F_q^2$ de la cubique $\Gamma$ d'équation $x^3 + y^3 = 1$ sur $\F_q$. 

Alors
$$N(x^3 + y^3 = 1) = \sum_{a+b = 1} N(x^3 = a) N(y^3 = b).$$
En effet, si on note $A_k = \{x \in \F_q \, |\, x^3 = k\}$ pour tout $k\in \F_q$, alors
\begin{align*}
\Gamma &= \{(x,y) \in \F_q^2\mid x^3 + y^3 =1\}\\
&=\coprod_{(a,b)\in \F_q^2,\, a+b = 1} \{(x,y) \in \F_p^2\mid x^3  =a \text { et }  y^3 =b\}\\
&= \coprod_{(a,b)\in \F_q^2,\, a+b = 1} A_a \times A_b.
\end{align*}
Comme $|A_k| = N(x^3 = k)$, nous obtenons bien le résultat annoncé.


$\bullet$ Si $q\equiv 2 \pmod 3$, d'après la proposition~\ref{nbsols} et l'exemple 2 qui suit, nous savons que $N(x^3 =a) = 1$ pour tout $a \in \F_q$.
Alors, d'après la formule précédente, $N(x^3 + y^3 = 1) = q$.

$\bullet$ Supposons maintenant que $q\equiv 1 \pmod 3$. Comme $3 \mid q-1$, Il existe alors au moins un caractère d'ordre 3, et même exactement 2, d'après la proposition~\ref{ordre_n}.  Soit $\chi$ un tel caractère d'ordre 3 (appelé caractère cubique). Alors $\chi^2$ est d'ordre 3, et $\{\varepsilon, \chi, \chi^2\}$ est l'ensemble des caractères dont l'ordre divise 3. La proposition~\ref{nbRacs} donne alors
$$N(x^3 = a) = 1 + \chi(a) + \chi^2(a).$$
Par conséquent,
\begin{align*}
N(x^3 + y^3 = 1) &= \sum_{a+b = 1} \sum_{i=0}^2 \chi^i(a) \sum_{j=0}^2 \chi^j(b)\\
&=\sum_{i=0}^2 \sum_{j=0}^2 \left( \sum_{a+b = 1} \chi^i(a)\chi^j(b)\right).
\end{align*}

Ceci conduit à la définition suivante.
\begin{dfn}
Soient $\chi$ et $\lambda$ des caractères sur $\F_q$. Alors
$$ J(\chi,\lambda) = \sum_{a+b = 1} \chi(a) \lambda(b)$$
s'appelle la somme de Jacobi associée à $\chi, \lambda$.
\end{dfn}

Avec cette notation, le résultat précédent s'écrit
\begin{align}\label{cubique}
N(x^3 + y^3 = 1) = \sum_{i=0}^2 \sum_{j=0}^2 J(\chi^i,\chi^j).
\end{align}
Donnons les propriétés usuelles de ces sommes de Jacobi.
\begin{prop}\label{jacobi1}
Soit $\chi$ un caractère non trivial sur $\F_q$. Alors
\be
\item[(a)] $J(\varepsilon, \varepsilon) = q.$
\item[(b)] $J(\varepsilon, \chi) = 0.$
\item[(c)] $J(\chi,\chi^{-1}) = -\chi(-1).$
\ee
\end{prop}
\begin{proof}
\be
\item[(a)] Puisque le cardinal de l'ensemble $\{(a,b)\in \F_q^2 \mid a+b = 1\}$ est égal à $q$,
$$J(\varepsilon, \varepsilon) = \sum\limits_{a+b = 1}  1 = q.$$
\item[(b)] D'après la proposition~\ref{somme_chi},
$$J(\varepsilon, \chi) = \sum\limits_{a+b = 1} \chi(a) = \sum\limits_{a \in \F_q} \chi(a) = 0.$$
\item[(c)] Remarquons que
\begin{align*}
J(\chi,\chi^{-1})&= \sum_{a+b = 1} \chi(a) \chi^{-1}(b)\\
&=\sum_{a+b = 1,\,  b \ne 0} \chi\left(\frac{a}{b}\right)\\
&= \sum_{a\ne 1} \chi\left(\frac{a}{1-a}\right).
\end{align*}
Comme l'application homographique
$$
\left\{
\begin{array}{ccc}
\F_q \setminus  \{1\} &\to &\F_q\setminus \{-1\}\\
a & \mapsto &\frac{a}{1-a}
\end{array}
\right.
$$
est une bijection, d'application réciproque 
$\left \{
\begin{array}{ccc}
\F_q \setminus  \{-1\} &\to &\F_q\setminus \{1\}\\
b & \mapsto &\frac{b}{1+b}
\end{array}
\right.$,
le changement d'indice $b = \frac{a}{1-a}$ donne
\begin{align*}
J(\chi,\chi^{-1}) &= \sum_{a\ne 1} \chi\left(\frac{a}{1-a}\right)\\
&= \sum_{b \ne -1} \chi(b)\\
&=  \sum_{b \in \F_p} \chi(b) - \chi(-1)\\
&= - \chi(-1).
 \end{align*}
\ee
\end{proof}

La proposition suivante donne de lien entre les sommes de Jacobi et les sommes de Gauss.
\begin{prop}\label{lien_Jacobi_Gauss}
Si $\chi, \lambda$ sont des caractères sur $\F_q$ tels que $\chi \ne \varepsilon, \lambda \ne \varepsilon , \chi \lambda \ne \varepsilon$, alors
$$J(\chi,\lambda) = \frac{g(\chi) g(\lambda)}{g(\chi \lambda)}.$$
\end{prop}
\begin{proof}
En notant comme d'habitude $\psi(x) = \zeta_p^{\mathrm{tr}(x)}$ pour $x \in \F_q$,
\begin{align*}
g(\chi) g (\lambda) &= \left(\sum_{x\in \F_q} \chi(x) \psi(x)\right)\left(\sum_{y\in \F_q} \lambda(y) \psi(y) \right)\\
&=\sum_{(x,y) \in \F_q^2} \chi(x) \lambda(y) \psi(x+y)\\
&=\sum_{t \in \F_q} \left( \sum_{x+y = t} \chi(x) \lambda(y)\right) \psi(t).
\end{align*}

Si $t = 0$, alors 
$$\sum_{x+y = 0} \chi(x) \lambda(y) = \sum_{x \in \F_q} \chi(x) \lambda(-x) = \lambda(-1) \sum_{x \in \F_q} (\chi \lambda)(x) = 0,$$
puisque $\chi \lambda \ne \varepsilon$.

Si $t \ne 0$, l'application
$$
\left\{
\begin{array}{ccc}
\{(x',y') \in \F_q^2\ | \ x'+y' = 1 \}& \to& \{(x,y) \in \F_q^2\ | \ x+y = t \} \\
(x',y') & \mapsto &(x,y) = (tx', ty')
\end{array}
\right.
$$
étant bijective, le changement d'indices $(x,y) = (tx',ty')$ donne
\begin{align*}
 \sum_{x+y = t} \chi(x) \lambda(y) &=  \sum_{x'+y' = 1} \chi(tx') \lambda(t y')\\
 &= (\chi \lambda)(t) J(\chi, \lambda).
 \end{align*}
 Par conséquent,
\begin{align*}
g(\chi) g (\lambda) &=\sum_{t \in \F_q^*} \left( \sum_{x+y = t} \chi(x) \lambda(y)\right) \psi(t)\\
 &=J(\chi, \lambda) \sum_{t \in \F_q^*}  (\chi \lambda)(t) \psi(t)\\
 &= J(\chi, \lambda) g(\chi \lambda).
 \end{align*}
 La proposition~\ref{module} montre que si $\chi \ne \varepsilon, g(\chi) \ne 0$. Comme ici $\chi \lambda \ne \varepsilon$, $g(\chi \lambda) \ne 0$, donc
 $$J(\chi,\lambda) = \frac{g(\chi) g(\lambda)}{g(\chi \lambda)}.$$
 \end{proof}
 Nous en tirons le corollaire suivant
 \begin{prop}\label{module_J}
Soient $\chi, \lambda$ des caractères sur $\F_q$. Si $\chi, \lambda$ et $\chi \lambda$ sont différents de $\varepsilon$, alors
 $$|J(\chi,\lambda)| = \sqrt{q}.$$
 \end{prop}
 \begin{proof}
 Comme $|g(\chi)| = \sqrt{q}$ pour tout caractère $\chi \ne \varepsilon$ (proposition~\ref{module}), nous obtenons
  $$|J(\chi,\lambda)| = \frac{|g(\chi)|\, |g(\lambda)|}{|g(\chi \lambda)|}  = \frac{\sqrt{q}\sqrt{q}}{\sqrt{q}}= \sqrt{q}.$$
 \end{proof}
 
 Reprenons l'évaluation de $N(x^3 + y^3 = 1)$ pour $q\equiv 1 \pmod 3$. L'égalité (\ref{cubique}) devient, en utilisant la proposition~\ref{jacobi1}, ainsi que $\chi^2 = \chi^{-1}$,
 \begin{align*}
 N(x^3 + y^3 = 1) &= \sum_{i=0}^2 \sum_{j=0}^2 J(\chi^i,\chi^j)\\
 &= J(\varepsilon, \varepsilon) + J(\varepsilon, \chi) + J(\varepsilon, \chi^2) +\\
 	& \quad J(\chi, \varepsilon) + J(\chi, \chi) + J(\chi, \chi^2) +\\
	& \quad J(\chi^2, \varepsilon) + J(\chi^2, \chi) + J(\chi^2, \chi^2) \\
	&= q  - \chi(-1) - \chi^2(-1) + J(\chi,\chi) + J(\chi^2,\chi^2)
 \end{align*}
 Comme $-1 = (-1)^3$, nous avons $\chi(-1) = \chi^2(-1) = 1$. De plus $J(\chi^2,\chi^2) = J(\overline{\chi}, \overline{\chi}) =\overline{J(\chi,\chi)}$, donc
 \begin{align}
 N(x^3 + y^3 = 1) = q-2 +2\,  \mathrm{Re}(J(\chi,\chi)).
 \end{align}
 Nous ne connaissons pas explicitement $J(\chi,\chi)$ pour toutes les valeurs de $q$. Néanmoins $| \mathrm{Re}(J(\chi,\chi))| \leq |J(\chi,\chi)| = \sqrt{q}$, donc
 $$|N(x^3 + y^3 = 1) - (q-2)| \leq 2 \sqrt{q}.$$
 qui donne l'ordre de grandeur de $N(x^3 + y^3 = 1)$.
 
 Un calcul semblable permet d'obtenir explicitement $N(x^2 + y^2 = 1)$, que nous présentons en supposant ici $q= p$ premier. Soit $\chi$ l'unique caractère d'ordre 2 : $\chi(a) = \legendre{a}{p}$ pour tout $a \in \F_p$.
 \begin{align*}
 N(x^2 + y^2 = 1) &= \sum_{a+b=1} N(x^2 = a) N(x^2 = b)\\
 &= \sum_{a+b = 1} (1 + \chi(a))(1 + \chi(b))\\
 &= p + \sum_{a \in \F_p} \chi(a) + \sum_{b \in \F_p} \chi(b)  + \sum_{a+b=1} \chi(a) \chi(b)\\
 &= p + J(\chi,\chi).
 \end{align*}
 Comme $\chi = \chi^{-1}$, la proposition~\ref{jacobi1} donne $J(\chi,\chi) = - \chi(-1)  = - \legendre{-1}{p} = -(-1)^{\frac{p-1}{2}}$. Ainsi
 $$N(x^2 + y^2 = 1) = p - (-1)^{\frac{p-1}{2}}.$$
 Autrement dit
 \begin{align*}
 N(x^2 + y^2 = 1) &= p-1 \qquad \text{ si } p\equiv 1 \pmod 4,\\
  N(x^2 + y^2 = 1) &= p+1\qquad  \text{ si } p\equiv 3 \pmod 4.\\
 \end{align*}
 
 La proposition~\ref{module_J} permet de retrouver le théorème des deux carrés :
 \begin{prop}
 Si $p\equiv 1 \pmod 4$, alors il existe des entiers $a$ et $b$ tels que $p = a^2 + b^2$.
 \end{prop}
 \begin{proof}
 Comme $p\equiv 1 \pmod 4$, il existe d'après la proposition~\ref{existence_caractere} un caractère $\chi$ d'ordre 4 sur $\F_p$. Pour tout $a \in \F_p^*$, $(\chi(a))^4 = \chi^4(a) = \varepsilon(a) = 1$, donc $\chi(a) \in \{1,i,-1,-i\}$, et $\chi(0) = 0$. Par conséquent, $J(\chi,\chi) = \sum\limits_{a+b=1} \chi(a) \chi(b) \in \Z[i]$. Ainsi $J(\chi,\chi)$ s'écrit sous la forme $J(\chi,\chi) =a + b i,\ a,b \in \Z$. La proposition~\ref{module_J} montre que $$a^2 + b^2 = \n(a + bi) = \n(J(\chi,\chi)) = p.$$
 \end{proof}
 
 On obtient de même la proposition suivante, déjà prouvée dans la section~\ref{section1_8} du chapitre "Entiers de Gauss".
 \begin{prop}
 Si $p\equiv 1 \pmod 3$, alors il existe des entiers $a$ et $b$ tels que $p = a^2 - ab +b^2$.
 \end{prop}
 
\begin{proof}
Comme $p\equiv 1 \pmod 3$, il existe un caractère $\chi$ d'ordre 3. Pour tout $a \in \F_p^*$,  $(\chi(a))^3 = 1$, $\chi(a) \in \{1,\omega, \omega^2\}$, donc $J(\chi,\chi) \in \Z[\omega]$. Ainsi $J(\chi,\chi) = a + b\omega,\ a,b \in \Z$, et $p = \n(J(\chi,\chi)) = a^2 -ab +b^2$.
\end{proof}

Nous avons vu dans cette même section que ceci entraînait, pour les premiers $p\equiv 1 \pmod 3$, l'existence d'entiers $x,y$ tels que $p = x^2 + 3y^2$.

Soit $\chi$ un caractère d'ordre 3 sur $\F_q$ (ce qui n'est possible que si $q \equiv 1 \pmod 3$). Alors $\chi \ne \varepsilon, \chi^2 \ne \varepsilon$. La proposition 18 donne alors
$$g(\chi)^2 = J(\chi,\chi) g(\chi^2).$$
En multipliant cette relation par $g(\chi)$, nous obtenons, en utilisant $ \chi(-1) g(\overline{\chi}) = \overline{g(\chi)}$ (proposition~\ref{conjugue}), où ici $\chi(-1) = 1$, 
\begin{align*}
g(\chi)^3 &= J(\chi,\chi) g(\chi) g(\chi^2)\\
&=J(\chi,\chi) g(\chi) g(\overline{\chi})\\
&=J(\chi,\chi) g(\chi) \overline{g(\chi)}\\
&= q \,J(\chi,\chi)
\end{align*}

Nous avons prouvé la proposition suivante.
\begin{prop}\label{ordre3}
Si $\chi$ est un caractère d'ordre $3$ sur $\F_q$, alors
$$g(\chi)^3 = q\,  J(\chi,\chi).$$
\end{prop}

Généralisons :
\begin{prop}\label{generalisation}
Supposons que $\chi$ est un caractère d'ordre $n>2$ sur $\F_q$. Alors
$$g(\chi)^n = \chi(-1) q J(\chi,\chi)\cdots J(\chi,\chi^{n-2}).$$
\end{prop}
\begin{proof}
Ici $\chi,\chi^2,\ldots,\chi^{n-1}$ sont différents de $\varepsilon$. Donc, comme précédemment, $g(\chi)^2 = J(\chi,\chi) g(\chi^2)$.

Supposons, à titre d'hypothèse de récurrence, que $$g(\chi)^{k} = J(\chi,\chi)J(\chi,\chi^2)\cdots J(\chi,\chi^{k-1}) g(\chi^k),$$ pour un entier $k$ tel que $2 \leq k < n-1$.
En multipliant par $g(\chi)$, on obtient
$$g(\chi)^{k+1} = J(\chi,\chi)J(\chi,\chi^2)\cdots J(\chi,\chi^{k-1}) g(\chi) g(\chi^k).$$
Comme $k+1 <n$, $\chi, \chi^k$ et $\chi^{k+1}$ sont différents de $\varepsilon$. Alors la proposition~\ref{lien_Jacobi_Gauss} montre que $$g(\chi) g(\chi^k) = J(\chi,\chi^k) g(\chi^{k+1}).$$
Par conséquent,
$$g(\chi)^{k} = J(\chi,\chi)J(\chi,\chi^2)\cdots J(\chi,\chi^{k-1})  J(\chi,\chi^k) g(\chi^{k+1}),$$
ce qui achève la récurrence. Ainsi la propriété est vraie jusqu'à la valeur $k = n-1$. Donc
\begin{align}\label{eqz}
g(\chi)^{n-1} = J(\chi,\chi)\cdots   J(\chi,\chi^{n-2}) g(\chi^{n-1}).
\end{align}
 Enfin, comme $\chi^{n-1} = \chi^{-1} = \overline{\chi}$ (et $\chi(-1) = \pm 1$), nous obtenons, en utilisant les propositions~\ref{conjugue} et~\ref{module_J},
$$g(\chi) g(\chi^{n-1}) = g(\chi)g(\overline{\chi}) =  \chi(-1) g(\chi)\overline{g(\chi)} = \chi(-1) q .$$ En multipliant une dernière fois l'égalité (\ref{eqz}) par $g(\chi)$, nous obtenons
$$g(\chi)^n = \chi(-1) q J(\chi,\chi)\cdots J(\chi,\chi^{n-2}).$$
\end{proof}

Nous pouvons maintenant compléter le calcul de $N(x^3 + y^3 =1) = p-2 + 2 \ \mathrm{Re}(J(\chi,\chi))$ dans le cas où $q=p$ est un nombre premier. Nous savons que, $\chi$ étant un caractère d'ordre 3, $J(\chi,\chi) \in \Z[\omega]$, soit $${J(\chi,\chi) = a + b \omega}, \ {a,b\in \Z}.$$
\begin{prop}\label{congruences}
Supposons que $p\equiv 1 \pmod 3$ et que $\chi$ est un caractère cubique sur $\F_p$. Soient $a,b$ les entiers tels que $J(\chi,\chi) = a  + b \omega$. Alors
\be
\item[(a)] $b \equiv 0 \pmod 3$,
\item[(b)] $a \equiv -1 \pmod 3$.
\ee
\end{prop}
\begin{proof}
Nous utilisons des congruences modulo 3 dans l'anneau des entiers algébriques.
$$g(\chi)^3 = \left(\sum_{t\in\F_p} \chi(t) \zeta^t\right)^3 \equiv \sum_{t\in \F_p} \chi(t)^3\zeta^{3t} \pmod 3.$$
Puisque $\chi(0)=0$, et $\chi(t)^3 = 1$ pour $t\ne 0$, nous obtenons 
$$\sum_{t\in \F_p} \chi(t)^3\zeta^{3t} = \sum_{t\in \F_p^*} \zeta^{3t} = -1.$$
La proposition~\ref{ordre3} donne alors, puisque $p \equiv 1 \pmod 3$,
$$g(\chi)^3 = p J(\chi,\chi)  \equiv a+b\omega \equiv -1 \pmod 3.$$

Le même calcul appliqué à $\overline{\chi}$ donne $g(\overline{\chi})^3 \equiv -1 \pmod 3$, et $\overline{g(\chi)} = g(\overline{\chi})$ (proposition~\ref{conjugue}). Le passage au conjugué dans la relation précédente donne alors
$$g(\overline{\chi})^3 = p J(\overline{\chi},\overline{\chi})  \equiv a+b\overline{\omega} \equiv -1 \pmod 3.$$
En soustrayant ces deux congruences, nous obtenons $b(\omega- \overline{\omega}) \equiv 0 \pmod 3$, soit $bi \sqrt{3} \equiv 0 \pmod 3$. L'élévation au carré donne $-3b^2 \equiv 0 \pmod 9$, et cette congruence est alors vraie dans l'anneau $\Z$. Par conséquent $3 \mid b^2$ dans $\Z$, et $3 \mid b$, ce qui prouve (a).

Comme $b \equiv 0 \pmod 3$ et $a + b \omega \equiv -1 \pmod 3$, nous obtenons $a\equiv -1 \pmod 3$.
\end{proof}

Nous pouvons maintenant prouver le beau résultat dû à Gauss.
\begin{prop}
\be
\item[(a)] Soit $p \equiv 1 \pmod 3$ un nombre premier. Alors il existe un et un seul couple d'entiers $(A,B)$ tel que $4p = A^2 + 27 B^2,\ A \equiv 1 \pmod 3, B>0$. 
\item[(b)] Cet unique élément $A$ vérifie
$$N(x^3 + y^3 = 1) = p-2 + A.$$
\ee
\end{prop}

\begin{proof}
\be
\item[(a)]
$\bullet$ Existence. 

Comme $p\equiv 1 \pmod 3$, il existe un caractère $\chi$ d'ordre 3. Il vérifie $J(\chi,\chi) = a + b \omega$ et $|J(\chi,\chi)|^2 = p$, donc $p = a^2 -ab + b^2$, soit $4p = (2a-b)^2 + 3 b^2$. La proposition~\ref{congruences} montre que $b\equiv 0, a \equiv -1 \pmod 3$. Posons alors $A =2a - b$, et $B = \frac{|b|}{3}$, avec $B\ne 0$ puisque $p$ est premier. Alors $A,B$ sont entiers, et
$$4p = A^2 + 27B^2, \qquad A \equiv 1 \pmod 3,\ B>0.$$

$\bullet$ Unicité.

Supposons que $4p = A^2 + 27 B^2 = C^2 + 27 D^2$, où $A \equiv C \equiv 1 \pmod 3, B>0,D>0$. Nous allons montrer que  $A = C, B = D$.

Comme $\omega = e^{\frac{2i\pi}{3}} = -\frac{1}{2} + i \frac{\sqrt{3}}{2}$, alors $i\sqrt{3} = 2 \omega +1$, et pour tout couple d'entiers $x,y$,
$x^2 + 3 y^2 = (x+i\sqrt{3}y)(x-i\sqrt{3}y) = (x + (2\omega+1)y)(x - (2\omega+1)y),$
$$x^2+3y^2 = (x+y+2\omega y)(x-y-2\omega y).$$
Avec $x =A, y = 3B$, nous obtenons
$$4p = A^2+27B^2 = (A+3B+6\omega B)(A-3B-6\omega B).$$
Notons que $A,B$ sont de même parité, puisque $4p = A^2 + 27 B^2$.

Nous pouvons donc écrire $p = (\frac{A+3B}{2} + 3\omega B)(\frac{A-3B}{2} - 3\omega B)$, soit
$$p = \pi \overline{\pi},\text{ où } \pi = \frac{A+3B}{2} + 3\omega B \in \Z[\omega].$$
Par conséquent $\pi$ est premier dans $\Z[\omega]$ (proposition 20 du chapitre "Entiers de Gauss").
$$\pi \overline{\pi} = \left(\frac{A+3B}{2} + 3\omega B\right)\left(\frac{A-3B}{2} - 3\omega B\right)=\left(\frac{C+3D}{2} + 3\omega D\right)\left(\frac{C-3D}{2} - 3\omega D\right).$$
Comme $\pi$ est premier, il divise $\frac{C+3D}{2} + 3\omega D$ ou son conjugué. Puisqu'ils ont la même norme $p$, ils sont associés. Les unités de $\Z[\omega]$ sont $\pm1,\pm \omega,\pm \omega^2$, si bien qu'il existe 12 cas :
\begin{align*}
\frac{A+3B}{2} + 3\omega B &= \pm \left(\frac{C+3D}{2} + 3\omega D\right),\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega \left(\frac{C+3D}{2} + 3\omega D\right),\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega^2\left(\frac{C+3D}{2} + 3\omega D\right),\\
\frac{A+3B}{2} + 3\omega B &= \pm \left(\frac{C-3D}{2} - 3\omega D\right),\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega \left(\frac{C-3D}{2} - 3\omega D\right),\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega^2\left(\frac{C-3D}{2} - 3\omega D\right).\\
\end{align*}
Pour prouver que $A = C$, si on remplace $D$ par $-D$, nous obtenons les 6 derniers cas à partir des 6 premiers, si bien qu'il suffit d'examiner les 6 premiers cas.

Rappelons que $(1,\omega)$ est une  $\Z$-base de $\Z[\omega]$.
\begin{enumerate}
\item[1)] $A + 3B + 6\omega B = C + 3D + 6\omega D$.

Alors $B = D$ et $A+3B = C + 3D$, donc $A = C$, ce qui est le résultat attendu.
Les cinq autres cas ne peuvent se produire :
\item[2)] $A+3B + 6\omega B = -C-3D -6\omega D$.

Alors $B = -D, A = -C$. Comme $A\equiv C \equiv 1 \pmod 3$, c'est impossible.
\item[3)] $A + 3 B + 6\omega B = \omega(C+3D+6\omega D) = \omega(C+3D) + (-1 - \omega) 6 D = -6D + \omega(C-3D)$.

Alors $A+3B = - 6 D$, $A \equiv 0 \pmod 3$, c'est impossible.
\item[4)] $A+3B + 6 \omega B = -\omega (C+3D+6\omega D) = -\omega (C+3D) + (1+\omega) 6D = 6D + \omega(-C+3D)$.

Alors $A+3B = -6D$, $A \equiv 0 \pmod 3$, c'est impossible.

\item[5)] $A+3B + 6\omega B = \omega^2(C+D+6\omega D) = (-1-\omega)(C + 3D) + 6D  = -C + 3D + \omega (-C-3D)$.
Alors $A+3B = - C +3D$, $A\equiv -C \pmod 3$, c'est impossible.

\item[6)] $A + 3B + 6 \omega B = -\omega^2(C+3D + 6\omega D) = (1 + \omega)(C+3D) - 6D = (C-3D) + \omega(C+3D)$.

Alors $6B = C+ 3D$, $C \equiv 0 \pmod 3$, c'est impossible.
\end{enumerate}
En conclusion $A = C$. Alors $B^2 = D^2$, où $B>0,D>0$, donc $B=D$.
\item[(b)] Nous avons déjà prouvé (voir l'égalité (1)) que
$$N(x^3+y^3 = 1) = p-2 + 2\ \mathrm{Re}(J(\chi,\chi)).$$
Comme $J(\chi,\chi) = a + b \omega$, nous obtenons $2 \mathrm{Re}(J(\chi,\chi)) = 2a - b = A \equiv 1 \pmod 3$, si bien que
$$N(x^3+y^3 = 1) = p-2 + A,$$
où $A$ est l'unique entier tel qu'il existe un entier $B$ vérifiant  $4p = A^2 + 27 B^2, A \equiv 1 \pmod 3$.
\ee

\end{proof}

Exemple 1 : soit $p = 37$. Alors $4 p = 148 = (-11)^2 + 27 \times 1^2$, où $-11\equiv 1 \pmod 3$, donc $A = -11$. Alors, dans $\F_{37}$,
$$N(x^3+y^3 = 1) = 37 - 2 -11 = 24\qquad (p=37).$$

Exemple 2 : soit $p = 97$. Alors $4p = 388 = 19^2 + 27 \times 1^2$, où $19\equiv 1 \pmod 3$, donc $A = 19$. Dans $\F_{97}$,
$$N(x^3+y^3 = 1) = 97 - 2 + 19 = 114 \qquad (p = 97).$$



\section{L'équation $x^n+y^n = 1$ dans $\F_p$.}

Ici $p$ est premier. Supposons d'abord que $p \equiv 1 \pmod n$. Alors $d = n \wedge( p-1) =n$.
Nous savons que $$N(x^n+y^n=1) =\sum_{a+b = 1} N(x^n = a) N(x^n = b).$$
Soit $\chi$ un caractère d'ordre $n$. D'après la proposition~\ref{ordre_n}, les éléments du groupe des caractères d'ordre divisant $n$ sont $\varepsilon, \chi,\chi^2,\ldots,\chi^{n-1}$. La proposition~\ref{nbRacs} montre que
$$N(x^n = a) = \sum_{i = 0} ^{n-1} \chi^i(a).$$
Ces deux résultats prouvent que
\begin{align*}
N(x^n +y^n = 1) &= \sum_{a+b = 1}  \sum_{i = 0} ^{n-1} \chi^i(a)  \sum_{j = 0} ^{n-1} \chi^j(b)\\
&=\sum_{i = 0} ^{n-1}\sum_{j = 0} ^{n-1} \left(\sum_{a+b = 1}  \chi^i(a) \chi^j(b) \right)\\
&=\sum_{i = 0} ^{n-1}\sum_{j = 0} ^{n-1} J(\chi^i,\chi^j).
\end{align*}
La proposition~\ref{jacobi1} permet d'estimer cette somme.
\be
\item[$\bullet$] Si $i=j=0$, $J(\chi^i,\chi^j) = J(\varepsilon, \varepsilon) = p$.
\item[$\bullet$] Si $i=0$ et $j\ne 0$, ou si $j = 0$ et $i \ne 0$, $J(\chi^i,\chi^j)  = 0$.
\item[$\bullet$] Si $i+j = n,i \ne 0, j\ne 0$, alors $J(\chi^i,\chi^j) =J(\chi^i, \chi^{-i}) = - \chi^i(-1)$, si bien que la somme de ces termes est
\begin{align*}
\sum_{i+j = n,i>0,j>0}J(\chi^i,\chi^j)&= -\sum_{i=1}^{n-1} \chi^i(-1).
\end{align*}
Comme l'ordre de $\chi$ est $n$,
$$\sum_{i=0}^{n-1} \chi^i(-1) = 
\left\{
\begin{array}{ll}
\frac{1 - \chi^n(-1)}{1 - \chi(-1)} = 0&\text{si } \chi(-1) \ne 1,\\
n&\text{si } \chi(-1) = 1.
\end{array}
\right.
$$

Soit $a\in \F_p^*$. Définissons $\delta_n(a)$ par
$$
\delta_n(a) = 
\left\{
 \begin{array}{ll}
 1 & \text{s'il existe } x \in \F_p \text{ tel que } x^n =a,\\
 0 & \text{sinon.}
 \end{array}
 \right.
$$
La proposition~\ref{existence_racine} montre que $\delta_n(a) = 1$ si et seulement si $\chi(a) = 1$ (et $\delta_n(a) = 0$ sinon). Cette notation permet d'écrire
$$\sum_{i=0}^{n-1} \chi^i(-1) =  \delta_n(-1) n.$$
Par conséquent,
\begin{align*}
\sum_{i+j = n,i>0,j>0}J(\chi^i,\chi^j)&= -\sum_{i=1}^{n-1} \chi^i(-1)\\
&= 1 - \sum_{i=0}^{n-1} \chi^i(-1)\\
&= 1 - \delta_n(-1) n
\end{align*}
\ee
En résumé,
$$N(x^n+y^n = 1 ) = p + 1 -\delta_n(-1) n + \sum_{(i,j) \in A} J(\chi^i, \chi^j),$$
où $A$ est l'ensemble des couples $(i,j)$ tels que $1\leq i \leq n-1, 1 \leq j \leq n-1, i+j \ne n$. Ainsi $|A| = (n-1)^2 - (n-1) = (n-1)(n-2)$. Comme $|J(\chi^i, \chi^j)| = \sqrt{p}$ si $(i,j)\in A$, nous avons prouvé la proposition suivante.
\begin{prop}\label{card_courbe}
Si $p$ est premier et $p\equiv 1 \pmod n$,
$$|N(x^n+y^n = 1)  + \delta_n(-1) n - (p+1)| \leq (n-1)(n-2) \sqrt{p}.$$
\end{prop}

Le terme $\delta_n(-1) n$ peut s'interpréter comme le nombre de points à l'infini de la courbe $x^n+y^n = 1$. En effet la complétion projective de cette courbe est la courbe projective d'équation homogène $x^n+y^n = t^n$, et les points à l'infini sont donnés par l'intersection avec la droite de l'infini d'équation $t=0$. Les points à l'infini sont donc les points projectifs de coordonnées homogènes $(x,y,0)$ vérifiant $x^n + y^n =0$. Alors $y\ne 0$, sinon $x=y= t= 0$, donc $(x,y,0) = y (a, 1,0)$, où $a = \frac{x}{y}$ vérifie $a^n = -1$. Le nombre $N$  points à l'infini de la courbe $x^n+y^n = 1$ est donc égal au nombre de solutions de $a^n = -1$ dans $\F_p$. La proposition~\ref{nbsols} montre que le nombre $N$ de solutions de $a^n = -1$ est $0$ si $\delta_n(-1) =0$, et $n = n \wedge (p-1)$ si $\delta_n(-1) = 1$. Ainsi $N = \delta_n(-1) n$. Par conséquent la somme des deux termes $N(x^n+y^n = 1) + \delta_n(-1) n$ désigne le nombre de points projectifs de la courbe d'équation homogène $x^n+y^n = t^n$.

Traitons maintenant le cas général, sans l'hypothèse $p\equiv 1 \pmod n$.
\begin{prop}\label{cas_general}
Soit $(a_1,\ldots ,a_n) \in \F_p^n, (m_1,\ldots,m_n) \in \N^n, b \in \F_p$. 

Posons $d_i = m_i \wedge (p-1), \ 1\leq i \leq n$. Alors
$$N\left(\sum_{i=0}^n a_i x_i^{m_i} = b\right) = N\left(\sum_{i=0}^n a_i x_i^{d_i} = b\right).$$
\end{prop}
\begin{proof}
La proposition~\ref{pgcd} montre que, pour tout $(u_1,\ldots,u_n)\in \F_p^n$,
$$N(x^{m_i} = u_i) = N(x^{d_i}= u_i).$$
En utilisant ce résultat, nous obtenons
\begin{align*}
N\left(\sum\limits_{i=1}^n a_i x_i^{m_i} = b\right) &= \sum\limits_{a_1u_1+\cdots+a_l u_l= b}\, \prod\limits_{i=1}^n N(x^{m_i} = u_i)\\
&= \sum\limits_{a_1u_1+\cdots+a_n u_n= b}\, \prod\limits_{i=1}^l N(x^{d_i} = u_i)\\
&=N\left(\sum\limits_{i=1}^n a_i x_i^{d_i} = b\right).
\end{align*}
\end{proof}

Cette proposition montre que
$$N(x^n+y^n =1) = N(x^d+y^d = 1), \text{ où } d =n\wedge (p-1),\ p \equiv 1 \pmod d.$$ 
La proposition \ref{card_courbe} permet alors d'estimer $N(x^d+y^d = 1)$.


\section{Sommes de Jacobi généralisées.}
La généralisation des sommes de Jacobi est donnée par la définition suivante.
\begin{dfn}
Si $\chi_1,\ldots,\chi_l$ sont des caractères sur $\F_q$, la somme de Jacobi associée est donnée par
$$J(\chi_1,\ldots,\chi_l) = \sum_{t_1+\cdots+t_l = 1} \chi_1(t_1)\cdots\chi_l(t_l).$$
\end{dfn}

Pour compléter cette définition, définissons $J_0$ par
\begin{dfn}
$$J_0(\chi_1,\ldots,\chi_l) = \sum_{t_1+\cdots+t_l = 0} \chi_1(t_1)\cdots\chi_l(t_l).$$
\end{dfn}

Donnons quelques valeurs particulières de $J$ et $J_0$ associées à $l$ caractères.
\begin{prop}\label{jac_gen1}
Soient $\chi_1,\ldots,\chi_l$ des caractères sur $\F_q$.
\be
\item[(a)] Si $\chi_1=\cdots = \chi_l = \varepsilon$, alors
\begin{align*}
J_0(\chi_1,\ldots,\chi_l)  &= q^{l-1},\\
J(\chi_1,\ldots,\chi_l)  &= q^{l-1}.
\end{align*}
\item[(b)] Si certains des caractères $\chi_i, \ 1 \leq i \leq l$ sont triviaux, mais pas tous, alors
\begin{align*}
J_0(\chi_1,\ldots,\chi_l) &= 0,\\
J(\chi_1,\ldots,\chi_l) &= 0.
\end{align*}
\item[(c)] Supposons que $\chi_l \ne \varepsilon$. Alors
$$
J_0(\chi_1,\ldots,\chi_l) = 
\left\{
\begin{array}{ll}
0&\text{si } \chi_1\cdots\chi_l \ne \varepsilon,\\
\chi_l(-1)(q-1)J(\chi_1,\ldots,\chi_{l-1})&\text{sinon}.
\end{array}
\right.
$$
\ee
\end{prop}
\begin{proof}
\be
\item[(a)] Si $\chi_1 = \cdots = \chi_l = \varepsilon$, alors
$$J_0(\chi_1,\ldots,\chi_l) = \sum_{t_1+\cdots+t_l = 0} 1 = \mathrm{Card}\{(t_1,\ldots,t_l)\in \F_q^l\ | \ t_1+\cdots + t_l =0\} = q^{l-1}.$$
En effet le nombre de solutions de l'équation de l'équation $t_1+\cdots+t_l = 0$ est $q^{l-1}$, puisqu'une telle solution est déterminée par le choix arbitraire de $(t_1,\ldots,t_{l-1})$ dans $\F_q^{l-1}$ (alors $t_l = -t_1-\cdots - t_{l-1}$).

De même,
$$J(\chi_1,\ldots,\chi_l) = \sum_{t_1+\cdots+t_l = 1} 1 = \mathrm{Card}\{(t_1,\ldots,t_l)\in \F_q^l\ | \ t_1+\cdots + t_l =1\} = q^{l-1}.$$
\item[(b)] Supposons, quitte à changer l'ordre des caractères, que $\chi_1,\ldots,\chi_s$ sont non triviaux (avec $s\geq 1$), et que $\chi_{s+1} = \cdots=\chi_l = \varepsilon$. Alors
\begin{align*}
J_0(\chi_1,\ldots,\chi_l) &= \sum_{t_1+\cdots+t_l = 0} \chi_1(t_1)\cdots\chi_l(t_l)\\
&=\sum_{t_1\in \F_q} \chi_1(t_1) \cdots \sum_{t_s\in \F_q} \chi_s(t_s)\left(\sum_{t_{s+1} + \cdots + t_l = -t_1-\cdots-t_{s} } 1 \right)\\
&=q^{l-s-1} \left(\sum_{t_1\in \F_q} \chi_1(t_1)\right) \cdots \left(\sum_{t_s\in \F_q} \chi_s(t_s)\right)
\end{align*}
(si $t_1,\ldots,t_s$ sont fixés, l'équation $t_{s+1} + \cdots + t_l = -t_1-\cdots-t_{s} $ a $q^{l-s-1}$ solutions.)

De plus $\sum\limits_{t_1\in \F_q} \chi_1(t_1) = 0$ (proposition~\ref{somme_chi}(a)), et $s\geq 1$, donc $J_0(\chi_1,\ldots,\chi_l) = 0$.

Même preuve pour $J(\chi_1,\ldots \chi_l) = 0$, l'équation $t_{s+1} + \cdots + t_l = -t_1-\cdots-t_{s} $ étant remplacée par $t_{s+1} + \cdots + t_l = 1 -t_1-\cdots-t_{s} $.
\item[(c)] Partons de 
$$J_0(\chi_1,\ldots,\chi_l) = \sum_{s\in \F_q} \left(\sum_{t_1+\cdots+t_{l-1} = -s} \chi_1(t_1)\cdots\chi_{l-1}(t_{l-1})\right) \chi_l(s).$$
Comme $\chi_l \ne \varepsilon$, $\chi_l(0) = 0$, donc
$$J_0(\chi_1,\ldots,\chi_l) = \sum_{s\in \F_q^*} \left(\sum_{t_1+\cdots+t_{l-1} = -s} \chi_1(t_1)\cdots\chi_{l-1}(t_{l-1})\right) \chi_l(s).$$
\ee
Le changement d'indice donné par $(t_1,\ldots,t_{l-1}) = (-st'_1,\ldots,-st'_{l-1})$ donne
\begin{align*}
\sum_{t_1+\cdots+t_{l-1} = -s} \chi_1(t_1)\cdots\chi_{l-1}(t_{l-1}) &= (\chi_1\cdots \chi_{l-1})(-s) \sum_{t'_1+\cdots+t'_{l-1} = 1} \chi_1(t'_1)\cdots\chi_{l-1}(t'_{l-1})\\
&=(\chi_1\cdots \chi_{l-1})(-s) J(\chi_1,\ldots,\chi_{l-1}).
\end{align*}
En reportant ce résultat dans le calcul de $J_0(\chi_1,\ldots,\chi_l)$, nous obtenons
$$J_0(\chi_1,\ldots,\chi_l) = (\chi_1\cdots \chi_{l-1})(-1) J(\chi_1,\ldots,\chi_{l-1}) \sum_{s \in \F_p^*} (\chi_1\cdots \chi_l)(s).$$
Si $\chi_1\cdots \chi_l \ne \varepsilon$, alors $ \sum_{s \in \F_q^*} (\chi_1\cdots \chi_l)(s) = 0$. Dans le cas contraire, $ \sum_{s \in \F_q^*} (\chi_1\cdots \chi_l)(s) = q-1$, donc 
\begin{align*}
J_0(\chi_1,\ldots,\chi_l) &= (\chi_1\cdots \chi_{l-1})(-1) (q-1) J(\chi_1,\ldots,\chi_{l-1})\\
&=\overline{\chi_l(-1)} (q-1) J(\chi_1,\ldots,\chi_{l-1})\\
&=\chi_l(-1) (q-1) J(\chi_1,\ldots,\chi_{l-1}).
\end{align*}
\end{proof}

La proposition~\ref{lien_Jacobi_Gauss} se généralise de la façon suivante.
\begin{prop}\label{jac_gen2}
Supposons que $\chi_1,\ldots,\chi_r$ sont non triviaux, ainsi que $\chi_1 \cdots \chi_r$. Alors
$$g(\chi_1)\cdots g(\chi_r) = J(\chi_1,\ldots,\chi_r) g(\chi_1\cdots \chi_r).$$
\end{prop}
\begin{proof}
En effet, en notant $\psi(s) = \zeta_p^{\mathrm{tr}(s)}$ pour $s \in \F_q$, nous obtenons
\begin{align*}
g(\chi_1)\cdots g(\chi_r) &= \left( \sum_{t_1 \in \F_q} \chi_1(t_1) \psi(t_1) \right)\cdots \left( \sum_{t_r \in \F_q} \chi_r(t_r) \psi(t_r) \right)\\
&=\sum_{s\in \F_q} \left (\sum_{t_1+\cdots+t_r=s} \chi_1(t_1)\cdots \chi_r(t_r) \right ) \psi(s).
\end{align*}
Notons $S(s) = \sum\limits_{t_1+\cdots+t_r=s} \chi_1(t_1)\cdots \chi_r(t_r)$ la somme intérieure.
L'hypothèse $\chi_1 \cdots \chi_r \ne \varepsilon$ permet d'appliquer la proposition~\ref{jac_gen1}(c) pour $s = 0$ :
$$S(0) = \sum_{t_1+\cdots+t_r=0} \chi_1(t_1)\cdots \chi_r(t_r) = J_0(\chi_1,\ldots,\chi_r) = 0, $$
Si $s\ne 0$, le changement d'indice $(t_1,\ldots,t_r) = (st'_1,\ldots,st'_r)$ donne
\begin{align*}
S(s) &= (\chi_1\cdots\chi_r)(s) J(\chi_1,\ldots,\chi_r)
\end{align*}
et ainsi
\begin{align*}
g(\chi_1)\cdots g(\chi_r) &= \sum_{s\in \F_p^*}  (\chi_1\cdots\chi_r)(s) J(\chi_1,\ldots,\chi_r) \zeta^s\\
&=J(\chi_1,\ldots,\chi_r) g(\chi_1\cdots \chi_r).
\end{align*}
\end{proof}

Nous en tirons les conséquences suivantes.
\begin{prop}\label{jac_gen3}
Supposons que $\chi_1,\ldots,\chi_r$ sont non triviaux, mais que $\chi_1\cdots \chi_r$ est trivial. Alors
$$g(\chi_1)\cdots g(\chi_r) = \chi_r(-1) \, q \, J(\chi_1,\cdots,\chi_{r-1}).$$
\end{prop}

\begin{proof}
La proposition~\ref{jac_gen2} montre que
$$g(\chi_1)\cdots g(\chi_{r-1}) = J(\chi_1,\ldots,\chi_{r-1}) g(\chi_1\cdots \chi_{r-1}).$$
En multipliant les deux membres de cette égalité par $g(\chi_r)$, puisque $\chi_1\cdots \chi_{r-1} = \chi_r^{-1} = \overline{\chi_r}$, nous obtenons
$$g(\chi_1)\cdots g(\chi_r) =  g(\chi_r) g( \overline{\chi_r}) J(\chi_1,\ldots,\chi_{r-1}).$$
En utilisant les propositions~\ref{module} et~\ref{conjugue},
$$g(\chi_r) g( \overline{\chi_r})  = \chi_r(-1) g(\chi_r) \overline{g(\chi_r)} = \chi_r(-1)q,$$
 donc 
$$g(\chi_1)\cdots g(\chi_r) =\chi_r(-1)q J(\chi_1,\ldots,\chi_{r-1}).$$
\end{proof}

\begin{prop}\label{jac_gen4}
Supposons que $\chi_1,\ldots,\chi_r$ sont non triviaux, mais que $\chi_1\cdots \chi_r$ est trivial. Alors
$$J(\chi_1,\ldots,\chi_r) = - \chi_r(-1) J(\chi_1,\ldots,\chi_{r-1}).$$
(pour $r = 2$, nous posons $J(\chi_1) = 1$.)
\end{prop}


\begin{proof}
Pour $r = 2$, il s'agit de la proposition~\ref{jacobi1}(c). Supposons maintenant que $r>2$.

Comme au début de la démonstration de la proposition~\ref{jac_gen2}, nous obtenons
\begin{align}\label{equa1}
g(\chi_1)\cdots g(\chi_r) = \sum_{s\in \F_q} \left (\sum_{t_1+\cdots+t_r=s} \chi_1(t_1)\cdots \chi_r(t_r) \right ) \psi(s),
\end{align}
mais maintenant, l'hypothèse $\chi_1\cdots \chi_r = \varepsilon$ donne, à l'aide de la proposition~\ref{jac_gen1}(c),
\begin{align}\label{equa2}
S(0) = \sum_{t_1+\cdots+t_r=0} \chi_1(t_1)\cdots \chi_r(t_r) = J_0(\chi_1,\ldots,\chi_r) = \chi_r(-1)(q-1)J(\chi_1,\ldots,\chi_{r-1}), 
\end{align}
et pour $s \ne 0$, comme dans la démonstration de la proposition~\ref{jac_gen1},
\begin{align}\label{equa3}
S(s) = \sum\limits_{t_1+\cdots+t_r=s} \chi_1(t_1)\cdots \chi_r(t_r) = (\chi_1\cdots\chi_r)(s) J(\chi_1,\ldots,\chi_r).
\end{align}
Ici $\chi_1\cdots \chi_r = \varepsilon$, donc $S(s) = J(\chi_1,\ldots,\chi_r)$.

Ainsi, en utilisant les égalités (\ref{equa1}), (\ref{equa2}), et (\ref{equa3}), ainsi que $ \sum_{s\in \F_q} \psi(s) = 0$ (proposition~\ref{proprietes_psi}),
\begin{align*}
g(\chi_1)\cdots g(\chi_r) &= J_0(\chi_1,\ldots,\chi_r) + J(\chi_1,\ldots,\chi_r) \sum_{s\in \F_q^*} \psi(s)\\
&=\chi_r(-1)(q-1)J(\chi_1,\ldots,\chi_{r-1}) -  J(\chi_1,\ldots,\chi_r) 
\end{align*}
La proposition~\ref{jac_gen3} donne $$g(\chi_1)\cdots g(\chi_r) = \chi_r(-1) \, q \, J(\chi_1,\cdots,\chi_{r-1}).$$ Par conséquent, 
\begin{align*}
\chi_r(-1) \, q \, J(\chi_1,\cdots,\chi_{r-1}) &= \chi_r(-1)(q-1)J(\chi_1,\ldots,\chi_{r-1})  - J(\chi_1,\ldots,\chi_r) \\
\end{align*}
et donc
$$J(\chi_1,\ldots,\chi_r) = -\chi_r(-1) J(\chi_1,\ldots,\chi_{r-1}).$$
\end{proof}

\begin{prop}\label{jac_gen5}
Supposons que $\chi_1,\ldots,\chi_r$ sont des caractères non triviaux sur $\F_q$.
\be
\item[(a)] Si $\chi_1\cdots\chi_r \ne \varepsilon$, alors
\begin{align*}
|J_0(\chi_1,\ldots,\chi_r)| &=0,\\
|J(\chi_1,\ldots,\chi_r)| &= q^{\frac{r-1}{2}}.
\end{align*}
\item[(b)] Si $\chi_1\cdots\chi_r = \varepsilon$, alors
\begin{align*}
|J_0(\chi_1,\ldots,\chi_r)| &= (q-1)q^{\frac{r}{2} - 1},\\
|J(\chi_1,\ldots,\chi_r)| &= q^{\frac{r}{2} - 1}.
\end{align*}
\ee
\end{prop}
\begin{proof}
Si $\chi$ n'est pas un caractère trivial, alors $|g(\chi)| = \sqrt{q}$. 

\be
\item[(a)] 

Si $\chi_1\cdots\chi_r \ne  \varepsilon$, la proposition~\ref{jac_gen1}(c) donne $J_0(\chi_1,\ldots,\chi_r) = 0$,
et la proposition~\ref{jac_gen2} donne
$$|J(\chi_1,\ldots,\chi_r)| = \frac{(\sqrt{q})^r}{\sqrt{q}} = q^{\frac{r-1}{2}} .$$
\item[(b)] Si $\chi_1\cdots\chi_r = \varepsilon$, la proposition~\ref{jac_gen1}(c) et la relation précédente donnent, puisque $\chi_1\cdots\chi_{r-1} = \chi_r^{-1} \ne \varepsilon$,
\begin{align*}
|J_0(\chi_1,\ldots,\chi_r)| &= (q-1) |J(\chi_1,\ldots,\chi_{r-1})|\\
&=(q-1) q^{\frac{r}{2} - 1}.
\end{align*}
Enfin, 
\begin{align*} |J(\chi_1,\ldots,\chi_r)|&=|J(\chi_1,\ldots,\chi_{r-1})| \qquad \text{(proposition~\ref{jac_gen4})}\\
&= q^{\frac{r}{2} - 1} \qquad \qquad \qquad \quad \text{(partie (a))}.
\end{align*}
\ee
\end{proof}


\section{Applications arithmétiques des sommes de Jacobi.}

Généralisons le calcul de $N(x^2 + y^2 = 1)$ à $N(x_1^2\cdots+x_r^2 = 1)$ dans $\F_p$, où $p$ est premier.

Soit $\chi$ l'unique caractère d'ordre 2, le caractère de Legendre. Nous avons vu que $N(x^2 = a) =1 + \chi(a)$. Alors
\begin{align*}
N(x_1^2+\cdots+x_r^2 = 1) &= \sum_{a_1+\cdots+a_r=1} N(x_1^2 =a_1)\cdots N(x_r^2=a_r)\\
&=\sum_{a_1+\cdots+a_r=1} (1 + \chi(a_1))\cdots(1+\chi(a_r))\\
&=\sum_{a_1+\cdots+a_r=1} \sum_{(i_1,\ldots,i_r) \in \{0,1\}^r} \chi^{i_1}(a_1)\cdots\chi^{i_r}(a_r)\\
&=  \sum_{(i_1,\ldots,i_r) \in \{0,1\}^r} J(\chi^{i_1},\ldots,\chi^{i_r})
\end{align*}

Si $i_1 = \cdots = i_r = 0$, alors $J(\chi^{i_1},\ldots,\chi^{i_r}) = J(\varepsilon,\ldots,\varepsilon) = p^{r-1}$ d'après la proposition~\ref{jac_gen1}(a).

Si l'un des exposant $i_k$ est nul, mais pas tous, la proposition~\ref{jac_gen1}(b) donne $J(\chi^{i_1},\ldots,\chi^{i_r}) = 0$. Il ne reste que le cas où $i_1 = \cdots=i_r=1$, donc
$$N(x_1^2+\cdots+x_r^2 = 1) = p^{r-1} + J(\chi,\ldots,\chi).$$
Notons que $\chi^{r} = \chi$ si $r$ est impair et $\chi^r = \varepsilon$ si $r$ est pair.

Supposons d'abord que $r$ est impair. Alors $\chi^r = \chi$ n'est pas trivial, donc la proposition~\ref{jac_gen2} donne
$$J(\chi,\cdots,\chi) = g(\chi)^{r-1}.$$
Les propositions~\ref{module} et~\ref{conjugue} donnent, puisque $\chi$ est à valeur réelles, 
$g(\chi)^2 = g(\chi)g(\overline{\chi}) = \chi(-1) g(\chi) \overline{g(\chi)} = \chi(-1)p$, et ainsi
$$g(\chi)^2 = \chi(-1) p.$$
Alors $J(\chi,\cdots,\chi) = (\chi(-1) p)^{\frac{r-1}{2}} = (-1)^{\frac{r-1}{2} \frac{p-1}{2}} p^{\frac{r-1}{2}}.$

Si $r$ est pair, alors $\chi^r=\varepsilon$. La proposition~\ref{jac_gen4} donne
$$J(\chi,\ldots,\chi) = -\chi(-1) (\chi(-1) p)^{\frac{r}{2}-1} =  -(-1)^{\frac{r}{2} \frac{p-1}{2}} p^{\frac{r}{2} -1}.$$
Nous avons donc prouvé la proposition suivante :
\begin{prop}Si $r$ est impair, 
$$N(x_1^2+\cdots+x_r^2 = 1) = p^{r-1} + (-1)^{\frac{r-1}{2} \frac{p-1}{2}} p^{\frac{r-1}{2}},$$
et si r est pair,
$$N(x_1^2+\cdots+x_r^2 = 1) = p^{r-1} - (-1)^{\frac{r}{2} \frac{p-1}{2}} p^{\frac{r}{2} -1}.$$
\end{prop}

\section{Un théorème général.}

Généralisant les résultats précédents, nous estimons maintenant le nombre de solutions $N$ dans $\F_q$ de
$$a_1x_1^{l_1} + \cdots + a_r x_r^{l_r} = b,$$
où $a_1,\ldots,a_r\in \F_q^*, b \in \F_q$ et $l_i \in \N^*$.

Puisque $N(x^m = a) = N(x^d = a)$, où $d = m \wedge (q-1)$, nous pouvons supposer que les exposants $l_i$ sont des diviseurs de $q-1$ (proposition~\ref{cas_general}).

Nous partons de 
$$ N = \sum_{\sum_{i=1}^r a_i u_i = b} N(x_1^{l_1} = u_1) \cdots N(x_r^{l_r} = u_r).$$

Comme dans le paragraphe~\ref{caracteres}, notons $C_{l}$ l'ensemble des caractères sur $\F_p$ dont l'ordre divise $l$. La proposition 10 donne
$$N(x_i^{l_i} =u_i)= \sum_{\chi_i \in C_{l_i}} \chi_i(u_i).$$
Ainsi
$$N = \sum_{(\chi_1,\ldots,\chi_r) \in C_{l_1} \times \cdots C_{l_r}} \left ( \sum_{\sum_{i=1}^r a_i u_i = b} \chi_1(u_1)\cdots \chi_r(u_r) \right).$$
Traitons la somme intérieure
$$T = T_{\chi_1,\ldots,\chi_r} =  \sum_{\sum_{i=1}^r a_i u_i = b} \chi_1(u_1)\cdots \chi_r(u_r),$$
en distinguant les cas $b = 0, b\ne 0$.

\be
\item[$\bullet$] Si $b = 0$, le changement de variable $t_i = a_i u_i$ donne 
\begin{align*}
T &= \sum_{t_1+\cdots + t_r = 0} \chi_1(a_1^{-1} t_1)\cdots \chi_r(a_r^{-1} t_r)\\
&=\chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J_0(\chi_1,\ldots,\chi_r).
\end{align*}

La proposition~\ref{jac_gen1} donne $J_0(\chi_1,\ldots,\chi_r) = q^{r-1}$ si $\chi_1 = \cdots = \chi_r = \varepsilon$, et  $J_0(\chi_1,\ldots,\chi_r) = 0 $ si l'un des $\chi_i$ est trivial, mais pas tous.
Enfin, si $\chi_1\ldots\chi_r = \varepsilon \ne 0$, alors $J_0(\chi_1,\ldots,\chi_r) = 0 $.

Ainsi
$$N = q^{r-1} + \sum_{(\chi_1,\ldots,\chi_r) \in A} \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J_0(\chi_1,\ldots,\chi_r),$$
où $A$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$ et $\chi_1 \cdots \chi_r = \varepsilon$. 

Posons $M = |A|$. Si $(\chi_1,\ldots,\chi_r) \in A$, la proposition~\ref{jac_gen5} donne $|J_0(\chi_1,\ldots,\chi_r)| = (q-1) q^{\frac{r}{2} - 1}$. Par conséquent,
$$|N - q^{r-1}| \leq M  (q-1) q^{\frac{r}{2} - 1}.$$





\item[$\bullet$] Si $b\ne 0$, le changement de variable $t_i = b^{-1} a_i u_i$ donne
\begin{align*}
T &=  \sum_{t_1+\cdots + t_r = 1} \chi_1( b a_1^{-1} t_1) \cdots  \chi_r( b a_r^{-1} t_r) \\
&=(\chi_1\cdots \chi_r)(b) \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J(\chi_1,\ldots,\chi_r).
\end{align*}
La proposition~\ref{jac_gen1} donne $J(\chi_1,\ldots,\chi_r) = q^{r-1}$ si $\chi_1 = \cdots = \chi_r = \varepsilon$, et  $J(\chi_1,\ldots,\chi_r) = 0 $ si l'un des $\chi_i$ est trivial, mais pas tous.

Ainsi
$$N = q^{r-1} + \sum_{(\chi_1,\ldots,\chi_r) \in B} (\chi_1\cdots \chi_r)(b) \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J(\chi_1,\ldots,\chi_r),
$$
où $B$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$.

Alors, d'après la proposition~\ref{jac_gen5},
$$
|J(\chi_1,\ldots, \chi_r)| = 
\left\{
\begin{array}{ll}
q^{\frac{r}{2} - 1} & \text{si } \chi_1\cdots \chi_r =  \varepsilon,\\
q^{\frac{r-1}{2}} & \text{si } \chi_1\cdots \chi_r \ne \varepsilon.\\
\end{array}
\right.
$$
Alors 
\begin{align*}N = q^{r-1} &+ \sum_{(\chi_1,\ldots,\chi_r) \in C} (\chi_1\cdots \chi_r)(b) \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J(\chi_1,\ldots,\chi_r)\\
&+\sum_{(\chi_1,\ldots,\chi_r) \in D} (\chi_1\cdots \chi_r)(b) \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J(\chi_1,\ldots,\chi_r),
\end{align*}
où 

$C$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$ et $ \chi_1\cdots \chi_r =  \varepsilon$,

$D$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$ et $ \chi_1\cdots \chi_r \ne  \varepsilon$.

Notons $M_0 = |B|, M_1 = |C|$. Alors,
$$|N-q^{r-1}| \leq M_0 \, q^{\frac{r}{2} - 1} + M_1\,  q^{\frac{r-1}{2}} .$$
\ee
Nous avons prouvé la proposition suivante.

\begin{prop}
Soit $N$ le nombre de solutions dans $\F_q^r$ de 
$$a_1x_1^{l_1} + \cdots + a_r x_r^{l_r} = b,$$
où $a_1,\ldots,a_r\in \F_q^*, b \in \F_q, l_i \in \N^*$ (et $l_i \mid q-1,\ i= 1,\ldots,r$).
\be
\item[$\bullet$] Si $b=0$, alors
$$N = q^{r-1} + \sum_{(\chi_1,\ldots,\chi_r) \in A} \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J_0(\chi_1,\ldots,\chi_r),$$
où $A$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$ et $\chi_1 \cdots \chi_r = \varepsilon$. Si $M = |A|$, alors
$$|N - q^{r-1}| \leq M  (q-1) q^{\frac{r}{2} - 1}.$$
\item[$\bullet$] Si $b\ne 0$, alors 
$$N = q^{r-1} + \sum_{(\chi_1,\ldots,\chi_r) \in B} (\chi_1\cdots \chi_r)(b) \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J(\chi_1,\ldots,\chi_r),
$$
où $B$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$.

Si $M_0$ est le nombre des $p$-uplets de $B$, vérifiant de plus $\chi_1\cdots \chi_r = \varepsilon$, et $M_1$ le nombre des $p$-uplets de $B$ vérifiant $\chi_1\cdots \chi_r \ne \varepsilon$, alors
$$|N-q^{r-1}| \leq M_0 \, q^{\frac{r}{2} - 1} + M_1\,  q^{\frac{r-1}{2}} .$$
\ee
\end{prop}

\medskip

Cette proposition prouve en particulier que l'équation $a_1x_1^{l_1} + \cdots + a_r x_r^{l_r} = b$ a des solutions dans $\F_q$ si $q$ est assez grand, et que le nombre de ces solutions tend vers l'infini quand $q$ tend vers l'infini.
