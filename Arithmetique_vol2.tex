%&LaTeX
\documentclass[11pt,a4paper]{book}
\usepackage[frenchb]{babel}
\usepackage[applemac]{inputenc}
\usepackage[OT1]{fontenc}
\usepackage[]{graphicx}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{tikz}
\usepackage{mathrsfs}
%\pagestyle{empty}
\usepackage{appendix}

%\usepackage{hyperref}
%\input{8bitdefs}

% marges
\topmargin 10pt
\headsep 10pt
\headheight 10pt
\marginparwidth 30pt
\oddsidemargin 40pt
\evensidemargin 40pt
\footskip 30pt
\textheight 670pt
\textwidth 420pt

\def\N{\mathbb{N}} %entiers naturels
\def\n{\mbox{\scriptsize I\hspace{-.15em}\scriptsize N}}
\def\Z{\mathbb{Z}} %entiers relatifs
\def\z{\mbox{\scriptsize Z\hspace{-.3em}\scriptsize Z}}
\def\R{\mathbb{R}} %nombres r\'eels
\def\C{\mathbb{C}}%nombres complexes
\def\Q{\mathbb{Q}}%nombres rationnels
\def\F{\mathbb{F}} % corps finis
\def\U{\mathbb{U}}%groupe des unit\'es
\def\imp{\Rightarrow}
\def\gcro{\mbox{[\hspace{-.15em}[}}% intervalles d'entiers 
\def\dcro{\mbox{]\hspace{-.15em}]}}
\def\d{\,\mathrm{d}}
\def\n{\mathrm{N}}%norme
\newcommand{\be} {\begin{enumerate}}
\newcommand{\ee} {\end{enumerate}}
\newcommand{\deb}{\begin{eqnarray*}}
\newcommand{\fin}{\end{eqnarray*}}
\newcommand{\ssi} {si et seulement si }
\newcommand{\D}{\mathrm{d}}
\newcommand{\Gal}{\mathrm{Gal}}
\newcommand{\legendre}[2]{\genfrac{(}{)}{}{}{#1}{#2}}
\renewcommand{\appendixpagename}{Annexes}
\renewcommand{\appendixtocname}{Annexes}

\theoremstyle{plain} \newtheorem{thr}{Th\'eor\`eme}
				 \newtheorem{prop}[thr]{Proposition}
				 \newtheorem{cor}[thr]{corollaire}
\theoremstyle{plain} \newtheorem{dfn}{D\'efinition}

%\includeonly{Groupe_des_classes}

\pagestyle{headings}
\title{ARITHM\'ETIQUE. \\Volume 2.}
\author{Richard Ganaye}





\begin{document}

\maketitle
\tableofcontents

\part{EQUATIONS SUR LES CORPS FINIS.}


\chapter{D\'ecomposition en somme de carr\'es.}

Nous commençons par donner les premiers exemples d'anneaux d'entiers de corps quadratiques, \`a savoir $\Z[i],\Z[i\sqrt{2}]$, et $\Z[\omega]$ (o\`u $\omega = e^{\frac{2i\pi}{3}}$). Nous \'etudierons dans les chapitres suivants des anneaux d'entiers plus g\'en\'eraux.

Ce traitement \`a part est dû au fait que ces anneaux sont euclidiens pour la norme usuelle des nombres complexes, et donc principaux et factoriels. Ils permettront de donner les premiers r\'esultats sur la d\'ecomposition des nombres premiers sous la forme $x^2 +y^2, x^2 + 2 y^2$ ou $x^2 + 3 y^2$. Les  anneaux $\Z[i], \Z[\omega]$ seront indispensables \`a la th\'eorie de la r\'eciprocit\'e cubique, et biquadratique. 

\section{Les anneaux $\Z[i], \Z[i\sqrt{2}]$.}\label{section_gauss}
$\Z[i]$ est l'ensemble des nombres complexes de la forme $a +b i$, o\`u $a,b$ sont des entiers de $\Z$ :

$$\Z[i] = \{z \in \C\, | \, \exists a \in \Z, \exists b \in \Z, z = a + bi\}.$$

Les \'el\'ements de $\Z[i]$ s'appellent les entiers de Gauss.

$\Z[i]$ est bien un anneau (commutatif unitaire), un sous-anneau de $(\C,+,\times)$. En effet, $1 = 1 + 0 i \in \Z[i]$, et si $z,z'$ sont dans $\Z[i]$, alors $z =a +b i, z' =a' +b'i$, donc $z-z' =(a-a') +(b -b')i \in \Z[i]$, et $zz' = (a +bi)(a' +b'i) =(aa' -bb') + (ab' +ba')i \in \Z[i]$.

$\Z[i]$ est le plus petit sous-anneau de $\C$ contenant $\Z$ et $i$.

De la m\^eme façon, 

$$\Z[i\sqrt{2}] = \{z \in \C\, | \, \exists a \in \Z, \exists b \in \Z, z = a + bi\sqrt{2}\}$$
est le plus petit sous-anneau de $\C$ contenant $\Z$ et la racine $i\sqrt{2}$ de $-2$.

Comme $\Z[i] = \Z[-i]$, et $\Z[i\sqrt{2}] = \Z[-i\sqrt{2}]$, on peut d\'esigner sans ambiguït\'e ces deux anneaux par $\Z[\sqrt{-1}], \Z[\sqrt{-2}]$, le choix de la racine de $-1$ ou de $-2$ n'ayant pas d'importance.

Montrons que ces deux anneaux sont euclidiens, pour la norme usuelle $\mathrm{N}(\cdot)$ des nombres complexes, d\'efinie pour tout $z \in \C$ par $\mathrm{N}(z) = |z|^2$.

\begin{prop}
\begin{enumerate}
\item[(i)] Si $z \in \C$, il existe $z_0 \in \Z[i]$ tel que $\mathrm{N}(z - z_0) < 1$.
\item[(ii)] Si $z \in \C$, il existe $z_1 \in \Z[i\sqrt{2}]$ tel que $\mathrm{N}(z - z_1) < 1$.
\end{enumerate}
\end{prop}
\begin{proof}
\be
\item[(i)]
Soit $z = a + bi \in \C$. Il existe des entiers $a_0, b_0 \in \Z$ tels que 
$$|a-a_0| < \frac{1}{2}, \quad |b-b_0|<\frac{1}{2}.$$
($a_0 = \lfloor a \rfloor$ convient si $\lfloor a \rfloor \leq a < \lfloor a \rfloor+ 1/2$, et $a_0 = \lfloor a \rfloor+ 1 = \lceil a \rceil$ convient si $\lfloor a \rfloor + 1/2 \leq a < \lfloor a \rfloor+ 1$. Idem pour $b_0$).
 Posons $z_0 = a_0 + b_0 i$. Alors $\mathrm{N}(z-z_0) = (a-a_0)^2 + (b-b_0)^2 < \frac{1}{4}+ \frac{1}{4} = \frac{1}{2} < 1$.
\item[(ii)] Tout \'el\'ement $z\in \C$ peut s'\'ecrire sous la forme $z = a + b i\sqrt{2},\ a, b \in \R$. Soient $a_0,b_0 \in \Z$ v\'erifiant $|a-a_0| < \frac{1}{2}, \quad |b-b_0|<\frac{1}{2}$. Posons $z_1 = a_0 + b_0 i \sqrt{2}$. Alors $\mathrm{N}(z-z_1) = (a-a_0)^2 + 2(b-b_0)^2 < \frac{1}{4}+ 2\times \frac{1}{4} = \frac{3}{4} < 1$.
\ee
\end{proof}

\begin{prop} \label{prop2}
$\Z[i]$ et $\Z[i\sqrt{2}]$ sont des anneaux euclidiens, pour la norme $\mathrm{N}(\cdot)$ de $\C$.
\end{prop}
\begin{proof}
Donnons une d\'emonstration commune pour $A = \Z[i]$, ou $A = \Z[i\sqrt{2}]$.

Si $a,b\in A$, et $b \ne 0$, il existe d'apr\`es la proposition pr\'ec\'edente $q \in A$ tel que $\left | \frac{a}{b} -q \right| < 1$. Posons alors $r = a - b q = b\left( \frac{a}{b} -q\right)$. Alors $r \in A$, et
$$a = bq +r, \quad 0\leq \mathrm{N}(r )< \mathrm{N}(b ).$$
Il existe donc une division euclidienne dans $A$.
\end{proof}

En conclusion, d'apr\`es le chapitre ``Anneaux'', ces anneaux sont principaux et factoriels.

Avant d' expliciter la d\'ecomposition en facteurs premiers, pr\'ecisons les unit\'es de ces anneaux. Notons $A^{\times}$ l'ensemble des unit\'es de $A$, o\`u $A$ est un sous-anneaux de $\C$. Alors
\begin{prop}\label{prop3}
Soit $A =\Z[i]$ (ou $A = \Z[i\sqrt{2}]$), et $A^{\times}$ l'ensemble des unit\'es de $A$. Si $z \in A$,

 $$z \in A^{\times} \iff \mathrm{N}(z) = 1.$$
\end{prop}
\begin{proof}
Si $z\in A^\times$, alors il existe $z' \in A$ tel que $zz' = 1$, Donc $\mathrm{N}(z) \mathrm{N}(z') = 1$, o\`u $\mathrm{N}(z), \mathrm{N}(z')$ sont des entiers naturels de $\N$. Donc $\mathrm{N}(z) = 1$.

R\'eciproquement, supposons $\mathrm{N}(z) = 1$, alors $z \overline{z} = 1$.

Si $A = \Z[i]$, alors $z = a+ib,\ a, b \in \Z$, donc $\overline{z} = a -i b \in A$.

Si $A = \Z[i\sqrt{2}]$, alors $z = a+ib\sqrt{2},\ a, b \in \Z$, donc $\overline{z} = a -i b\sqrt{2} \in A$.

Dans les deux cas, $z' = \overline{z} \in A$ v\'erifie $zz' = 1$, donc $z \in A^{\times}$.
\end{proof}
\begin{prop}
\be
\item[(i)] Les unit\'es de $\Z[i]$ sont $1,i,i^2 = -1,i^3 = -i$.
$$\Z[i]^{\times} = \{1,i,i^2,i^2\} = \mathbb{U}_4.$$
\item[(i)] Les unit\'es de $\Z[i\sqrt{2}]$ sont $1$ et $-1$.
$$\Z[i\sqrt{2}]^{\times} = \{1,-1\} = \mathbb{U}_2.$$
\ee
\end{prop}
\begin{proof}
\be
\item[(i)] Soit $z = a + b i \in \Z[i]$. Alors $z =a +i b \in \Z[i]^{\times}$ si et seulement si $a^2 + b^2 =1$. Comme $|a| \leq 1, |b| \leq 1$, l'ensemble des solutions de cette \'equation dans $\Z$ est $\{(1,0),(0,1),(-1,0),(0,-1)\}$, ce qui donne les solutions complexes $1,i,-1,-i$ de $\mathrm{N}(z) = 1$.
\item[(ii)] Soit $z = a + b i \in \Z[i\sqrt{2}]$. Alors $z =a +i b\sqrt{2} \in \Z[i\sqrt{2}]^{\times}$ si et seulement si $a^2 + 2 b^2 =1$. Alors $|b| \leq 1/2$, donc $b = 0$, et les seules solutions sont $(1,0),(-1,0)$.
\ee

\end{proof}

\section{Somme de deux carr\'es : une premi\`ere preuve.}\label{section1_2}

Avant de donner la liste des \'el\'ements premiers dans $\Z[i]$, on peut utiliser le fait que $\Z[i]$ est principal dans une d\'emonstration courte du th\'eor\`eme des deux carr\'es.
\begin{prop}\label{prop5}
 Soit $p$ un nombre premier congru \`a $1$ modulo $4$. Alors il existe un entier $a \in \Z$ tels que $p$ divise $a^2 + 1$.
 \end{prop}
 
 \begin{proof}
 Notons $\F_p$ le corps $\Z/p\Z$ \`a $p$ \'el\'ements. Pour tout $\alpha \in\F_p^*,$
  $$ 0 = \alpha^{p-1} - 1 =  (\alpha^{\frac{p-1}{2}}- 1)(\alpha^{\frac{p-1}{2}}+1).$$
  Comme le polynôme $x^{\frac{p-1}{2}}- 1 \in \F_p[x]$ admet au plus $\frac{p-1}{2}$ racines dans $\F_p^*$, et que le cardinal de $\F_p^*$ est $p-1$, il existe au moins un $\beta \in \F_p$ tel  que $\beta^{\frac{p-1}{2}}+1 = 0$, soit $ \left(\beta^{\frac{p-1}{4}}\right)^2+1 = 0$, o\`u l'exposant $(p-1)/4$ est entier, puisque $p\equiv 1 \pmod 4$.
  
  Posons  $\gamma = \beta^{\frac{p-1}{4}}$. Alors $\gamma^2 + 1 = 0$.
  
  Si $a \in \mathbb{Z}$ est un repr\'esentant de $\gamma \in \F_p$, alors $p$ divise $a^2+1.$ 
 \end{proof}
 
 Donnons maintenant le th\'eor\`eme des deux carr\'es.
 
 \begin{prop}\label{prop6}
 Soit $p$ un nombre premier impair. Alors $p\equiv1 \pmod 4$ si et seulement s'il existe  un couple d'entiers $(x,y)$ tel que $p = x^2+y^2$. 
 \end{prop}

  \begin{proof}
  Soit $p$ un nombre premier impair.
  
  ($\Leftarrow$)
  Si $p=x^2+y^2$, alors $x^2 \equiv 0,1\pmod 4, y^2 \equiv 0,1\pmod 4$, donc $x^2+y^2 \equiv 0,1,2\pmod 4$. Comme $p$ est impair, $p\equiv 1 \pmod 4$.
 
   ($\Rightarrow$)  
   Soit $a$ un entier, dont l'existence est prouv\'ee dans la proposition pr\'ec\'edente, tel que $p \mid a^2 +1$.
   
   Soit $I$ l'id\'eal de $\Z[i]$ d\'efini par
   $$I = p \Z[i] + (a+i) \Z[i] = \langle p, a+i \rangle.$$
   Montrons que $I \ne \Z[i]$, en prouvant que l'hypoth\`ese $I = \Z[i]$ est absurde.
   
   Soit $\lambda$ un diviseur premier de $p$ dans $\Z[i]$ : un tel diviseur existe puisque $\Z[i]$ est principal.
   
   Alors $\lambda \mid p$, et $p \mid a^2 + 1 = (a+i)(a-i)$, donc $\lambda \mid (a+i)(a-i)$. L'entier de Gauss $\lambda$ \'etant premier, il divise soit $a+i$, soit $a-i$.
   
   Dans la premier cas, $\lambda$ divise $p$ et $a+i$. Dans le deuxi\`eme cas, $\lambda \mid a-i$, alors $a-i = \lambda \mu$, donc $a+i = \overline{\lambda} \overline{\mu}$, o\`u $\overline{\mu} \in \Z[i]$, donc $\overline{\lambda} \mid a+i$. De plus $\overline{\lambda} \mid p$ : en effet $p = \lambda \nu$ pour un certain $\nu \in \Z[i]$, donc $p =\overline{\lambda} \overline{\nu}$. Notons que $\mathrm{N}(\lambda) = \mathrm{N}(\overline{\lambda})>1$.   
   
 Dans les deux cas, il existe $\xi \in \Z[i]$ (o\`u $\xi = \lambda$ ou $\xi = \overline{\lambda}$) tel que $\xi \mid p, \xi \mid a+i$, et $\mathrm{N}(\xi) > 1$.
 
 Sous l'hypoth\`ese $I = \Z[i]$, alors $1 = p \zeta + (a+i) \eta$, o\`u $\zeta, \eta$ sont des entiers de Gauss. Alors $\xi \mid 1$, en contradiction avec $\mathrm{N}(\xi) >1$, ce qui prouve que $I \ne \Z[i]$.
 
 Comme $\Z[i]$ est principal, il existe $\pi \in \Z[i]$ tel que
 $$ p \Z[i] + (a+i) \Z[i] = \pi \Z[i].$$
 De plus $\pi$ n'est pas une unit\'e, sinon $\pi \Z[i] = \Z[i]$. Par cons\'equent $\mathrm{N}(\pi) > 1$. Nous venons de prouver l'existence d'un pgcd non trivial $\pi$ de $p$ et $a+i$.
 
 Comme $p  = p\times 1 + (a+i)\times 0 \in  p \Z[i] + (a+i) \Z[i] = \pi \Z[i]$, il existe $\gamma \in \Z[i]$ tel que $p = \pi \gamma$, et donc $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$.
 
 Si $\mathrm{N}(\gamma) = 1$, alors $\gamma$ est une unit\'e, donc $p$ et $\pi$ sont associ\'es, et $\pi$ divise $a+i$, donc $p$ divise $a+i$, ce qui est absurde puisque $\frac{a}{p} + \frac{1}{p} i \not \in \Z[i]$. Ainsi $\mathrm{N}(\gamma) > 1$. 
 
 L'\'egalit\'e $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$, o\`u $\mathrm{N}(\pi) > 1, \mathrm{N}(\gamma)>1$, montre que
 $$ p = \mathrm{N}(\pi).$$
 Si $\pi = x + iy,\ x,y \in \Z$, alors $p=x^2 +y^2$, ce qui prouve le th\'eor\`eme.
 \end{proof}
 

La d\'emonstration d'existence fournit un premier algorithme efficace pour d\'ecomposer un nombre premier $p$ en somme de deux carr\'es.
 
 \be
\item[$\bullet$] Premi\`ere \'etape : trouver un entier $a$ tel que $p \mid a^2 +1$.

La d\'emonstration de la proposition \ref{prop5} montre que la moiti\'e (\`a savoir $\frac{p-1}{2}$) des \'el\'ements $\alpha$ de $\F_p^*$ v\'erifie $\alpha^{\frac{p-1}{2}} = 1$, l'autre moiti\'e v\'erifie $\alpha^{\frac{p-1}{2}}= -1$. 

Il suffit donc de tirer au sort un \'el\'ement $a, \ 1 \leq a < p$, et de calculer le moindre reste de $a^{\frac{p-1}{2}}$ modulo $p$ par une exponentiation rapide modulaire.
Si le r\'esultat est $-1$, $a$ convient, sinon on recommence le tirage jusqu'\`a obtenir $-1$. Le temps d'attente d'un r\'esultat suis une loi g\'eom\'etrique de param\`etre $1/2$. Ce temps d'attente a donc une esp\'erance de deux tirages.

Evidemment on ne peut garantir que cet algorithme probabiliste donne un r\'esultat rapide, mais la probabilit\'e que ce soit le cas est forte. On ne connait pas d'algorithme d\'eterministe plus efficace.

\item[$\bullet$]  Trouver un pgcd de $p$ et $a+i$.

L'anneau $\Z[i]$ \'etant euclidien, l'algorithme d'Euclide s'applique pour obtenir un tel pgcd : on d\'efinit les suites finies $(r_n)$ d'entiers de Gauss par des divisions euclidiennes successives dans $\Z[i]$, tant que le reste $r_n$ est non nul
\begin{align*}
&r_0 = p, \quad r_1 = a+i,\\
&r_n = r_{n+1} q_{n+1} + r_{n+2},\ \mathrm{N}(r_{n+2}) < \mathrm{N}(r_{n+1})\qquad (0 \leq n \leq l)\\
&r_{l+2} = 0
 \end{align*}
 $r_{l+1} = x + iy$ donne alors un pgcd de $p$ et $a+i$, et $p = x^2 + y^2$.
  \ee
 Le programme correspondant est donn\'e dans l'appendice.
 
 
 
 \section{Elements premiers dans $\Z[i]$.}

\begin{prop}\label{prop7}
Soit $\pi \in \Z[i]$.
Si $\mathrm{N}(\pi)$ est premier dans $\Z$, alors $\pi$ est premier dans $\Z[i]$.
\end{prop}
\begin{proof}
Supposons que $\pi = \alpha \beta$, o\`u $\alpha, \beta$ sont dans $\Z[i]$. Par hypoth\`ese, $p = \mathrm{N}(\pi) = \mathrm{N}(\alpha) \mathrm{N}(\beta)$ est premier dans $\Z$, $p>0$, donc $\mathrm{N}(\alpha) =1$ ou $\mathrm{N}(\beta) = 1$. D'apr\`es la proposition 3, $\alpha$ ou $\beta$ est une unit\'e, ce qui prouve que $\pi$ est irr\'eductible, donc premier dans $\Z[i]$, puisque $\Z[i]$ est principal.
\end{proof}

Par exemple $\mathrm{N}(2 + 3i) = 13$, donc $2+3i$ est premier. Nous allons voir que la r\'eciproque de cette proposition est fausse.

\begin{prop}\label{prop8}
Soit $\pi$ un \'el\'ement premier dans $\Z[i]$. Alors il existe un unique entier rationnel premier $p \in \N$ tel que $\pi \mid p$.
\end{prop}
\begin{proof}
Le premier $\pi$ divise l'entier naturel $n = \mathrm{N}(\pi) = \pi \overline{\pi}$. Alors $n>1$, sinon $\pi$ serait une unit\'e. L'entier rationnel $n$ se d\'ecompose en facteurs premiers dans $\N$ sous la forme $n =p_1^{a_1}\cdots p_l^{a_l}$. Comme $\pi$ est premier, $\pi$ divise l'un des $p_i$. Si $p$ d\'esigne un tel $p_i$, $\pi \mid p$, et $p \in \N$ est un entier rationnel premier.

Supposons que $\pi \mid p, \pi \mid q$, o\`u $p,q$ sont des nombres premiers rationnels distincts. Alors $p,q$ sont premiers entre eux, donc il existe des entiers $u,v$ dans $\Z$ tels que $up +vq = 1$. Mais alors $\pi \mid up+vq = 1$, et $\pi$ est une unit\'e : c'est une contradiction, qui prouve l'unit\'e de l'entier $p$ de l'\'enonc\'e.
\end{proof}

Cette proposition montre que pour lister tous les \'el\'ements premiers de $\Z[i]$, il suffit de factoriser tous les nombres premiers rationnels. Un tel premier rationnel admet toujours au moins un diviseur premier $\pi \in \Z[i]$.

Donnons d'abord une liste d'\'el\'ements premiers :

\be
\item[$\bullet$] $\mathrm{N}(1+i) = 2$ est premier dans $\Z$, donc $1+i$ est premier, ainsi que ses associ\'es $-1+i, -1-i, 1-i$.

\item[$\bullet$] Soit $q \equiv 3 \pmod 4$ un nombre premier dans $\Z$, $q>0$. Montrons que $q$ est irr\'eductible dans $\Z[i]$. Dans le cas contraire, $q = \alpha \beta$, o\`u $\alpha, \beta$ sont des entiers de Gauss v\'erifiant $\mathrm{N}(\alpha)>1, \mathrm{N}(\beta)>1$. Alors $q^2 = \mathrm{N}(\alpha) \mathrm{N}(\beta)$, donc $q = \mathrm{N}(\alpha)$ (nous utilisons ici l'hypoth\`ese $q>0$). Si $\alpha = a+bi$, alors $q = a^2 + b^2$, mais $a^2 +b^2 \equiv 3 \pmod 4$ est impossible, ce qui montre que $q$ est irr\'eductible dans $\Z[i]$. Comme $\Z[i]$ est principal, $q$ est premier dans $\Z[i]$, ainsi que ses associ\'es $iq, i^2q,i^3q$.

Notons que si $\pi \sim q$, o\`u $q>0, q\equiv 3 \pmod 4$, alors $\pi$ est premier dans $\Z[i]$, mais $\n(\pi) =q^2$ n'est pas premier dans $\Z$. La r\'eciproque de la proposition \ref{norme_p} est fausse.

\item[$\bullet$] Soit $p$ un nombre premier tel que $p = \mathrm{N}(\pi),\, \pi =a + bi \in \Z[i]$ (donc $p = a^2 + b^2 \equiv 1 \pmod 4)$. Alors $\pi$ est premier dans $\Z[i]$ puisque $\mathrm{N}(\pi)$ est premier dans $\Z$.
\ee

Ces \'el\'ements seront d\'esign\'es comme les \'el\'ements premiers connus dans $\Z[i]$. Montrons qu'il n'existe pas d'autres \'el\'ements premiers.

\begin{prop}\label{prop9}
Les \'el\'ements premiers dans $\Z[i]$ sont
\be
\item[(i)] 1 + i et ses associ\'es,
\item[(ii)] les entiers rationnels $q \equiv 3 \pmod 4$, $q>0$ , premiers dans $\Z$, ainsi que leurs associ\'es,
\item[(iii)] les \'el\'ements $\pi = a +ib$ tels que $p = \pi \overline \pi = a^2 +b^2$ soit premier dans $\Z$.
\ee
\end{prop}
\begin{proof}
Soit $\pi  = a + bi$ un \'el\'ement premier dans $\Z[i]$. La proposition \ref{prop8} montre qu'il existe un nombre premier $p \in \N$ tel que $\pi \mid p$. 

Discutons les trois seuls cas possibles, $p=2, p \equiv 3 \pmod 4$, et $p\equiv 1 \pmod 4$.
\be
\item[(i)] Supposons  que $\pi \mid 2$. Comme  $2 = (1+i)(1-i) =-i(1+i)^2$, o\`u $1+i$ est premier, et $-i$ est une unit\'e, alors $\pi \mid 1+i$. Comme $1+i$ est premier, $\pi$ est associ\'e \`a $1+i$.

\item[(ii)] Supposons que $\pi \mid p$, o\`u $p \equiv 3 \pmod 4$. Puisque $p$ est un \'el\'ement premier connu de $\Z[i]$, $\pi$ est associ\'e \`a $p$.
\item[(iii)] Supposons que $\pi \mid p$, o\`u $p \equiv 1 \pmod 4$. Alors $ p = \pi \lambda$ pour un certain $\lambda \in \Z[i]$.

 Montrons par l'absurde que $p$ n'est pas premier dans $\Z[i]$.

D'apr\`es la proposition \ref{prop5}, il existe $a \in \Z$ tel que $p \mid a^2 +1$, donc $p \mid (a+i)(a - i)$, et $p$ \'etant premier dans $\Z[i]$, $p \mid a +i$, ou $p \mid a-i$. Ceci est absurde puisque $\frac{a}{p} \pm \frac{1}{p} i \not \in \Z[i]$. 

Alors $\lambda$ n'est pas une unit\'e, sinon $p$ serait associ\'e \`a $\pi$ et serait donc premier. Ainsi $p = \pi \lambda$, o\`u $\mathrm{N}(\pi)>1, \mathrm{N}(\lambda)>1$. L'\'egalit\'e $p^2 = \n(\pi) \n(\lambda)$ montre que $p = \mathrm{N}(\pi) = \pi \overline \pi = a^2 +b^2$.

 
\ee 
\end{proof}

Incidemment, nous obtenons une deuxi\`eme preuve du th\'eor\`eme des deux carr\'es :

{\it
Soit $p \in \N$ un entier premier tel que $p \equiv 1 \pmod 4$, alors $p =a^2 + b^2$ est somme de deux carr\'es d'entiers.
}
\begin{proof}
Reprenons l'argument de la partie (iii) de la d\'emonstration pr\'ec\'edente :
Si $p \equiv 1 \pmod 4$, alors (proposition 5) il existe un entier $a$ tel que $p \mid a^2 +1 = (a + i)(a - i)$, mais $p \nmid a +i, p\nmid a-i$, donc $p$ n'est pas premier, a fortiori il n'est pas irr\'eductible, donc
$$p = \alpha \beta, \text{ o\`u }\mathrm{N}(\alpha)>1, \mathrm{N}(\beta) >1.$$
Alors $p^2 = \mathrm{N}(\alpha) \mathrm{N}(\beta)$, donc $p = \mathrm{N}(\alpha)$. Si $\alpha = a + bi$, alors $p = a^2 +b^2$.
\end{proof}
Cette d\'emonstration ne donne pas explicitement un algorithme pour obtenir la d\'ecomposition $p = a^2 + b^2$. Un tel algorithme est donn\'e dans la section pr\'ec\'edente. Nous expliciterons d'autres algorithmes dans le paragraphe suivant.


 Prouvons maintenant l'unicit\'e de la d\'ecomposition en somme de deux carr\'es.
 \begin{prop}\label{prop10}
 Si $p \equiv 1 \pmod 4$, il existe exactement un couple d'entiers $(a, b)$ tel que $p = a^2 +b^2$, o\`u $0<a<b$.
 \end{prop}
 
 \begin{proof}
La proposition \ref{prop6} prouve l'existence d'entiers $x,y$ tels que $p = x^2 + y^2$. Posons $a = \min(|x|, |y|), b = \max(|x|, |y|)$. Alors $p = a^2 +b^2$, o\`u $0 \leq a \leq b$. De plus $a = 0$ est impossible : un nombre premier ne peut \^etre le carr\'e de $b$, et $a = b$ est impossible, sinon $p = 2b^2$, o\`u $b >  1,$ n'est pas premier. Donc $p =a^2 +b^2, \ 0<a<b$.


Supposons que $p = a^2 + b^2 = c^2 +d^2$, o\`u $0<a<b$ et $0<c<d$. Posons $\pi = a+bi, \lambda =c +di$. La proposition 7 montre que $\pi, \overline{\pi}, \lambda, \overline{\lambda}$ sont premiers dans $\Z[i]$, et 
$$p = \pi \overline{\pi} = \lambda\overline{\lambda}.$$
Comme le premier $\pi$ divise $\lambda\overline{\lambda}$, $\pi$ divise $\lambda$ ou $\pi \mid \overline{\lambda}$. Ces \'el\'ements \'etant tous premiers, $\pi$ est associ\'e \`a $\lambda$ ou $\overline{\lambda}$, soit
$$a+ib  \in \{c+id, i(c+id), - (c+id), -i (c+id), c-id,i(c-id)-(c-id),-i(c-id)\}.$$
Par cons\'equent $a =\pm c, b = \pm d$, ou $a = \pm d, b = \pm c$. Comme $a,b,c,d$ sont positifs $(a,b) = (c,d)$ ou $(a,b) = (d,c)$. Mais $a<b$ et $c<d$, donc $(a,b) = (c,d)$.
 \end{proof}
 Remarque : si on oublie la condition $0<x<y$, l'\'equation $p = x^2 +y^2$ admet 8 solutions : $(a,b), (-a,b), (a,-b), (-a,-b), (b,a),(-b,a),(a,-b),(-a,-b)$.

\bigskip 

Nous pouvons pr\'eciser les \'el\'ements premiers du type (iii) dans la proposition 9 :
\begin{prop}\label{prop11}
Soit $p \equiv 1 \pmod 4$ un premier rationnel positif. Il existe 8 diviseurs premiers de $p$ dans $\Z[i]$,  constituant deux classes d'association distinctes.
\end{prop}
\begin{proof}
Comme $p \equiv 1 \pmod 4$, le th\'eor\`eme des deux carr\'es montre que $p =a^2 + b^2 = \n(\pi) = \pi \overline{\pi}$, o\`u $\pi =a + bi \in \Z[i]$. Les quatre associ\'es de $\pi$ et les quatre associ\'es de $\overline{\pi}$ sont des diviseurs de $p$. Montrons que $\pi$ et $\overline{\pi}$ ne sont pas associ\'es. 
Comme
$$\frac{\pi}{\overline{\pi}} = \frac{a+bi}{a-bi} = \frac{(a+bi)^2}{a^2+b^2} = \frac{a^2 - b^2}{a^2+b^2} + i \frac{2ab}{a^2+b^2},$$
$\frac{\pi}{\overline{\pi}} \in \{1,-1,i,-i\}$ entra\^ine $a^2 -b^2 = 0$ ou $2ab = 0$, donc $a = b$ ou $a = -b$ ou $a = 0$ ou $b= 0$. Aucune de ces \'eventualit\'es n'est compatible avec l'\'egalit\'e $p= a^2+b^2$, o\`u $p$ est premier impair. Ainsi $\pi$ et $\overline{\pi}$ ne sont pas associ\'es.

De plus, tout diviseur premier $\lambda \in \Z[i]$ de $p$ v\'erifie $\lambda \mid \pi \overline{\pi}$, donc $\lambda \mid \pi$ ou $\lambda \mid \overline{\pi}$, et alors $\lambda\sim \pi$ ou $\lambda \sim \overline{\pi}$, et ainsi $\lambda$ est dans l'une des deux classes d'association de $\pi$ ou $\overline{\pi}$.
\end{proof}




\section{Sommes de deux carr\'es : la m\'ethode d'Euler.}\label{section1_4}
 Nous allons prouver que tout nombre premier de la forme $4k+1$ est somme de deux carr\'es d'entiers, en suivant les \'etapes de la premi\`ere d\'emonstration donn\'ee par Euler, mais en utilisant le langage des entiers de Gauss, ce qui permet de mieux comprendre les id\'ees de cette preuve.
 
 La d\'emonstration se fait traditionnellement, depuis Euler, en deux \'etapes, nomm\'ees r\'eciprocit\'e et descente. La proposition \ref{prop5} montre que $p \mid a^2 +1$ pour un certain entier $a \in \Z$. L'\'etape ``r\'eciprocit\'e'' est le fait que $p$ divise une somme de deux carr\'es $x^2 + y^2$, o\`u $x,y$ sont premiers entre eux : il suffit de poser $x = a, y = 1$.
  
Poursuivons maintenant avec l'\'etape ``descente'', en commençant par le lemme suivant, dû \`a Euler.

\begin{prop}
Soit $n$ un entier positif, et $q$ un diviseur premier de $n$.

Si $q,n$ se d\'ecomposent en somme de deux carr\'es, i.e. $n = a^2 + b^2, q = c^2 +d^2$, alors $n/q$ est somme de deux carr\'es.
\end{prop}

\begin{proof}
$$ \frac{n}{q} = \frac{\mathrm{N}(a+bi)}{\mathrm{N}(c+di)} = \mathrm{N}\left (\frac{a+bi}{c+di}\right ) = \mathrm{N}\left (\frac{(a+bi)(c-di)}{c^2+d^2}\right ) = \mathrm{N}\left (\frac{ac+bd}{q} + i \frac{bc-ad}{q} \right),$$
 donc
 \begin{align}\label{dec1}
 \frac{n}{q} = \left (\frac{ac+bd}{q}\right )^2 + \left (\frac{bc-ad}{q}\right )^2.
 \end{align}
 
 Rien ne permet d'affirmer que $\frac{ac+bd}{q} , \frac{bc-ad}{q}$ sont des entiers, mais comme $q=\mathrm{N}(c+di) = \mathrm{N}(c-di)$, nous pouvons remplacer $d$ par $-d$, et nous obtenons aussi bien
 
 \begin{align}\label{dec2}
 \frac{n}{q}  = \left (\frac{ac-bd}{q}\right )^2 + \left (\frac{bc+ad}{q}\right )^2.
  \end{align}
  
  Montrons qu'une des deux formules (\ref{dec1}) ou (\ref{dec2}) donne une d\'ecomposition de $n/q$ en somme de carr\'es d'entiers.
  
  Notons $z = a +bi$, et $\pi = c +di$. D'apr\`es la proposition 7, $\pi$ est premier dans $\Z[i]$. De plus $\pi \mid \n(\pi) = q$, et $q \mid n = \mathrm{N}(z) = z \overline{z}$. L'anneau $\Z[i]$ \'etant principal, ceci entra\^ine que $\pi \mid z$, ou $\pi \mid \overline{z}$.
  
  Si $\pi \mid z$, alors $q = \pi \overline{\pi} \mid z \overline{\pi} =  (ac +bd) + i (bc -ad)$, donc  $\frac{ac +bd}{q} + i \frac{bc -ad}{q} \in \Z[i]$, ce qui montre que $q \mid ac + bd$, et $q \mid bc -ad$ : la formule (\ref{dec1}) donne la d\'ecomposition de $n/q$ en somme de deux carr\'es d'entiers.
  
 Si $\pi \mid \overline{z}$, alors $q = \pi \overline{\pi} \mid \overline{z} \overline{\pi} =  (ac -bd) - i (bc +ad)$, donc   $q \mid ac - bd$, et $q \mid bc +ad$ : la formule (\ref{dec2}) donne la d\'ecomposition de $n/q$ en somme de deux carr\'es d'entiers.

\end{proof}

Ceci donne la preuve originale du th\'eor\`eme des deux carr\'es :

{\it
 soit $p$ un nombre premier impair. Si $p\equiv1 \pmod 4$, alors il existe  un couple $(x,y)\in \N^2$ tel que $p = x^2+y^2$. 
}

  
  \begin{proof}
  
 
  Soit $p$ premier, $p\equiv 1\pmod 4$. Supposons que tout nombre premier inf\'erieur \`a $p$ et congru \`a 1 modulo 4 soit somme de deux carr\'es d'entiers. Montrons qu'il en va de m\^eme pour $p$.
  
  
  Nous savons que $p$ divise $a^2+1$  pour un certain $a \in \Z$ (proposition 5). Si $A$ est le moindre reste de $a$ modulo $p$, alors $p \mid A^2 + 1$ et $-p/2<A<p/2$ .
   
  Alors $A^2+1 = p K, K \in \mathbb{N}^*$ et $A^2+1<\frac{p^2}{4}+1$, donc $K<\frac{p}{4} + \frac{1}{p} < \frac{p}{4}+1<p$.
  
  Si $K= 1$, $p = A^2+1$ est somme de deux carr\'es. Sinon $K$ se d\'ecompose en facteurs premiers sous la forme $K = q_1 q_2\cdots q_l$ (avec d'\'eventuelles r\'ep\'etitions).
  
  $$A^2+1=p\,q_1q_2\cdots q_l.$$
  
  
  Ici $q_i$ divise $A^2+1$, soit $-1 \equiv A^2 \pmod {q_i}$ donc $\legendre{-1}{q_i} = 1$, donc $q_i = 2$ ou $q_i \equiv 1 \pmod 4$, et $q_i\leq K <p$. On peut donc appliquer l'hypoth\`ese de r\'ecurrence \`a chaque $q_i$ : 
  $q_i = a_i^2+b_i^2$ (et aussi $2 = 1^2+1^2)$. 
 
 Nous allons diviser cette \'egalit\'e successivement par chacun des $q_i$.
  
 Faisons l'hypoth\`ese suivante (pour $1\leq m\leq l$)  : supposons qu'il existe un couple $(a,b)\in\mathbb{Z}^2$ tels que  
 
 $$a^2+b^2 = p\,q_1q_2\cdots q_m,$$
 o\`u on rappelle que $q_i <p, i=1,\cdots,m$, et que chaque $q_i$ est somme de carr\'es d'entiers.
 
 Au d\'epart $l=m, a=A, b=1$ et l'hypoth\`ese est v\'erifi\'ee au rang $l$.
  
  
 Il existe deux entiers $c,d$ tels que $q_m = c^2+d^2$.
  
  Si $n=a^2+b^2$, alors $q_m\mid n$ : le lemme pr\'ec\'edent (proposition 11) montre que $\frac{n}{q_m}$ est somme de deux carr\'es d'entiers, ce qui signifie qu'il existe des entiers $u,v$ tels que
  
  $$u^2+v^2 = p \,q_1 q_2\cdots q_{m-1} .$$
  On prouve ainsi successivement que les nombres $p\,q_1 q_2\cdots q_{m}, m=l,l-1,\cdots,1$ sont sommes de deux carr\'es. La derni\`ere \'etape montre que $p = x^2+y^2$.
  
  \end{proof}
  
 {\bf Exemple} : d\'ecomposons le premier $p = 11213$ en somme de deux carr\'es.
  
  Comme la moiti\'e des \'el\'ements de $(\mathbb{Z}/11213 \mathbb{Z})^*$ v\'erifie $ x^{\frac{p-1}{2}}+1 = 0$, on trouve rapidement, \`a l'aide de l'exponentiation rapide, que $\dot{2}^{\frac{p-1}{2}}+1 = 0$, et $\dot{2}^{\frac{p-1}{4}}= 1505$, donc $p  = 11213 \mid  1505^2+1 = n$.
  
  $n = 2265026 = 202 \times 11213 = 2 \times 101 \times 11213$,
  
  et $2 = 1^2+1^2, 101 = 10^2 + 1^2$.
  
  $$2 \times 11213 = \frac{n}{101} = \mathrm{N}\left(\frac{1505+i}{10+i}\right) = \mathrm{N}\left(\frac{15051}{101} + i \frac{1495}{101}\right),$$
  
  et aussi
  
    $$2 \times 11213 = \frac{n}{101} = \mathrm{N}\left(\frac{1505+i}{10-i}\right) = \mathrm{N}\left (\frac{15049}{101} + i \frac{1515}{101}\right).$$
    
    Seule la deuxi\`eme d\'ecomposition donne des entiers
    
    $$2 \times 11213 = \mathrm{N}(149 + 15 i) = 149^2 + 15^2,$$
    
    et enfin
    
    $$11213 = \mathrm{N}\left (\frac{149+15i}{1+i} \right) = \mathrm{N}(82 + 67i),$$
  
  $$11213 = 82^2 + 67^2.$$
  
  Remarque : cette d\'emonstration suis les \'etapes de la premi\`ere d\'emonstration due \`a Euler, en utilisant les nombres complexes, ce qu'Euler voulait \'eviter en donnant une d\'emonstration \'el\'ementaire.
  Cette preuve \'etant constructive, elle permet d'obtenir des d\'ecompositions effectives. N\'eanmoins elle n'est pas la plus rapide sur le plan algorithmique, puisqu'elle n\'ecessite une factorisation en facteurs premiers, qui peut \^etre tr\`es gourmande en temps de calcul. La variante de descente donn\'ee dans le paragraphe suivant \'evite cet \'ecueil.   
  
  \section{Autre preuve et algorithme pour la d\'ecomposition en somme de deux carr\'es.}\label{section1_5}
  Cet autre d\'emonstration-algorithme vient de [Lehman].
  
  Cette proposition donne une variante de la descente donn\'ee par Euler.
  \begin{prop}
  Soit $p \in \N$ un nombre premier impair. Supposons que l'entier $k$  soit tel qu'il existe des entiers $a,b$ v\'erifiant 
  $$k p = a^2 +b^2,\qquad 1<k<p.$$
  Alors il existe un entier $l$, o\`u $1 \leq l \leq \frac{k}{2} < k$, et des entiers $c,d$ tels que $lp = c^2 +d^2$.
  \end{prop}
  \begin{proof}
  Partons de l'hypoth\`ese $kp = a^2 +b^2$, avec $1<k<p$. Soient $m,n$ les moindres restes de $a,b$ modulo $k$ :
  $$ m \equiv a \pmod k, \quad n\equiv b \pmod k, \qquad -\frac{k}{2} \leq m < \frac{k}{2}, \quad  -\frac{k}{2} \leq n < \frac{k}{2}.$$

  
  Notons que $m,n$ ne sont pas tous deux nuls. Sinon  $k \mid a, k \mid b$, donc $k^2 \mid a^2+b^2 = kp$, ce qui entra\^ine que $k \mid p$, en contradiction avec les hypoth\`eses $p$ premier et $1<k<p$.
  
  De plus $m^2 + n^2 \equiv a^2 + b^2 \equiv 0 \pmod  k$, et ainsi $k \mid m^2 +n^2$. Il existe donc un entier $l$ tel que $m^2 +n^2 = kl$. Puisque $m,n$ ne sont pas tous deux nuls, $l\geq 1$. Comme $|m| \leq \frac{k}{2}$ et $|n| \leq \frac{k}{2}$, on obtient $kl = m^2 +n^2 \leq  \frac{k^2}{4} +  \frac{k^2}{4} =  \frac{k^2}{2}$, donc $1\leq l \leq \frac{k}{2}<k$.
  
  La division des deux \'egalit\'es
  \begin{align*}
    k p&=a^2 + b^2  =\mathrm{N}(a + bi),\\
   k l &= m^2 +n^2 = \mathrm{N}(m +ni),\\
  \end{align*}
  donne
  \begin{align*}
   \frac{p}{l} &=  \mathrm{N}\left( \frac{a+bi}{m+ni}\right)\\
   &= \mathrm{N}\left( \frac{(a+bi)(m-ni)}{m^2+n^2}\right)\\
   &= \mathrm{N}\left( \frac{(a+bi)(m-ni)}{kl}\right)\\
   &= \frac{1}{l^2}  \left[ \left(\frac{am +bn}{k}\right)^2 +  \left(\frac{bm -an}{k}\right)^2  \right],
   \end{align*}
   donc
   $$l p= \left(\frac{am +bn}{k}\right)^2 +  \left(\frac{bm -an}{k}\right)^2.$$
Puisque $ m \equiv a \pmod k, n\equiv b \pmod k$, nous obtenons
\begin{align*}
am +bn \equiv a^2+b^2 \equiv 0 \pmod{k},\\
bm-an \equiv ba - ab \equiv 0 \pmod{k},
\end{align*}
donc $c = \frac{am +bn}{k}$ et $d = \frac{bm -an}{k}$ sont des entiers, et ils v\'erifient
$$ lp = c^2 +d^2, \text{ o\`u } 1\leq l < \frac{k}{2}<k.$$
\end{proof}

Ceci donne une nouvelle preuve du th\'eor\`eme des deux carr\'es :

{\it
Soit $p \in \N$ un entier premier tel que $p \equiv 1 \pmod 4$, alors $p =a^2 + b^2$ est somme de deux carr\'es d'entiers.
}

\begin{proof}
Comme $p\equiv 1 \pmod 4$, la proposition 5 donne l'existence d'un entier $a$ tel que $p \mid a^2 +1$. Si $b$ est le moindre reste de $a$ dans la division par $p$, alors $ b \equiv a \pmod{p}$ et $-\frac{p}{2} < b < \frac{p}{2}$. Alors $p \mid b^2 +1$, avec $|b| < \frac{p}{2}$.  Quitte \`a remplacer $b$ par $-b$, on peut supposer $b>0$. Ainsi il existe un entier $k$ tel que
$$kp = b^2 + 1,$$
et puisque $0<b< \frac{p}{2}$, $k p < \frac{p^2}{4} + 1$, donc $k <\frac{p}{4} + \frac{1}{p} <\frac{p}{4} + 1 < p$.

Si $k = 1$, $p = b^2 + 1$ est somme de deux carr\'es. Sinon, $kp = b^2 + 1, \ 1<k<p$, et ainsi l'hypoth\`ese de la proposition 12 est v\'erifi\'ee.

La proposition 12 donne alors un entier $k_1$ tel que $1\leq k_1 < k$ tel que $k_1 p$ est somme de deux carr\'es. Si $k_1 = 1$, $p$ est some de deux carr\'es. Sinon on continue. On construit ainsi une suite strictement d\'ecroissante $k_1> k_2> \cdots > k_n> \cdots $  d'entiers, tant qu'aucun terme de cette suite n'est \'egal \`a 1, et v\'erifiant tous $k_n p = a_n^2+b_n^2$ pour des entiers $a_n,b_n$. Comme il n'existe pas de suite infinie strictement d\'ecroissante d'entiers naturels, cette suite est n\'ecessairement finie : il existe un indice $t$ tel que $k_t = 1$, et donc $p$ est somme de deux carr\'es.

    \end{proof}
    
  L'algorithme correspondant ne demande pas de factorisations, et il est efficace. En effet la proposition 13 montre que $k_{n+1} < \frac{k_n}{2}$. On atteint donc $k_t = 1$ en un temps $t = O(\log(n))$. Le programme correspondant \`a cet algorithme est donn\'e dans l'appendice \`a ce chapitre.
  
  Une autre preuve du th\'eor\`eme des deux carr\'es sera donn\'ee dans un chapitre ult\'erieur par la m\'ethode de Lagrange pour obtenir une forme r\'eduite, une avec les sommes de Jacobi, et une autre encore dans le chapitre sur la g\'eom\'etrie des nombres.
  
  
  
  
 \section{Repr\'esentation d'un nombre premier par la forme $x^2 + 2 y^2$.}
 Le nombre 2 se d\'ecompose sous la forme $2 = 0^2 + 2\times1^2$.
 
 Maintenant, soit $p$ un nombre premier impair. A quelle condition peut-il se d\'ecomposer sous la forme $p = x^2 + 2 y^2$ ? Donnons d'abord une condition n\'ecessaire :
 
 Si $p = x^2 + 2y^2$, alors $p \nmid y$, sinon $p \mid y, p \mid x$, donc $p^2 \mid x^2 + 2y^2 = p$, et $p \mid 1$ : c'est absurde. Par cons\'equent la classe $\dot y$ de $y$ est non nulle dans $\Z/p\Z$, et $-2 = (\dot x \dot {y}^{-1})^2$, donc $\legendre{-2}{p} = 1$. Ceci \'equivaut d'apr\`es les caract\`eres quadratique de $-1$ et $2$ \`a
 $$(-1)^{\frac{p^2-1}{8}} = (-1)^{\frac{p-1}{2}}.$$
 R\'esumons le tableau de ces valeurs pour chaque valeur de $p$ modulo $8$ :
 $$
 \begin{array}{c|cccc}
 p  & 1 & 3 & 5 & 7  \\
 \hline
 (-1)^{\frac{p-1}{2}} & 1 & -1 & 1 & -1\\
 (-1)^{\frac{p^2-1}{8}}& 1 & -1 & -1 & 1
 \end{array} 
 $$
 Donc 
 $$\legendre{-2}{p} = 1 \iff p \equiv 1,3 \pmod 8.$$
 
 Montrons que cette condition est suffisante
 
 \begin{prop}\label{prop14}
 Soit $p$ un nombre premier impair . Alors
 $$\exists x \in \Z,\  \exists y \in \Z, \ p = x^2 + 2 y^2  \iff p \equiv 1 \text{ ou } p \equiv 3 \pmod 8.$$
 \end{prop}

 \begin{proof}
  Il reste \`a prouver que la condition est suffisante. Supposons que $p \equiv 1,3 \pmod 8$. Le calcul pr\'ec\'edent montre que $\legendre{-2}{p} = 1$, donc il existe un entier $a$ tel que $p \mid a^2 + 2$.
  
  L'anneau $\Z[i\sqrt{2}]$ \'etant principal (proposition \ref{prop2}), nous pouvons calquer la preuve de la proposition \ref{prop6}.
  
  Notons $\rho = i \sqrt{2}$. Soit $I$ l'id\'eal de $\Z[\rho]$ d\'efini par
   $$I = p \Z[\rho] + (a+ \rho) \Z[i] = \langle p, a+\rho \rangle.$$
   Montrons que $I \ne \Z[\rho]$, en prouvant que l'hypoth\`ese $I = \Z[\rho]$ est absurde.
   
   Soit $\lambda$ un diviseur premier de $p$ dans $\Z[\rho]$ : un tel diviseur existe puisque $\Z[\rho]$ est principal.
   
   Alors $\lambda \mid p$, et $p \mid a^2 + 2 = (a+\rho)(a-\rho)$, donc $\lambda \mid (a+\rho)(a-\rho)$. L'\'el\'ement $\lambda$ \'etant premier, il divise soit $a+\rho$, soit $a-\rho$.
   
   Dans la premier cas, $\lambda$ divise $p$ et $a+\rho$. Dans le deuxi\`eme cas, si $\lambda \mid a-\rho$, alors $a-\rho = \lambda \mu$, donc $a+\rho= \overline{\lambda} \overline{\mu}$, o\`u $\overline{\mu} \in \Z[\rho]$, donc $\overline{\lambda} \mid a+\rho$. De plus $\overline{\lambda} \mid p$ : en effet $p = \lambda \nu$ pour un certain $\nu \in \Z[\rho]$, donc $p =\overline{\lambda} \overline{\nu}$. Notons que $\mathrm{N}(\lambda) = \mathrm{N}(\overline{\lambda})>1$.   
   
 Dans les deux cas, il existe $\xi \in \Z[\rho]$ (o\`u $\xi = \lambda$ ou $\xi = \overline{\lambda}$) tel que $\xi \mid p, \xi \mid a+\rho$, et $\mathrm{N}(\xi) > 1$.
 
 Sous l'hypoth\`ese $I = \Z[\rho]$, alors $1 = p \zeta + (a+\rho) \eta$, o\`u $\zeta, \eta$ sont dans $\Z[\rho]$. Alors $\xi \mid 1$, en contradiction avec $\mathrm{N}(\xi) >1$, ce qui prouve que $I \ne \Z[\rho]$.
 
 Comme $\Z[\rho]$ est principal, il existe $\pi \in \Z[\rho]$ tel que
 $$ p \Z[\rho] + (a+\rho) \Z[\rho] = \pi \Z[\rho].$$
 De plus $\pi$ n'est pas une unit\'e, sinon $I = \pi \Z[\rho] = \Z[\rho]$. Par cons\'equent $\mathrm{N}(\pi) > 1$. Nous venons de prouver l'existence d'un pgcd non trivial $\pi$ de $p$ et $a+\rho$.
 
 Comme $p  = p\times 1 + (a+\rho)\times 0 \in  p \Z[\rho] + (a+\rho) \Z[\rho] = \pi \Z[\rho]$, il existe $\gamma \in \Z[\rho]$ tel que $p = \pi \gamma$, et donc $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$.
 
 Si $\mathrm{N}(\gamma) = 1$, alors $\gamma$ est une unit\'e, donc $p$ et $\pi$ sont associ\'es, et $\pi$ divise $a+\rho$, donc $p$ divise $a+ \rho$, ce qui est absurde puisque $\frac{a}{p} + \frac{1}{p} \rho \not \in \Z[\rho]$. Ainsi $\mathrm{N}(\gamma) > 1$. 
 
 L'\'egalit\'e $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$, o\`u $\mathrm{N}(\pi) > 1, \mathrm{N}(\gamma)>1$, montre que
 $$ p = \mathrm{N}(\pi).$$
 Si $\pi = x + i\sqrt{2}y,\ x,y \in \Z$, alors $p=x^2 +2y^2$, ce qui prouve le th\'eor\`eme.
 \end{proof}
 
\section{L'anneau $\Z[\omega]$.}

Soit $\omega = e^{2i\pi/3} = -\frac{1}{2} + i \frac{\sqrt{3}}{2}$. Alors $\omega^2 + \omega +1 = 1, \omega^3 = 1$ et $\overline{\omega} = \omega^2 = -1 - \omega$.

Notons $\Z[\omega]$ l'ensemble des nombres complexes de la forme $a +b \omega$ :
$$A = \{z \in \C\ | \ \exists a \in \Z, \ \exists b \in \Z, \ z = a + b \omega\}.$$
$A$ est le plus petit sous-anneau de $\C$ qui contient $\Z$ et $\omega$.

Si $z =a + b \omega \in \Z[\omega]$, alors $\mathrm{N}(z) = (a +b\omega)(a + b \omega^2) = a^2 -ab + b^2$.

Notons que $\Z[\omega]$ est stable par conjugaison :
$$\overline{z} = a + b \omega^2 = a + b(-1 - \omega) = (a-b) - b \omega \in \Z[\omega].$$

Montrons que cet anneau est euclidien, pour la norme usuelle des nombres complexes.
\begin{prop}
Si $z \in \C$, il existe $z_0 \in \Z[\omega]$ tel que $\mathrm{N}(z-z_0)<1$.
\end{prop}

\begin{proof} Soit $z = a +b \omega \in \Z[\omega]$. Il existe des entiers $a_0, b_0$ tels que
$$|a-a_0| < \frac{1}{2}, \quad |b-b_0|<\frac{1}{2}.$$
Alors 
\begin{align*}
\mathrm{N}(z-z_0) & = \mathrm{N}[(a-a_0) + \omega (b-b_0)]\\
&= (a-a_0)^2 -(a-a_0)(b-b_0) + (b-b_0)^2\\
&\leq |a-a_0|^2 + |a-a_0||b-b_0| + |b-b_0|^2\\
&\leq \frac{1}{4} + \frac{1}{4} + \frac{1}{4} = \frac{3}{4}
\end{align*}
\end{proof}

\begin{prop}
$\Z[\omega]$ est un anneau euclidien pour la norme $\mathrm{N}(\cdot)$ de $\C$.
\end{prop}

M\^eme preuve que celle de la proposition \ref{prop2} :
\begin{proof}
Si $a,b\in \Z[\omega]$, et $b \ne 0$, il existe d'apr\`es la proposition pr\'ec\'edente $q \in \Z[\omega]$ tel que $\left | \frac{a}{b} -q \right| < 1$. Posons alors $r = a - b q = b\left( \frac{a}{b} -q\right)$. Alors $r \in \Z[\omega]$, et
$$a = bq +r, \quad 0\leq \mathrm{N}(r )< \mathrm{N}(b ).$$
Il existe donc une division euclidienne dans $\Z[\omega]$.
\end{proof}

Pr\'ecisons les unit\'es de $\Z[\omega]$.


\begin{prop}
Pour tout $z \in \Z[\omega]$,
$$z \in \Z[\omega]^{\times} \iff \n(z) = 1.$$
\end{prop}

(M\^eme d\'emonstration que celle de la proposition \ref{prop3}, en utilisant le fait que $\Z[\omega]$ est stable par conjugaison.)

\begin{prop}
$$\Z[\omega]^{\times} = \{1,\omega,\omega^2,-1,-\omega,-\omega^2\} = \mathbb{U}_6.$$
\end{prop}

\begin{proof}
Soit $\alpha = a + b \omega$ une unit\'e dans $\Z[\omega]$. Alors $\n(\omega) = 1$, soit $a^2 -ab + b^2 = 1$. Donc $4 = 4a^2 -4ab + 4 b^2 = (2a-b)^2 + 3b^2$. Ceci implique $3b^2 \leq 4$, donc $|b| \leq 1$. Ceci donne deux cas :
\be
\item[$\bullet$] $b = 0, 2a - b = \pm 2$.
\item[$\bullet$] $b = \pm 1, 2a - b = \pm 1$,
\ee
Alors $(a,b) \in \{(1,0),(-1,0),(1,1),(0,1),(0,-1),(-1,-1)\}$, donc $$z = a + b \omega \in \{1,-1,1+\omega, \omega,-\omega, - 1 - \omega\}.$$
Puisque $1+\omega = -\omega^2$, on obtient bien 
$$ z \in \{1,\omega,\omega^2,-1,-\omega,-\omega^2\} .$$
R\'eciproquement, ces 6 \'el\'ements sont de norme 1, donc sont des unit\'es. Ils constituent le groupe des racines 6-i\`eme de l'unit\'e dans $\C$, engendr\'e par $1+ \omega = - \omega^2 = e^{i\pi/3}$.
\end{proof}






\section{Repr\'esentation des nombres premiers sous la forme $x^2 + 3y^2$.}\label{section1_8}

Sachant que $\Z[\omega]$ est principal, donnons maintenant la repr\'esentation d'un nombre premier sous la forme $x^2 + 3 y^2$.

Le nombre $3$ se d\'ecompose sous la forme $3 = 0^2 + 3 \times 1^2$. Prenons maintenant un autre nombre premier.
\begin{prop}\label{prop19}
Soit p  un nombre premier diff\'erent de $3$. Alors
$$\exists x \in \Z, \ \exists y \in \Z, \ p=x^2 + 3y^2 \iff p \equiv 1 \pmod {3}.$$

\begin{proof}
\be 
\item[$(\Rightarrow)$] Si $p \ne 3$ v\'erifie $p =x^2 + 3 y^2,\ x,y \in \Z$, alors $p \equiv x^2 \pmod 3$, et $p\nmid x$ (sinon $p \mid x$, donc $p \mid y,\ p^2 \mid x^2 +3 y^2 = p$ : c'est absurde). Par cons\'equent $p\equiv 1 \pmod 3$.

\item[$(\Leftarrow)$] 
Notons que, pour tout premier impair diff\'erent de $3$, 
$$\legendre{-3}{p}  = (-1)^{\frac{p-1}{2}} \legendre{3}{p}  = (-1)^{\frac{p-1}{2}} (-1)^{\frac{3-1}{2} \frac{p-1}{2}}  \legendre{p}{3} = \legendre{p}{3}.$$
Par cons\'equent, $$\legendre{-3}{p} = 1 \iff  \legendre{p}{3} = 1  \iff p \equiv 1 \pmod 3.$$

Si $p\equiv 1\pmod 3$, l'\'equivalence pr\'ec\'edente montre que $\legendre{-3}{p} = 1$, donc il existe un entier $a$ tel que $p \mid a^2 + 3$.

Comme $\omega =  -\frac{1}{2} + i \frac{\sqrt{3}}{2}$, alors $i\sqrt{3} = 1 + 2 \omega$, donc
$$a^2 + 3 = (a+i\sqrt{3})(a - i \sqrt{3}) = (a + 1 + 2\omega)(a+1 + 2 \omega^2).$$
Reprenons le sch\'ema de d\'emonstration de la proposition 14.
Soit $I$ l'id\'eal de $\Z[\omega]$ d\'efini par
   $$I = p \Z[\omega] + (a+1 + 2\omega) \Z[\omega] = \langle p, a+1 + 2 \omega \rangle.$$
   Montrons que $I \ne \Z[\omega]$, en prouvant que l'hypoth\`ese $I = \Z[\omega]$ est absurde.
   
   Soit $\lambda$ un diviseur premier de $p$ dans $\Z[\omega]$ : un tel diviseur existe puisque $\Z[\omega]$ est principal.
   
   Alors $\lambda \mid p$, et $p \mid a^2 + 3 =(a + 1 + 2\omega)(a+1 + 2 \omega^2)$, donc $\lambda \mid (a + 1 + 2\omega)(a+1 + 2 \omega^2)$. L'\'el\'ement $\lambda$ \'etant premier, il divise soit $a+1 + 2\omega$, soit $a + 1 + 2\omega^2$.
   
   Dans la premier cas, $\lambda$ divise $p$ et $a+1+2\omega$. Dans le deuxi\`eme cas, si $\lambda \mid a+1 + 2\omega^2$, alors $a+1+2\omega^2= \lambda \mu$. Par passage aux conjugu\'es, $a+1+2\omega= \overline{\lambda} \overline{\mu}$, o\`u $\overline{\mu} \in \Z[\omega]$, donc $\overline{\lambda} \mid a+1+2\omega$. De plus $\overline{\lambda} \mid p$ : en effet $p = \lambda \nu$ pour un certain $\nu \in \Z[\omega]$, donc $p =\overline{\lambda} \overline{\nu}$. Notons que $\mathrm{N}(\lambda) = \mathrm{N}(\overline{\lambda})>1$.   
   
 Dans les deux cas, il existe $\xi \in \Z[\omega]$ (o\`u $\xi = \lambda$ ou $\xi = \overline{\lambda}$) tel que $\xi \mid p, \xi \mid a+1+2\omega$, et $\mathrm{N}(\xi) > 1$.
 
 Sous l'hypoth\`ese $I = \Z[\omega]$, alors $1 = p \zeta + (a+1+2\omega) \eta$, o\`u $\zeta, \eta$ sont dans $\Z[\omega]$. Alors $\xi \mid 1$, en contradiction avec $\mathrm{N}(\xi) >1$, ce qui prouve que $I \ne \Z[\omega]$.
 
 Comme $\Z[\omega]$ est principal, il existe $\pi \in \Z[\omega]$ tel que
 $$ p \Z[\omega] + (a+1+2\omega) \Z[\omega] = \pi \Z[\omega].$$
 De plus $\pi$ n'est pas une unit\'e, sinon $\pi \Z[\omega] = \Z[\omega]$. Par cons\'equent $\mathrm{N}(\pi) > 1$. Nous venons de prouver l'existence d'un pgcd non trivial $\pi$ de $p$ et $a+1+2\omega$.
 
 Comme $p  \in  p \Z[\omega] + (a+1+2\omega) \Z[\omega] = \pi \Z[\omega]$, il existe $\gamma \in \Z[\omega]$ tel que $p = \pi \gamma$, et donc $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$.
 
 Si $\mathrm{N}(\gamma) = 1$, alors $\gamma$ est une unit\'e, donc $p$ et $\pi$ sont associ\'es, et $\pi$ divise $a+1+2\omega$, donc $p$ divise $a+ 1+2\omega$, ce qui est absurde puisque $\frac{a+1}{p} + \frac{2}{p} \omega \not \in \Z[\omega]$. Ainsi $\mathrm{N}(\gamma) > 1$. 
 
 L'\'egalit\'e $p^2 = \mathrm{N}(\pi) \mathrm{N}(\gamma)$, o\`u $\mathrm{N}(\pi) > 1, \mathrm{N}(\gamma)>1$, montre que
 $$ p = \mathrm{N}(\pi).$$
 Si $\pi = x + \omega y,\ x,y \in \Z$, alors $p=\mathrm{N}(\pi) = \mathrm{N}(\omega \pi)$, o\`u 
 $$\pi = x + \omega y, \qquad \omega \pi = -y + (x-y)\omega.$$
 La formule $p = \mathrm{N}(\pi)$ donne  $p = x ^2 -xy + y^2$, soit $4 p = 4x^2 - 4xy + 4 y^2 =(2x-y)^2 + 3y^2$.
 
 La substitution $(x,y) \leftarrow (-y, x-y)$ donne $4 p =(-2y -x+y)^2 + 3(x-y)^2 = (x+y)^2 + 3(x-y)^2$.
 
 Comme $\mathrm{N}(x + \omega y) = x^2 -xy +y^2 =\mathrm{N}(y + \omega x)$, on peut \'echanger $x$ et $y$.
 
  En r\'esum\'e, on obtient les trois formules \'equivalentes suivantes :
 \begin{align*}
 4p &= (2x - y)^2  + 3 y^2,\\
 4p &= (2y -x)^2 + 3x^2,\\
 4 p &= (x+y)^2 + 3(x-y)^2.
 \end{align*}
 
 Si $x$ impair et $y$ pair, alors $p = \left(x - \frac{y}{2}\right)^2 + 3 \left(\frac{y}{2}\right)^2$.

Si $x$ pair et $y$ impair, alors $p = \left(y - \frac{x}{2}\right)^2 + 3 \left(\frac{x}{2}\right)^2$.

Si $x,y$ sont de m\^eme parit\'e, alors $p = \left(\frac{x+y}{2}\right)^2 + 3 \left(\frac{x-y}{2}\right)^2$.

Dans les trois cas, $p$ est de la forme $a^2 + 3 b^2$, o\`u $a,b$ sont entiers.
\ee
\end{proof}
\end{prop}




\section{El\'ements premiers dans $\Z[\omega]$.}

Les deux propositions suivantes se d\'emontrent comme dans $\Z[i]$ \`a la section \ref{section_gauss}.

\begin{prop}\label{prop20}
Soit $\pi \in \Z[\omega]$. Si $\mathrm{N}(\pi)$ est premier dans $\Z$, alors $\pi$ est premier dans $\Z[\omega]$.
\end{prop}

\begin{prop}\label{prop21}
Soit $\pi$ un \'el\'ement premier dans $\Z[\omega]$. Alors il existe un unique entier rationnel premier $p\in \N$ tel que $\pi \mid p$.
\end{prop}

Donnons d'abord une liste d'\'el\'ements premiers dans $\Z[\omega]$ :
\be
\item[$\bullet$] Comme $x^2+x+1 = (x-\omega)(x-\omega^2)$, $\n(1-\omega) = (1-\omega)(1-\omega^2) = 3$ est premier dans $\Z$, donc $1-\omega$ est premier dans $\Z[i]$, ainsi que ses 6 associ\'es $1-\omega,1+2\omega,-2-\omega,-1+\omega,-1-2\omega,2+\omega$.

\item[$\bullet$] Soit $q \equiv 2 \pmod 3$ un premier rationnel, $q>0$. Montrons que $q$ est premier dans $\Z[\omega]$. Dans le cas contraire, $q = \alpha \beta$, o\`u $\alpha, \beta \in \Z[\omega]$ v\'erifient $\n(\alpha)>1, \n(\beta)>1$. Alors $q^2 = \n(\alpha)\n(\beta)$, donc $\n(\alpha) = q$. Si $\alpha = a + b \omega$, alors $q = a^2 -ab +b^2$, donc $4q = (2a -b)^2 + 3b^2$, et ainsi $q \equiv (2a -b)^2 \not \equiv -1 \pmod 3$. Cette contradiction montre que $q$ est premier dans $\Z[\omega]$ (ainsi que ses associ\'es $\pm q, \pm \omega q, \pm \omega^2 q$).

\item[$\bullet$] Soit $\pi = a + b \omega\in \Z[\omega]$ tel que $p = \n(\pi) = a^2 -ab +b^2$ est premier dans $\Z$ (donc $4 p = (2a -b)^2 + 3b^2$, ce qui montre que $p \equiv 1 \pmod 3$). Alors $\pi$ est premier dans $\Z[\omega]$ puisque $\n(\pi)$ est premier dans $\Z$.
\ee

Ces \'el\'ements seront appel\'es les \'el\'ements premiers connus dans $\Z[\omega]$. Montrons que cette liste est exhaustive.

\begin{prop} \label{prop22} 
Les \'el\'ements premiers dans $\Z[\omega]$ sont
\be
\item[(i)] $1 - \omega$ et ses associ\'es,
\item[(ii)] les entiers rationnels $q \equiv 2 \pmod 3, q>0,$ premiers dans $\Z$, ainsi que leurs associ\'es,
\item[(iii)] les \'el\'ements $\pi = a + b \omega$ tels que $ p = \pi \overline{\pi} = a^2 -ab +b^2 \equiv 1 \pmod 3$ soit premier dans $\Z$.
\ee
\end{prop}
\begin{proof}
Soit $\pi = a + b\omega$ un \'el\'ement premier dans $\Z[\omega]$. La proposition \ref{prop21} montre qu'il existe un premier rationnel $p\in \N$ tel que $\pi \mid p$.
Discutons les trois seuls cas possibles, $p = 3$, $p\equiv 2 \pmod 3$, et $p \equiv 1 \pmod 3$.
\be
\item[(i)] Supposons que $\pi \mid 3$. Comme $3 = (1-\omega)(1-\omega^2) = (1+\omega) (1-\omega)^2 = -\omega^2(1- \omega)^2$, o\`u $1-\omega$ est premier, et $-\omega^2$ est une unit\'e, alors $\pi$ est associ\'e \`a $1-\omega$.

\item[(ii)] Supposons que $\pi \mid p$, o\`u $p \equiv 2 \pmod 3$. Comme $p$ est un \'el\'ement premier connu, $\pi$ est associ\'e \`a $p$.

\item[(iii)] Supposons que $\pi  = a + b \omega \mid p$, o\`u $p \equiv 1 \pmod 4$. Alors $p = \pi \lambda$ pour un certain $\lambda \in \Z[\omega]$. Montrons par l'absurde que $p$ n'est pas premier dans $\Z[\omega]$. Comme vu dans la section \ref{section1_8}, $\legendre{-3}{p} = \legendre{p}{3} = 1$, donc il existe un entier $a$ tel que $p \mid a^2 + 3$.

Alors $p \mid a^2 + 3 = (a + 1 + 2\omega)(a+1 + 2 \omega^2)$. Ici $p$ est suppos\'e premier,  donc $p \mid a + 1 + 2\omega$, ou $p \mid a + 1 + 2\omega^2$, en contradiction avec le fait que $\frac{a+1}{p} + \frac{2}{p} \omega \not \in \Z[\omega]$ (ni son conjugu\'e, puisque $\Z[\omega]$ est stable par conjugaison).

Ainsi $p$ n'est pas premier, donc $\lambda$ n'est pas une unit\'e. Par cons\'equent $p = \pi \lambda,$, o\`u $\n(\pi)>1, \n(\lambda)>1$. L'\'egalit\'e $p^2 = \n(\pi)(\n(\lambda)$ montre que $p = \n(\pi) = \pi \overline{\pi} = a^2 -ab +b^2$.
\ee

Remarque : si $p$ est un premier rationnel tel que $p \equiv 1 \pmod 3$, il admet un diviseur premier $\pi = a + b \omega \in \Z[\omega]$, et le (iii) prouve que $p = a^2 - ab +b^2$. D'apr\`es la fin du raisonnement de la section \ref{section1_8}, ceci montre que $p$ est de la forme $x^2 + 3y^2$, ce qui donne une nouvelle preuve de la proposition \ref{prop19}.
\end{proof}

Nous pouvons donner l'analogue de la proposition 11 dans $\Z[\omega]$ :

\begin{prop}
Soit $p \equiv 1 \pmod 3$ un premier rationnel. Il existe 12 diviseurs premiers de $p$ dans $\Z[\omega]$,  constituant deux classes d'association distinctes.
\end{prop}
\begin{proof}
Comme $p \equiv 1 \pmod 3$, la remarque pr\'ec\'edente montre que $p = \pi \overline{\pi} = a^2 -ab + b^2$, o\`u $\pi = a + b \omega \in \Z[\omega]$. Comme
$$\frac{\pi}{\overline{\pi}} = \frac{a+b \omega}{a+ b \omega^2} = \frac{(a+b\omega)^2}{\n(\pi)} = \frac{a^2 - b^2}{\n(\pi)} + \frac{(2a-b)b}{\n(\pi)} \omega,$$
alors $\frac{\pi}{\overline{\pi}}  \in \{1,-1,\omega,-\omega, -1 - \omega,1 +\omega\}$ entra\^ine $a^2 - b^2 = 0$ ou $(2a-b)b =0$ ou $a^2 - b^2 = (2a-b)b$, soit $a = b$ ou $a = -b$ ou $2a - b = 0$ ou $b=0$ ou $a= 0$ ou $2b-a =0$. L'\'egalit\'e $p = a^2 -ab + b^2$, o\`u $p$ est un premier diff\'erent de $3$, montre que $a= \pm b$ est impossible, ainsi que $a = 0$ ou $b = 0$. L'\'egalit\'e $4p = (2a-b)^2 + 3b^2$ montre que $2a -b=0$ est impossible, et l'\'egalit\'e $4 p = (2b -a)^2 + 3a^2$ montre que $2b -a = 0$ est impossible. Ceci montre que $\pi$ n'est pas associ\'e \`a $\overline{\pi}$. 

Le reste de la d\'emonstration se fait comme dans la proposition \ref{prop11}.
\end{proof}



\section{La forme $x^2 + n y^2$ si $n>3$.}

Nous savons que si $p \equiv 1 \pmod 4$, alors $p = x^2 + y^2$. Alors $x$ et $y$ sont de parit\'e distinctes, sinon $p$ serait pair, donc $p = 2$, mais $2 \not \equiv 1 \pmod 4$. Quitte \`a \'echanger $x,y$, on peut supposer que $x$ est impair et $y$ pair. Donc $y = 2z, z \in \Z$, et donc $p = x^2 + 4 z^2$. Inversement, puisque $2$ ne s'exprime pas sous la forme $x^2 + 4 z^2$, si $p = x^2 + 4 z^2 = x^2 + (2z)^2$, alors $p \equiv 1 \pmod 4$.

A ce stade, nous avons prouv\'e les \'equivalence suivantes :

si $p$ est un nombre premier ($p \ne 2, p \ne 3$) alors
\begin{align*}
p = x^2 + y^2, \ x,y \in \Z \iff  p \equiv 1 \pmod 4 &\iff \legendre{-1}{p} = 1\\
p = x^2 + 2 y^2,\ x,y \in \Z \iff p \equiv 1,3 \pmod 8 &\iff \legendre{-2}{p} = 1\\
p = x^2 + 3 y^2, \ x,y \in \Z  \iff p \equiv 1 \pmod 3 &\iff \legendre{-3}{p} = 1\\
p = x^2 + 4 y^2, \ x,y \in \Z  \iff p \equiv 1 \pmod 4 &\iff \legendre{-4}{p} = 1
\end{align*}

Si on voulait g\'en\'eraliser, on peut bien sûr affirmer que
$$p = x^2 + n y^2 \Rightarrow \legendre{-n}{p} = 1,$$
mais l'\'equivalence est fausse d\`es $n=5$.
En effet $\legendre{-5} p = 1 \iff p\equiv 1,3, 7,9 \pmod {20}$, mais, comme l'ont remarqu\'e Fermat et Euler, $p = x^2 + 5 y^2,\ x,y \in \Z$ \'equivaut \`a $p=1,9 \pmod {20}$, et $2p = x^2 + 5y^2$ \'equivaut \`a $p\equiv 3,7 \pmod {20}$. Par exemple $23$ ne s'\'ecrit pas sous la forme $x^2 + 5 y^2$, mais $2 \times 23 = 46 = 1^2 + 5 \times 3^2$.

Les d\'emonstrations pr\'ec\'edentes ne peuvent se g\'en\'eraliser, car $\Z[\sqrt{-5}]$ n'est pas principal. Si $\omega = i\sqrt{5}$, alors $6 = 2 \times 3 = (1 + \omega)(1-\omega)$. On v\'erifie au chapitre ``Entiers d'un corps quadratique'', que $2,3 = 1 + \omega, 1- \omega$ sont des \'el\'ements premiers non associ\'es. Cette \'egalit\'e montre donc que $\Z[\sqrt{-5}]$ n'est pas factoriel, et a fortiori il n'est pas principal. Les chapitres suivants nous permettrons de traiter ce cas.


\begin{subappendices}

\bigskip
APPENDICE AU CHAPITRE 1.

\section{R\'ecr\'eation informatique.}




Nous choisissons dans ces r\'ecr\'eations de pr\'esenter les algorithmes \'etudi\'es pr\'ec\'edemment sous la forme de programme Python (ou Sage). Il sera possible de t\'el\'echarger ces programmes sur le site 
\begin{center}
%\url
{https://github.com/RichardGanaye}
\end{center}
\subsection{Quelques proc\'edures arithm\'etique g\'en\'erales.}

Donnons d'abord le module ``numtheory'' pr\'esentant les proc\'edures usuelles de th\'eorie des nombres.

La fonction {\bf isprime} est un test de primalit\'e probaliliste, avec une certaine probabilit\'e d'erreur.

La fonction {\bf ifactors} est naïve. Elle ne peut fonctionner que pour des petits nombres. Il sera pr\'ef\'erable de la remplacer par l'ordre {\bf factor} de Sage pour les grands nombres.

\begin{verbatim}
from random import randint

def powermod(a,n,p):
    """retourne a^n mod p (exponentiation rapide )
       resultat positif
    """
    resu=1
    while n!= 0:
        if n%2 != 0:
            resu = (a*resu) % p
        a = (a*a) % p
        n=n//2
    return resu
    
def expomod(a,n,p):
    """retourne a^n mod p (exponentiation rapide )
       resultat entre -p/2 et p/2
    """
    resu=1
    while n!= 0:
        if n%2 != 0:
            resu = (a*resu) % p
        a = (a*a) % p
        n=n//2
    if resu>p//2:
        resu -=p
    return resu

def legendre(a,p):
    """retourne le symbole de Legendre (a/p) si p premier"""
    return expomod(a,(p-1)//2,p)

def jacobi2(n):
    """retourne jacobi(n,2)"""
    r = n%8
    if r==1 or r==7:
        return 1
    else:
        return -1

def jacobi(n,m):
    """retourne le symbole de Jacobi (n/m)"""
    if n==0: return 0
    prod = 1
    while m>1:
        k = 0
        while n%2 == 0:
            k += 1
            n = n//2
        if k%2 == 1:
            prod = prod*jacobi2(m)
        if (n%4 == 3 and m%4 == 3):
            prod = -prod
        num = m%n
        m = n
        n = num
    return prod

def pgcd(a,b):
    a , b = abs(a), abs(b)
    while b != 0:
        a, b = b, a%b
    return a


def isprime(p,k=30):
    """ test de primalite, proba d'erreur < 2^(-k)"""
    if p <= 1: return False
    if p <= 3: return True
    test = True
    while k>0:
        k-=1
        b = randint(2,p-2)
        if pgcd(b,p) !=1:
            test = False
        else:
            if legendre(b,p) != jacobi(b,p):
                test = False
    return test

def nextprime(n):
    q=n+1
    while not isprime(q):
        q += 1
    return q

def plusPetitFacteur(n):
    """ plus petit facteur premier si n>1"""
    if n==1 or isprime(n):
        return n
    else:
        d = 2
        while n%d != 0:
            d += 1
        return d

def ifactors(n):
    """decomposition en facteurs d'un entier n>1"""
    l=[]
    while n!=1:
        p=plusPetitFacteur(n)
        alpha = 0
        while n%p == 0:
            n //=p
            alpha += 1
        l.append([p,alpha])
    return l

def factorielle(n):
    fact = 1
    while n>1:
        fact *= n
        n -= 1
    return fact


def lucas(p):
    """ retourne True ssi 2**p-1 est premier """
    def S(n,p):
        Mp=2**p-1
        s=4
        i=1
        while i<n:
            s=(s*s - 2) % Mp
            i+=1
        return s

    if S(p-1,p) == 0:
        return True
    else:
        return False


def bezout(a,b):
    """input  : couple d'entiers (a,b)
        output : triplet (x,y,d),
        (x,y) solution de ax+by =d, d = pgcd(a,b)
    """
    sgn_a = 1 if a >= 0 else -1
    sgn_b = 1 if b >= 0 else -1
    (r0, r1)=(abs(a), abs(b))
    (u0, v0) = (1, 0)
    (u1, v1) = (0, 1)
    while r1 != 0:
        q = r0 // r1
        (r2, u2, v2) = (r0 - q * r1, u0 - q * u1, v0 - q * v1)
        (r0, r1) = (r1, r2)
        (u0, u1) = (u1, u2)
        (v0, v1) = (v1, v2)
    x , y, d  = sgn_a * u0, sgn_b * v0, r0
    if x <= 0: x, y = x + abs(b), y - sgn_b * a
    return x, y, d

def inverse(a,modulo):
    """retourne l'inverse de a mod modulo
    """
    return bezout(a,modulo)[0] % modulo

def racineEntiere(n):
    """input  : entier n positif ou nul
        output : partie enti\`ere de la racine de n
    """
    a=n
    b=(n+1)//2
    while b<a:
        a=b
        b=(a*a+n)//(2*a)
    return a

def carre(A):
    """ input : entier naturel A
        output: True ssi A est un carr\'e
    """
    a=racineEntiere(A)
    if a*a==A:
        return True
    else:
        return False

def convert(n,base=10):
    l=[]
    while n!=0:
        r=n%base
        l.append(r)
        n = n//base
    return l

def primroot(p):
    assert(isprime(p))
    pas_trouve = True
    g = 1
    while pas_trouve:
        g += 1
        l = ifactors(p-1)
        k = 0
        test = True
        while k<len(l) and test:
            q = l[k][0]
            if expomod(g,(p-1)//q, p) == 1:
                test = False
            k += 1
        if test: pas_trouve = False
    return g
        
def chinois(a1,a2,n1,n2):
    "retourne x tel que x=a1[n1], x=a2[n2]"
    t = bezout(n1,n2)
    (u,v)=(t[0],t[1])
    r = (n2*v*a1 + n1*u*a2) % (n1*n2)
    return (n2*v*a1 + n1*u*a2) % (n1*n2)
    
def chinoiserie(liste,modules):
    "reste chinois pour des listes"
    liste = liste[:]
    modulos = modules[:]
    lg = len(liste)
    if lg==1:
        return liste[0] % modulos[0]
    else:
        a2 = liste.pop(0)
        n2 = modulos.pop(0)
        prod=1
        for nombre in modulos:
            prod *= nombre
        z = chinoiserie(liste,modulos)
        return chinois(z,a2,prod,n2)
    
if __name__ == '__main__':
    print(inverse(217,11213))
    
\end{verbatim}
\subsection{M\'ethode d'Euler.}
Mettons d'abord en oeuvre l'algorithme correspondant \`a la descente d'Euler propos\'e au la section \ref{section1_4} ``Sommes de deux carr\'es : la m\'ethode d'Euler''. Ce n'est pas la plus efficace puisqu'elle n\'ecessite une factorisation.

\begin{verbatim}
from numtheory import jacobi, carre, isprime, ifactors, nextprime
from random import randint

def reste_minimal(a,b):
    assert(b > 0)
    r = a % b
    if 2 * r > b:
        r -= b
    return r
    
def racine_de_moins_un(p):
    """ 
    input : p premier congru \`a 1 modulo 4
    output :  k tel que k^2 = -1 mod p
    |k| minimal, k > 0
    """
    assert isprime(p), "p non premier"
    assert p % 4 == 1, "p premier non congru \`a 1 modulo 4"
    while True:
        a = randint(2, p - 2)
        if jacobi(a, p) == -1:
            break
    b = pow(a, (p - 1) // 4, p)
    k = reste_minimal(b, p)
    return abs(k)   

def decomposition(p):
    if p == 2: 
        return (1,1)
    k = racine_de_moins_un(p)
    u = (k**2 + 1) // p
    l = ifactors(u)
    li = []
    for p,alpha in l:
        for i in range(alpha):
            li.append(p)
    if li == []:
        return (k,1)
    a, b = k, 1 
    for q in li:
        c,d = decomposition(q)
        if (a*c + b*d) % q == 0:
            a, b = (a*c + b*d) // q, (b*c - a*d) // q
        else: # (a*c - b*d) % q == 0
            a, b = (a*c - b*d) // q, (b*c + a*d) // q
    return (abs(a),abs(b))
        
        
if __name__ == "__main__":
    ttest = [13, 101, 10009, 11213,  100049, 1000000009,
             1234567891234567891234567909, 10**50 + 577]
    for p in ttest:
        a,b = decomposition(p)
        assert p == a**2 + b**2, "erreur test"
        print(p,'=>', a, b)
\end{verbatim}

Notons que si on ajoute aux tests le nombre premier $10**100 + 949$, le programme ne donne pas de r\'eponse dans des d\'elais raisonnables, ce qui ne sera pas le cas pour les proc\'edures suivantes.

\subsection{Calcul du pgcd dans $\Z[i]$.}

Donnons d'abord le module {\bf Zi} qui construit la classe des entiers de Gauss.
\begin{verbatim}
class Zi:
    """ classe Zi des entiers de Gauss a + ib"""
    
    def __init__(self,a = 0,b = 0):
        self.re = int(a)
        self.im = int(b)
        
    def Re(self):
        return self.re
        
    def Im(self):
        return self.im
        
    def couple(self):
        return [self.re, self.im]
        
    def norme(self):
        return (self.re)**2+(self.im)**2
        
    def bar(self):
        return Zi(self.re, -self.im) 
        
    def div(self, n):
        return Zi(self.re // n, self.im // n)
             
    def __repr__(self):
        if self.im>0:
            return f"{self.re} + {self.im} i"
        if self.im<0:
            return f"{self.re} - {abs(self.im)} i"
        if self.im == 0:
            return f"{self.re}"
        
    def __eq__(self, other):
        if isinstance(other,int):
            return self.im == 0 and self.re == other
        return self.re == other.re and self.im == other.im
    
    def __hash__(self):
        return (11 * self.re + self.im) // 16
        
    def __add__(self,other):
        if isinstance(other,int): return Zi(self.re + other,self.im)
        return Zi(self.re + other.re, self.im + other.im)

    def __sub__(self,other):
        if isinstance(other,int): return Zi(self.re - other,self.im)
        return Zi(self.re - other.re, self.im - other.im)

    def __mul__(self,other):
        if isinstance(other,int): return Zi(self.re * other,self.im * other)
        return Zi(self.re * other.re - self.im * other.im,
            self.re * other.im + self.im * other.re)
            
    def __floordiv__(self, other):
        a = self.re; b = self.im
        c = other.re; d = other.im
        return Zi((2*(a*c+b*d) +c*c+d*d) // (2*(c*c + d*d)),
            (2*(b*c-a*d) + c*c + d*d) // (2*(c*c+d*d)))
        
    def __mod__(self, other):
        return self - ( self // other) * other
        
    def __rmul__(self, a):
        return Zi(a * self.re, a* self.im)
    
    def __radd__(self, other):
        return Zi(other + self.re, self.im)
        
    def __rsub__(self,other):
        return Zi(other - self.re, -self.im)
        
    def __neg__(self):
        return Zi(-self.re, -self.im)
        
    def __pos__(self):
        return self
        
    def __pow__(self,n):
        resu = Zi(1)
        a = self
        while n!= 0:
            if n % 2 != 0:
                resu = resu * a
            a = a * a
            n = n // 2
        return resu
 
i = Zi(0,1)

if __name__ == "__main__":
    z = Zi(31,7)
    t = Zi(3,5)
    print(z,t)
    print(z//t, z % t)

\end{verbatim}

Le programme suivant permet la d\'ecomposition d'un nombre premier de la forme $4k+1$ en somme de deux carr\'es, \`a la vitesse de l'algorithme d'Euclide. Il suit l'algoritme pr\'esent\'e dans le paragraphe \ref{section1_2} ``Somme de deux carr\'es : une premi\`ere preuve.''.

\begin{verbatim}
from random import randint
from numtheory import isprime
from Zi import *

def pgcd(a,b):
    while b != Zi(0, 0):
        a, b = b, a % b
    return a

def racine_de_moins_un(p):
    pas_trouve = True
    while pas_trouve:
        a = randint(2, p - 2)
        b = pow(a, (p - 1)//4, p)
        if (b * b) % p == p-1:
            pas_trouve = False
    if 2 * b > p:
        b = b - p
    return b

def decomposition_carres(p):
    assert(p % 4 == 1)
    assert(isprime(p))
    a = racine_de_moins_un(p)
    pr = Zi(p)
    z = pgcd(pr, a+i)
    return abs(z.Re()), abs(z.Im())

if __name__ == "__main__":
    ttest = [13, 101, 10009, 11213,  100049, 1000000009,
             1234567891234567891234567909, 10**50 + 577, 10**100 + 949]
    for p in ttest:
        a,b = decomposition_carres(p)
        assert p == a**2 + b**2, "erreur test"
        print(p,'=>', a, b)
\end{verbatim}

Notons qu'il donne une r\'eponse imm\'ediate, m\^eme pour le nombre premier $10^{100}+949$, sur lequel buttait le programme pr\'ec\'edent.

\subsection{L'algorithme de Lehman.}
Il correspond \`a l'algorithme pr\'esent\'e \`a la section \ref{section1_5} ``Autre preuve et algorithme pour la d\'ecomposition en somme de deux carr\'es'', donn\'e dans [Lehman] ``Quadratic numbers''.
\begin{verbatim}
"""algorithme de Lehman, quadratic numbers"""

from numtheory import jacobi, carre, isprime
from random import randint
from Zn import Mod

def reste_minimal(a,b):
    assert(b > 0)
    r = a % b
    if 2 * r > b:
        r -= b
    return r

def racine_de_moins_un(p):
    """ 
    input : p premier congru \`a 1 modulo 4
    output :  k tel que k^2 = -1 mod p
    |k| minimal, k > 0
    """
    assert isprime(p), "p non premier"
    assert p % 4 == 1, "p premier non congru \`a 1 modulo 4"
    while True:
        a = randint(2, p - 2)
        if jacobi(a, p) == -1:
            break
    b = pow(a, (p - 1) // 4, p)
    k = reste_minimal(b, p)
    return abs(k)   
    
def somme_carres(p):
    k = racine_de_moins_un(p)
    a = (k**2 + 1) // p
    q, r = k, 1
    while a != 1:
        m, n = reste_minimal(q, a), reste_minimal(r, a)
        b = (m**2 + n**2) // a
        q, r = (q * m + r * n) // a, (q *n - r * m) // a
        a = b
    return abs(q),abs(r)
        

if __name__ == "__main__":
    ttest = [13, 101, 10009, 11213,  100049, 1000000009,
             1234567891234567891234567909, 10**50 + 577, 10**100 + 949]
    for p in ttest:
        a,b = somme_carres(p)
        assert p == a**2 + b**2, "erreur test"
        print(p,'=>', a, b)
\end{verbatim}

Il donne lui aussi des r\'eponses imm\'ediates.

Un autre algorithme de d\'ecomposition en sommes de deux carr\'es, tr\`es diff\'erent, sera pr\'esent\'e dans le chapitre ``Formes quadratiques''.
\end{subappendices}


\chapter{Sommes de Gauss et sommes de Jacobi.}
Les r\'esultats de ce chapitre sont adapt\'es de [Ireland,Rosen].
\section{Caract\'erisation des puissances $n$-i\`emes dans un corps fini.}
\begin{prop}\label{nbsols}
Soit $\F_q$ un corps fini \`a $q$ \'el\'ements, et soit  $\alpha \in \F_q^*$.
\be
\item[(a)] L'\'equation $x^n = \alpha$ a au moins une solution si et seulement si $\alpha^{\frac{q-1}{d}} = 1$, o\`u $d = n \wedge (q-1)$.
$$\exists x \in \F_q^*,\  x^n = \alpha \iff \alpha^{\frac{q-1}{d}} = 1 \qquad (\text{o\`u } d = n \wedge (q-1)).$$
\item[(b)] Si l'\'equation $x^n = \alpha$ a une solution, elle en a exactement $d =n \wedge (q-1)$.
\ee
\end{prop}
\begin{proof}
Rappelons que, le groupe $\F_q^*$ ayant $q-1$ \'el\'ements, tout \'el\'ement $\alpha$ de $\F_q^*$ v\'erifie $\alpha^{q-1} = 1$, et aussi que $\F_q^*$ est cyclique : appelons $g$ un g\'en\'erateur de ce groupe.

Alors il existe un entier $a$ tel que $\alpha = g^a$, et tout $x \in \F_q^*$ s'\'ecrit sous la forme $x = g^y$ pour un certain entier $y$. Alors

$$x^n = \alpha \iff g^{ny} = g^a \iff g^{ny-a} = 1 \iff q-1 \mid ny -a.$$
\be
\item[(a)] 
Supposons qu'il  existe $x\in \F_q$ tel que $x^n = \alpha$. Alors il existe $y\in \Z$ tel que $q-1 \mid ny -a$. Comme  $d \mid q-1$, et $d \mid n$,  alors  $d \mid a$.

Puisque $\frac{a}{d}$ est un entier, 
$$\alpha^{\frac{q-1}{d}} = g^{a \frac{q-1}{d}} = \left(g^{q-1}\right)^{\frac{a}{d}} = 1.$$
R\'eciproquement, supposons que $\alpha^{\frac{q-1}{d}}  = 1$. Alors $g^{a \frac{q-1}{d}} = 1$, donc $q-1 \mid a \, \frac{q-1}{d}$, soit $d \mid a$. 
Comme $d = n \wedge (q-1)$, il existe des entiers $u,v$ tels que $un + v(q-1) = d$, donc $u \frac{n}{d} + v \frac{q-1}{d} = 1$. Alors, puisque $\frac{a}{d}$ est un entier,
\begin{align*}
\alpha &= g^a\\
&=  g^{\left(u\frac{n}{d} + v \frac{q-1}{d}\right)a}\\
&=  \left(g^{u \frac{a}{d}}\right)^n \left(g^{q-1} \right)^{v \frac{a}{d}}\\
&=\left(g^{u \frac{a}{d}}\right)^n
\end{align*}
Ainsi $x = g^{u \frac{a}{d}}$ est une solution de $x^n = \alpha$.

\item[(b)] Supposons que l'\'equation $x^n = \alpha$ ait une solution $x = g^y$. D'apr\`es la partie (a), avec les m\^emes notations, $d$ divise $a$. Cherchons alors toutes les solutions de $x^n = \alpha$, ce qui revient \`a trouver tous les $y \in \Z$ tels que $q-1 \mid ny - a$ soit $\frac{n}{d} y \equiv \frac{a}{d} \pmod {\frac{q-1}{d}}$.

Si $u,v$ sont les entiers tels que $un + v(q-1) = d$, alors $u \frac{n}{d} +v \frac{q-1}{d} = 1$, donc $u \frac{n}{d} \equiv 1 \pmod {\frac{q-1}{d}}$. Ainsi
$$\frac{n}{d} y \equiv \frac{a}{d} \pmod {\frac{q-1}{d}} \iff y \equiv u \frac{a}{d} \pmod {\frac{q-1}{d}}.$$
Les solutions $x = g^y$ de $x^n = \alpha$ sont donn\'ees par les valeurs  de $y$ v\'erifiant
$$y = u \frac{a}{d} + k \frac{q-1}{d}, \ k \in \Z.$$
Notons $y_k = u \frac{a}{d} + k \frac{q-1}{d}$, et $x_k = g^{y_k}$. Alors $y_{k+d} = u \frac{a}{d} + (k +d)  \frac{q-1}{d} \equiv y_k \pmod {q-1}$, donc $x_{k+d} = x_k$.

Les solutions de $x^n = \alpha$ sont donc $x_0,\cdots,x_{d-1}$. V\'erifions que ces solutions sont distinctes. Supposons que $x_k = x_l$, o\`u $0\leq k <d, 0\leq l <d$. Alors $g^{y_k} = g^{y_l}$, donc $q-1 \mid y_k - y_l = (k-l) \frac{q-1}{d} $, donc $d \mid (k-l)$, o\`u $|k-l| < d$, donc $k=l$.

En conclusion, ou bien $x^n = \alpha$ n'a pas de solution, ou bien les solutions de cette \'equation sont les $d$ \'el\'ements distincts 
$$x = g^{ u \frac{a}{d} + k \frac{q-1}{d}},\ \qquad k = 0,1,\cdots,d-1.$$
\ee
\end{proof}

Exemple 1. Si $q = p$ est un nombre premier impair, et $p \nmid a$, on d\'eduit de cette proposition le r\'esultat bien connu
$$\exists x \in \Z,\  x^2 \equiv a \pmod p \iff a^{\frac{p-1}{2}}  \equiv 1 \pmod p.$$

Exemple 2. Soit $q=p^s$ une puissance d'un nombre premier $p$.

Si $q \equiv 2 \pmod 3$, et $a \in \F_q^*$, alors l'\'equation $x^3 = a$ a au moins une solution dans $\F_q^*$ si $a^{q-1} = 1$, ce qui est toujours vrai. Ainsi, tout $a \in \F_q$ est un cube dans $\F_q$. De plus $d = 3 \wedge (q-1) = 1$, donc $a\in\F_q^*$ est le cube d'un unique \'el\'ement de $\F_q^*$. Autrement dit l'application $\F_q^* \to \F_q^*, x \mapsto x^3$ est un automorphisme de groupe de $\F_q^*$.

Si $q \equiv 1 \pmod 3$, alors l'\'equation $x^3 = a$ a au moins une solution dans $\F_p^*$ si $a^{\frac{q-1}{3}} = 1$, auquel cas elle admet 3 solutions.





\section{Trace et norme dans les corps finis.}
\subsection{Groupe de Galois d'un corps fini.}
La th\'eorie de Galois d'un corps fini est particuli\`erement simple, et nous la d\'eveloppons ici, sans utiliser les th\'eor\`emes g\'en\'eraux de la th\'eorie de Galois.

Soit $F = \F_q$ un corps \`a $q$ \'el\'ements, et $K = \F_{q^s} \supset \F_q$ une extension de $F$ \`a $q^s$ \'el\'ements. Alors $[K:F] = s$.

\begin{dfn}
Un automorphisme $\sigma$ du corps $K$ s'appelle un $F$-automorphisme si pour tout \'el\'ement $\alpha$ de $F$, $\sigma(\alpha) = \alpha$.
L'ensemble de ces $F$-automorphismes forment un groupe, appel\'e groupe de Galois de $K$ sur $F$, et not\'e
$$G = \Gal(K/F).$$
\end{dfn}

Exemples : $1_{K}$ est un \'el\'ement du groupe de Galois. Un exemple plus int\'eressant est l'automorphisme de Frobenius $\mathrm{F}$  (il faut distinguer $\mathrm{F} $ et $F$ !), d\'efini par
$$
\mathrm{F}
\left\{
\begin{array}{ccl}
K & \to &K\\
\alpha & \mapsto & \alpha^q.
\end{array}
\right.
$$
Si $\alpha$ est un \'el\'ement du corps $K$ alors $\mathrm{F}(\alpha) = \alpha^q \in K$. Puisque $q = p^k, k \in \N^*$, o\`u $p$ est la caract\'eristique de $F$, pour tous les $\alpha, \beta \in K$, $\mathrm{F}(x+y) = (x + y)^{q} = (x + y)^{p^{k}} = x^{p^{k}} +  y^{p^{k}} = \mathrm{F}(\alpha) + \mathrm{F}(\beta)$, et $\mathrm{F}(1) = 1$, $\mathrm{F}(\alpha \beta) = (\alpha \beta)^q =\alpha^q \beta^q= \mathrm{F}(\alpha) F(\beta)$.
De plus comme tout morphisme de corps, $\mathrm{F}$ est injectif : si $\alpha \ne 0$, alors $\mathrm{F}(\alpha) \mathrm{F}(\alpha^{-1}) = \mathrm{F}(\alpha \alpha^{-1}) = \mathrm{F}(1) = 1 \ne 0$, donc $\mathrm{F}(\alpha) \ne 0$. Comme l'injection $\mathrm{F}$ applique $K$ dans $K$, o\`u $K$ est fini, $\mathrm{F}$ est une bijection.

Si $\alpha \in F = \F_q$, alors $\alpha^q = \alpha$, donc $\mathrm{F}(\alpha) = \alpha$. Ainsi $\mathrm{F} \in \Gal(K/F)$.

Cet automorphisme suffit pour d\'ecrire le groupe $G$.

\begin{prop} Le groupe de Galois $G = \Gal(K/F)$ est un groupe cyclique d'ordre $s = [K : F]$, engendr\'e par l'automorphisme de Frobenius $\mathrm{F}$.
\end{prop}

\begin{proof}
Soit $g$ un g\'en\'erateur du groupe cyclique $K^*$. Consid\'erons un \'el\'ement quelconque $\sigma \in G$. Alors $(\mathrm{F}^{-1} \circ \sigma)(g) \ne 0$, et donc $(\mathrm{F}^{-1} \circ \sigma)(g)= g^i$, pour un certain $i \in \gcro 0,  q^s - 2 \dcro$, ce qui donne $\sigma(g) = \mathrm{F}(g)^i$. Si $\alpha$ est un \'el\'ement de $K^*$, alors $\alpha = g^k$, o\`u $k$ est un entier, donc $\sigma(\alpha) = \sigma(g)^k = \mathrm{F}(g)^{ik} = \mathrm{F}(g^k)^i = \mathrm{F}^i(\alpha)$ (et $\sigma(0) = 0 = \mathrm{F}^i(0)$). Ceci prouve que $\sigma = \mathrm{F}^i$, et ainsi $G$ est cyclique, engendr\'e par $\mathrm{F}$.

Pour tout $\alpha \in K$, $\mathrm{F}^s(\alpha) = \alpha^{q^s} =\alpha$, donc $\mathrm{F}^{s} = 1_{K}$. De plus, si $\mathrm{F}^k = 1_{K}$ pour un entier $k$, alors pour tout $\alpha \in K$, $\alpha^{q^k} = \mathrm{F}^k(\alpha) = \alpha$, en particulier $g^{q^k} = g$, donc $g^{q^k-1} = 1$, o\`u le g\'en\'erateur $g$ est d'ordre $q^s - 1$, ce qui prouve que $q^s - 1 \mid q^k - 1$, donc $s \mid k$. L'ordre de $\mathrm{F}$ est donc \'egal \`a $s$, ainsi que l'ordre du groupe $G = \langle \mathrm{F} \rangle = \{1_{K}, \mathrm{F}, \ldots,\mathrm{F} ^{s-1}\}$.
\end{proof}


La proposition suivante montre que l'extension $F \subset K$ entre deux corps finis est galoisienne.
\begin{prop}\label{prop26}
Soient $F, K$ deux corps finis tels que $F \subset K$, et soit $\alpha \in K$. Notons $p(x) = \Pi_{\alpha,F} \in F[x]$ le polynôme minimal de $\alpha$ sur $F$, o\`u $r = \deg(p) = [F[\alpha] : F]$. Alors
\be
\item[(i)] Le polynôme $p$ est scind\'e dans $K$, i.e. $p$ est produit de facteurs lin\'eaires $x - \beta$, o\`u $\beta \in K$.
\item[(ii)] Toutes les racines du polynôme $p$ sont simples.
\ee
Ainsi $p(x) = \prod_{\beta \in S}( x- \beta) = (x- \beta_1)\ldots(x- \beta_r)$, o\`u $S = \{\beta_1,\ldots,\beta_r\} \subset K$, et les $\beta_i,\ i= 1,\ldots,r,$ sont distincts.
\end{prop}

\begin{proof} Ici $|F| = q$, et $|K| = p^s$. Notons $L = F[\alpha]$.

Comme $F \subset K$, et $\alpha \in K$, alors $F \subset L \subset K$. Alors $L$ est un corps \`a $q^r$ \'el\'ements, o\`u $r = [L : F] = \deg(p)$, et $r \mid s$.

Par cons\'equent tout \'el\'ement $\gamma \in L$ v\'erifie $\gamma^{q^r} = \gamma$. Puisque $\alpha \in L$, $\alpha$ est racine du polynôme $x^{q^r} - x \in F[x]$, donc son polynôme minimal $p(x)$ divise $x^{q^r} - x = \prod\limits_{ \beta \in L} (x - \beta)$.

Le polynôme $x^{q^r} - x$ ayant $q^r$ racines distincts dans $L \subset K$, il en va de m\^eme de son diviseur $p(x)$. Ainsi $p(x) = \prod\limits_{x \in S} (x- \beta)$, o\`u $S \subset L \subset K$, ce qui montre (i) et (ii).
\end{proof}

Nous pouvons pr\'eciser les racines de $p(x)$.

\begin{prop} En gardant les conditions de la proposition {\rm \ref{prop26}}, notons $\mathrm{F}$ le $F$-automorphisme de Frobenius de $K$. Alors
$$p(x) = \Pi_{\alpha,F}(x) = \prod_{i = 0}^{r-1} (x - \mathrm{F}^i(\alpha)) = \prod_{i = 0}^{r-1} (x - \alpha^{q^i}).$$
\end{prop}

\begin{proof}Si $q  = \sum_{i=0}^d a_i x^i\in K[x]$, notons $\mathrm{F}\cdot q =  \sum_{i=0}^d \mathrm{F}(a_i) x^i$. Si $q,r \in K[x]$, $\mathrm{F} \cdot (q +r) = (\mathrm{F}\cdot q) + (\mathrm{F}\cdot r)$ et $\mathrm{F} \cdot (q r) = (\mathrm{F}\cdot q)(\mathrm{F}\cdot r)$. Alors, en appliquant $\mathrm{F}$ au polynôme $ s = \prod_{i = 0}^{r-1} (x - \mathrm{F}^i(\alpha)) $, nous obtenons, en utilisant $\alpha^{q^r} = \alpha$, soit $\mathrm{F}^r(\alpha) = \alpha$,
\begin{align*}
\mathrm{F} \cdot s &= \mathrm{F} \left( \prod_{i = 0}^{r-1} \left(x - \mathrm{F}^i(\alpha)\right)\right)\\
 &=   \prod_{i = 0}^{r-1} \mathrm{F}\cdot (x - \mathrm{F}^i(\alpha))\\
&=  \prod_{i = 0}^{r-1} (x - \mathrm{F}^{i+1}(\alpha))\\
&= \prod_{j = 1}^{r} (x - \mathrm{F}^{j}(\alpha))\qquad (j = i+1)\\
&=(x - \mathrm{F}^r(\alpha))\prod_{j = 1}^{r-1} (x - \mathrm{F}^{j}(\alpha))\\
&= (x- \alpha) \prod_{j = 1}^{r-1} (x - \mathrm{F}^j(\alpha))\\
&=\prod_{j = 0}^{r-1} (x - \mathrm{F}^j(\alpha))\\
&= s
\end{align*}
L'\'egalit\'e $\mathrm{F} \cdot s = s$ montre que tous les coefficients de $s$ sont dans $F$, soit $s \in F[x]$. Puisque $s(\alpha) = 0$, le polynôme minimal $p$ divise $s$. Mais $p$ et $R$  sont de m\^eme degr\'e $r$, et sont normalis\'es, donc $p = r$, ce qui prouve
$$p(x) = \Pi_{\alpha,F}(x) = \prod_{i = 0}^{r-1} (x - \mathrm{F}^i(\alpha)) = \prod_{i = 0}^{r-1} (x - \alpha^{q^i}).$$

\end{proof}



\subsection{Trace et norme.}\label{trace_norme_corps_finis}
Consid\'erons encore l'extension $F \subset K$ de degr\'e $s$.

Pour chaque $\alpha \in K$, d\'efinissons l'application $m_{\alpha}$ de multiplication par $\alpha$ par
$$
m_{\alpha}
\left\{
\begin{array}{ccc}
K & \to & K\\
\gamma & \mapsto & \alpha \gamma.
\end{array}
\right.
$$
Alors $m_\alpha$ est un endomorphisme du $F$-espace vectoriel $K$.

\begin{dfn}
 $\chi_{\alpha,K/F} \in F[x]$ est le polynôme caract\'eristique de $m_\alpha$ : 

$$\chi_{\alpha,K/F}(x)= \det(x\, \mathrm{Id}_L - m_\alpha),$$
et la trace et la norme de $\alpha$ sont d\'efinis par
$$\mathrm{Tr}_{K/F}(\alpha) = \mathrm{tr}(m_\alpha),\qquad \mathrm{N}_{K/F}(\alpha) = \det(m_\alpha),$$
o\`u $\mathrm{tr}$ et $\det$, d\'efinis en alg\`ebre lin\'eaire, d\'esignent la trace et la norme d'un endomorphisme.
\end{dfn}

Cette d\'efinition montre que, pour tout $\alpha \in K$, $\mathrm{Tr}_{K/F}(\alpha)$ et $\mathrm{N}_{K/F}(\alpha) $ sont des \'el\'ements de $F$.
\begin{prop} \label{trace_corps_finis1}
\be
Si $a,b \in F$, et $\alpha,\beta \in K$,  
\item[(i)] 
$$
\mathrm{Tr}_{K/F}(a \alpha + b \beta)  = a \mathrm{Tr}_{K/F}(\alpha) + b \mathrm{Tr}_{K/F}(\beta).
$$
Autrement dit, la trace est $F$-lin\'eaire.
\item[(ii)]
\begin{align*}
\mathrm{N}_{K/F}(\alpha\beta)  &= \mathrm{N}_{K/F}(\alpha) \mathrm{N}_{K/F}(\beta),\\
\mathrm{N}_{K/F}(a \alpha) &= a^s \mathrm{N}_{K/F}(\alpha),
\end{align*}
o\`u $s = [K:F]$.
\ee
\end{prop}

\begin{proof} 
\be
\item[(i)] Notons que $m_{a\alpha + b \beta} = a m_\alpha + b m_\beta$. La lin\'earit\'e de la trace donne alors
\begin{align*}
\mathrm{Tr}_{K/F}(a \alpha + b \beta) &= \mathrm{tr}(a m_\alpha + b m_\beta)\\
&= a \, \mathrm{tr}(m_\alpha) + b\,  \mathrm{tr}(m_\beta)\\
&= a \mathrm{Tr}_{K/F}(\alpha) + b \mathrm{Tr}_{K/F}(\beta).
\end{align*}
\item[(ii)] Comme $m_{\alpha \beta} = m_\alpha \circ m_\beta$,
\begin{align*}
\mathrm{N}_{K/F}(\alpha\beta) &= \det(m_{\alpha \beta})\\
&= \det(m_\alpha \circ m_\beta)\\
&= \det(m_\alpha) \det(m_\beta)\\
&= \mathrm{N}_{K/F}(\alpha) \mathrm{N}_{K/F}(\beta).
\end{align*}
En utilisant $m_{a\alpha} = a m_\alpha$ si $a \in F$,
\begin{align*}
\mathrm{N}_{K/F}(a \alpha) &= \det(m_{a \alpha})\\
&= \det(a m_\alpha)\\
&=a^s \det(m_\alpha)\\
&= a^s \mathrm{N}_{K/F}(\alpha).
\end{align*}

\ee
\end{proof}

Si $\alpha \in K$, la relation entre le polynôme minimal $\Pi_{\alpha,F}$ et le polynôme caract\'eristique $\chi_{\alpha,K/F}$ est donn\'ee dans la proposition suivante.

\begin{prop}\label{prop29} \label{trace_corps_finis2}
Si $\alpha \in K$, alors $\chi_{\alpha,K/F} = \Pi_{\alpha,F}^r$, o\`u $r = [K:F(\alpha)]$.
\end{prop}

\begin{proof}
Notons $n = [F(\alpha) : F], r = [K : F(\alpha)]$. Si $(e_1,\ldots,e_r)$ est une base de $K$ sur $F(\alpha)$, comme $(1,\alpha,\ldots,\alpha^{n-1})$ est une base de $F(\alpha)$ sur $F$, le lemme t\'elescopique montre que
$${\cal B} = (e_1,\alpha e_1,\ldots,\alpha^{n-1}e_1,\ e_2, \alpha e_2,\ldots,\alpha ^{n-1}e_2,\  \ldots,e_r,\alpha e_r,\ldots,\alpha^{n-1}e_r)$$
est une base de $K$ sur $F$.

Les sous-espaces  $E_i = \mathrm{Vect} (e_i,\ldots,\alpha^{n-1}e_i), \ i=1,\ldots r$ sont stables pour l'endomorphisme $m_\alpha$ : en effet, si on note $P(x) = \Pi_{\alpha,K}(x) = x^n + a_{n-1}x^{n-1}+ \cdots+a_0$, alors $\alpha^n = -a_0 - \cdots - a_{n-1} \alpha^{n-1}$, et
\begin{align*}
&m_{\alpha}(\alpha^i e_j) =\alpha^{i+1} e_j \  (0 \leq i \leq n-2, 1 \leq j \leq r),\\
&m_{\alpha}(\alpha^{n-1} e_j) = \alpha^n e_j = - \sum_{k=0}^{n-1} a_k \alpha^k e_j.
\end{align*}
Donc la matrice de l'application induite par $m_\alpha$ sur $E_i$ est la matrice compagnon

$$
A = 
\begin{pmatrix}
0   & 0 &  \cdots    & 0  & -a_0\\
1  &     0      &       &              &-a_1\\ 
0 &    1        &   \ddots   &              & -a_2\\
\vdots & \ddots  &   1  &    0           & \vdots\\
0 & \cdots  &      0 &            1  &- a_{n-1}
\end{pmatrix},
$$

et 
$$M = {\cal M}_{\cal B} (m_\alpha)=
\begin{pmatrix}
A & 0  & \cdots & 0\\
0 & A  & \ddots & \vdots\\
 \vdots & \ddots    &\ddots  & 0\\
0 & \cdots  & 0 & A
\end{pmatrix}.
$$

Rappelons le calcul du polynôme caract\'eristique de la matrice compagnon $A$ :
 $$\chi_A(x) = \det (x I_n - A) = 
\begin{vmatrix}
x  & 0 &\cdots       & 0  & a_0\\
-1  &     x      &       &              &a_1\\ 
0 &    -1        &   \ddots   &              & a_2\\
\vdots & \ddots  &   -1  &    x           & \vdots\\
0 & \cdots  &      0 &            -1  & x+a_{n-1}
\end{vmatrix}
$$

Ce d\'eterminant se calcule par une relation de r\'ecurrence : posons
$$D_k =
\begin{vmatrix}
x  &  0&   \cdots   & 0  & a_0\\
-1  &     x      &       &              &a_1\\ 
0 &    -1        &   \ddots   &              & a_2\\
\vdots & \ddots  &   -1  &    x           & \vdots\\
0 & \cdots  &      0 &            -1  & a_k
\end{vmatrix}
$$

Le d\'eveloppement de $D_k$ suivant la derni\`ere ligne donne $D_k = a_k x^k + D_{k-1}$, et par r\'ecurrence $D_k = a_kx^k+a_{k-1}x^{k-1}+ \cdots+a_0$.

Ce r\'esultat, appliqu\'e \`a la matrice $x I_n - A$ donne $\det(xI_n-A) = (x+a_{n-1})x^{n-1} + D_{n-2} =  x^n+ a_{n-1} x^{n-1}+ \cdots + a_0 = P(x)$, donc
$$\det(xI_n-M) = P(x)^r.$$
Ainsi $\chi_{\alpha,K/F}= \Pi_{\alpha,F}^r$, o\`u $r = [K:F(\alpha)]$.
\end{proof}

\begin{prop}
Soit $F\subset K$ une extension de corps finis, avec $|F| = q, |K| = q^s$, et soit $\alpha \in K$.  Notons $G = \Gal(K/F)$ le groupe de Galois de $K$ sur $F$. Alors
\be
\item[(i)]  $\chi_{\alpha,K/F}(x) = \prod\limits_{\sigma\in G}(x - \sigma(\alpha)) = (x - \alpha)(x- \alpha^q)\cdots (x- \alpha^{q^{s-1}})$.
\item[(ii)] $\mathrm{Tr}_{K/F}(\alpha) = \sum\limits_{\sigma\in G} \sigma(\alpha) = \alpha + \alpha^q + \cdots + \alpha^{q^{s-1}}$.
\item[(iii)] $\mathrm{N}_{K/F}(\alpha) = \prod\limits_{\sigma\in G} \sigma(\alpha) = \alpha \cdot \alpha^q \cdot \  \cdots\   \cdot \alpha^{q^{s-1}}$.
\ee
\end{prop}

\begin{proof}
\be
\item[(i)] Partons de la factorisation dans $K[x]$ du polynôme minimal de $\alpha$ sur $F$:
$$\Pi_{\alpha,F}(x) = \prod_{i = 0}^{r-1}(x - \alpha^{q^i})   =  \prod_{i = 0}^{r-1}(x - \mathrm{F}^i(\alpha))\qquad ( r = [F[\alpha] : F],\  r \mid s).$$
Posons $e = [K : F[\alpha]]$, si bien que $s = er$. Tout entier $k \in \gcro 0, s\gcro$ s'\'ecrit, par la division euclidienne de $k$ par $r$, sous la forme $k = jr + i, \ 0 \leq i < r, \ 0 \leq j < e$. Ceci justifie les \'egalit\'es suivantes :
\begin{align*}
\prod_{\sigma\in G}(x - \sigma(\alpha)) &=  \prod_{k= 0}^{s-1}(x - \mathrm{F}^k(\alpha))\\
&= \prod_{j = 0}^{e-1} \prod_{i= 0}^{r-1} (x - \mathrm{F}^{j r + i}(\alpha))\\
&=\prod_{j = 0}^{e-1} \prod_{i= 0}^{r-1} (x - \mathrm{F}^{ i}(\alpha))\qquad (\text{car } F^r(\alpha) = \alpha)\\
&= \prod_{j = 0}^{e-1} \Pi_{\alpha,F}(x) \\
&=  \Pi_{\alpha,F}^e\\
&= \chi_{\alpha,K/F}(x), 
\end{align*}
la derni\`ere \'egalit\'e venant de la proposition \ref{prop29}. Ceci prouve (i).

\item[(ii),(iii)] Le d\'eveloppement de $\chi_{\alpha,K/F}(x) $ donne, par d\'efinition de la trace et de la norme d'un nombre alg\'ebrique :
$$\chi_{\alpha,K/F}(x) = x^n - \mathrm{Tr}_{K/F}(\alpha) x^{n-1} + \cdots + (-1)^n \mathrm{N}_{K/F}(\alpha)\quad (n = [K:F]),$$
et le d\'eveloppement de la formule de la partie (i) donne
$$\chi_{\alpha,K/F}(x) = x^n - \left(\sum\limits_{\sigma\in G} \sigma(\alpha)\right) x^{n-1} + \cdots + (-1)^n \prod\limits_{\sigma\in G} \sigma(\alpha).$$
Ainsi
$$\mathrm{Tr}_{K/F}(\alpha) = \sum\limits_{\sigma\in G} \sigma(\alpha) = \alpha + \alpha^q + \cdots + \alpha^{q^{s-1}}.$$
$$\mathrm{N}_{K/F}(\alpha) = \prod\limits_{\sigma\in G} \sigma(\alpha) = \alpha \cdot \alpha^q \cdot \  \cdots\   \cdot \alpha^{q^{s-1}}.$$
\ee
\end{proof}

Donnons quelques propri\'et\'es de la trace et de la norme.
\begin{prop}\label{trace_surjective}
\be
\item[(i)] L'application $\mathrm{Tr} = \mathrm{Tr}_{K/F} : K \to F$ est surjective.
\item[(ii)] La restriction
$$\varphi
\left\{
\begin{array}{ccl}
K^* & \to & F^*\\
\alpha & \mapsto & \mathrm{N}_{K/F}(\alpha)
\end{array}
\right.
$$
est surjective.
\ee
\end{prop}
\begin{proof}
\be 
\item[(i)]Le polynôme $p (x) = x + x^q + \cdots + x^{q^{s-1}}$, de degr\'e $q^{s-1}$, a au plus $q^{s-1}$ racines. Comme $|K| = q^s$, il existe un \'el\'ement $\alpha \in K$ tel que $p(\alpha) \ne 0$. Alors $c = \mathrm{Tr}(\alpha) = p(\alpha) \ne 0$. Si $b \in F$, alors $\mathrm{Tr}(c^{-1} b \alpha) = c^{-1} b \mathrm{Tr}(\alpha) = b$, ce qui prouve la surjectivit\'e de $\mathrm{Tr}_{K/F} : K \to F$.

\item[(ii)] Notons d'abord que $\alpha \ne 0$ entra\^ine $\mathrm{N}_{K/F}(\alpha)  = \alpha \cdot \alpha^q \cdot \  \cdots\   \cdot \alpha^{q^{s-1}} \ne 0$, ce qui montre que $\varphi$ est correctement d\'efini.


L'application $\varphi$ est un homomorphisme de groupes. Pr\'ecisons son noyau. Si $\alpha \in K$,
\begin{align*}
\alpha \in \ker(\varphi) &\iff 1 = \alpha \cdot \alpha^q\cdot \ \cdots\  \cdot \alpha^{q^{s-1}}\\
&\iff 1 = \alpha^{1+q+\cdots + q^{s-1}} = \alpha^{\frac{q^s-1}{q-1}}.
\end{align*}

Puisque $\frac{q^s-1}{q-1}$ divise $q^s - 1 = |K|$, la proposition \ref{nbsols} du chapitre ``Sommes de Gauss et somme de Jacobi'' montre que l'\'equation $ \alpha^{\frac{q^s-1}{q-1}} = 1$ a exactement $\frac{q^s-1}{q-1} = (\frac{q^s-1}{q-1}) \wedge (q^s - 1)$ solutions. Ainsi
$$|\ker(\varphi)| = \frac{q^s-1}{q-1}.$$
Le premier th\'eor\`eme d'isomorphisme donne alors $|\mathrm{im}(\varphi)| = |K^*|/ |\ker(\varphi)| = q-1$. Ainsi $|\mathrm{im}(\varphi)|  =|F^*|$, avec $\mathrm{im}(\varphi) \subset F^*$, donc $\mathrm{im}(\varphi) = F^*$, ce qui prouve que l'application $\varphi$ est surjective.
\ee
\end{proof}

\begin{prop}
Soient $F \subset E \subset K$ trois corps finis, et $\alpha \in K$. Alors
\be
\item[(i)] $\mathrm{Tr}_{K/F}(\alpha) = \mathrm{Tr}_{E/F}(\mathrm{Tr}_{K/E}(\alpha))$,
\item[(ii)] $\mathrm{N}_{K/F}(\alpha) = \mathrm{N}_{E/F}(\mathrm{N}_{K/E}(\alpha))$.
\ee
\end{prop}

\begin{proof}
Posons $d = [E:F], m = [K:E]$, et $n = [K:F]$. Alors $n = dm$. Si $q = |F|$, alors $q_1 = |E| = q^d$ et $|K| = q^n$. De plus
$$\mathrm{Tr}_{K/E}(\alpha) = \alpha + \alpha^{q_1}+ \cdots + \alpha^{q_1^{m-1}}.$$

Alors
\begin{align*}
\mathrm{Tr}_{E/F}(\mathrm{Tr}_{K/E}(\alpha)) &=\sum_{i=0}^d \mathrm{Tr}_{K/E}(\alpha)^{q^i}\\
&=\sum_{i=0}^d \sum_{j=0}^{m-1} \alpha^{q_1^j q^i}\\
&=\sum_{i=0}^d \sum_{j=0}^{m-1} \alpha^{q^{dj+i}}\\
&= \sum_{k=0}^{n-1} \alpha^{q^k}\\
&= \mathrm{Tr}_{K/F}(\alpha).
\end{align*}
Nous avons utilis\'e le fait que tout entier $k \in \gcro 0,n \gcro$ s'\'ecrit de façon unique sous la forme $k = dj + i, 0\leq i < d, 0 \leq j < m$.

En remplaçant les sommes par des produits, nous obtenons la m\^eme d\'emonstration pour les normes.
\end{proof}

La connaissance du polynôme minimal de $\alpha \in K$ suffit pour calculer sa trace et sa norme sur $F$. Pr\'ecisons.


\begin{prop}
Soit $F \subset K$ une extension de corps finis, et soit $\alpha \in K$, et $E = F[\alpha]$. Notons $n = [K : F], d = [E:F]$, et
$$f(x) = x^d -c_1 x^{d-1}+ \cdots + (-1)^d c_d$$
le polynôme minimal de $\alpha$ sur $F$. Alors
\be
\item[(i)] $\mathrm{Tr}_{K/F}(\alpha) = \frac{n}{d} c_1,$
\item[(ii)] $\mathrm{N}_{K/F}(\alpha) = c_d ^{n/d}.$
\ee

\end{prop}
\begin{proof} Notons $e = n/d$. La proposition \ref{prop29} donne $\chi_{\alpha,K/F}(x) = f(x)^e$, o\`u $\chi_{\alpha,K/F}(x) $ est le polynôme caract\'eristique de $\alpha \in K$ sur $F$.
Alors
\begin{align*}
\chi_{\alpha,K/F}(x) &=(x^d -c_1 x^{d-1}+ \cdots + (-1)^d c_d)^e\\
&=x^n -ec_1x^{n-1} + \cdots + (-1)^{n} c_d^e.
\end{align*}
La comparaison avec
$$\chi_{\alpha,K/F}(x) = x^n - \mathrm{Tr}_{K/F}(\alpha) x^{n-1} + \cdots + (-1)^n \mathrm{N}_{K/F}(\alpha)$$
montre que $\mathrm{Tr}_{K/F}(\alpha) = ec_1, \mathrm{N}(\alpha) = c_d^e$, ce qu'il fallait prouver.
\end{proof}








\section{Caract\`eres multiplicatifs.}\label{caracteres}
Soit $q = p^s$ une puissance d'un nombre premier $p$, et $\F_q$ un corps de cardinal $q$.

Un caract\`ere multiplicatif sur $\F_q^*$ est un homomorphisme de groupe $\chi$ du groupe multiplicatif $\F_q^*$ dans le groupe $\C^*$. Il v\'erifie ainsi, pour tous les \'el\'ements $a,b$ de $\F_q^*$, la relation
$$\chi(ab) = \chi(a) \chi(b).$$

{\bf Exemple 1.} Nous savons que pour tout $a \in \Z$, pour tout $b \in \Z$, $a \equiv b \pmod p$ entra\^ine $\legendre{a}{p} = \legendre{b}{p}$, et aussi $\legendre{ab}{p} = \legendre{a}{p}\legendre{b}{p}$. L'application 
$$
\chi
\left \{
\begin{array}{ccc}
\F_p^* &\to &\C^*\\
{[}a{]}_p & \mapsto &\legendre{a}{p}
\end{array}
\right.
$$
est donc bien d\'efinie, et c'est un caract\`ere sur $\F_p^*$.

\medskip
{\bf Exemple 2.} L'application $\varepsilon$ d\'efinie pour tout $a \in \F_q^*$ par $\varepsilon(a) = 1$ est un caract\`ere.

\medskip
Il est commode de prolonger ces applications sur $\F_q$ tout entier en posant $\chi(0) = 0$ si $\chi \ne \varepsilon$, et $\varepsilon(0) = 1$. Nous dirons alors que $\chi$ est un caract\`ere sur $\F_q$.

Un caract\`ere \'etant d'abord un homomorphisme de groupes, il v\'erifie donc

\be
\item[(a)] $\chi(1) = 1$,
\item[(b)] $\chi(a^{-1}) = \chi(a)^{-1}$, pour tout $a \in \F_q^*$.
\ee

De plus, tout caract\`ere v\'erifie la proposition suivante. 
\begin{prop}
Soit $\chi$ un caract\`ere sur $\F_q^*$.

Pour tout $a\in \F_q^*$, $\chi(a)$ est une racine $q-1$-i\`eme de l'unit\'e.
\end{prop}
\begin{proof}
Soit $a \in \F_q^*$. Alors $a^{q-1} = 1$, donc $\chi(a)^{q-1} = \chi(a^{q-1}) = \chi(1) = 1.$
\end{proof}
Le caract\`ere $\chi$ induit donc un homomorphisme de $\F_q^*$ sur le groupe $\U_{q-1} \subset \U$ des racines $(q-1)$-i\`emes de l'unit\'e.

Si $z \in \U$, alors $|z| = 1$, donc $z^{-1} = \overline{z}$, et ainsi
$$\chi(a^{-1}) = \overline{\chi(a)}.$$

\begin{prop}\label{somme_chi}
Soit $\chi$ un caract\`ere multiplicatif sur $\F_q$. 
\be
\item[(a)] Si $\chi \ne \varepsilon$, alors $\sum\limits_{t\in \F_q} \chi(t) = 0$.
\item[(b)] Si $\chi = \varepsilon$, alors $\sum\limits_{t\in \F_q} \varepsilon(t) = q$.
\ee
\end{prop}
\begin{proof}
\be
\item[(a)] Comme $\chi \ne \varepsilon$, il existe $a \in \F_q^*$ tel que $\chi(a) \ne 1$. 

Posons $S = \sum\limits_{t\in \F_q} \chi(t).$ Alors, puisque l'application $t \mapsto at$ est une permutation des \'el\'ements de $\F_q^*$,
\begin{align*}
\chi(a) S &= \sum_{t \in \F_q} \chi(a) \chi(t)\\
&= \sum_{t \in \F_q} \chi(at) \\
&=  \sum_{s \in \F_q} \chi(s) \qquad (s =at)\\
&= S
\end{align*}
Ainsi $(\chi(a) - 1) S = 0$, o\`u $\chi(a) \ne 1$, donc $S = 0$.
\item[(b)] Si $\chi = \varepsilon$, alors $\sum\limits_{t\in \F_q} \varepsilon(t) = \sum\limits_{t\in \F_q} 1 = |\F_q| = q.$
\ee
\end{proof}

L'ensemble des caract\`eres sur $\F_q^*$ est l'ensemble $\mathrm{Hom}(\F_q^*, \C^*)$. Il forme donc un groupe pour la loi $(\chi, \lambda) \mapsto \chi \lambda$, o\`u $\chi \lambda$ est d\'efini par
$$(\chi \lambda)(a) = \chi(a) \lambda(a), \text{ pour tout }a \in \F_p^*.$$
Remarquons que cette relation reste vraie si $a = 0$.

L'\'el\'ement neutre est $\varepsilon$, et le sym\'etrique d'un caract\`ere $\chi$ dans ce groupe est le caract\`ere $\chi^{-1}$ v\'erifiant, pour tout $a \in \F_q^*$, $\chi^{-1}(a) = (\chi(a))^{-1}$.

Notons maintenant $C = \mathrm{Hom}(\F_q^*, \C^*)$ le groupe des caract\`eres sur $\F_q^*$.

\begin{prop}\label{cyclique}
Le groupe $C$ des caract\`eres sur $\F_q^*$ est un groupe cyclique d'ordre $q-1$.
\end{prop}
\begin{proof}
Nous savons que $\F_q^*$ est cyclique. Soit $g$ un g\'en\'erateur de ce groupe, si bien que tout $a \in \F_q^*$ est une puissance de $g$.

$\chi$ est enti\`erement d\'etermin\'e par la valeur de $\chi(g)$ : si $a \in \F_q^*$, alors $a = g^l, \ l\in \N$, donc $\chi(a) = \chi(g)^l$. Comme $\chi(g) \in \U_{q-1}$, o\`u $|\U_{q-1}| = q-1$, il existe au plus $q-1$ caract\`eres, soit $|C| \leq q-1$.

Il existe un (et un seul) caract\`ere $\lambda$ tel que $\lambda(g) = e^{2i \frac{\pi}{q-1}}$. En effet, l'application $\lambda$ telle que $\lambda(g^k) = e^{2i k\frac{\pi}{q-1}}$ est bien d\'efinie, et c'est un caract\`ere :
\be
\item[$\bullet$] si $a = g^k = g^l$, alors $k \equiv l \pmod{q-1}$, soit $ l = k +s (q-1), s \in \Z$, donc 
$$ e^{2i l \frac{\pi}{q-1}} = e^{2i (k + s(q-1))\frac{\pi}{q-1}} =e^{2i k \frac{\pi}{q-1}}  e^{2i \pi s } = e^{2i k \frac{\pi}{q-1}},$$
\item[$\bullet$] si $a, b \in \F_q^*$, il existe des entiers $k,l$ tels que $a =g^k, b = g^l$, et
$$\lambda(ab ) = \lambda(g^{k+l}) =  e^{2i (k+l) \frac{\pi}{q-1}} =  e^{2i k\frac{\pi}{q-1}}  e^{2i l\frac{\pi}{q-1}} = \lambda(a) \lambda(b).$$
\ee

Montrons que $\lambda$ est d'ordre $q-1$ dans le groupe des caract\`eres. D'abord, pour tout $a = g^k \in \F_q^*$, $\lambda^{q-1}(a) = e^{2ik\pi} = 1$, donc $\lambda^{q-1} = \varepsilon$. 

Inversement, si $\lambda^n = \varepsilon$, alors $\lambda^n(g) = \varepsilon(g) = 1$, donc $\lambda(g^n) = 1$, soit $e^{2i n\frac{\pi}{q-1}} = 1$, ce qui impose $\frac{n}{q-1} \in \Z$, donc $q-1 \mid n$. 

Ceci prouve que l'ordre de $\lambda$ est $q-1$, et donc $|C| \geq q-1$. Ainsi $|C| =q-1$ , et $\lambda$ est un g\'en\'erateur de ce groupe.
\end{proof}
Retenons l'expression d'un tel g\'en\'erateur. Nous avons prouv\'e la proposition suivante.

\begin{prop}\label{generator}
Si $g$ est un g\'en\'erateur de $\F_q^*$, il existe un et un seul caract\`ere $\lambda$ tel que $\lambda(g) =  e^{2i \frac{\pi}{q-1}}$, et $\lambda$ est un g\'en\'erateur du groupe des caract\`eres $C$.
\end{prop}

A titre de corollaire de la proposition~\ref{cyclique}, nous avons le r\'esultat suivant.
\begin{prop}\label{ordre_n}
Si $n$ divise $q-1$, alors il existe exactement $n$ caract\`eres $\chi$ v\'erifiant $\chi^n = \varepsilon$.

Ces caract\`eres forment un sous-groupe $C_n$ de $C$, cyclique et d'ordre $n$.
\end{prop}

\begin{proof}
Ceci est une cons\'equence du fait que $C$ est cyclique. Rappelons une d\'emonstration de ce fait. 

Si $\lambda$ est un g\'en\'erateur de $C$, d'ordre $q-1$, alors tout caract\`ere $\chi$ est de la forme $\chi = \lambda^k, k \in \Z$, donc $\chi^n = \varepsilon$ \'equivaut \`a $\lambda^{kn} = \varepsilon$, soit $q-1 \mid kn$, ou encore $\frac{q-1}{n} \mid k$. Les solutions de $\chi^n = 1$ sont donc de la forme $\lambda^{j\frac{q-1}{n}}$, o\`u on peut prendre $0 \leq j < n$, puisque $\lambda^{(j+n) \frac{q-1}{n}} = \lambda^{j\frac{q-1}{n}}$.


L'ensemble des solutions de $\chi^n = \varepsilon$ est donc  donc l'ensemble $$C_n = \{\varepsilon, \lambda^{\frac{q-1}{n}}, \lambda^{2\frac{q-1}{n}}, \ldots,  \lambda^{(n-1)\frac{q-1}{n}}\},$$ et ces solutions sont distinctes, puisque $\lambda^{j\frac{q-1}{n}} = \lambda^{l\frac{q-1}{n}}$, o\`u $0\leq j<n, 0 \leq l < n$,  implique $\lambda^{(j- l)\frac{q-1}{n}} = 1$, donc $q-1 \mid (j- l)\frac{q-1}{n}$, soit $n \mid j-l$, o\`u $|j-l|<n$, donc $j = l$. Ainsi $|C_n| = n$, et $C_n$ est cyclique, engendr\'e par $\lambda^{\frac{q-1}{n}}$.


\end{proof}

Nous pouvons pr\'eciser la condition pour qu'existent des caract\`eres d'ordre $n$.
\begin{prop}\label{existence_caractere}
Il existe un caract\`ere d'ordre $n$ sur $\F_q$ si et seulement si $q\equiv 1 \pmod n$.
\end{prop}
\begin{proof}
Supposons que $q\equiv 1 \pmod n$. La proposition~\ref{ordre_n} montre que $C_n$ est cyclique d'ordre $n$, donc admet un g\'en\'erateur d'ordre $n$, qui est dans $C$. 

R\'eciproquement, s'il existe un caract\`ere $\chi$ d'ordre $n$, alors le sous-groupe engendr\'e par $\chi$ est d'ordre $n$, et le th\'eor\`eme de Lagrange montre que $n \mid q-1$.
\end{proof}

La proposition suivante sert de lemme  \`a la proposition~\ref{somme_nulle}.
\begin{prop}
Si $a \in \F_q^*$, et $a \ne 1$, alors il existe un caract\`ere $\lambda$ sur $\F_q$ tel que $\lambda(a) \ne 1$.
\end{prop}
\begin{proof}
Soit $g$ un g\'en\'erateur de $\F_q^*$, et $\lambda$ le caract\`ere d\'efini dans la proposition~\ref{generator}. Puisque $a \in \F_q^*$, il existe un entier $k$ tel que $a = g^k$, et comme $a \ne 1$, $q-1 \nmid k$.

Alors $\lambda(a) = \lambda(g^k) = e^{2i k\frac{\pi}{q-1}} \ne 1$, puisque $\frac{k}{q-1} \not \in \Z$.
\end{proof}

\begin{prop}\label{somme_nulle}
Si $a \in \F_q^*$, et $a \ne 1$, alors $\sum\limits_{\chi \in C} \chi(a) = 0$.
\end{prop}

\begin{proof}
D'apr\`es le lemme pr\'ec\'edent, il existe un caract\`ere $\lambda$ tel que $\lambda(a) \ne 1$. Soit $S = \sum\limits_{\chi \in C} \chi(a)$. Alors, puisque l'application $\chi \mapsto \lambda \chi$ est une bijection de $C$ sur $C$,
\begin{align*}
\lambda(a) S &=   \sum_{\chi \in C} \lambda(a) \chi(a)\\
&= \sum_{\chi \in C} (\lambda \chi)(a) \\
&= \sum_{\mu \in C} \mu(a)\qquad (\mu = \lambda \chi)\\
&= S.
\end{align*}
Puisque $\lambda(a) \ne 1$, nous en concluons que $S = 0$.
\end{proof}

Les caract\`eres sont utiles pour conna\^itre le nombre de solutions de l'\'equation $x^n = a$ dans $\F_q$, comme nous allons le voir dans les trois propositions suivantes.

\begin{prop}
Si $a \in \F_q^*$, $n \mid q-1$ et $x^n = a$ n'est pas r\'esoluble dans $\F_q$, alors il existe un caract\`ere $\chi$ tel que
\be
\item[(a)] $\chi^n =\varepsilon.$
\item[(b)] $\chi(a) \ne 1.$
\ee
\end{prop}
(Notons que la r\'eciproque est vraie : en supposant (a), si $x^n = a,\ x \in \F_q^*$, alors $\chi(a) = \chi(x^n) = (\chi(x))^n = \chi^n(x) = \varepsilon(x) = 1$, donc (a) et (b) impliquent l'impossibilit\'e de l'\'egalit\'e $x^n = a$ dans $\F_q$.)

\begin{proof}
Soit $g$ un g\'en\'erateur de $\F_q^*$, et $\lambda$ le g\'en\'erateur de $C$ associ\'e, donn\'e par la proposition~\ref{generator} : l'ordre de $\lambda$ est donc $q-1$. En utilisant $n \mid q-1$, d\'efinissons $\chi = \lambda^{\frac{q-1}{n}}$. Alors $\chi^n = \lambda^{q-1} = \varepsilon$, et ainsi (a) est v\'erifi\'e.

Il existe un entier $l$ tel que $a = g^l$. En raisonnant par l'absurde, si $n \mid l$, alors $l = kn,\ k \in \Z$, donc $(g^k)^n = g^l = a$, et l'\'equation $x^n = a$ admettrait une solution $x = g^k$. Par cons\'equent, $n \nmid l$.

$$\chi(g)  = \lambda^{\frac{q-1}{n}}(g) = \lambda(g)^{\frac{q-1}{n}} = \left( e^{2i\frac{\pi}{q-1}}\right)^{\frac{q-1}{n}} = e^{2i \frac{\pi}{n}},$$ donc

$$\chi(a) = \chi(g^l) = e^{2i\pi \frac{l}{n}}, $$
o\`u $n \nmid l$, donc $\chi(a) \ne 1$, et (b) est v\'erifi\'e.
\end{proof}

Si $a \in \F_q$, Notons $N(x^n =a)$ le nombre de solutions de l'\'equation $x^n = a$ dans $\F_q$.

A titre d'exemple, supposons que  $q=p$ est premier. V\'erifions alors que $N(x^2 =a) = 1 + \legendre{a}{p}$, en faisant trois cas : si $a$ est un carr\'e de $\F_p^*$, alors $\legendre{a}{p} = 1$, et $N(x^2 = a) = 2 =  1 + \legendre{a}{p}$, et dans le cas contraire $\legendre{a}{p} = -1$, donc $N(x^2 = a) = 0 = 1 + \legendre{a}{p}$. Enfin, si $a=0$, $1 + \legendre{a}{p} = 1 = N(x^2 = 0)$.

Comme $\varepsilon$ et le caract\`ere de Legendre sont les seuls caract\`eres dont l'ordre divise 2, on peut encore \'ecrire cette formule sous la forme
$$N(x^2 = a) = \sum_{\chi^2 = \varepsilon} \chi(a).$$

G\'en\'eralisons cette formule.

\begin{prop}\label{nbRacs}
Si $n \mid q-1$, et $a \in \F_q$,
$$N(x^n =a) = \sum_{\chi^n = \varepsilon} \chi(a).$$
\end{prop}

\begin{proof}
La somme de l'\'enonc\'e s'effectue sur le groupe $C_n$ des caract\`eres $\chi$ tel que $\chi^n = \varepsilon$, ce qui revient \`a dire que l'ordre de $\chi$ divise $n$. Comme $n$ divise $|C| = q-1$, la proposition ~\ref{ordre_n} montre que $|C_n| = n$ : il existe exactement $n$ tels caract\`eres. 

\be
\item[$\bullet$] Si $a = 0$, $ \varepsilon(0) = 1$, et $\chi(0) = 0$ si $\chi \ne \varepsilon$, donc $\sum\limits_{\chi^n = \varepsilon} \chi(a) = 1 = N(x^n=a)$.

\item[$\bullet$]Si $a \ne 0$, et si de plus $x^n =a$ est r\'esoluble, alors il existe un \'el\'ement $b \in \F_p^*$ tel que $b^n = a$. Si $\chi^n =\varepsilon$, alors $\chi(a) = \chi(b^n) = \chi(b)^n = \chi^n(b) = \varepsilon(b) = 1$. Ainsi $\sum\limits_{\chi^n= \varepsilon} \chi(a) =|C_n| =  n$. Comme $n \mid q-1$, alors $d = n \wedge (q-1) = n$ est d'apr\`es la proposition~\ref{nbsols} le nombre de solutions de l'\'equation $x^n =a$. Dans ce cas $$\sum\limits_{\chi^n = \varepsilon} \chi(a)= n = N(x^n=a).$$

\item[$\bullet$]Si $a \ne 0$ et si $x^n =a$ n'est pas r\'esoluble, alors nous devons prouver $\sum\limits_{\chi^n = \varepsilon} \chi(a) = 0$. Notons $S = \sum\limits_{\chi^n = \varepsilon} \chi(a) $. D'apr\`es la proposition pr\'ec\'edente, il existe un caract\`ere $\rho$ tel que $\rho^n = \varepsilon$ et $\rho(a) \ne 1$. 

Comme l'application $\chi \mapsto \rho \chi$ est une permutation de $C_n$,
\begin{align*}
\rho(a) S &= \sum_{\chi^n = \varepsilon} \rho(a) \chi(a)\\
&=  \sum_{\chi^n = \varepsilon} (\rho \chi)(a) \\
&=  \sum_{\mu^n = \varepsilon} \mu(a) \qquad (\mu = \rho \chi)\\
&= S
\end{align*}
Puisque $\rho(a) \ne 1$, $S = 0$.
\ee
\end{proof}

Remarque : si $\chi$ est un caract\`ere d'ordre $n$, il engendre le sous-groupe $C_n$ de $C$ des caract\`eres dont l'ordre divise $n$, et donc la formule pr\'ec\'edente peut s'\'ecrire
$$N(x^n =a) = \sum_{i=0}^{n-1} \chi^i(a).$$

Si on oublie l'hypoth\`ese $n\mid q-1$, nous obtenons :
\begin{prop}\label{pgcd}
Soit $q = p^s$ une puissance d'un nombre premier, et $d = n \wedge (q-1)$. Si $a \in \F_q$, alors
\be
\item[(a)] $$N(x^n = a) = N(x^d=a).$$
\item[(b)] $$N(x^n = a) = \sum_{\chi^d = \varepsilon} \chi(a).$$
\ee
\end{prop}
\begin{proof}
Soit $d$ le pgcd de $n$ et $p-1$.
\be
\item[(a)]
   \be
   \item[$\bullet$] Si $a = 0$, $0$ est la seule solution des \'equations $x^m = a$ ou $x^d = a$, donc $N(x^n=a) = N(x^d = a) = 1$.
   \item[$\bullet$] Si $a\in \F_q^*$ et si $x^n = a$ a une solution, d'apr\`es la proposition~\ref{nbsols}(b), le nombre de solutions de $x^n = a$ est $n \wedge (q-1) = d$, et le nombre de solutions de $x^d = a$ est $d \wedge (q-1) = d$. Ainsi $N(x^n =a) = N(x^d=a) = d$.
   \item[$\bullet$] Si $a\in \F_q^*$ et si $x^n = a$ n'a pas de solution, alors la proposition 1(a) montre que $a^{\frac{q-1}{d}} \ne 1$. Comme $d = d \wedge (q-1)$, la m\^eme proposition montre que $x^d = a$ n'a pas de solution. Ainsi $N(x^n =a) = N(x^d =a) =0$.
   \ee
\item[(b)] Comme $d \mid q-1$, la proposition pr\'ec\'edente donne
$$N(x^n = a) = N(x^d =a) = \sum_{\chi^d = \varepsilon} \chi(a).$$
\ee
\end{proof}


\begin{prop}\label{existence_racine}
Supposons que $q \equiv 1 \pmod n$. Soit $\chi$ un caract\`ere d'ordre $n$ sur $\F_q^*$, et $a \in \F_q^*$. Alors
$$\exists x \in \F_q^*,\ x^n = a \iff \chi(a) = 1.$$
\end{prop}
\begin{proof}
La proposition~\ref{existence_caractere} montre que l'existence d'un tel caract\`ere $\chi$ sur $\F_q^*$ \'equivaut \`a $q\equiv 1 \pmod n$.

($\Rightarrow$) Si $x^n = a$, o\`u $x \in \F_q^*$, alors $\chi(a) = \chi(x^n)=\chi(x)^n =\chi^n(x) = \varepsilon(x) = 1$.

($\Leftarrow$) Supposons $\chi(a) = 1$. Soit $g$ un g\'en\'erateur de $\F_q^*$. Alors il existe un entier $l$ tel que $a = g^l$. Notons $\lambda$ le g\'en\'erateur (d'ordre $q-1$) du groupe des caract\`eres donn\'e par la proposition~\ref{existence_caractere}, caract\'eris\'e par $\lambda(g) = e^{\frac{2i\pi}{q-1}}$. Alors $\chi = \lambda^k$ pour un certain entier $k$.

Rappelons que l'ordre de $\lambda^k$ est donn\'e par
$$\mathrm{ord}(\lambda^k) = \frac{q-1}{(q-1) \wedge k}.$$
En effet, notons $d = (q-1) \wedge k$. Alors $\frac{q-1}{d} \wedge \frac{k}{d}= 1$. Pour tout $m \in \Z$,
$$\left(\lambda^k\right)^m = 1 \iff q-1 \mid km \iff \frac{q-1}{d} \mid \frac{k}{d} m \iff \frac{q-1}{d} \mid m.$$
Ainsi $n = \mathrm{ord}(\chi) = \frac{q-1}{d}$, o\`u $d = (q-1) \wedge k$. Par cons\'equent, en utilisant $\frac{q-1}{d} \wedge \frac{k}{d} = 1$,
\begin{align*}
\chi(a) = 1 & \iff \lambda^k(a) = 1\\
&\iff e^{\frac{2i\pi k l}{q-1}} = 1\\
&\iff q-1 \mid kl\\
&\iff \frac{q-1}{d} \mid \frac{k}{d} l\\
&\iff \frac{q-1}{d} \mid l\\
& \iff n \mid l
\end{align*}
L'hypoth\`ese $\chi(a) = 1$ montre donc que $l = q n$, pour un certain entier $q$, et donc $a = g^l = (g^q)^n$. Si on pose $x= g^q \in \F_q^*$, alors $a = x^n$ est bien une puissance $n$-i\`eme dans $\F_q^*$.
\end{proof}



\section{Sommes de Gauss.}
D\'efinissons d'abord la somme de Gauss associ\'ee \`a un caract\`ere $\chi$ sur $\F_p$, o\`u $p$ est premier.  Notons $\zeta = e^{\frac{2i\pi}{p}}$, et posons, pour $a \in \F_p$, 
\begin{align}\label{defGauss}
g_a(\chi) = \sum_{t \in \F_p} \chi(t) \zeta^{at}.
\end{align}
($\zeta^{u}$ a bien un sens si $u \in \F_p$ : en effet, si $a,b \in \Z$ sont des repr\'esentants de $u \in \F_p$, alors $b = a + k p,\ k \in \Z$, donc $\zeta^{b} = \zeta^a (\zeta^p)^k = \zeta^a$.)

$g_a(\chi)$ s'appelle la somme de Gauss sur $\F_p$, relative au caract\`ere $\chi$.

Par exemple, si $\chi$ est le caract\`ere quadratique relatif au nombre premier $p$,  $g_a(\chi) = \sum\limits_{t \in \F_p}\legendre{t}{p} \zeta^{at}$. Ce sont ces sommes de Gauss que nous avions utilis\'ees dans la preuve du th\'eor\`eme de r\'eciprocit\'e quadratique.

G\'en\'eralisons maintenant les sommes de Gauss aux caract\`eres $\chi$ sur $\F_q$, o\`u $q = p^n$ est une puissance du nombre premier $p$. \`A cette fin, notons que l'application $\psi : \F_p \to \C^*$ d\'efinie par $\psi(\alpha) = \zeta_p^\alpha$ v\'erifie $\psi(\alpha + \beta) = \psi(\alpha)\psi(\beta)$, et donc $\psi : \F_p \to \C^*$ est un homomorphisme de groupes, du groupe $(\F_p,+)$ dans $(\C^*,\times)$.

Recherchons maintenant les homomorphismes de $\F_q$ dans $\C^*$.

\begin{prop}\label{homomorphisme_psi}
Soit $\psi : \F_q \to \C^*$, o\`u $q =p^n$, $p$ premier.  

Alors $\psi$ est un homomorphisme de $(\F_q,+)$ dans $(\C^*,\times)$ si et seulement s'il existe $\gamma \in \F_q$ tel que
\begin{align}\label{homomorphisme}
\forall x \in \F_q,\ \psi(x) = \zeta^{\mathrm{tr}(\gamma x)},
\end{align}
o\`u $\zeta = e^{\frac{2i\pi}{p}}$, et $\mathrm{tr}(x) = \mathrm{Tr}_{\F_q/\F_p}(x)\ (x \in \F_q)$.
\end{prop}

\begin{proof}
Soit $\psi$ est un homomorphisme de $(\F_q,+)$ dans $(\C^*,\times)$. Alors $\psi(0) = 1$, et $\psi(a \alpha) = \psi(\alpha)^a$, pour tout $\alpha \in \F_q$ et tout $a \in \Z$.

Soit $(\omega_1,\ldots,\omega_n)$ une base de $\F_q = \F_{p^n}$ sur $\F_p$. La caract\'eristique du corps $\F_q$ \'etant \'egale \`a $p$,
$$\psi(\omega_k)^p = \psi(p \omega_k) = \psi(0) = 1\qquad (1\leq k \leq n).$$
Ainsi $\psi(\omega_k)$ est une racine $p$-i\`eme de l'unit\'e, de la forme
\begin{align}\label{psi}
\psi(\omega_k) &= \zeta^{c_k},\qquad c_k\in \{0,,\ldots,p-1\}.
\end{align}
Puisque $\zeta^{c_k} = \zeta^{c_k + lp}$, on peut donner un sens \`a $\zeta^{[c_k]}$, o\`u $[c_k]$ est la classe de $c_k$ modulo $p$. Alors $\psi(\omega_k) = \zeta^{[c_k]}$.

Consid\'erons l'application
$$
\varphi
\left\{
\begin{array}{ccl}
\F_q & \to & (\F_p)^n\\
\alpha & \mapsto & (\mathrm{tr}(\alpha \omega_1),\ldots, \mathrm{tr}(\alpha \omega_n)).
\end{array}
\right.
$$
o\`u $\mathrm{tr}$ d\'esigne l'application $\mathrm{Tr}_{\F_q/\F_p}$.

Montrons que l'application $\F_p$-lin\'eaire $\varphi$ est bijective.

Si $\alpha \in \ker(\varphi)$, alors $\mathrm{tr}(\alpha \omega_1) =\ldots =  \mathrm{tr}(\alpha \omega_n) = 0$. Si $y$ est un \'el\'ement arbitraire de $\F_q$, alors $y = b_1\omega_1 + \cdots + b_n \omega_n$, o\`u $b_1,\ldots,b_n \in \F_p$. Alors $\mathrm{tr}(\alpha y) = b_1 \mathrm{tr}(\alpha \omega_1)+ \cdots + b_n\mathrm{tr}(\alpha \omega_n) = 0$, ce qui donne
$$\forall y \in \F_q,\ \mathrm{tr}(\alpha y) = 0.$$
En raisonnant par l'absurde, supposons que $\alpha \ne 0$. Puisque l'application $\mathrm{tr} = \mathrm{Tr}_{\F_q/\F_p} : \F_q \to \F_p$ est surjective (Proposition~\ref{trace_surjective}), il existe un \'el\'ement $\delta \in \F_q$ tel que $\mathrm{\delta} = 1$. Pour $y = \delta \alpha^{-1}$, alors $0 = \mathrm{tr}(\alpha y) = \mathrm{tr}(\delta) = 1$. C'est une contradiction, donc $\alpha = 0$. Ceci montre que $\ker(\varphi) = \{0\}$.

De plus $\dim_{\F_p}(\F_q) = \dim_{\F_p} (\F_p)^n = n$, donc $\varphi$ est une bijection. La surjectivit\'e de $\varphi$ montre qu'il existe $\gamma \in \F_q$ tel que
\begin{align}\label{psi2}
\mathrm{tr}(\gamma \omega_k )= [c_k],\qquad k= 1,\ldots,n.
\end{align}
Si $x$ est un \'el\'ement arbitraire de $\F_q$, nous pouvons \'ecrire $x$ sous la forme $x = a_1 \omega_1 + \cdots + a_n \omega_n$, o\`u $a_1,\ldots,a_k \in \F_p$. En utilisant les \'egalit\'es (\ref{psi}) et (\ref{psi2}), nous obtenons 
\begin{align*}
\psi(x) &= \psi( a_1 \omega_1 + \cdots + a_n \omega_n)\\
&=\psi(\omega_1)^{a_1} \cdots \psi(\omega_n)^{a_n}\\
&=\zeta^{a_1 \mathrm{tr}(\gamma \omega_1) + \cdots + a_n \mathrm{tr}(\gamma\omega_n)}\\
&=\zeta^{\mathrm{tr}(\gamma x)}.
\end{align*}
R\'eciproquement, v\'erifions que, $\gamma \in \F_q$ \'etant donn\'e, l'application $\psi : \F_q \to \C^*$ d\'efini par $\psi(x) = \zeta^{\mathrm{tr}(\gamma x)}$ est bien un homomorphisme de groupes.

Si $x,y \in \F_q$, alors
$$\psi(x+y) = \zeta^{\mathrm{tr}(\gamma(x+y))} = \zeta^{\mathrm{tr}(\gamma x) + \mathrm{tr}(\gamma x)}  = \zeta^{\mathrm{tr}(\gamma x)}\zeta^{\mathrm{tr}(\gamma y)} = \psi(x) \psi(y).$$
\end{proof}
Notons maintenant $\psi$ l'homomorphisme d\'efini par $\psi(x) = \zeta^{\mathrm{tr}(x)},\ x \in \F_q$. Donnons quelques propri\'et\'es de $\psi$.

\begin{prop}\label{proprietes_psi}
L'application $\psi : \F_q \to \C^*$ d\'efinie par $\psi(x) = \zeta^{\mathrm{tr}(x)}$ v\'erifie
\be
\item[(a)] $\psi(\alpha + \beta) = \psi(\alpha) \psi(\beta)\ (\alpha, \beta \in \F_q)$.
\item[(b)]  Il existe un $\alpha \in \F_q$ tel que $\psi(\alpha) \ne 1$.
\item[(c)] $\sum\limits_{\alpha \in \F_q} \psi(\alpha) = 0.$
\ee
\end{prop}
\begin{proof}
\item[(a)] Cette relation a \'et\'e prouv\'ee dans la proposition~\ref{homomorphisme_psi}.
\item[(b)] L'application $\mathrm{tr} = \mathrm{Tr}_{\F_q/\F_p} : \F_q \to \F_p$ est surjective (Proposition~\ref{trace_surjective}). Par cons\'equent, il existe $\alpha \in \F_q$ tel que $\mathrm{tr}(\alpha) = 1$. Alors $\psi(\alpha) = \zeta \ne 1$.
\item[(c)] Soit $S = \sum\limits_{\alpha \in \F_q} \psi(\alpha) $, et $\beta \in \F_q$ tel que $\psi(\beta) \ne 1$. Alors
$$\psi(\beta) S = \sum_{\alpha \in \F_q} \psi(\beta) \psi(\alpha) =  \sum_{\alpha \in \F_q} \psi(\beta + \alpha) = \sum\limits_{\gamma \in \F_q} \psi(\gamma)= S,$$
donc $S=0$.
\end{proof}

\begin{prop}\label{fourier}
Si $\alpha, x, y \in \F_q$, alors
$$\frac{1}{q} \sum_{\alpha \in \F_q} \psi(\alpha(x-y)) = \delta(x,y),$$
o\`u $\delta(x,y) = 1$ si $x=y$ et $0$ sinon.
\end{prop}

\begin{proof}
Si $x=y$, alors
$$ \sum_{\alpha \in \F_q} \psi(\alpha(x-y)) =  \sum_{\alpha \in \F_q} \psi(0) = q.$$
Si $x \ne y$, alors le changement d'indice $\beta = \alpha(x-y)$, o\`u $x-y \ne 0$, donne
$$ \sum_{\alpha \in \F_q} \psi(\alpha(x-y)) = \sum_{\beta \in \F_q} \psi(\beta) = 0,$$
d'apr\`es la proposition~\ref{proprietes_psi}(c).
\end{proof}


La d\'efinition~\ref{defGauss} se g\'en\'eralise aux caract\`eres sur $\F_q$, o\`u $q = p^s$, sous la forme
\begin{align}\label{gen}
g_\alpha(\chi) = \sum_{t \in \F_q} \chi(t) \psi(\alpha t) = \sum_{t \in \F_q} \chi(t) \zeta^{\mathrm{tr}(\alpha t)}, \qquad\text{o\`u } \zeta = e^{\frac{2i\pi}{p}}, \mathrm{tr} = \mathrm{Tr}_{\F_q/\F_p}.
\end{align}

Si $q=p$ est premier, et $\alpha = a \in \F_p$, alors $\mathrm{tr}(ay) = at$, et nous obtenons bien $g_a(\chi) =\sum\limits_{t \in \F_p} \chi(t) \zeta^{at}$ ce qui montre que (\ref{gen}) g\'en\'eralise bien la d\'efinition (\ref{defGauss}).



\medskip
Pr\'ecisons quelques valeurs de $g_\alpha(\chi)$.
\begin{prop} \label{valeurs_g}
Soit $\alpha \in \F_q$, et $\chi$ un caract\`ere sur $\F_q$.
\be 
\item[(a)] Si $\alpha\ne 0$ et $\chi = \varepsilon$, alors $g_\alpha(\varepsilon) = 0$.
\item[(b)] Si $\alpha = 0$ et $\chi = \varepsilon$, alors $g_0(\varepsilon) = q$.
\item[(c)] Si $\alpha = 0$ et $\chi \ne \varepsilon$, alors $g_0(\chi) = 0$.

\ee
\end{prop}
\begin{proof}
\be
\item[(a)] Ici $\alpha \ne 0$. En utilisant la proposition~\ref{proprietes_psi}(c), nous obtenons
\begin{align*}
g_\alpha(\varepsilon) &= \sum_{t \in \F_q} \varepsilon(t) \zeta^{\mathrm{tr}(\alpha t)}\\
&= \sum_{t\in \F_q} \zeta^{\mathrm{tr}(\alpha t)}\\
&= \sum_{u \in \F_q} \zeta^{\mathrm{tr}(u)} \qquad (u = \alpha t)\\
&=  \sum_{u \in \F_q} \psi(u)\\
&= 0
\end{align*}
\item[(b)] Comme $\alpha = 0$, $$g_0(\varepsilon) = \sum_{t\in \F_q} \varepsilon(t) =  \sum_{t\in \F_q}  1 = q.$$
\item[(c)] Si $\chi \ne \varepsilon$, la proposition~\ref{somme_chi} donne
$$g_0(\chi) = \sum_{t\in \F_q} \chi(t) = 0.$$
\ee
\end{proof}

\begin{prop}\label{prop50}
Si $\alpha \in \F_q^*$, alors $g_\alpha(\chi)  = \chi(\alpha^{-1}) g_1(\chi) = \overline{\chi(\alpha)} g_1(\chi)$.
\end{prop}
\begin{proof}
Si $\alpha \in \F_q^*$,
\begin{align*}
\chi(\alpha) g_\alpha(\chi) &=\sum_{t \in \F_q} \chi(\alpha)\chi(t) \psi(\alpha t)\\
&=\sum_{t \in \F_q} \chi(\alpha t) \psi(\alpha t)\\
&= \sum_{s \in \F_q} \chi(s) \psi( s)\qquad (s =\alpha t)\\
&= g(\chi).
\end{align*}
Puisque $|\chi(\alpha)| = 1$, $\chi(\alpha)^{-1} = \overline{\chi(\alpha)}$, alors
$$g_\alpha(\chi) = \overline{\chi(\alpha)} g(\chi).$$
\end{proof}
Nous noterons par la suite $g(\chi) = g_1(\chi)$.

\begin{prop}\label{module}
Si $\chi \ne \varepsilon$ est un caract\`ere sur $\F_q$, alors $|g(\chi)| = \sqrt{q}$.
\end{prop}
\begin{proof}

Nous \'evaluons la somme $S = \sum\limits_{a \in \F_q} g_a(\chi) \overline{g_a(\chi)}$ de deux façons.

\begin{enumerate}
\item[$\bullet$]  Comme $\chi \ne \varepsilon$, la proposition~\ref{valeurs_g}(c) donne $g_0(\chi) = 0$. Si $a \in \F_q^*$, alors $g_a(\chi) = \chi(a^{-1}) g(\chi)$ (proposition~\ref{prop50}), et $\overline{g_a(\chi)} = \overline{\chi(a^{-1})} \overline{g(\chi)} = \chi(a) \overline{g(\chi)}$. Par cons\'equent,
\begin{align*}
S&= \sum_{a \in \F_q^*} \chi(a^{-1}) g(\chi)  \chi(a) \overline{g(\chi)}\\
&= \sum_{a \in \F_q^*} |g(\chi)|^2\\
&= (q-1) |g(\chi)|^2
\end{align*}
\item[$\bullet$] De plus, puisque $\psi(a(x-y)) = \psi(ax) \psi(ay)^{-1} = \psi(ax) \overline{\psi(ay)}$,
 $$g_a(\chi) \overline{g_a(\chi)} = \sum_{x \in \F_q} \sum_{y \in \F_q} \chi(x) \overline{\chi(y)} \psi(a(x-y)).$$
Par cons\'equent,
\begin{align*}
S &= \sum_{a\in \F_q}  \sum_{x \in \F_q} \sum_{y \in \F_q} \chi(x) \overline{\chi(y)} \psi(a(x-y))\\
&=  \sum_{x \in \F_q} \sum_{y \in \F_q}\chi(x) \overline{\chi(y)} \left(  \sum_{a\in \F_q}\psi(a(x-y))\right)
\end{align*}
D'apr\`es la proposition~\ref{fourier},
\begin{align*}
 \sum_{a\in \F_q} \psi(a(x-y)) &= q \delta(x,y),
  \end{align*}
donc,
 \begin{align*}
 S &=  q \sum_{x \in \F_q} \sum_{y \in \F_q}\chi(x) \overline{\chi(y)}  \delta(x,y) \\
 &= q \sum_{x \in \F_q} \chi(x) \overline{\chi(x)}\\
 \end{align*}
Puisque $\chi(x) \overline{\chi(x)} = 1$ si $x \ne 0$, et $\chi(x) \overline{\chi(x)} = 0$ si $x = 0$, nous obtenons
 $$S = q(q-1).$$
\end{enumerate}
La comparaison de ces deux r\'esultats donne
$$(q-1) |g(\chi)|^2 = (q-1)q,$$
donc $$  |g(\chi)| = \sqrt{q}.$$
\end{proof}

Exprimons le lien entre $\overline{g(\chi)}$ et $g(\overline{\chi})$. Ici $\overline{\chi}$ est le caract\`ere qui envoie tout $a \in \F_q$ sur $\overline{\chi(a)} = \chi(a)^{-1} = \chi^{-1}(a)$, donc $\overline{\chi} = \chi^{-1}$.
\begin{prop}\label{conjugue}
Si $\chi$ est un caract\`ere sur $\F_q$, alors
$$\overline{g(\chi)} = \chi(-1) g(\overline{\chi}).$$
\end{prop}
\begin{proof}
 Puisque $(-1)^2 = 1$, $(\chi(-1))^2 = 1$, donc $\chi(-1) = \pm 1$ est r\'eel, et ainsi $\overline{\chi(-1)} = \chi(-1)$. Ceci donne
\begin{align*}
\overline{g(\chi)} &= \sum_{t \in \F_q} \overline{\chi(t)} \zeta_p^{-\mathrm{tr}( t)}\\
&=\sum_{t \in \F_q} \overline{\chi(-1) \chi(-t)}  \zeta_p^{-\mathrm{tr}( t)}\\
&=\chi(-1) \sum_{t \in \F_q} \overline{ \chi(-t)}  \zeta_p^{\mathrm{tr}( -t)}\\
&=\chi(-1) \sum_{s \in \F_q} \overline{ \chi(s)}  \zeta_p^{\mathrm{tr}( s)}\qquad (s = -t)\\
&=\chi(-1) g(\overline{\chi}).\\
\end{align*}
\end{proof}

Remarque : si $\lambda$ est le caract\`ere de Legendre d\'efini par $\lambda(a) = \legendre{a}{p}$, alors $\lambda$ est d'ordre 2, donc $\lambda = \lambda^{-1} = \overline{\lambda}$. Ainsi
$$g(\lambda)^2 = g(\lambda)g(\overline{\lambda}) = \lambda(-1) g(\lambda) \overline{g(\lambda)} = \lambda(-1)p = (-1)^{\frac{p-1}{2}} p.$$
On retrouve ainsi le calcul de $g^2 =  (-1)^{\frac{p-1}{2}} p$ dans le chapitre "Loi de r\'eciprocit\'e quadratique".




\section{Sommes de Jacobi.}

Les sommes de Jacobi interviennent naturellement dans le calcul du nombre de points de courbes alg\'ebriques sur $\F_q$. Notons $N(x^3 + y^3 = 1)$ le nombre de solutions $(x,y) \in \F_q^2$ de la cubique $\Gamma$ d'\'equation $x^3 + y^3 = 1$ sur $\F_q$. 

Alors
$$N(x^3 + y^3 = 1) = \sum_{a+b = 1} N(x^3 = a) N(y^3 = b).$$
En effet, si on note $A_k = \{x \in \F_q \, |\, x^3 = k\}$ pour tout $k\in \F_q$, alors
\begin{align*}
\Gamma &= \{(x,y) \in \F_q^2\mid x^3 + y^3 =1\}\\
&=\coprod_{(a,b)\in \F_q^2,\, a+b = 1} \{(x,y) \in \F_p^2\mid x^3  =a \text { et }  y^3 =b\}\\
&= \coprod_{(a,b)\in \F_q^2,\, a+b = 1} A_a \times A_b.
\end{align*}
Comme $|A_k| = N(x^3 = k)$, nous obtenons bien le r\'esultat annonc\'e.


$\bullet$ Si $q\equiv 2 \pmod 3$, d'apr\`es la proposition~\ref{nbsols} et l'exemple 2 qui suit, nous savons que $N(x^3 =a) = 1$ pour tout $a \in \F_q$.
Alors, d'apr\`es la formule pr\'ec\'edente, $N(x^3 + y^3 = 1) = q$.

$\bullet$ Supposons maintenant que $q\equiv 1 \pmod 3$. Comme $3 \mid q-1$, Il existe alors au moins un caract\`ere d'ordre 3, et m\^eme exactement 2, d'apr\`es la proposition~\ref{ordre_n}.  Soit $\chi$ un tel caract\`ere d'ordre 3 (appel\'e caract\`ere cubique). Alors $\chi^2$ est d'ordre 3, et $\{\varepsilon, \chi, \chi^2\}$ est l'ensemble des caract\`eres dont l'ordre divise 3. La proposition~\ref{nbRacs} donne alors
$$N(x^3 = a) = 1 + \chi(a) + \chi^2(a).$$
Par cons\'equent,
\begin{align*}
N(x^3 + y^3 = 1) &= \sum_{a+b = 1} \sum_{i=0}^2 \chi^i(a) \sum_{j=0}^2 \chi^j(b)\\
&=\sum_{i=0}^2 \sum_{j=0}^2 \left( \sum_{a+b = 1} \chi^i(a)\chi^j(b)\right).
\end{align*}

Ceci conduit \`a la d\'efinition suivante.
\begin{dfn}
Soient $\chi$ et $\lambda$ des caract\`eres sur $\F_q$. Alors
$$ J(\chi,\lambda) = \sum_{a+b = 1} \chi(a) \lambda(b)$$
s'appelle la somme de Jacobi associ\'ee \`a $\chi, \lambda$.
\end{dfn}

Avec cette notation, le r\'esultat pr\'ec\'edent s'\'ecrit
\begin{align}\label{cubique}
N(x^3 + y^3 = 1) = \sum_{i=0}^2 \sum_{j=0}^2 J(\chi^i,\chi^j).
\end{align}
Donnons les propri\'et\'es usuelles de ces sommes de Jacobi.
\begin{prop}\label{jacobi1}
Soit $\chi$ un caract\`ere non trivial sur $\F_q$. Alors
\be
\item[(a)] $J(\varepsilon, \varepsilon) = q.$
\item[(b)] $J(\varepsilon, \chi) = 0.$
\item[(c)] $J(\chi,\chi^{-1}) = -\chi(-1).$
\ee
\end{prop}
\begin{proof}
\be
\item[(a)] Puisque le cardinal de l'ensemble $\{(a,b)\in \F_q^2 \mid a+b = 1\}$ est \'egal \`a $q$,
$$J(\varepsilon, \varepsilon) = \sum\limits_{a+b = 1}  1 = q.$$
\item[(b)] D'apr\`es la proposition~\ref{somme_chi},
$$J(\varepsilon, \chi) = \sum\limits_{a+b = 1} \chi(a) = \sum\limits_{a \in \F_q} \chi(a) = 0.$$
\item[(c)] Remarquons que
\begin{align*}
J(\chi,\chi^{-1})&= \sum_{a+b = 1} \chi(a) \chi^{-1}(b)\\
&=\sum_{a+b = 1,\,  b \ne 0} \chi\left(\frac{a}{b}\right)\\
&= \sum_{a\ne 1} \chi\left(\frac{a}{1-a}\right).
\end{align*}
Comme l'application homographique
$$
\left\{
\begin{array}{ccc}
\F_q \setminus  \{1\} &\to &\F_q\setminus \{-1\}\\
a & \mapsto &\frac{a}{1-a}
\end{array}
\right.
$$
est une bijection, d'application r\'eciproque 
$\left \{
\begin{array}{ccc}
\F_q \setminus  \{-1\} &\to &\F_q\setminus \{1\}\\
b & \mapsto &\frac{b}{1+b}
\end{array}
\right.$,
le changement d'indice $b = \frac{a}{1-a}$ donne
\begin{align*}
J(\chi,\chi^{-1}) &= \sum_{a\ne 1} \chi\left(\frac{a}{1-a}\right)\\
&= \sum_{b \ne -1} \chi(b)\\
&=  \sum_{b \in \F_p} \chi(b) - \chi(-1)\\
&= - \chi(-1).
 \end{align*}
\ee
\end{proof}

La proposition suivante donne de lien entre les sommes de Jacobi et les sommes de Gauss.
\begin{prop}\label{lien_Jacobi_Gauss}
Si $\chi, \lambda$ sont des caract\`eres sur $\F_q$ tels que $\chi \ne \varepsilon, \lambda \ne \varepsilon , \chi \lambda \ne \varepsilon$, alors
$$J(\chi,\lambda) = \frac{g(\chi) g(\lambda)}{g(\chi \lambda)}.$$
\end{prop}
\begin{proof}
En notant comme d'habitude $\psi(x) = \zeta_p^{\mathrm{tr}(x)}$ pour $x \in \F_q$,
\begin{align*}
g(\chi) g (\lambda) &= \left(\sum_{x\in \F_q} \chi(x) \psi(x)\right)\left(\sum_{y\in \F_q} \lambda(y) \psi(y) \right)\\
&=\sum_{(x,y) \in \F_q^2} \chi(x) \lambda(y) \psi(x+y)\\
&=\sum_{t \in \F_q} \left( \sum_{x+y = t} \chi(x) \lambda(y)\right) \psi(t).
\end{align*}

Si $t = 0$, alors 
$$\sum_{x+y = 0} \chi(x) \lambda(y) = \sum_{x \in \F_q} \chi(x) \lambda(-x) = \lambda(-1) \sum_{x \in \F_q} (\chi \lambda)(x) = 0,$$
puisque $\chi \lambda \ne \varepsilon$.

Si $t \ne 0$, l'application
$$
\left\{
\begin{array}{ccc}
\{(x',y') \in \F_q^2\ | \ x'+y' = 1 \}& \to& \{(x,y) \in \F_q^2\ | \ x+y = t \} \\
(x',y') & \mapsto &(x,y) = (tx', ty')
\end{array}
\right.
$$
\'etant bijective, le changement d'indices $(x,y) = (tx',ty')$ donne
\begin{align*}
 \sum_{x+y = t} \chi(x) \lambda(y) &=  \sum_{x'+y' = 1} \chi(tx') \lambda(t y')\\
 &= (\chi \lambda)(t) J(\chi, \lambda).
 \end{align*}
 Par cons\'equent,
\begin{align*}
g(\chi) g (\lambda) &=\sum_{t \in \F_q^*} \left( \sum_{x+y = t} \chi(x) \lambda(y)\right) \psi(t)\\
 &=J(\chi, \lambda) \sum_{t \in \F_q^*}  (\chi \lambda)(t) \psi(t)\\
 &= J(\chi, \lambda) g(\chi \lambda).
 \end{align*}
 La proposition~\ref{module} montre que si $\chi \ne \varepsilon, g(\chi) \ne 0$. Comme ici $\chi \lambda \ne \varepsilon$, $g(\chi \lambda) \ne 0$, donc
 $$J(\chi,\lambda) = \frac{g(\chi) g(\lambda)}{g(\chi \lambda)}.$$
 \end{proof}
 Nous en tirons le corollaire suivant
 \begin{prop}\label{module_J}
Soient $\chi, \lambda$ des caract\`eres sur $\F_q$. Si $\chi, \lambda$ et $\chi \lambda$ sont diff\'erents de $\varepsilon$, alors
 $$|J(\chi,\lambda)| = \sqrt{q}.$$
 \end{prop}
 \begin{proof}
 Comme $|g(\chi)| = \sqrt{q}$ pour tout caract\`ere $\chi \ne \varepsilon$ (proposition~\ref{module}), nous obtenons
  $$|J(\chi,\lambda)| = \frac{|g(\chi)|\, |g(\lambda)|}{|g(\chi \lambda)|}  = \frac{\sqrt{q}\sqrt{q}}{\sqrt{q}}= \sqrt{q}.$$
 \end{proof}
 
 Reprenons l'\'evaluation de $N(x^3 + y^3 = 1)$ pour $q\equiv 1 \pmod 3$. L'\'egalit\'e (\ref{cubique}) devient, en utilisant la proposition~\ref{jacobi1}, ainsi que $\chi^2 = \chi^{-1}$,
 \begin{align*}
 N(x^3 + y^3 = 1) &= \sum_{i=0}^2 \sum_{j=0}^2 J(\chi^i,\chi^j)\\
 &= J(\varepsilon, \varepsilon) + J(\varepsilon, \chi) + J(\varepsilon, \chi^2) +\\
 	& \quad J(\chi, \varepsilon) + J(\chi, \chi) + J(\chi, \chi^2) +\\
	& \quad J(\chi^2, \varepsilon) + J(\chi^2, \chi) + J(\chi^2, \chi^2) \\
	&= q  - \chi(-1) - \chi^2(-1) + J(\chi,\chi) + J(\chi^2,\chi^2)
 \end{align*}
 Comme $-1 = (-1)^3$, nous avons $\chi(-1) = \chi^2(-1) = 1$. De plus $J(\chi^2,\chi^2) = J(\overline{\chi}, \overline{\chi}) =\overline{J(\chi,\chi)}$, donc
 \begin{align}
 N(x^3 + y^3 = 1) = q-2 +2\,  \mathrm{Re}(J(\chi,\chi)).
 \end{align}
 Nous ne connaissons pas explicitement $J(\chi,\chi)$ pour toutes les valeurs de $q$. N\'eanmoins $| \mathrm{Re}(J(\chi,\chi))| \leq |J(\chi,\chi)| = \sqrt{q}$, donc
 $$|N(x^3 + y^3 = 1) - (q-2)| \leq 2 \sqrt{q}.$$
 qui donne l'ordre de grandeur de $N(x^3 + y^3 = 1)$.
 
 Un calcul semblable permet d'obtenir explicitement $N(x^2 + y^2 = 1)$, que nous pr\'esentons en supposant ici $q= p$ premier. Soit $\chi$ l'unique caract\`ere d'ordre 2 : $\chi(a) = \legendre{a}{p}$ pour tout $a \in \F_p$.
 \begin{align*}
 N(x^2 + y^2 = 1) &= \sum_{a+b=1} N(x^2 = a) N(x^2 = b)\\
 &= \sum_{a+b = 1} (1 + \chi(a))(1 + \chi(b))\\
 &= p + \sum_{a \in \F_p} \chi(a) + \sum_{b \in \F_p} \chi(b)  + \sum_{a+b=1} \chi(a) \chi(b)\\
 &= p + J(\chi,\chi).
 \end{align*}
 Comme $\chi = \chi^{-1}$, la proposition~\ref{jacobi1} donne $J(\chi,\chi) = - \chi(-1)  = - \legendre{-1}{p} = -(-1)^{\frac{p-1}{2}}$. Ainsi
 $$N(x^2 + y^2 = 1) = p - (-1)^{\frac{p-1}{2}}.$$
 Autrement dit
 \begin{align*}
 N(x^2 + y^2 = 1) &= p-1 \qquad \text{ si } p\equiv 1 \pmod 4,\\
  N(x^2 + y^2 = 1) &= p+1\qquad  \text{ si } p\equiv 3 \pmod 4.\\
 \end{align*}
 
 La proposition~\ref{module_J} permet de retrouver le th\'eor\`eme des deux carr\'es :
 \begin{prop}
 Si $p\equiv 1 \pmod 4$, alors il existe des entiers $a$ et $b$ tels que $p = a^2 + b^2$.
 \end{prop}
 \begin{proof}
 Comme $p\equiv 1 \pmod 4$, il existe d'apr\`es la proposition~\ref{existence_caractere} un caract\`ere $\chi$ d'ordre 4 sur $\F_p$. Pour tout $a \in \F_p^*$, $(\chi(a))^4 = \chi^4(a) = \varepsilon(a) = 1$, donc $\chi(a) \in \{1,i,-1,-i\}$, et $\chi(0) = 0$. Par cons\'equent, $J(\chi,\chi) = \sum\limits_{a+b=1} \chi(a) \chi(b) \in \Z[i]$. Ainsi $J(\chi,\chi)$ s'\'ecrit sous la forme $J(\chi,\chi) =a + b i,\ a,b \in \Z$. La proposition~\ref{module_J} montre que $$a^2 + b^2 = \n(a + bi) = \n(J(\chi,\chi)) = p.$$
 \end{proof}
 
 On obtient de m\^eme la proposition suivante, d\'ej\`a prouv\'ee dans la section~\ref{section1_8} du chapitre "Entiers de Gauss".
 \begin{prop}
 Si $p\equiv 1 \pmod 3$, alors il existe des entiers $a$ et $b$ tels que $p = a^2 - ab +b^2$.
 \end{prop}
 
\begin{proof}
Comme $p\equiv 1 \pmod 3$, il existe un caract\`ere $\chi$ d'ordre 3. Pour tout $a \in \F_p^*$,  $(\chi(a))^3 = 1$, $\chi(a) \in \{1,\omega, \omega^2\}$, donc $J(\chi,\chi) \in \Z[\omega]$. Ainsi $J(\chi,\chi) = a + b\omega,\ a,b \in \Z$, et $p = \n(J(\chi,\chi)) = a^2 -ab +b^2$.
\end{proof}

Nous avons vu dans cette m\^eme section que ceci entra\^inait, pour les premiers $p\equiv 1 \pmod 3$, l'existence d'entiers $x,y$ tels que $p = x^2 + 3y^2$.

Soit $\chi$ un caract\`ere d'ordre 3 sur $\F_q$ (ce qui n'est possible que si $q \equiv 1 \pmod 3$). Alors $\chi \ne \varepsilon, \chi^2 \ne \varepsilon$. La proposition 18 donne alors
$$g(\chi)^2 = J(\chi,\chi) g(\chi^2).$$
En multipliant cette relation par $g(\chi)$, nous obtenons, en utilisant $ \chi(-1) g(\overline{\chi}) = \overline{g(\chi)}$ (proposition~\ref{conjugue}), o\`u ici $\chi(-1) = 1$, 
\begin{align*}
g(\chi)^3 &= J(\chi,\chi) g(\chi) g(\chi^2)\\
&=J(\chi,\chi) g(\chi) g(\overline{\chi})\\
&=J(\chi,\chi) g(\chi) \overline{g(\chi)}\\
&= q \,J(\chi,\chi)
\end{align*}

Nous avons prouv\'e la proposition suivante.
\begin{prop}\label{ordre3}
Si $\chi$ est un caract\`ere d'ordre $3$ sur $\F_q$, alors
$$g(\chi)^3 = q\,  J(\chi,\chi).$$
\end{prop}

G\'en\'eralisons :
\begin{prop}\label{generalisation}
Supposons que $\chi$ est un caract\`ere d'ordre $n>2$ sur $\F_q$. Alors
$$g(\chi)^n = \chi(-1) q J(\chi,\chi)\cdots J(\chi,\chi^{n-2}).$$
\end{prop}
\begin{proof}
Ici $\chi,\chi^2,\ldots,\chi^{n-1}$ sont diff\'erents de $\varepsilon$. Donc, comme pr\'ec\'edemment, $g(\chi)^2 = J(\chi,\chi) g(\chi^2)$.

Supposons, \`a titre d'hypoth\`ese de r\'ecurrence, que $$g(\chi)^{k} = J(\chi,\chi)J(\chi,\chi^2)\cdots J(\chi,\chi^{k-1}) g(\chi^k),$$ pour un entier $k$ tel que $2 \leq k < n-1$.
En multipliant par $g(\chi)$, on obtient
$$g(\chi)^{k+1} = J(\chi,\chi)J(\chi,\chi^2)\cdots J(\chi,\chi^{k-1}) g(\chi) g(\chi^k).$$
Comme $k+1 <n$, $\chi, \chi^k$ et $\chi^{k+1}$ sont diff\'erents de $\varepsilon$. Alors la proposition~\ref{lien_Jacobi_Gauss} montre que $$g(\chi) g(\chi^k) = J(\chi,\chi^k) g(\chi^{k+1}).$$
Par cons\'equent,
$$g(\chi)^{k} = J(\chi,\chi)J(\chi,\chi^2)\cdots J(\chi,\chi^{k-1})  J(\chi,\chi^k) g(\chi^{k+1}),$$
ce qui ach\`eve la r\'ecurrence. Ainsi la propri\'et\'e est vraie jusqu'\`a la valeur $k = n-1$. Donc
\begin{align}\label{eqz}
g(\chi)^{n-1} = J(\chi,\chi)\cdots   J(\chi,\chi^{n-2}) g(\chi^{n-1}).
\end{align}
 Enfin, comme $\chi^{n-1} = \chi^{-1} = \overline{\chi}$ (et $\chi(-1) = \pm 1$), nous obtenons, en utilisant les propositions~\ref{conjugue} et~\ref{module_J},
$$g(\chi) g(\chi^{n-1}) = g(\chi)g(\overline{\chi}) =  \chi(-1) g(\chi)\overline{g(\chi)} = \chi(-1) q .$$ En multipliant une derni\`ere fois l'\'egalit\'e (\ref{eqz}) par $g(\chi)$, nous obtenons
$$g(\chi)^n = \chi(-1) q J(\chi,\chi)\cdots J(\chi,\chi^{n-2}).$$
\end{proof}

Nous pouvons maintenant compl\'eter le calcul de $N(x^3 + y^3 =1) = p-2 + 2 \ \mathrm{Re}(J(\chi,\chi))$ dans le cas o\`u $q=p$ est un nombre premier. Nous savons que, $\chi$ \'etant un caract\`ere d'ordre 3, $J(\chi,\chi) \in \Z[\omega]$, soit $${J(\chi,\chi) = a + b \omega}, \ {a,b\in \Z}.$$
\begin{prop}\label{congruences}
Supposons que $p\equiv 1 \pmod 3$ et que $\chi$ est un caract\`ere cubique sur $\F_p$. Soient $a,b$ les entiers tels que $J(\chi,\chi) = a  + b \omega$. Alors
\be
\item[(a)] $b \equiv 0 \pmod 3$,
\item[(b)] $a \equiv -1 \pmod 3$.
\ee
\end{prop}
\begin{proof}
Nous utilisons des congruences modulo 3 dans l'anneau des entiers alg\'ebriques.
$$g(\chi)^3 = \left(\sum_{t\in\F_p} \chi(t) \zeta^t\right)^3 \equiv \sum_{t\in \F_p} \chi(t)^3\zeta^{3t} \pmod 3.$$
Puisque $\chi(0)=0$, et $\chi(t)^3 = 1$ pour $t\ne 0$, nous obtenons 
$$\sum_{t\in \F_p} \chi(t)^3\zeta^{3t} = \sum_{t\in \F_p^*} \zeta^{3t} = -1.$$
La proposition~\ref{ordre3} donne alors, puisque $p \equiv 1 \pmod 3$,
$$g(\chi)^3 = p J(\chi,\chi)  \equiv a+b\omega \equiv -1 \pmod 3.$$

Le m\^eme calcul appliqu\'e \`a $\overline{\chi}$ donne $g(\overline{\chi})^3 \equiv -1 \pmod 3$, et $\overline{g(\chi)} = g(\overline{\chi})$ (proposition~\ref{conjugue}). Le passage au conjugu\'e dans la relation pr\'ec\'edente donne alors
$$g(\overline{\chi})^3 = p J(\overline{\chi},\overline{\chi})  \equiv a+b\overline{\omega} \equiv -1 \pmod 3.$$
En soustrayant ces deux congruences, nous obtenons $b(\omega- \overline{\omega}) \equiv 0 \pmod 3$, soit $bi \sqrt{3} \equiv 0 \pmod 3$. L'\'el\'evation au carr\'e donne $-3b^2 \equiv 0 \pmod 9$, et cette congruence est alors vraie dans l'anneau $\Z$. Par cons\'equent $3 \mid b^2$ dans $\Z$, et $3 \mid b$, ce qui prouve (a).

Comme $b \equiv 0 \pmod 3$ et $a + b \omega \equiv -1 \pmod 3$, nous obtenons $a\equiv -1 \pmod 3$.
\end{proof}

Nous pouvons maintenant prouver le beau r\'esultat dû \`a Gauss.
\begin{prop}
%\be
\item[(a)] Soit $p \equiv 1 \pmod 3$ un nombre premier. Alors il existe un et un seul couple d'entiers $(A,B)$ tel que $4p = A^2 + 27 B^2,\ A \equiv 1 \pmod 3, B>0$. 
\item[(b)] Cet unique \'el\'ement $A$ v\'erifie
$$N(x^3 + y^3 = 1) = p-2 + A.$$
%\ee
\end{prop}

\begin{proof}
\item[(a)]
$\bullet$ Existence. 

Comme $p\equiv 1 \pmod 3$, il existe un caract\`ere $\chi$ d'ordre 3. Il v\'erifie $J(\chi,\chi) = a + b \omega$ et $|J(\chi,\chi)|^2 = p$, donc $p = a^2 -ab + b^2$, soit $4p = (2a-b)^2 + 3 b^2$. La proposition~\ref{congruences} montre que $b\equiv 0, a \equiv -1 \pmod 3$. Posons alors $A =2a - b$, et $B = \frac{|b|}{3}$, avec $B\ne 0$ puisque $p$ est premier. Alors $A,B$ sont entiers, et
$$4p = A^2 + 27B^2, \qquad A \equiv 1 \pmod 3,\ B>0.$$

$\bullet$ Unicit\'e.

Supposons que $4p = A^2 + 27 B^2 = C^2 + 27 D^2$, o\`u $A \equiv C \equiv 1 \pmod 3, B>0,D>0$. Nous allons montrer que  $A = C, B = D$.

Comme $\omega = e^{\frac{2i\pi}{3}} = -\frac{1}{2} + i \frac{\sqrt{3}}{2}$, alors $i\sqrt{3} = 2 \omega +1$, et pour tout couple d'entiers $x,y$,
$x^2 + 3 y^2 = (x+i\sqrt{3}y)(x-i\sqrt{3}y) = (x + (2\omega+1)y)(x - (2\omega+1)y),$
$$x^2+3y^2 = (x+y+2\omega y)(x-y-2\omega y).$$
Avec $x =A, y = 3B$, nous obtenons
$$4p = A^2+27B^2 = (A+3B+6\omega B)(A-3B-6\omega B).$$
Notons que $A,B$ sont de m\^eme parit\'e, puisque $4p = A^2 + 27 B^2$.

Nous pouvons donc \'ecrire $p = (\frac{A+3B}{2} + 3\omega B)(\frac{A-3B}{2} - 3\omega B)$, soit
$$p = \pi \overline{\pi},\text{ o\`u } \pi = \frac{A+3B}{2} + 3\omega B \in \Z[\omega].$$
Par cons\'equent $\pi$ est premier dans $\Z[\omega]$ (proposition 20 du chapitre "Entiers de Gauss").
$$\pi \overline{\pi} = \left(\frac{A+3B}{2} + 3\omega B\right)\left(\frac{A-3B}{2} - 3\omega B\right)=\left(\frac{C+3D}{2} + 3\omega D\right)\left(\frac{C-3D}{2} - 3\omega D\right).$$
Comme $\pi$ est premier, il divise $\frac{C+3D}{2} + 3\omega D$ ou son conjugu\'e. Puisqu'ils ont la m\^eme norme $p$, ils sont associ\'es. Les unit\'es de $\Z[\omega]$ sont $\pm1,\pm \omega,\pm \omega^2$, si bien qu'il existe 12 cas :
\begin{align*}
\frac{A+3B}{2} + 3\omega B &= \pm \left(\frac{C+3D}{2} + 3\omega D\right),\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega \left(\frac{C+3D}{2} + 3\omega D\right),\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega^2\left(\frac{C+3D}{2} + 3\omega D\right),\\
\frac{A+3B}{2} + 3\omega B &= \pm \left(\frac{C-3D}{2} - 3\omega D\right),\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega \left(\frac{C-3D}{2} - 3\omega D\right),\\
\frac{A+3B}{2} + 3\omega B &= \pm \omega^2\left(\frac{C-3D}{2} - 3\omega D\right).\\
\end{align*}
Pour prouver que $A = C$, si on remplace $D$ par $-D$, nous obtenons les 6 derniers cas \`a partir des 6 premiers, si bien qu'il suffit d'examiner les 6 premiers cas.

Rappelons que $(1,\omega)$ est une  $\Z$-base de $\Z[\omega]$.
\begin{enumerate}
\item[1)] $A + 3B + 6\omega B = C + 3D + 6\omega D$.

Alors $B = D$ et $A+3B = C + 3D$, donc $A = C$, ce qui est le r\'esultat attendu.
Les cinq autres cas ne peuvent se produire :
\item[2)] $A+3B + 6\omega B = -C-3D -6\omega D$.

Alors $B = -D, A = -C$. Comme $A\equiv C \equiv 1 \pmod 3$, c'est impossible.
\item[3)] $A + 3 B + 6\omega B = \omega(C+3D+6\omega D) = \omega(C+3D) + (-1 - \omega) 6 D = -6D + \omega(C-3D)$.

Alors $A+3B = - 6 D$, $A \equiv 0 \pmod 3$, c'est impossible.
\item[4)] $A+3B + 6 \omega B = -\omega (C+3D+6\omega D) = -\omega (C+3D) + (1+\omega) 6D = 6D + \omega(-C+3D)$.

Alors $A+3B = -6D$, $A \equiv 0 \pmod 3$, c'est impossible.

\item[5)] $A+3B + 6\omega B = \omega^2(C+D+6\omega D) = (-1-\omega)(C + 3D) + 6D  = -C + 3D + \omega (-C-3D)$.
Alors $A+3B = - C +3D$, $A\equiv -C \pmod 3$, c'est impossible.

\item[6)] $A + 3B + 6 \omega B = -\omega^2(C+3D + 6\omega D) = (1 + \omega)(C+3D) - 6D = (C-3D) + \omega(C+3D)$.

Alors $6B = C+ 3D$, $C \equiv 0 \pmod 3$, c'est impossible.
\end{enumerate}
En conclusion $A = C$. Alors $B^2 = D^2$, o\`u $B>0,D>0$, donc $B=D$.
\item[(b)] Nous avons d\'ej\`a prouv\'e (voir l'\'egalit\'e (1)) que
$$N(x^3+y^3 = 1) = p-2 + 2\ \mathrm{Re}(J(\chi,\chi)).$$
Comme $J(\chi,\chi) = a + b \omega$, nous obtenons $2 \mathrm{Re}(J(\chi,\chi)) = 2a - b = A \equiv 1 \pmod 3$, si bien que
$$N(x^3+y^3 = 1) = p-2 + A,$$
o\`u $A$ est l'unique entier tel qu'il existe un entier $B$ v\'erifiant  $4p = A^2 + 27 B^2, A \equiv 1 \pmod 3$.

\end{proof}

Exemple 1 : soit $p = 37$. Alors $4 p = 148 = (-11)^2 + 27 \times 1^2$, o\`u $-11\equiv 1 \pmod 3$, donc $A = -11$. Alors, dans $\F_{37}$,
$$N(x^3+y^3 = 1) = 37 - 2 -11 = 24\qquad (p=37).$$

Exemple 2 : soit $p = 97$. Alors $4p = 388 = 19^2 + 27 \times 1^2$, o\`u $19\equiv 1 \pmod 3$, donc $A = 19$. Dans $\F_{97}$,
$$N(x^3+y^3 = 1) = 97 - 2 + 19 = 114 \qquad (p = 97).$$



\section{L'\'equation $x^n+y^n = 1$ dans $\F_p$.}

Ici $p$ est premier. Supposons d'abord que $p \equiv 1 \pmod n$. Alors $d = n \wedge( p-1) =n$.
Nous savons que $$N(x^n+y^n=1) =\sum_{a+b = 1} N(x^n = a) N(x^n = b).$$
Soit $\chi$ un caract\`ere d'ordre $n$. D'apr\`es la proposition~\ref{ordre_n}, les \'el\'ements du groupe des caract\`eres d'ordre divisant $n$ sont $\varepsilon, \chi,\chi^2,\ldots,\chi^{n-1}$. La proposition~\ref{nbRacs} montre que
$$N(x^n = a) = \sum_{i = 0} ^{n-1} \chi^i(a).$$
Ces deux r\'esultats prouvent que
\begin{align*}
N(x^n +y^n = 1) &= \sum_{a+b = 1}  \sum_{i = 0} ^{n-1} \chi^i(a)  \sum_{j = 0} ^{n-1} \chi^j(b)\\
&=\sum_{i = 0} ^{n-1}\sum_{j = 0} ^{n-1} \left(\sum_{a+b = 1}  \chi^i(a) \chi^j(b) \right)\\
&=\sum_{i = 0} ^{n-1}\sum_{j = 0} ^{n-1} J(\chi^i,\chi^j).
\end{align*}
La proposition~\ref{jacobi1} permet d'estimer cette somme.
\be
\item[$\bullet$] Si $i=j=0$, $J(\chi^i,\chi^j) = J(\varepsilon, \varepsilon) = p$.
\item[$\bullet$] Si $i=0$ et $j\ne 0$, ou si $j = 0$ et $i \ne 0$, $J(\chi^i,\chi^j)  = 0$.
\item[$\bullet$] Si $i+j = n,i \ne 0, j\ne 0$, alors $J(\chi^i,\chi^j) =J(\chi^i, \chi^{-i}) = - \chi^i(-1)$, si bien que la somme de ces termes est
\begin{align*}
\sum_{i+j = n,i>0,j>0}J(\chi^i,\chi^j)&= -\sum_{i=1}^{n-1} \chi^i(-1).
\end{align*}
Comme l'ordre de $\chi$ est $n$,
$$\sum_{i=0}^{n-1} \chi^i(-1) = 
\left\{
\begin{array}{ll}
\frac{1 - \chi^n(-1)}{1 - \chi(-1)} = 0&\text{si } \chi(-1) \ne 1,\\
n&\text{si } \chi(-1) = 1.
\end{array}
\right.
$$

Soit $a\in \F_p^*$. D\'efinissons $\delta_n(a)$ par
$$
\delta_n(a) = 
\left\{
 \begin{array}{ll}
 1 & \text{s'il existe } x \in \F_p \text{ tel que } x^n =a,\\
 0 & \text{sinon.}
 \end{array}
 \right.
$$
La proposition~\ref{existence_racine} montre que $\delta_n(a) = 1$ si et seulement si $\chi(a) = 1$ (et $\delta_n(a) = 0$ sinon). Cette notation permet d'\'ecrire
$$\sum_{i=0}^{n-1} \chi^i(-1) =  \delta_n(-1) n.$$
Par cons\'equent,
\begin{align*}
\sum_{i+j = n,i>0,j>0}J(\chi^i,\chi^j)&= -\sum_{i=1}^{n-1} \chi^i(-1)\\
&= 1 - \sum_{i=0}^{n-1} \chi^i(-1)\\
&= 1 - \delta_n(-1) n
\end{align*}
\ee
En r\'esum\'e,
$$N(x^n+y^n = 1 ) = p + 1 -\delta_n(-1) n + \sum_{(i,j) \in A} J(\chi^i, \chi^j),$$
o\`u $A$ est l'ensemble des couples $(i,j)$ tels que $1\leq i \leq n-1, 1 \leq j \leq n-1, i+j \ne n$. Ainsi $|A| = (n-1)^2 - (n-1) = (n-1)(n-2)$. Comme $|J(\chi^i, \chi^j)| = \sqrt{p}$ si $(i,j)\in A$, nous avons prouv\'e la proposition suivante.
\begin{prop}\label{card_courbe}
Si $p$ est premier et $p\equiv 1 \pmod n$,
$$|N(x^n+y^n = 1)  + \delta_n(-1) n - (p+1)| \leq (n-1)(n-2) \sqrt{p}.$$
\end{prop}

Le terme $\delta_n(-1) n$ peut s'interpr\'eter comme le nombre de points \`a l'infini de la courbe $x^n+y^n = 1$. En effet la compl\'etion projective de cette courbe est la courbe projective d'\'equation homog\`ene $x^n+y^n = t^n$, et les points \`a l'infini sont donn\'es par l'intersection avec la droite de l'infini d'\'equation $t=0$. Les points \`a l'infini sont donc les points projectifs de coordonn\'ees homog\`enes $(x,y,0)$ v\'erifiant $x^n + y^n =0$. Alors $y\ne 0$, sinon $x=y= t= 0$, donc $(x,y,0) = y (a, 1,0)$, o\`u $a = \frac{x}{y}$ v\'erifie $a^n = -1$. Le nombre $N$  points \`a l'infini de la courbe $x^n+y^n = 1$ est donc \'egal au nombre de solutions de $a^n = -1$ dans $\F_p$. La proposition~\ref{nbsols} montre que le nombre $N$ de solutions de $a^n = -1$ est $0$ si $\delta_n(-1) =0$, et $n = n \wedge (p-1)$ si $\delta_n(-1) = 1$. Ainsi $N = \delta_n(-1) n$. Par cons\'equent la somme des deux termes $N(x^n+y^n = 1) + \delta_n(-1) n$ d\'esigne le nombre de points projectifs de la courbe d'\'equation homog\`ene $x^n+y^n = t^n$.

Traitons maintenant le cas g\'en\'eral, sans l'hypoth\`ese $p\equiv 1 \pmod n$.
\begin{prop}\label{cas_general}
Soit $(a_1,\ldots ,a_n) \in \F_p^n, (m_1,\ldots,m_n) \in \N^n, b \in \F_p$. 

Posons $d_i = m_i \wedge (p-1), \ 1\leq i \leq n$. Alors
$$N\left(\sum_{i=0}^n a_i x_i^{m_i} = b\right) = N\left(\sum_{i=0}^n a_i x_i^{d_i} = b\right).$$
\end{prop}
\begin{proof}
La proposition~\ref{pgcd} montre que, pour tout $(u_1,\ldots,u_n)\in \F_p^n$,
$$N(x^{m_i} = u_i) = N(x^{d_i}= u_i).$$
En utilisant ce r\'esultat, nous obtenons
\begin{align*}
N\left(\sum\limits_{i=1}^n a_i x_i^{m_i} = b\right) &= \sum\limits_{a_1u_1+\cdots+a_l u_l= b}\, \prod\limits_{i=1}^n N(x^{m_i} = u_i)\\
&= \sum\limits_{a_1u_1+\cdots+a_n u_n= b}\, \prod\limits_{i=1}^l N(x^{d_i} = u_i)\\
&=N\left(\sum\limits_{i=1}^n a_i x_i^{d_i} = b\right).
\end{align*}
\end{proof}

Cette proposition montre que
$$N(x^n+y^n =1) = N(x^d+y^d = 1), \text{ o\`u } d =n\wedge (p-1),\ p \equiv 1 \pmod d.$$ 
La proposition \ref{card_courbe} permet alors d'estimer $N(x^d+y^d = 1)$.


\section{Sommes de Jacobi g\'en\'eralis\'ees.}
La g\'en\'eralisation des sommes de Jacobi est donn\'ee par la d\'efinition suivante.
\begin{dfn}
Si $\chi_1,\ldots,\chi_l$ sont des caract\`eres sur $\F_q$, la somme de Jacobi associ\'ee est donn\'ee par
$$J(\chi_1,\ldots,\chi_l) = \sum_{t_1+\cdots+t_l = 1} \chi_1(t_1)\cdots\chi_l(t_l).$$
\end{dfn}

Pour compl\'eter cette d\'efinition, d\'efinissons $J_0$ par
\begin{dfn}
$$J_0(\chi_1,\ldots,\chi_l) = \sum_{t_1+\cdots+t_l = 0} \chi_1(t_1)\cdots\chi_l(t_l).$$
\end{dfn}

Donnons quelques valeurs particuli\`eres de $J$ et $J_0$ associ\'ees \`a $l$ caract\`eres.
\begin{prop}\label{jac_gen1}
Soient $\chi_1,\ldots,\chi_l$ des caract\`eres sur $\F_q$.
\be
\item[(a)] Si $\chi_1=\cdots = \chi_l = \varepsilon$, alors
\begin{align*}
J_0(\chi_1,\ldots,\chi_l)  &= q^{l-1},\\
J(\chi_1,\ldots,\chi_l)  &= q^{l-1}.
\end{align*}
\item[(b)] Si certains des caract\`eres $\chi_i, \ 1 \leq i \leq l$ sont triviaux, mais pas tous, alors
\begin{align*}
J_0(\chi_1,\ldots,\chi_l) &= 0,\\
J(\chi_1,\ldots,\chi_l) &= 0.
\end{align*}
\item[(c)] Supposons que $\chi_l \ne \varepsilon$. Alors
$$
J_0(\chi_1,\ldots,\chi_l) = 
\left\{
\begin{array}{ll}
0&\text{si } \chi_1\cdots\chi_l \ne \varepsilon,\\
\chi_l(-1)(q-1)J(\chi_1,\ldots,\chi_{l-1})&\text{sinon}.
\end{array}
\right.
$$
\ee
\end{prop}
\begin{proof}
\be
\item[(a)] Si $\chi_1 = \cdots = \chi_l = \varepsilon$, alors
$$J_0(\chi_1,\ldots,\chi_l) = \sum_{t_1+\cdots+t_l = 0} 1 = \mathrm{Card}\{(t_1,\ldots,t_l)\in \F_q^l\ | \ t_1+\cdots + t_l =0\} = q^{l-1}.$$
En effet le nombre de solutions de l'\'equation de l'\'equation $t_1+\cdots+t_l = 0$ est $q^{l-1}$, puisqu'une telle solution est d\'etermin\'ee par le choix arbitraire de $(t_1,\ldots,t_{l-1})$ dans $\F_q^{l-1}$ (alors $t_l = -t_1-\cdots - t_{l-1}$).

De m\^eme,
$$J(\chi_1,\ldots,\chi_l) = \sum_{t_1+\cdots+t_l = 1} 1 = \mathrm{Card}\{(t_1,\ldots,t_l)\in \F_q^l\ | \ t_1+\cdots + t_l =1\} = q^{l-1}.$$
\item[(b)] Supposons, quitte \`a changer l'ordre des caract\`eres, que $\chi_1,\ldots,\chi_s$ sont non triviaux (avec $s\geq 1$), et que $\chi_{s+1} = \cdots=\chi_l = \varepsilon$. Alors
\begin{align*}
J_0(\chi_1,\ldots,\chi_l) &= \sum_{t_1+\cdots+t_l = 0} \chi_1(t_1)\cdots\chi_l(t_l)\\
&=\sum_{t_1\in \F_q} \chi_1(t_1) \cdots \sum_{t_s\in \F_q} \chi_s(t_s)\left(\sum_{t_{s+1} + \cdots + t_l = -t_1-\cdots-t_{s} } 1 \right)\\
&=q^{l-s-1} \left(\sum_{t_1\in \F_q} \chi_1(t_1)\right) \cdots \left(\sum_{t_s\in \F_q} \chi_s(t_s)\right)
\end{align*}
(si $t_1,\ldots,t_s$ sont fix\'es, l'\'equation $t_{s+1} + \cdots + t_l = -t_1-\cdots-t_{s} $ a $q^{l-s-1}$ solutions.)

De plus $\sum\limits_{t_1\in \F_q} \chi_1(t_1) = 0$ (proposition~\ref{somme_chi}(a)), et $s\geq 1$, donc $J_0(\chi_1,\ldots,\chi_l) = 0$.

M\^eme preuve pour $J(\chi_1,\ldots \chi_l) = 0$, l'\'equation $t_{s+1} + \cdots + t_l = -t_1-\cdots-t_{s} $ \'etant remplac\'ee par $t_{s+1} + \cdots + t_l = 1 -t_1-\cdots-t_{s} $.
\item[(c)] Partons de 
$$J_0(\chi_1,\ldots,\chi_l) = \sum_{s\in \F_q} \left(\sum_{t_1+\cdots+t_{l-1} = -s} \chi_1(t_1)\cdots\chi_{l-1}(t_{l-1})\right) \chi_l(s).$$
Comme $\chi_l \ne \varepsilon$, $\chi_l(0) = 0$, donc
$$J_0(\chi_1,\ldots,\chi_l) = \sum_{s\in \F_q^*} \left(\sum_{t_1+\cdots+t_{l-1} = -s} \chi_1(t_1)\cdots\chi_{l-1}(t_{l-1})\right) \chi_l(s).$$
\ee
Le changement d'indice donn\'e par $(t_1,\ldots,t_{l-1}) = (-st'_1,\ldots,-st'_{l-1})$ donne
\begin{align*}
\sum_{t_1+\cdots+t_{l-1} = -s} \chi_1(t_1)\cdots\chi_{l-1}(t_{l-1}) &= (\chi_1\cdots \chi_{l-1})(-s) \sum_{t'_1+\cdots+t'_{l-1} = 1} \chi_1(t'_1)\cdots\chi_{l-1}(t'_{l-1})\\
&=(\chi_1\cdots \chi_{l-1})(-s) J(\chi_1,\ldots,\chi_{l-1}).
\end{align*}
En reportant ce r\'esultat dans le calcul de $J_0(\chi_1,\ldots,\chi_l)$, nous obtenons
$$J_0(\chi_1,\ldots,\chi_l) = (\chi_1\cdots \chi_{l-1})(-1) J(\chi_1,\ldots,\chi_{l-1}) \sum_{s \in \F_p^*} (\chi_1\cdots \chi_l)(s).$$
Si $\chi_1\cdots \chi_l \ne \varepsilon$, alors $ \sum_{s \in \F_q^*} (\chi_1\cdots \chi_l)(s) = 0$. Dans le cas contraire, $ \sum_{s \in \F_q^*} (\chi_1\cdots \chi_l)(s) = q-1$, donc 
\begin{align*}
J_0(\chi_1,\ldots,\chi_l) &= (\chi_1\cdots \chi_{l-1})(-1) (q-1) J(\chi_1,\ldots,\chi_{l-1})\\
&=\overline{\chi_l(-1)} (q-1) J(\chi_1,\ldots,\chi_{l-1})\\
&=\chi_l(-1) (q-1) J(\chi_1,\ldots,\chi_{l-1}).
\end{align*}
\end{proof}

La proposition~\ref{lien_Jacobi_Gauss} se g\'en\'eralise de la façon suivante.
\begin{prop}\label{jac_gen2}
Supposons que $\chi_1,\ldots,\chi_r$ sont non triviaux, ainsi que $\chi_1 \cdots \chi_r$. Alors
$$g(\chi_1)\cdots g(\chi_r) = J(\chi_1,\ldots,\chi_r) g(\chi_1\cdots \chi_r).$$
\end{prop}
\begin{proof}
En effet, en notant $\psi(s) = \zeta_p^{\mathrm{tr}(s)}$ pour $s \in \F_q$, nous obtenons
\begin{align*}
g(\chi_1)\cdots g(\chi_r) &= \left( \sum_{t_1 \in \F_q} \chi_1(t_1) \psi(t_1) \right)\cdots \left( \sum_{t_r \in \F_q} \chi_r(t_r) \psi(t_r) \right)\\
&=\sum_{s\in \F_q} \left (\sum_{t_1+\cdots+t_r=s} \chi_1(t_1)\cdots \chi_r(t_r) \right ) \psi(s).
\end{align*}
Notons $S(s) = \sum\limits_{t_1+\cdots+t_r=s} \chi_1(t_1)\cdots \chi_r(t_r)$ la somme int\'erieure.
L'hypoth\`ese $\chi_1 \cdots \chi_r \ne \varepsilon$ permet d'appliquer la proposition~\ref{jac_gen1}(c) pour $s = 0$ :
$$S(0) = \sum_{t_1+\cdots+t_r=0} \chi_1(t_1)\cdots \chi_r(t_r) = J_0(\chi_1,\ldots,\chi_r) = 0, $$
Si $s\ne 0$, le changement d'indice $(t_1,\ldots,t_r) = (st'_1,\ldots,st'_r)$ donne
\begin{align*}
S(s) &= (\chi_1\cdots\chi_r)(s) J(\chi_1,\ldots,\chi_r)
\end{align*}
et ainsi
\begin{align*}
g(\chi_1)\cdots g(\chi_r) &= \sum_{s\in \F_p^*}  (\chi_1\cdots\chi_r)(s) J(\chi_1,\ldots,\chi_r) \zeta^s\\
&=J(\chi_1,\ldots,\chi_r) g(\chi_1\cdots \chi_r).
\end{align*}
\end{proof}

Nous en tirons les cons\'equences suivantes.
\begin{prop}\label{jac_gen3}
Supposons que $\chi_1,\ldots,\chi_r$ sont non triviaux, mais que $\chi_1\cdots \chi_r$ est trivial. Alors
$$g(\chi_1)\cdots g(\chi_r) = \chi_r(-1) \, q \, J(\chi_1,\cdots,\chi_{r-1}).$$
\end{prop}

\begin{proof}
La proposition~\ref{jac_gen2} montre que
$$g(\chi_1)\cdots g(\chi_{r-1}) = J(\chi_1,\ldots,\chi_{r-1}) g(\chi_1\cdots \chi_{r-1}).$$
En multipliant les deux membres de cette \'egalit\'e par $g(\chi_r)$, puisque $\chi_1\cdots \chi_{r-1} = \chi_r^{-1} = \overline{\chi_r}$, nous obtenons
$$g(\chi_1)\cdots g(\chi_r) =  g(\chi_r) g( \overline{\chi_r}) J(\chi_1,\ldots,\chi_{r-1}).$$
En utilisant les propositions~\ref{module} et~\ref{conjugue},
$$g(\chi_r) g( \overline{\chi_r})  = \chi_r(-1) g(\chi_r) \overline{g(\chi_r)} = \chi_r(-1)q,$$
 donc 
$$g(\chi_1)\cdots g(\chi_r) =\chi_r(-1)q J(\chi_1,\ldots,\chi_{r-1}).$$
\end{proof}

\begin{prop}\label{jac_gen4}
Supposons que $\chi_1,\ldots,\chi_r$ sont non triviaux, mais que $\chi_1\cdots \chi_r$ est trivial. Alors
$$J(\chi_1,\ldots,\chi_r) = - \chi_r(-1) J(\chi_1,\ldots,\chi_{r-1}).$$
(pour $r = 2$, nous posons $J(\chi_1) = 1$.)
\end{prop}


\begin{proof}
Pour $r = 2$, il s'agit de la proposition~\ref{jacobi1}(c). Supposons maintenant que $r>2$.

Comme au d\'ebut de la d\'emonstration de la proposition~\ref{jac_gen2}, nous obtenons
\begin{align}\label{equa1}
g(\chi_1)\cdots g(\chi_r) = \sum_{s\in \F_q} \left (\sum_{t_1+\cdots+t_r=s} \chi_1(t_1)\cdots \chi_r(t_r) \right ) \psi(s),
\end{align}
mais maintenant, l'hypoth\`ese $\chi_1\cdots \chi_r = \varepsilon$ donne, \`a l'aide de la proposition~\ref{jac_gen1}(c),
\begin{align}\label{equa2}
S(0) = \sum_{t_1+\cdots+t_r=0} \chi_1(t_1)\cdots \chi_r(t_r) = J_0(\chi_1,\ldots,\chi_r) = \chi_r(-1)(q-1)J(\chi_1,\ldots,\chi_{r-1}), 
\end{align}
et pour $s \ne 0$, comme dans la d\'emonstration de la proposition~\ref{jac_gen1},
\begin{align}\label{equa3}
S(s) = \sum\limits_{t_1+\cdots+t_r=s} \chi_1(t_1)\cdots \chi_r(t_r) = (\chi_1\cdots\chi_r)(s) J(\chi_1,\ldots,\chi_r).
\end{align}
Ici $\chi_1\cdots \chi_r = \varepsilon$, donc $S(s) = J(\chi_1,\ldots,\chi_r)$.

Ainsi, en utilisant les \'egalit\'es (\ref{equa1}), (\ref{equa2}), et (\ref{equa3}), ainsi que $ \sum_{s\in \F_q} \psi(s) = 0$ (proposition~\ref{proprietes_psi}),
\begin{align*}
g(\chi_1)\cdots g(\chi_r) &= J_0(\chi_1,\ldots,\chi_r) + J(\chi_1,\ldots,\chi_r) \sum_{s\in \F_q^*} \psi(s)\\
&=\chi_r(-1)(q-1)J(\chi_1,\ldots,\chi_{r-1}) -  J(\chi_1,\ldots,\chi_r) 
\end{align*}
La proposition~\ref{jac_gen3} donne $$g(\chi_1)\cdots g(\chi_r) = \chi_r(-1) \, q \, J(\chi_1,\cdots,\chi_{r-1}).$$ Par cons\'equent, 
\begin{align*}
\chi_r(-1) \, q \, J(\chi_1,\cdots,\chi_{r-1}) &= \chi_r(-1)(q-1)J(\chi_1,\ldots,\chi_{r-1})  - J(\chi_1,\ldots,\chi_r) \\
\end{align*}
et donc
$$J(\chi_1,\ldots,\chi_r) = -\chi_r(-1) J(\chi_1,\ldots,\chi_{r-1}).$$
\end{proof}

\begin{prop}\label{jac_gen5}
Supposons que $\chi_1,\ldots,\chi_r$ sont des caract\`eres non triviaux sur $\F_q$.
\be
\item[(a)] Si $\chi_1\cdots\chi_r \ne \varepsilon$, alors
\begin{align*}
|J_0(\chi_1,\ldots,\chi_r)| &=0,\\
|J(\chi_1,\ldots,\chi_r)| &= q^{\frac{r-1}{2}}.
\end{align*}
\item[(b)] Si $\chi_1\cdots\chi_r = \varepsilon$, alors
\begin{align*}
|J_0(\chi_1,\ldots,\chi_r)| &= (q-1)q^{\frac{r}{2} - 1},\\
|J(\chi_1,\ldots,\chi_r)| &= q^{\frac{r}{2} - 1}.
\end{align*}
\ee
\end{prop}
\begin{proof}
Si $\chi$ n'est pas un caract\`ere trivial, alors $|g(\chi)| = \sqrt{q}$. 

\be
\item[(a)] 

Si $\chi_1\cdots\chi_r \ne  \varepsilon$, la proposition~\ref{jac_gen1}(c) donne $J_0(\chi_1,\ldots,\chi_r) = 0$,
et la proposition~\ref{jac_gen2} donne
$$|J(\chi_1,\ldots,\chi_r)| = \frac{(\sqrt{q})^r}{\sqrt{q}} = q^{\frac{r-1}{2}} .$$
\item[(b)] Si $\chi_1\cdots\chi_r = \varepsilon$, la proposition~\ref{jac_gen1}(c) et la relation pr\'ec\'edente donnent, puisque $\chi_1\cdots\chi_{r-1} = \chi_r^{-1} \ne \varepsilon$,
\begin{align*}
|J_0(\chi_1,\ldots,\chi_r)| &= (q-1) |J(\chi_1,\ldots,\chi_{r-1})|\\
&=(q-1) q^{\frac{r}{2} - 1}.
\end{align*}
Enfin, 
\begin{align*} |J(\chi_1,\ldots,\chi_r)|&=|J(\chi_1,\ldots,\chi_{r-1})| \qquad \text{(proposition~\ref{jac_gen4})}\\
&= q^{\frac{r}{2} - 1} \qquad \qquad \qquad \quad \text{(partie (a))}.
\end{align*}
\ee
\end{proof}


\section{Applications arithm\'etiques des sommes de Jacobi.}

G\'en\'eralisons le calcul de $N(x^2 + y^2 = 1)$ \`a $N(x_1^2\cdots+x_r^2 = 1)$ dans $\F_p$, o\`u $p$ est premier.

Soit $\chi$ l'unique caract\`ere d'ordre 2, le caract\`ere de Legendre. Nous avons vu que $N(x^2 = a) =1 + \chi(a)$. Alors
\begin{align*}
N(x_1^2+\cdots+x_r^2 = 1) &= \sum_{a_1+\cdots+a_r=1} N(x_1^2 =a_1)\cdots N(x_r^2=a_r)\\
&=\sum_{a_1+\cdots+a_r=1} (1 + \chi(a_1))\cdots(1+\chi(a_r))\\
&=\sum_{a_1+\cdots+a_r=1} \sum_{(i_1,\ldots,i_r) \in \{0,1\}^r} \chi^{i_1}(a_1)\cdots\chi^{i_r}(a_r)\\
&=  \sum_{(i_1,\ldots,i_r) \in \{0,1\}^r} J(\chi^{i_1},\ldots,\chi^{i_r})
\end{align*}

Si $i_1 = \cdots = i_r = 0$, alors $J(\chi^{i_1},\ldots,\chi^{i_r}) = J(\varepsilon,\ldots,\varepsilon) = p^{r-1}$ d'apr\`es la proposition~\ref{jac_gen1}(a).

Si l'un des exposant $i_k$ est nul, mais pas tous, la proposition~\ref{jac_gen1}(b) donne $J(\chi^{i_1},\ldots,\chi^{i_r}) = 0$. Il ne reste que le cas o\`u $i_1 = \cdots=i_r=1$, donc
$$N(x_1^2+\cdots+x_r^2 = 1) = p^{r-1} + J(\chi,\ldots,\chi).$$
Notons que $\chi^{r} = \chi$ si $r$ est impair et $\chi^r = \varepsilon$ si $r$ est pair.

Supposons d'abord que $r$ est impair. Alors $\chi^r = \chi$ n'est pas trivial, donc la proposition~\ref{jac_gen2} donne
$$J(\chi,\cdots,\chi) = g(\chi)^{r-1}.$$
Les propositions~\ref{module} et~\ref{conjugue} donnent, puisque $\chi$ est \`a valeur r\'eelles, 
$g(\chi)^2 = g(\chi)g(\overline{\chi}) = \chi(-1) g(\chi) \overline{g(\chi)} = \chi(-1)p$, et ainsi
$$g(\chi)^2 = \chi(-1) p.$$
Alors $J(\chi,\cdots,\chi) = (\chi(-1) p)^{\frac{r-1}{2}} = (-1)^{\frac{r-1}{2} \frac{p-1}{2}} p^{\frac{r-1}{2}}.$

Si $r$ est pair, alors $\chi^r=\varepsilon$. La proposition~\ref{jac_gen4} donne
$$J(\chi,\ldots,\chi) = -\chi(-1) (\chi(-1) p)^{\frac{r}{2}-1} =  -(-1)^{\frac{r}{2} \frac{p-1}{2}} p^{\frac{r}{2} -1}.$$
Nous avons donc prouv\'e la proposition suivante :
\begin{prop}Si $r$ est impair, 
$$N(x_1^2+\cdots+x_r^2 = 1) = p^{r-1} + (-1)^{\frac{r-1}{2} \frac{p-1}{2}} p^{\frac{r-1}{2}},$$
et si r est pair,
$$N(x_1^2+\cdots+x_r^2 = 1) = p^{r-1} - (-1)^{\frac{r}{2} \frac{p-1}{2}} p^{\frac{r}{2} -1}.$$
\end{prop}

\section{Un th\'eor\`eme g\'en\'eral.}

G\'en\'eralisant les r\'esultats pr\'ec\'edents, nous estimons maintenant le nombre de solutions $N$ dans $\F_q$ de
$$a_1x_1^{l_1} + \cdots + a_r x_r^{l_r} = b,$$
o\`u $a_1,\ldots,a_r\in \F_q^*, b \in \F_q$ et $l_i \in \N^*$.

Puisque $N(x^m = a) = N(x^d = a)$, o\`u $d = m \wedge (q-1)$, nous pouvons supposer que les exposants $l_i$ sont des diviseurs de $q-1$ (proposition~\ref{cas_general}).

Nous partons de 
$$ N = \sum_{\sum_{i=1}^r a_i u_i = b} N(x_1^{l_1} = u_1) \cdots N(x_r^{l_r} = u_r).$$

Comme dans le paragraphe~\ref{caracteres}, notons $C_{l}$ l'ensemble des caract\`eres sur $\F_p$ dont l'ordre divise $l$. La proposition 10 donne
$$N(x_i^{l_i} =u_i)= \sum_{\chi_i \in C_{l_i}} \chi_i(u_i).$$
Ainsi
$$N = \sum_{(\chi_1,\ldots,\chi_r) \in C_{l_1} \times \cdots C_{l_r}} \left ( \sum_{\sum_{i=1}^r a_i u_i = b} \chi_1(u_1)\cdots \chi_r(u_r) \right).$$
Traitons la somme int\'erieure
$$T = T_{\chi_1,\ldots,\chi_r} =  \sum_{\sum_{i=1}^r a_i u_i = b} \chi_1(u_1)\cdots \chi_r(u_r),$$
en distinguant les cas $b = 0, b\ne 0$.

\be
\item[$\bullet$] Si $b = 0$, le changement de variable $t_i = a_i u_i$ donne 
\begin{align*}
T &= \sum_{t_1+\cdots + t_r = 0} \chi_1(a_1^{-1} t_1)\cdots \chi_r(a_r^{-1} t_r)\\
&=\chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J_0(\chi_1,\ldots,\chi_r).
\end{align*}

La proposition~\ref{jac_gen1} donne $J_0(\chi_1,\ldots,\chi_r) = q^{r-1}$ si $\chi_1 = \cdots = \chi_r = \varepsilon$, et  $J_0(\chi_1,\ldots,\chi_r) = 0 $ si l'un des $\chi_i$ est trivial, mais pas tous.
Enfin, si $\chi_1\ldots\chi_r = \varepsilon \ne 0$, alors $J_0(\chi_1,\ldots,\chi_r) = 0 $.

Ainsi
$$N = q^{r-1} + \sum_{(\chi_1,\ldots,\chi_r) \in A} \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J_0(\chi_1,\ldots,\chi_r),$$
o\`u $A$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$ et $\chi_1 \cdots \chi_r = \varepsilon$. 

Posons $M = |A|$. Si $(\chi_1,\ldots,\chi_r) \in A$, la proposition~\ref{jac_gen5} donne $|J_0(\chi_1,\ldots,\chi_r)| = (q-1) q^{\frac{r}{2} - 1}$. Par cons\'equent,
$$|N - q^{r-1}| \leq M  (q-1) q^{\frac{r}{2} - 1}.$$





\item[$\bullet$] Si $b\ne 0$, le changement de variable $t_i = b^{-1} a_i u_i$ donne
\begin{align*}
T &=  \sum_{t_1+\cdots + t_r = 1} \chi_1( b a_1^{-1} t_1) \cdots  \chi_r( b a_r^{-1} t_r) \\
&=(\chi_1\cdots \chi_r)(b) \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J(\chi_1,\ldots,\chi_r).
\end{align*}
La proposition~\ref{jac_gen1} donne $J(\chi_1,\ldots,\chi_r) = q^{r-1}$ si $\chi_1 = \cdots = \chi_r = \varepsilon$, et  $J(\chi_1,\ldots,\chi_r) = 0 $ si l'un des $\chi_i$ est trivial, mais pas tous.

Ainsi
$$N = q^{r-1} + \sum_{(\chi_1,\ldots,\chi_r) \in B} (\chi_1\cdots \chi_r)(b) \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J(\chi_1,\ldots,\chi_r),
$$
o\`u $B$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$.

Alors, d'apr\`es la proposition~\ref{jac_gen5},
$$
|J(\chi_1,\ldots, \chi_r)| = 
\left\{
\begin{array}{ll}
q^{\frac{r}{2} - 1} & \text{si } \chi_1\cdots \chi_r =  \varepsilon,\\
q^{\frac{r-1}{2}} & \text{si } \chi_1\cdots \chi_r \ne \varepsilon.\\
\end{array}
\right.
$$
Alors 
\begin{align*}N = q^{r-1} &+ \sum_{(\chi_1,\ldots,\chi_r) \in C} (\chi_1\cdots \chi_r)(b) \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J(\chi_1,\ldots,\chi_r)\\
&+\sum_{(\chi_1,\ldots,\chi_r) \in D} (\chi_1\cdots \chi_r)(b) \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J(\chi_1,\ldots,\chi_r),
\end{align*}
o\`u 

$C$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$ et $ \chi_1\cdots \chi_r =  \varepsilon$,

$D$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$ et $ \chi_1\cdots \chi_r \ne  \varepsilon$.

Notons $M_0 = |B|, M_1 = |C|$. Alors,
$$|N-q^{r-1}| \leq M_0 \, q^{\frac{r}{2} - 1} + M_1\,  q^{\frac{r-1}{2}} .$$
\ee
Nous avons prouv\'e la proposition suivante.

\begin{prop}
Soit $N$ le nombre de solutions dans $\F_q^r$ de 
$$a_1x_1^{l_1} + \cdots + a_r x_r^{l_r} = b,$$
o\`u $a_1,\ldots,a_r\in \F_q^*, b \in \F_q, l_i \in \N^*$ (et $l_i \mid q-1,\ i= 1,\ldots,r$).
\be
\item[$\bullet$] Si $b=0$, alors
$$N = q^{r-1} + \sum_{(\chi_1,\ldots,\chi_r) \in A} \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J_0(\chi_1,\ldots,\chi_r),$$
o\`u $A$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$ et $\chi_1 \cdots \chi_r = \varepsilon$. Si $M = |A|$, alors
$$|N - q^{r-1}| \leq M  (q-1) q^{\frac{r}{2} - 1}.$$
\item[$\bullet$] Si $b\ne 0$, alors 
$$N = q^{r-1} + \sum_{(\chi_1,\ldots,\chi_r) \in B} (\chi_1\cdots \chi_r)(b) \chi_1(a_1^{-1}) \cdots \chi_r(a_r)^{-1} J(\chi_1,\ldots,\chi_r),
$$
o\`u $B$ est l'ensemble des $r$-uplets $(\chi_1,\ldots,\chi_r)$ tels que $\chi_i^{l_i} = \varepsilon, \chi_i \ne \varepsilon$.

Si $M_0$ est le nombre des $p$-uplets de $B$, v\'erifiant de plus $\chi_1\cdots \chi_r = \varepsilon$, et $M_1$ le nombre des $p$-uplets de $B$ v\'erifiant $\chi_1\cdots \chi_r \ne \varepsilon$, alors
$$|N-q^{r-1}| \leq M_0 \, q^{\frac{r}{2} - 1} + M_1\,  q^{\frac{r-1}{2}} .$$
\ee
\end{prop}

\medskip

Cette proposition prouve en particulier que l'\'equation $a_1x_1^{l_1} + \cdots + a_r x_r^{l_r} = b$ a des solutions dans $\F_q$ si $q$ est assez grand, et que le nombre de ces solutions tend vers l'infini quand $q$ tend vers l'infini.


\chapter{R\'eciprocit\'e cubique.}
Les r\'esultats de ce chapitre, ainsi que du chapitre suivant, viennent de [Ireland, Rosen], [Cox2] et [Lemmermeyer].
Notons ici $A = \Z[\omega]$, o\`u, comme dans le chapitre pr\'ec\'edent $\omega^3 = 1, \omega \ne 1$.
Les nombres premiers de $\Z$ serons nomm\'es ``premiers rationnels'', pour les distinguer des \'el\'ements premiers de $A$.

\section{Anneaux quotients de $\Z[\omega]$.}


Si $\pi$ est premier dans $A$, alors $A/\pi A$ est un corps (voir le chapitre anneaux).

\begin{prop} \label{prop71}
Soit $\pi \in A  =  \Z[\omega]$ un \'el\'ement premier.  Alors $A/\pi A$ est un corps \`a $\n(\pi)$ \'el\'ements :
$$\n(\pi) = |A/\pi A|.$$
\end{prop}
\begin{proof}
Nous prouvons cette proposition en consid\'erant les diff\'erents types d'\'el\'ements premiers de $\Z[\omega]$, donn\'es dans la proposition \ref{prop22} du chapitre ``Entiers de Gauss''.
\be
\item[$\bullet$] Supposons que $\pi = q$ est un premier rationnel, o\`u $q \equiv 2 \pmod 3, q>0$. V\'erifions que
$$S = \{a + b \omega\ | \ 0 \leq a < q, \ 0\leq b < q\}$$
est un syst\`eme complet de repr\'esentants des classes modulo $\pi$.

Si $\alpha = u + \omega v \in A$, alors les divisions euclidiennes de $u$ et $ v$ par $q$ donnent des entiers $a,b,s,t$ tels que $u = qs +a, v = qt +b$, o\`u $0\leq a <q, 0 \leq b < q$. Alors $\alpha \equiv a + b \omega \pmod q$, o\`u $a + b \omega \in S$.

V\'erifions que les \'el\'ements de $S$ sont dans des classes distinctes. Si $\alpha =a +b \omega \equiv \beta = a' + b' \omega \pmod q$, o\`u $\alpha, \beta \in S$, alors $q \mid (a - a')+(b-b') \omega$, donc $\frac{a-a'}{q} + \omega\frac{b-b'}{q} \in \Z[\omega]$, ce qui implique $q \mid a-a', q \mid b-b'$. Comme $|a-a'| < q$ et $|b-b'|<q$, il s'ensuit que $a=a', b=b'$, donc $\alpha = \beta$. Ainsi $|A/\pi A| = |S| = q^2 = \n(q) = \n(\pi)$.

\item[$\bullet$] Supposons que $\pi = a + b \omega$ v\'erifie $\n(\pi) = p$, o\`u $p$ est un premier rationnel, $p\equiv 1 \pmod 3$. V\'erifions que
$$T = \{0,1,\cdots,p-1\}$$
est un syst\`eme complet de repr\'esentants des classes.

Comme $\n(\pi) = p = a^2 -ab +b^2$, il s'ensuit que $p\nmid b$, sinon $p\mid a, p\mid b$, donc $p^2 \mid a^2-ab +b^2 = p$, donc $p\mid 1$ : c'est absurde.

Soit $\alpha = u + \omega v \in A$. Comme $p\nmid b$, il existe un entier $c$ tel que $cb \equiv v \pmod p$, a fortiori modulo $\pi$. Alors $\alpha -c \pi = u -ca + \omega(v -cb)$, donc $\alpha \equiv u -ca \pmod \pi$. Posons $n = u-ca$. Alors $n\in \Z$, et $\alpha \equiv n \pmod \pi$. La division euclidienne de $n$ par $p$ donne $n =ps +r, \ 0\leq r < p$, donc $\alpha \equiv r \pmod \pi$, o\`u $r \in T$.

Les \'el\'ements de $T$ sont dans des classes distinctes modulo $\pi$. En effet, si $r,s \in T$, et $r \equiv s \pmod \pi$, alors $\pi \mid r-s$, soit $r-s =\pi \lambda , \lambda \in A$, donc $(r-s)^2 =  \n(\pi) \n(\lambda) = p \n(\lambda)$. Ainsi $p \mid (r-s)^2$, o\`u $p$ est un premier rationnel, donc $p \mid r-s$, o\`u $|r-s|<p$, donc $r= s$.

Par cons\'equent, $ |A/\pi A| = |T| = p = \n(\pi)$.

\item[$\bullet$] Supposons que $\pi = 1 - \omega$. V\'erifions que
$$U = \{0,1,2\}$$
est un syst\`eme complet de repr\'esentants des classes modulo $\pi = 1 - \omega$.

Soit $\alpha =a + b \omega \in A$ quelconque. Comme $\omega \equiv 1 \pmod \pi$, $\alpha \equiv a + b \pmod \pi$. Posons $n = a +b$; alors $n\in \Z$ et $\alpha \equiv n \pmod \pi$. La division euclidienne de $n$ par $3$ donne les entiers $q,r$ tels que $n =3q + r, r \in \{0,1,2\}$, donc $n \equiv r \pmod 3$, et puisque $1 - \omega \mid 3$, $\alpha \equiv n \equiv r \pmod \pi$, o\`u $r \in U$.

De plus, $0 \not \equiv 2 \pmod \pi$, sinon $\pi \mid 2$, et $\pi \mid 3$, donc $\pi \mid 1$ : c'est absurde puisque $\pi$ est premier, et n'est donc pas une unit\'e. De m\^eme, $0 \equiv 1$, ou $1 \equiv 2$, entra\^ine $\pi \mid 1$, ce qui contredit l'hypoth\`ese $\pi$ premier.

Ainsi $|A/\pi A| = |U| = 3 = \n(\pi)$.
\ee
Si $\lambda$ est un \'el\'ement premier quelconque de $A$, alors $\lambda$ est associ\'e \`a un \'el\'ement $\pi$ appartenant \`a l'un des trois types consid\'er\'es, donc v\'erifiant $\n(\pi) = |A/\pi A|$. Alors $\n(\pi) = \n(\lambda)$, et $\pi A = \lambda A$, donc $\n(\lambda) = |A/\lambda A|$.

\end{proof}


\section{Caract\`ere cubique.}
Ici $A = \Z[\omega]$. Donnons l'analogue du th\'eor\`eme de Fermat dans $A$.
\begin{prop}\label{prop72}
Soit $\alpha \in A$, et $\pi$ un premier de $A$ tel que $\pi$ ne divise pas $\alpha$. Alors 
$$\alpha^{\n(\pi) - 1} \equiv 1 \pmod \pi.$$
\end{prop}
\begin{proof}
Soit $K$ le corps $A/\pi A$. Le cardinal du groupe $K^*$ est $\n(\pi) -1$, donc l'ordre de la classe $[\alpha] \in K^*$ divise $\n(\pi) -1$. Ainsi $[\alpha]^{\n(\pi) - 1} = 1$, donc $\alpha^{\n(\pi) - 1} \equiv 1 \pmod \pi.$
\end{proof}

\begin{prop}\label{prop73}
Si $\pi$ est un premier de $A$, et si $\n(\pi) \ne 3$, alors
$$3 \mid \n(\pi) - 1.$$
\end{prop}
\begin{proof}
Notons que si $\n(\pi) \ne 3$, alors les classes modulo $\pi$ de $1,\omega, \omega^2$ sont distinctes.

En raisonnant par l'absurde, supposons que $1 \equiv \omega \pmod \pi$. Alors $\pi \mid 1 - \omega$, o\`u $1-\omega$ est premier, donc $\pi$ serait associ\'e \`a $1 - \omega$, mais alors $\n(\pi) = \n(1-\omega) = 3$, contrairement \`a l'hypoth\`ese. Comme $\omega^2 - 1 = (\omega +1)(\omega - 1) = \omega^2(1-\omega)$, et $\omega - \omega^2 = \omega(1-\omega)$ sont tous deux associ\'es \`a $1- \omega$, le m\^eme raisonnement montre que $1 \not \equiv \omega^2 \pmod \pi$ et $\omega\not \equiv \omega^2 \pmod \pi$.

L'ensemble des classes $\{[1],[\omega],[\omega]^2\}$ est donc un sous-groupe \`a trois \'el\'ements du groupe $(A/\pi A)^*$. Le th\'eor\`eme de Lagrange montre alors que
$$3 \mid \n(\pi) - 1.$$
\end{proof}
A titre de v\'erification, si $\pi = q$, o\`u $q \equiv 2 \pmod 3$, alors $\n(\pi) = q^2 \equiv 1 \pmod 3$, et si $\pi$ v\'erifie $\n(\pi) = p$, alors $p\equiv 1 \pmod 3$.

\begin{prop}
Supposons que $\pi$ est un premier de $A$ tel que $\n(\pi) \ne 3$, et que $\pi \nmid \alpha$. Alors il existe un unique entier $m \in\{0,1,2\}$ tel que
$$\alpha^{\frac{\n(\pi) - 1}{3}} \equiv \omega^m \pmod \pi.$$
\end{prop}
\begin{proof}
Nous savons que $\pi$ divise $\alpha^{\n(\pi) - 1} - 1$, et comme $\n(\pi) - 1$ est un multiple de 3,
$$\alpha^{\n(\pi) - 1} - 1 = (\alpha^{\frac{\n(\pi) - 1}{3}} - 1)(\alpha^{\frac{\n(\pi) - 1}{3}} - \omega)(\alpha^{\frac{\n(\pi) - 1}{3}} - \omega^2).$$
Comme $\pi$ est premier, il divise l'un des trois facteurs. De plus $1,\omega, \omega^2$ sont dans des classes distinctes modulo $\pi$, donc il divise au plus un de ces facteurs. Ainsi $\alpha^{\n(\pi) - 1} \equiv \omega^m \pmod \pi,$ pour un unique $m\in \{0,1,2\}$.
\end{proof}

Notons que dans le cas o\`u $\pi \mid \alpha$, $\alpha^{\frac{\n(\pi) - 1}{3}} \equiv 0 \pmod \pi$.

Nous savons que les classes de $1,\omega,\omega^2$ dans $A/\pi A$ sont distinctes. De plus, les classes de $0,1,\omega, \omega^2$ sont distinctes, puisque $\omega^k \equiv 0 \pmod \pi$, entra\^ine $\pi \mid \omega^k$, donc $\pi \mid 1$, ce qui est absurde puisque $\pi$ premier n'est pas une unit\'e. Pour tout $\alpha \in A$, $[\alpha]^{\frac{\n(\pi) - 1}{3}}  \in \{[0],[1],[\omega],[\omega]^2\}$, donc il existe un et un seul $z \in \{0,1,\omega,\omega^2\}$ tel que $\alpha^{\frac{\n(\pi) - 1}{3}} \equiv z \pmod \pi$. Ceci justifie la d\'efinition suivante :
\begin{dfn}
Soit $\pi$ un premier de $A$ tel que $\n(\pi) \ne 3$. Le caract\`ere cubique de $\alpha \in A$ modulo $\pi$, not\'e $\legendre{\alpha}{\pi}_{3}$ (ou $(\alpha/\pi)_3$) est le nombre complexe de l'ensemble $\{0,1, \omega, \omega^2\}$ caract\'eris\'e par
 $$\legendre{\alpha}{\pi}_3 \equiv \alpha^{\frac{\n(\pi) - 1}{3}} \pmod \pi.$$ 
\end{dfn}
Cette d\'efinition implique que $\legendre{\alpha}{\pi}_3 = 0 \iff \pi \mid \alpha$.

\begin{prop}\label{prop75}
Si $\legendre{\alpha}{\pi}_3 \equiv \zeta \pmod \pi$, o\`u $\zeta \in \{0,1,\omega,\omega^2\}$, alors $\legendre{\alpha}{\pi}_3 = \zeta$.
\end{prop}
\begin{proof}
En effet, $\legendre{\alpha}{\pi}_3$ et $\zeta$ sont des \'el\'ements de $\{0,1,\omega,\omega^2\}$, et les classes de ces \'el\'ements sont distinctes modulo $\pi$.
\end{proof}

Donnons les premi\`eres propri\'et\'es de ce caract\`ere cubique
\begin{prop} \label{prop76}
Si $\alpha, \beta \in A$, et si $\pi$ est un premier de $A$ tel que $\n(\pi)\ne 3$, 
\be 
\item[(a)] $\legendre{\alpha\beta}{\pi}_3 = \legendre{\alpha}{\pi}_3 \legendre{\beta}{\pi}_3 .$ 
\item[(b)] Si $\alpha \equiv \beta \pmod \pi$, alors $\legendre{\alpha}{\pi}_3  = \legendre{\beta}{\pi}_3$.
\ee
\end{prop}
\begin{proof}
\be
\item[(a)]Par d\'efinition
$$\legendre{\alpha\beta}{\pi}_3  \equiv (\alpha \beta)^{\frac{\n(\pi) - 1}{3}} = \alpha^{\frac{\n(\pi) - 1}{3}} \beta^{\frac{\n(\pi) - 1}{3}} \equiv \legendre{\alpha}{\pi}_3\legendre{\beta}{\pi}_3 \pmod \pi.$$

La proposition \ref{prop75} permet de conclure que
$$\legendre{\alpha\beta}{\pi}_3  = \legendre{\alpha}{\pi}_3\legendre{\beta}{\pi}_3.$$
\item[(b)] Si $\alpha \equiv \beta \pmod \pi$, alors $ \alpha^{\frac{\n(\pi) - 1}{3}}  \equiv  \beta^{\frac{\n(\pi) - 1}{3}} \pmod \pi$, donc $\legendre{\alpha}{\pi}_3 \equiv \legendre{\beta}{\pi}_3 \pmod \pi$. La proposition \ref{prop75} montre alors que $\legendre{\alpha}{\pi}_3 = \legendre{\beta}{\pi}_3$.
\ee
\end{proof} 

Notons que (b) assure que l'application $\chi$
$$
\begin{array}{ccc}
(A/\pi A)^* & \to & \C^*\\
{[}\alpha {]}& \mapsto & \legendre{\alpha}{\pi}_3 
\end{array}
$$
est bien d\'efinie, et le (a) montre que $\chi$ est un homomorphisme de groupe. Ainsi $\chi$ est un caract\`ere multiplicatif sur $(A/\pi A)^*$, et il est d'ordre 3. 

Le caract\`ere cubique permet de caract\'eriser les cubes de $A$ modulo $\pi$.

\begin{prop}\label{prop77}
 Soit $\alpha \in  A = \Z[\omega]$, et $\pi$ un premier de $A$ tel que $\n(\pi) \ne 3$ et $\pi \nmid \alpha$. Alors
$$\legendre{\alpha}{\pi}_3 = 1 \iff \exists x \in A, \ x^3 \equiv \alpha \pmod \pi.$$ 
\end{prop}

\begin{proof}
$A/\pi A$ est un corps \`a $\n(\pi)$ \'el\'ements d'apr\`es la proposition \ref{prop71}, et $3$ divise $\n(\pi) - 1$ d'apr\`es la proposition \ref{prop73}, donc $d = 3 \wedge (\n(\pi) - 1) = 3$. Alors la proposition 1 du chapitre "Sommes de Gauss et sommes de Jacobi" montre que l'\'equation $[x]^3 = [\alpha]$ a une solution dans $(A/\pi A)^*$ si et seulement si $[\alpha]^{\frac{\n(\pi) - 1}{3}} = 1$, ce qui \'equivaut \`a $\legendre{\alpha}{\pi}_3 = 1$.
\end{proof}
Nous verrons comment ceci permet de caract\'eriser les cubes de $\F_p^*$.

Notons dans cette section $\chi_{\pi}(\alpha) = \legendre{\alpha}{\pi}_3$, si $\alpha \in A$.

\begin{prop}\label{prop78}
 Si $\alpha \in A$,
$$\overline{\chi_\pi(\alpha)} = \chi_{\overline{\pi}}(\overline{\alpha}).$$
\end{prop}
\begin{proof}
La d\'efinition de $\chi_\pi$ donne la relation
$$\alpha^{\frac{\n(\pi) - 1}{3}} \equiv \chi_\pi(\alpha) \pmod \pi.$$
Le passage au conjugu\'e donne
$$\overline{\alpha}^{\, \frac{\n(\pi) - 1}{3}} \equiv \overline{\chi_\pi(\alpha)} \pmod {\overline{\pi}}. $$
Comme $\n(\pi) = \n(\overline{\pi})$,
\begin{align*}
\chi_{\overline{\pi}}(\overline{\alpha}) &\equiv  \overline{\alpha}^{\frac{\n(\overline{\pi}) - 1}{3}} \pmod {\overline{\pi}}\\
&=\overline{\alpha}^{\frac{\n(\pi) - 1}{3}} \\
& \equiv \overline{\chi_\pi(\alpha)} \pmod {\overline{\pi}}.
\end{align*}
La conclusion vient alors de la proposition \ref{prop75}.
\end{proof}

\begin{prop}\label{prop79}
Soit $q$ un premier rationnel, $q\equiv 2 \pmod 3, q>0$. Si $n\in \Z$ est premier avec $q$, alors $\chi_q(n) = 1$.
\end{prop}

\begin{proof}
L'\'el\'ement $q$ est premier dans $A$, et par d\'efinition de $\chi_q$,
$$\chi_q(n) \equiv n^{\frac{\n(q) - 1}{3}} = n^{\frac{q^2 - 1}{3}} = (n^{q-1})^{\frac{q+1}{3}} \equiv 1 \pmod q.$$
\end{proof}

Remarque 1 : l'exemple 2 de la proposition \ref{nbsols} du chapitre ``Sommes de Gauss et sommes de Jacobi'' d\'emontre que dans le cas $q \equiv 2 \pmod 3, q \nmid n$, il existe un entier $x \in \Z$ tel que $x^3 \equiv n \pmod q$. La proposition \ref{prop77} donne alors $\chi_q(n) = 1$, ce qui prouve \`a nouveau la proposition.

\medskip

Remarque 2: si $q \ne q'$ sont des premiers rationnels tous deux congrus \`a 2 modulo 3, alors $\chi_q(q')  = \chi_{q'}(q) = 1$, ce qui est un cas particulier de la loi de r\'eciprocit\'e cubique.



\section{\'El\'ements primaires de $\Z[\omega]$}

Introduisons la notion d'\'el\'ement primaire, qui permet de choisir un \'el\'ement privil\'egi\'e parmi les associ\'es d'un \'el\'ement de $A$.

\begin{dfn} 
Un \'el\'ement $\alpha  = a + b \omega \in A = \Z[\omega], (a,b \in \Z)$, qui n'est pas une unit\'e, est dit primaire si $\alpha \equiv -1 \pmod 3$. 
\end{dfn}




Si $\alpha= a + b \omega$ est premier dans $A$, $\alpha$ est primaire signifie que $a \equiv -1 \pmod 3$ et $b \equiv 0 \pmod 3$. En effet $a + b\omega \equiv -1 \pmod 3$ \'equivaut \`a $3 \mid a+1 + b \omega$, soit $\frac{a+1}{3} + \frac{b}{3} \omega \in \Z[\omega]$.

Ce concept d'\'el\'ement primaire permet de distinguer un \'el\'ement parmi les 6 conjugu\'es d'un \'el\'ement de $A$.



\begin{prop}\label{prop80}
Soit $\alpha$ un \'el\'ement de $A = \Z[\omega]$ qui n'est pas une unit\'e et tel que $\lambda = 1 - \omega \nmid \alpha$. Parmi les associ\'es de $\alpha$, exactement un est primaire.
\end{prop}
\begin{proof}
Rappelons que $3 = \n(\lambda) = \lambda \overline{\lambda} = -\omega^2 \lambda^2$, et donc $\lambda \mid 3$ dans $A$.

Les associ\'es de $\alpha= a + b \omega$ sont $\alpha, \omega\alpha, \omega^2 \alpha, -\alpha, -\omega\alpha,-\omega^2 \alpha$, soit
$$a + b \omega,-b +(a-b)\omega,(b-a) - a\omega,-a - b \omega,b + (b-a)\omega,(a-b) + a \omega.$$


Puisque $\lambda \nmid \alpha$, a fortiori $3 \nmid \alpha$, donc $a$ et $b$ ne sont pas tous deux divisibles par 3. Posons $A + B\omega =a + b \omega$ si $3 \nmid a$, et $A+ B \omega = - b + (a-b)\omega$ sinon : dans les deux cas $3\nmid A$. Les \'el\'ements $A+ B \omega$ et $-A - B \omega$ sont des conjugu\'es de $\alpha$, et $A \equiv -1 \pmod 3$, ou $-A \equiv -1 \pmod 3$, donc l'un des conjugu\'es $\beta = c + d\omega$ de $\alpha$ v\'erifie $c \equiv -1 \pmod 3$.

Alors $d \not \equiv 1 \pmod 3$. Sinon $\beta = 3m-1 + (3n+1) \omega$, o\`u $m,n\in \Z$, et alors $\beta= 3(m+n\omega) - (1-\omega)$ est divisible par $1-\omega$, et donc aussi son associ\'e $\alpha$, contrairement \`a l'hypoth\`ese. Ainsi $d \equiv 0 \pmod 3$ ou $d \equiv -1 \pmod 3$. Dans le premier cas, $\beta$ est primaire, et dans le deuxi\`eme cas son associ\'e $-\omega \beta = d + (d-c) \omega \equiv -1 \pmod 3$ est primaire.

Pour montrer l'unicit\'e, notons $a+b \omega$ un des conjugu\'es primaires de $\alpha$, alors $a \equiv -1, b \equiv 0 \pmod 3$. V\'erifions alors que les 5 autres conjugu\'es ne sont pas primaires. Comme $b \equiv 0 \pmod 3$, alors $-b+(a-b)\omega$ n'est pas primaire, ni $b + (b-a)\omega$. De m\^eme $a \not \equiv 0 \pmod 3$, donc $(b-a) -a\omega$ n'est pas primaire, ni  $(a-b) + a\omega$. Enfin  $-a \equiv 1 \pmod 3$, donc $-a - b \omega$ n'est pas primaire.
\end{proof}

Pr\'ecisons la d\'ecomposition d'un \'el\'ement de $A$ en facteurs premiers.

\begin{prop}\label{prop81}
Soit $S$ l'ensemble contenant $\lambda = 1 - \omega$ et tous les premiers primaires.  $S$ est un syst\`eme complet de repr\'esentants des classes d'association, soit
\be
\item[(a)] Tout premier de $A$ est associ\'e \`a un premier de $S$.
\item[(b)] Deux \'el\'ements arbitraires distincts de $S$ ne sont pas associ\'es. 
\ee
\end{prop}

\begin{proof}
(a) Soit $\pi$ un \'el\'ement premier de $A$. Si $\n(\pi) = 3$, $\pi$ est associ\'e \`a $1-\lambda$. Sinon, la proposition \ref{prop80} montre que $\pi$ est associ\'e \`a exactement un premier primaire.

(b) 
Soient $\pi,\mu$ deux \'el\'ements de $S$ associ\'es. Alors ils ont m\^eme norme. Ils s'agit de prouver qu'ils sont \'egaux.

Si $\n(\pi) = \n(\mu) = 3$, alors $\pi = \mu = \lambda$, puisque $S$ contient un seul \'el\'ement de norme 3, \`a savoir $\lambda$.

Si $\n(\pi) = \n(\mu) \ne 3$, alors $\pi, \mu$ sont des premiers primaires par d\'efinition de $S$, et la proposition \ref{prop80} montre qu'il n'y a qu'un premier primaire associ\'e $\pi$, donc $\pi = \mu$.

\end{proof}

\begin{prop} \label{prop82}
Tout \'el\'ement $\alpha \in A$ se d\'ecompose sous la forme
$$\alpha = (-1)^a\omega^b\lambda^c \pi_1^{a_1}\cdots \pi_t^{a_t},$$
o\`u les $\pi_i$ sont des premiers primaires, et $a,b,c,a_i$ sont des entiers, $0\leq a \leq 1, 0 \leq b \leq 2, a_i>0$.
Cette d\'ecomposition est unique \`a l'ordre pr\`es des \'el\'ements $\pi_1,\ldots,\pi_t$.
\end{prop}
\begin{proof}
Puisque $A = \Z[\omega]$ est principal, donc factoriel, et $S$ \'etant un syst\`eme complet de repr\'esentant des classes d'association, tout \'el\'ement $\alpha$ de $A$ s'\'ecrit de façon unique sous la forme
$$\alpha = u \prod_{\pi \in S} \pi^{e(\pi)},$$
o\`u $e(\pi) \geq 0$ est nul sauf sur un ensemble fini de valeurs de $\pi\in S$, et o\`u $u$ est une unit\'e, donc $u =(-1)^a \omega^b, 0\leq a \leq 1, 0 \leq b \leq 2$, et $a, b$ sont alors uniquement d\'etermin\'es. Par d\'efinition de $S$,
$$\alpha =  (-1)^a\omega^b\lambda^c \pi_1^{a_1}\cdots \pi_t^{a_t}.$$
\end{proof}

Notons que si $\gamma, \rho \in A$ sont primaires, alors $-\gamma \rho$ est primaire. En effet, $\gamma \equiv \rho \equiv -1 \pmod 3$, donc $-\gamma \rho \equiv -1 \pmod 3$. Plus g\'en\'eralement, si $\gamma_1,\cdots, \gamma_t$ sont primaires, alors $(-1)^{t-1} \gamma_1\cdots\gamma_t \equiv -1 \pmod 3$ est primaire.

\begin{prop}\label{prop83}
Si $\gamma$ est un \'el\'ement primaire de $A$, alors
$$\gamma = \pm \gamma_1\cdots \gamma_t,$$
o\`u $t\geq 1$, et les $\gamma_i$ sont des premiers primaires (pas n\'ecessairement distincts).
\end{prop}

\begin{proof}
D'apr\`es la proposition 12, 
$$\gamma = (-1)^a\omega^b\lambda^c \gamma_1 \cdots \gamma_t,$$
o\`u les $\gamma_i$ sont des premiers primaires, et $a\in \{0,1\}, b \in \{0,1,2\}, c \in \N$. Il faut montrer que $b =c = 0$.

Comme $\gamma, \gamma_1,\ldots \gamma_t$ sont congrus \`a $-1$ modulo 3, nous obtenons
$$\omega^b\lambda^c \equiv \pm 1 \pmod 3.$$

Si $c\geq 1$,  comme $\lambda \mid 3$, nous obtenons $\lambda \mid 1$. Puisque $\lambda \nmid 1$, c'est une contradiction, donc $c = 0$.

Alors $\omega^b \equiv \pm 1 \pmod 3$, o\`u $\omega^b \in \{1,\omega, - 1 - \omega\}$. Puisque $\omega \not \equiv \pm 1 \pmod 3$, et $-1 - \omega \not \equiv  \pm 1 \pmod 3$, alors $\omega^b = 1$, avec $0\leq b \leq 2$, donc $b=0$.

En conclusion, tout \'el\'ement primaire $\gamma \in A$ se d\'ecompose sous la forme
$$\gamma = \pm \gamma_1\cdots \gamma_t,$$
o\`u les $\gamma_i$ sont des premiers primaires (et le signe $\pm$ est \'egal \`a $(-1)^{t-1}$). Ici $t\geq 1$, puisque par d\'efinition d'un \'el\'ement primaire, $\gamma$ n'est pas une unit\'e.
\end{proof}

\section{Caract\`eres cubiques g\'en\'eralis\'es.}

De mani\`ere analogue \`a l'extension du symbole de Legendre au symbole de Jacobi, nous allons \'etendre la d\'efinition de  $\chi_{\gamma}$ \`a des \'el\'ements primaires $\gamma$ de $A$, pas n\'ecessairement premiers. 


\begin{dfn}
Soit $\gamma$ un \'el\'ement primaire de $A$, et $\gamma = \pm \gamma_1\cdots \gamma_t$ la d\'ecomposition de $\gamma$ en facteurs premiers primaires. Alors, pour tout $\alpha \in A$,
$$\chi_\gamma(\alpha) =\chi_{\gamma_1}(\alpha)\cdots\chi_{\gamma_t}(\alpha).$$
\end{dfn}

Nous noterons aussi
$$\chi_\gamma(\alpha) = \legendre{\alpha}{\gamma}_3.$$

\begin{prop}\label{prop84}
Soient $\gamma, \rho$ des \'el\'ements primaires de $A$, et $\alpha, \beta \in A$. Alors
\be
\item[(a)] 
$\alpha \equiv \beta \pmod \gamma \Rightarrow \chi_\gamma(\alpha) = \chi_\gamma(\beta).$
\item[(b)] $\chi_\gamma(\alpha \beta) = \chi_\gamma(\alpha) \chi_\gamma(\beta).$
\item[(c)] $\chi_\rho(\alpha) \chi_\gamma(\alpha) = \chi_{-\rho \gamma}(\alpha).$
\ee
\end{prop}

\begin{proof}
\be
\item[(a)] Soit $\gamma = \pm \gamma_1\cdots \gamma_t$ la d\'ecomposition de $\gamma$ en facteurs premiers primaires. Alors pour tout $i$, $\alpha \equiv \beta \pmod{\gamma_i}$, donc  $\chi_{\gamma_i}(\alpha) = \chi_{\gamma_i}(\beta)$ (proposition \ref{prop76}(b)). Par cons\'equent $\chi(\alpha) = \prod_{i=1}^t \chi_{\gamma_i}(\alpha) = \prod_{i=1}^t \chi_{\gamma_i}(\beta) =\chi_{\gamma}(\beta)$.

\item[(b)] La proposition \ref{prop76}(a) montre que
\begin{align*}
\chi_\gamma(\alpha \beta) &= \chi_{\gamma_1}(\alpha \beta)\chi_{\gamma_2}(\alpha \beta)\cdots\chi_{\gamma_t}(\alpha \beta)\\
&= \chi_{\gamma_1}(\alpha)\chi_{\gamma_2}(\alpha)\cdots\chi_{\gamma_t}(\alpha)\chi_{\gamma_1}(\beta)\chi_{\gamma_2}(\beta)\cdots\chi_{\gamma_t}(\beta)\\
&= \chi_\gamma(\alpha) \chi_{\gamma}(\beta)
\end{align*}
\item[(c)] Si $\rho = \pm \rho_1\rho_2\cdots\rho_l$ est primaire, alors $-\rho \gamma$ est primaire, et $-\rho \gamma = \pm \rho_1\rho_2\cdots\rho_l\gamma_1\gamma_2\cdots\gamma_t$, donc
$$\chi_{-\rho \gamma}(\alpha) = (\chi_{\rho_1} \chi_{\rho_2}\cdots \chi_{\rho_l}\chi_{\gamma_1} \chi_{\gamma_2}\cdots \chi_{\gamma_t} )(\alpha)= \chi_\rho(\alpha)\chi_\gamma(\alpha).$$
\ee
\end{proof}


\section{Somme de Gauss associ\'ee au caract\`ere $\chi_\pi$.}

Soit $\pi$ un premier primaire de norme $N(\pi) = p, p \equiv 1 \pmod 3$.

Nous savons que $A/\pi A$ est un corps \`a $p$ \'el\'ements (proposition \ref{prop71}). Il existe donc un isomorphisme $\varphi$, et un seul, de $\F_p$ sur $A/\pi A$ : cet isomorphisme envoie $[1]_p$ sur $[1]_\pi = 1 + \pi A$, donc $[k]_p$ sur $[k]_\pi = k + \pi A$.

La proposition \ref{prop76} et son commentaire montrent que l'application $\chi$
$$
\begin{array}{ccc}
(A/\pi A)^* & \to & \C^*\\
{[}\alpha {]}& \mapsto & \legendre{\alpha}{\pi}_3 
\end{array}
$$
est un homomorphisme de groupes, et la restriction $\phi$ de $\varphi$ \`a $\F_p^*$ aussi, donc la compos\'ee $\psi = \chi \circ \phi$ aussi :
$$ \F_p^* \to (A/\pi A)^* \to \C^*.$$

$\psi$ est donc ainsi un caract\`ere cubique sur $\F_p^*$, auquel on peut appliquer les concepts de sommes de Gauss et de Jacobi. En identifiant $\F_p$ avec $A/\pi A$, et $\psi$ avec $\chi$, nous obtenons donc, pour les caract\`eres  cubiques $\chi$,
$$g(\chi) = \sum_{t =0}^{p-1} \chi(t) \zeta^t.$$

Les propositions \ref{ordre3} et \ref{congruences} du chapitre ``Sommes de Gauss et sommes de Jacobi'' montrent que, pour tout caract\`ere cubique $\chi$ sur $\F_p$,

\be
\item[(a)] $g(\chi)^3 = p J(\chi,\chi)$.
\item[(b)] Si $J(\chi,\chi) = a + b \omega$, alors $a\equiv -1 \pmod 3$ et $b \equiv 0 \pmod 3$.
\ee
Puisque $\n(J(\chi,\chi)) = p$, $J(\chi,\chi)$ est premier dans $A$, et l'affirmation (b) montre que $J(\chi,\chi)$ est un premier primaire.



\bigskip 

$\bullet$ Supposons que $\pi$ est primaire. Montrons que $$J(\chi_\pi,\chi_\pi) = \pi.$$

Posons $J(\chi_\pi,\chi_\pi) = \pi'$. Alors $\pi \overline{\pi} = p = \pi' \overline{\pi'}$, si bien que $\pi \mid \pi'$ ou $\pi \mid \overline{\pi'}$, et puisque tous ces \'el\'ements ont pour norme $p$, $\pi \sim \pi'$ ou $\pi \sim \overline{\pi'}$. De plus ces premiers sont primaires, donc $\pi = \pi'$ ou $\pi = \overline{\pi'}$. Il s'agit d'\'eliminer la seconde possibilit\'e.

Par d\'efinition,
\begin{align*}
J(\chi_\pi, \chi_\pi) &= \sum_{x =0}^{p-1} \chi_{\pi}(x) \chi_{\pi}(1-x)\\
&\equiv \sum_{x = 0}^{p-1} x^{\frac{p-1}{3}} (1-x)^{\frac{p-1}{3}} \pmod \pi.
\end{align*}
Le polynôme $X^{\frac{p-1}{3}} (1-X)^{\frac{p-1}{3}} = \sum_{k=0}^d a_k X^k$ est de degr\'e $d = \frac{2}{3}(p-1) < p-1$, et son coefficient constant $a_0$ est nul. 

Si $1\leq k \leq d < p-1$,  posons $S_k = 1^k+ 2^k+\cdots+(p-1)^k$. Comme $p-1 \nmid k$, il existe un \'el\'ement $a \in \F_p^*$ tel que $a^k \ne 1$ (on peut prendre par exemple pour $a$ un g\'en\'erateur de $\F_p^*$). Puisque $i \mapsto j = a i$ est une bijection de $\F_p^*$, le changement d'indice $j = ai$ donne
$$a^k S_k \equiv  \sum_{i = 0}^{p-1} (ai)^k \equiv  \sum_{j=0}^{p-1}j^k = S_k \pmod p.$$
Comme $a^k \not \equiv 1 \pmod p$, $S_k \equiv 0 \pmod p$, a fortiori $S_k \equiv 0 \pmod \pi$, donc $J(\chi_\pi,\chi_\pi) = \sum_{k=1}^d a_k S_k \equiv 0 \pmod \pi$. Ainsi
$$J(\chi_\pi,\chi_\pi) \equiv 0 \pmod \pi.$$
Donc $\pi \mid \pi'$, et ainsi $\pi = \pi' = J(\chi_\pi,\chi_\pi)$.

En utilisant l'affirmation (a), nous obtenons alors
$g(\chi_\pi)^3 = p \pi.$

Nous avons prouv\'e la proposition suivante :
\begin{prop}\label{prop85}
Soit $\pi$ un premier primaire de norme $\n(\pi) = p,\ p \equiv 1 \pmod 3$.  Alors 
$$g(\chi_\pi)^3 = p \pi.$$
\end{prop}



\section{Loi de r\'eciprocit\'e cubique.}

Puisque $\overline{\lambda} = 1 -\omega^2 = -\omega^2(1 - \omega) =-\omega^2 \lambda$, les premiers $\lambda, \overline{\lambda}$ sont associ\'es. Alors les \'el\'ements $\alpha$ de norme 3 sont premiers, et v\'erifient $\alpha \overline{\alpha} = 3 =\lambda \overline{\lambda} =-\omega^2 \lambda^2$. Ils sont donc associ\'es \`a $\lambda$, et ne sont pas primaires. Ainsi un premier primaire $\pi$ v\'erifie $\n(\pi) \ne 3$.

Nous pouvons maintenant \'enoncer la loi de r\'eciprocit\'e cubique, en consid\'erant d'abord le cas de deux premiers primaires de normes distinctes, ce qui revient \`a dire qu'ils sont distincts et non conjugu\'es.

\begin{prop}\label{prop86}
Soient $\pi_1,\pi_2$ des premiers primaires tels que $\n(\pi_1) \ne \n(\pi_2)$. Alors
$$\legendre{\pi_2}{\pi_1}_3 = \legendre{\pi_1}{\pi_2}_3.$$
\end{prop}


\begin{proof}

Trois cas sont \`a consid\'erer. Le premier cas correspond \`a $\pi_1 = q, \pi_2 = q'$, o\`u $q,q'$ sont des premiers rationnels positifs congrus \`a $-1$ modulo $3$ : ce cas a d\'ej\`a \'et\'e trait\'e dans la remarque 2 suivant la proposition \ref{prop79}. Le deuxi\`eme cas consiste \`a supposer que  $\pi_1 = q$, et  que $\pi_2$ v\'erifie $\n(\pi) = p$, $p$ premier rationnel congru \`a 1 modulo 3. Le troisi\`eme cas est la cas o\`u $\pi_1,\pi_2$ ont tous deux pour norme un nombre premier.


\bigskip 
$\bullet$ Commençons par le cas 2 : $q \equiv -1 \pmod 3$ est un premier rationnel positif, et $\pi$ un premier de $A$ tel que $\n(\pi) = p \equiv 1 \pmod 3$, $p$ premier. Il s'agit de prouver que ${\legendre{\pi}{q}}_3 = {\legendre{q}{\pi}}_3$.

\medskip
La proposition \ref{prop85} donne
$$g(\chi_\pi)^3 = p \pi.$$
Elevons cette \'egalit\'e \`a la puissance $(q^2 - 1)/3$ :
$$g(\chi_\pi)^{q^2 - 1}  = (p \pi)^{\frac{q^2-1}{3}}.$$
En r\'eduisant modulo $q$, comme $\n(q) = q^2$,
$$g(\chi_\pi)^{q^2 - 1}  \equiv \chi_q(p\pi) \pmod q.$$
Comme $\chi_q(p) = 1$ (proposition \ref{prop79}), ceci donne, en multipliant par $g(\chi_\pi)$,
\begin{align}\label{eq3.1}
g(\chi_\pi)^{q^2} \equiv \chi_q(\pi)g(\chi_\pi) \pmod q.
\end{align}
Par ailleurs,
\begin{align*}
g(\chi_\pi)^{q^2} &= \left(\sum_{t =0}^{p-1} \chi_\pi(t) \zeta^t\right)^{q^2}\\
& \equiv \sum_{t =0}^{p-1} \chi_\pi(t)^{q^2} \zeta^{q^2t} \pmod q.
\end{align*}
Puisque $q^2 \equiv 1 \pmod 3$, et que $\chi_\pi(t)$ est une racine cubique de l'unit\'e, $\chi_\pi(t)^{q^2} = \chi_\pi(t)$, donc 
$$g(\chi_\pi)^{q^2} \equiv g_{q^2}(\chi_\pi) \pmod q.$$
La proposition \ref{prop50} du chapitre ``Sommes de Gauss et sommes de Jacobi'' donne $g_{q^2}(\chi_\pi) = \chi_\pi(q^{-2})g(\chi_\pi) = \chi_\pi(q) g(\chi_\pi)$. Ainsi
\begin{align}\label{eq3.2}
g(\chi_\pi)^{q^2}  \equiv \chi_\pi(q)g(\chi_\pi) \pmod q
\end{align}
En combinant (\ref{eq3.1}) et (\ref{eq3.2}), nous obtenons
$$\chi_\pi(q)g(\chi_\pi) \equiv \chi_q(\pi) g(\chi_\pi) \pmod q.$$
Multiplions les deux membres de cette congruence par $\overline{g(\chi_\pi)}$. Puisque $g(\chi_\pi) \overline{g(\chi_\pi)} = p$,
$$\chi_\pi(q) p \equiv \chi_q(\pi) p \pmod q.$$
Comme $p\wedge q = 1$,
$$\chi_\pi(q) \equiv \chi_q(\pi) \pmod q.$$
Les classes de $1,\omega, \omega^2$ \'etant distinctes dans $A/qA$,
$$\chi_\pi(q) = \chi_q(p).$$

\bigskip

$\bullet$ Il reste \`a traiter le cas o\`u $\pi_1,\pi_2$ sont des premiers tels que $\n(\pi_1) = p_1 \equiv 1 \pmod 3$ et $\n(\pi_2) = p_2 \equiv 1 \pmod 3$.

Notons $\gamma_1 = \overline{\pi_1}$ et $\gamma_2 = \overline{\pi_2}$. Alors $\gamma_1$ et $\gamma_2$ sont des premiers primaires, et $p_1 = \pi_1 \gamma_1, p_2 = \pi_2 \gamma_2$.

Mettons en oeuvre la m\^eme m\'ethode que pr\'ec\'edemment. Partons de l'\'egalit\'e $$g(\chi_{\gamma_1})^3 = p_1 \gamma_1$$ prouv\'ee ci dessus pour les premiers primaires. L'\'el\'evation \`a la puissance $\frac{\n(\pi_2) - 1}{3} = \frac{p_2-1}{3}$ donne 
$$g(\chi_{\gamma_1})^{p_2-1} = (p_1\gamma_1)^{\frac{p_2-1}{3}},$$
 et la r\'eduction modulo $\pi_2$ donne
 $$g(\chi_{\gamma_1})^{p_2-1} \equiv \chi_{\pi_2}(p_1\gamma_1) \pmod {\pi_2},$$
 donc
\begin{align}\label{eq3.3}
g(\chi_{\gamma_1})^{p_2} \equiv \chi_{\pi_2}(p_1\gamma_1)g(\chi_{\gamma_1}) \pmod {\pi_2}.
\end{align}
De plus, 
\begin{align*}
g(\chi_{\gamma_1})^{p_2} &= \left(\sum_{t=0}^{p_2-1} \chi_{\gamma_1}(t) \zeta^t\right)^{p_2}\\
&\equiv \sum_{t=0}^{p_2-1} \chi_{\gamma_1}(t)^{p_2} \zeta^{p_2t} \pmod {\pi_2}
\end{align*}
Comme $p_2 \equiv 1 \pmod 3$, $\chi_{\gamma_1}(t)^{p_2} = \chi_{\gamma_1}(t)$, donc
\begin{align*}
g(\chi_{\gamma_1})^{p_2} &\equiv g_{p_2}(\chi_{\gamma_1}) \pmod {\pi_2}
\end{align*}
Comme
\begin{align*}
g_{p_2}(\chi_{\gamma_1}) & = \chi_{\gamma_1}(p_2^{-1}) g(\chi_{\gamma_1})\\
&= \chi_{\gamma_1}(p_2^2) g(\chi_{\gamma_1}),
\end{align*}
nous en d\'eduisons
\begin{align}\label{eq3.4}
g(\chi_{\gamma_1})^{p_2} \equiv \chi_{\gamma_1}(p_2^2) g(\chi_{\gamma_1}) \pmod{\pi_2}.
\end{align}
La comparaison des congruences (\ref{eq3.3}) et (\ref{eq3.4}) donne
$$\chi_{\gamma_1}(p_2^2) g(\chi_{\gamma_1}) \equiv \chi_{\pi_2}(p_1\gamma_1)g(\chi_{\gamma_1}) \pmod {\pi_2} .$$
En multipliant par $\overline{g(\chi_{\gamma_1})}$, puisque  $g(\chi_{\gamma_1})\overline{g(\chi_{\gamma_1})} = p_1$, nous obtenons
$$p_1\, \chi_{\gamma_1}(p_2^2) \equiv p_1\,  \chi_{\pi_2}(p_1\gamma_1) \pmod {\pi_2}.$$
Comme $\n(\pi_1) \ne \n(\pi_2)$ par hypoth\`ese, $p_1 \ne p_2$, donc les entiers $p_1,p_2$ sont premiers entre eux dans $\Z$, donc dans $A$, a fortiori $\pi_2$ est premier avec $p_1$ dans $A$. Par cons\'equent
$$\chi_{\gamma_1}(p_2^2) \equiv  \chi_{\pi_2}(p_1\gamma_1) \pmod {\pi_2}.$$
Les classes de $1,\omega,\omega^2$ \'etant distinctes dans $A/\pi_2A$, nous pouvons conclure que
\begin{align}\label{eq3.5}
\chi_{\gamma_1}(p_2^2)=  \chi_{\pi_2}(p_1\gamma_1) .
\end{align}

En remplaçant dans les calculs pr\'ec\'edents le couple $(\gamma_1, \pi_2)$ par le couple $(\pi_2,\pi_1)$, et donc en \'echangeant $p_1$ et $p_2$, nous obtenons de m\^eme
\begin{align}\label{eq3.6}
\chi_{\pi_2}(p_1^2) = \chi_{\pi_1}(p_2 \pi_2).
\end{align}


Rappelons le r\'esultat de la proposition \ref{prop78}, qui  montre que $\overline{\chi_\pi(\alpha)} = \chi_{\overline{\pi}}(\overline{\alpha}).$ Alors

$$\chi_{\gamma_1}(p_2^2) = \chi_{\overline{\pi_1}}(p_2^2) =  \chi_{\overline{\pi_1}}\left(\overline{p_2^2}\right) = \overline{\chi_{\pi_1}(p_2^2)} = \overline{\chi_{\pi_1}(p_2)^2} = \chi_{\pi_1}(p_2),$$
et ainsi
\begin{align}\label{eq3.7}
\chi_{\gamma_1}(p_2^2) = \chi_{\pi_1}(p_2).
\end{align}
En utilisant les \'egalit\'es (\ref{eq3.5}),(\ref{eq3.6}) et (\ref{eq3.7}), nous obtenons
\begin{align*}
 \chi_{\pi_1}(\pi_2)\chi_{\pi_2}(p_1\gamma_1) &= \chi_{\pi_1}(\pi_2) \chi_{\gamma_1}(p_2^2)\qquad \text{(\'egalit\'e (\ref{eq3.5}))}\\
 &= \chi_{\pi_1}(\pi_2) \chi_{\pi_1}(p_2) \qquad \text{(\'egalit\'e (\ref{eq3.7}))}\\
 &= \chi_{\pi_1}(p_2 \pi_2)\\
 &=\chi_{\pi_2}(p_1^2)\qquad \qquad \quad \ \text{(\'egalit\'e (\ref{eq3.6}))}\\
 &=\chi_{\pi_2}(p_1 \pi_1 \gamma_1)\\
 &=\chi_{\pi_2}(\pi_1) \chi_{\pi_2}(p_1 \gamma_1)
\end{align*}
En simplifiant par $\chi_{\pi_2}(p_1 \gamma_1) \ne 0$, nous obtenons bien
$$\chi_{\pi_1}(\pi_2) = \chi_{\pi_2}(\pi_1) .$$
\end{proof}

\section{Autre d\'emonstration de la r\'eciprocit\'e cubique.}

{
A l'aide des sommes de Jacobi g\'en\'eralis\'ees, donnons une nouvelle preuve de la loi de r\'eciprocit\'e cubique (proposition 16).

\medskip
{\bf Lemme.} {\it Soient $p,q$ deux nombres premiers rationnels distincts, et $\chi$ un caract\`ere sur $\F_p$. Consid\'erons
$$S = J(\chi,\ldots,\chi)$$
la somme de Jacobi avec $q$ entr\'ees \'egales \`a $\chi$. Alors
$$J(\chi,\ldots,\chi) \equiv \chi^q(q^{-1}) \pmod q.$$
}
\medskip

\begin{proof}
Consid\'erons la somme de Jacobi $S = J(\chi,\ldots,\chi)$, avec $q$ entr\'ees \'egales \`a $\chi$:
$$S = J(\chi_1,\ldots,\chi_q),\quad \text{o\`u } \chi_1 = \ldots = \chi_q= \chi,$$
$\chi$ \'etant un caract\`ere sur $\F_p$.

Alors
$$S = J(\chi,\ldots,\chi) = \sum_{(x_1,\ldots,x_q)\in X} \chi(x_1)\cdots\chi(x_q),$$
o\`u
$$X = \{(x_1,\ldots,x_q) \in (\F_p)^q \mid x_1 + \cdots+x_q = 1\}.$$

D\'efinissons une action \`a droite de $S_q$ sur $(\F_p)^q$ par
$$  (x_1,\ldots,x_q)^\sigma = (x_{\sigma(1)}, \ldots,x_{\sigma(q)}),\qquad (x_1,\ldots,x_q) \in \F_p^q, \sigma \in S_q.$$
 V\'erifions qu'il s'agit bien d'une action \`a droite :

 si $x = (x_1,\ldots,x_q) \in (\F_p)^q$, et $\sigma, \sigma' \in S_n$, alors
\begin{align*}
x^e &= x,\\
(x^\sigma)^{\sigma'} &= ((x_1,\ldots,x_q)^\sigma)^{\sigma'} \\
&= (x_{\sigma(1)}, \ldots,x_{\sigma(q)})^{\sigma'}\\
&=(y_1,\ldots,y_q)^{\sigma'} \qquad \qquad \qquad (\text{o\`u } y_i = x_{\sigma(i)})\\
&= (y_{\sigma'(1)},\ldots,y_{\sigma'(q)})\\
&= (x_{\sigma(\sigma'(1))}, \ldots, x_{\sigma(\sigma'(q))}) \qquad (\text{puisque } y_{\sigma'(j)} = x_{\sigma(\sigma'(j))})\\
&= (x_1,\ldots,x_q)^{\sigma \circ \sigma'}\\
&=x^{\sigma \sigma'}.
\end{align*}


Le cycle  $\tau = (1\,2\,\cdots\, q) \in S_q$ engendre un sous-groupe $H = \langle \tau \rangle $ de $S_q$ d'ordre $q$. Pour tout $x = (x_1,\cdots,x_q) \in (\F_p)^q$,  $(x_1,\cdots,x_q)^\tau = (x_2,\ldots,x_{q}, x_1)$. Par cons\'equent $\tau$ laisse stable $X$, puisque 
$$x = (x_1,\cdots,x_q) \in X \Rightarrow x_1+ \cdots+x_q = 1 \Rightarrow x_2+ \ldots + x_q + x_1 = 1 \Rightarrow x^\tau \in X.$$

Ceci prouve
     $$x \in X \Rightarrow x^\tau \in X.$$
     
Par cons\'equent, si on restreint l'action de $G$ au sous-groupe $H$, $H = \langle \tau \rangle$ op\`ere \`a droite sur $X$.

Calculons le cardinal de $X$. Puisqu'un $q$-uplet de $X$ est d\'etermin\'e par ses $q-1$ premiers \'el\'ements,
$$|X| = p^{q-1}.$$

Comme $H = \langle \tau \rangle$ op\`ere sur $X$, la formule orbite-stabilisateur donne, pour tout $x \in X$, en notant ${\cal O}_x = x^H$ l'orbite de $x$ sous l'action de $H$, et $H_x $ le stabilisateur de $x$,
$$|{\cal O}_x | = (H : H_x ) = |H|/|H_x |.$$
Par cons\'equent $|{\cal O}_x |$ divise $|H| = q$. Comme $q$ est premier, le cardinal d'une orbite ${\cal O}_x$ est soit $1$, soit $q$.
$$\forall  x\in  X, \ |{\cal O}_x | = 1 \text{ ou } |{\cal O}_x | = q.$$

A quelle condition $x \in X$ v\'erifie-t-il  $|{\cal O}_x | = 1$ ?

Comme $H = \{e,\tau, \cdots, \tau^{q-1}\}$,
$${\cal O}_x = \{x, x^\tau, \cdots,x^{\tau^{q-1}}\}.$$
Par cons\'equent, pour tout $x = (x_1,\ldots,x_q) \in X$,
\begin{align*}
|{\cal O}_x | = 1 &\iff x = x^\tau =x^{\tau^2} = \cdots = x^{\tau^{q-1}}\\
& \iff x^\tau = x\\
&\iff (x_2,x_3,\ldots,x_q,x_1) = (x_1,x_2,\ldots,x_q)\\
&\iff x_1 = x_2 = \cdots = x_q.
\end{align*}
D\'efinissons
$$ Y = \{(x_1,\ldots,x_q)\in X \mid x_1 = x_2 = \cdots = x_q\}.$$
Soit $x =(x_1,\ldots,x_q)\in \F_p^q$. Alors $x \in Y$ si et seulement s'il existe $a \in \F_p$ tel que $x =(a,\ldots,a)$ et $qa = 1$, soit $a = q^{-1}$. Ainsi $|Y| = 1$, le seul \'el\'ement de $Y$ \'etant l'\'el\'ement $y=(a,\ldots,a)$, o\`u $a = q^{-1}$ est l'inverse de $q$ dans $\F_p$.

Nous avons montr\'e que
$$ Y = \{(x_1,\ldots,x_q)\in X \mid x_1 = x_2 = \cdots = x_p\} = \{x \in X \mid \quad  |{\cal O}_x | = 1\} = \{y\}.$$

Comme les orbites de l'action de $H$ sur $X$ forment une partition de $X$, en notant $S$ un syst\`eme complet de repr\'esentants des orbites,
$$X = \coprod_{x \in S} {\cal O}_x$$
(r\'eunion disjointe des orbites).

Si une orbite est r\'eduite \`a un seul \'el\'ement, i.e. ${\cal O}_x = \{x\}$, alors son unique repr\'esentant ne peut \^etre que $y$, donc $y \in  S$, et ainsi
$$ X = \{y\} \cup \bigcup_{x \in S \setminus \{y\}} {\cal O}_x.$$
(Alors $|X| = \sum_{x\in S} |{\cal O}_x| = 1+ \sum_{x \in S \setminus \{y\}} |{\cal O}_x|$. Comme $q \mid |{\cal O}_x|$ pour tout $x \ne y$, nous obtenons $|X| \equiv 1 \pmod q$, ce qui n'est pas surprenant puisque $|X| = p^{q-1} \equiv 1 \pmod q$ !)
Par cons\'equent,
\begin{align*}
S = J(\chi,\ldots,\chi) &= \sum_{(x_1,\ldots,x_q)\in X} \chi(x_1)\cdots\chi(x_q)\\
 &=\chi(a)^q + \sum_{x \in S\setminus\{y\}} \sum_{(x_1,\ldots,x_q) \in {\cal O}_x} \chi(x_1)\ldots \chi(x_q)\\
 &=\chi^q(q^{-1})+ \sum_{x \in S\setminus\{y\}} \sum_{(x_1,\ldots,x_q) \in {\cal O}_x} \chi(x_1)\ldots \chi(x_q).
\end{align*}
De plus, si $x \in S \setminus \{y\}$, le produit $\chi(x_1)\cdots \chi(x_p)$ est constant sur l'orbite ${\cal O}_x$, puisque $\chi(x_{\tau(1)})\cdots \chi(x_{\tau(p)}) = \chi(x_1)\cdots \chi(x_p)$. Par cons\'equent 
$$ q \mid \sum_{(x_1,\ldots,x_q) \in {\cal O}_x} \chi(x_1) \cdots \chi(x_q), \qquad (x \in S \setminus \{y\}).$$
Ainsi
$$S = J(\chi,\ldots,\chi) \equiv \chi^q(q^{-1}) \pmod q.$$

\end{proof}

\begin{proof}(proposition \ref{prop86})

 Trois cas sont \`a consid\'erer. 
 \item[$\bullet$] Le premier cas correspond \`a $\pi_1 = q, \pi_2 = q'$, o\`u $q,q'$ sont des premiers rationnels positifs distincts congrus \`a $-1$ modulo $3$. 
 
Alors $q \wedge q' =1$. La proposition \ref{prop79} donne $\chi_q(q') = 1 = \chi_{q'}(q)$.
  
 
\item[$\bullet$]Dans le deuxi\`eme cas, $\pi_1 =q$ est un premier rationnel positif congru \`a $-1$ modulo $3$, et  $\pi_2 = \pi$ v\'erifie $\n(\pi) = p$, o\`u $p$ est un premier rationnel congru \`a 1 modulo 3.

Posons $\chi = \chi_\pi$. Appliquons le lemme \`a $J(\chi,\ldots,\chi)$, avec $q$ entr\'ees \'egales \`a $\chi$ :

$$J(\chi,\ldots,\chi) \equiv \chi^q(q^{-1}) \pmod q.$$

Puisqu'ici $q \equiv 2 \pmod 3$, $\chi^q = \chi^2 = \chi^{-1}$, donc
$$J(\chi,\ldots,\chi) \equiv \chi(q) \pmod q.$$

 Comme $3 \mid q+1$, $\chi^{q+1} =\varepsilon$ est le caract\`ere trivial, et $\chi$ n'est pas trivial. La proposition \ref{jac_gen3} du chapitre ``Sommes de Gauss et sommes de Jacobi'' donne
$$ g(\chi)^{q+1}  = p J(\chi,\ldots,\chi).$$

D'apr\`es la proposition \ref{prop85}, $g(\chi_\pi)^3 = p \pi,$ donc 
$$g(\chi)^{q+1} = (p\pi)^{\frac{q+1}{3}}.$$
Par cons\'equent,
$$ (p\pi)^{\frac{q+1}{3}} \equiv   p \chi(q) \pmod q,$$
ou encore
$$p^\frac{q-2}{3}\pi^\frac{q+1}{3} \equiv \chi(q) \pmod q.$$
En \'elevant les deux membres \`a la puissance $q-1$, sachant que $q-1 \equiv 1 \pmod 3$,
$$(p^{\frac{q-2}{3}})^{q-1} \pi^\frac{q^2-1}{3}  \equiv \chi(q) \pmod q.$$
Comme $(p^{\frac{q-2}{3}})^{q-1}  \equiv 1 \pmod q$ d'apr\`es le petit th\'eor\`eme de Fermat, et puisque $\pi^\frac{q^2-1}{3} \equiv \chi_q(\pi) \pmod q$ par d\'efinition, nous obtenons
$$\chi_q(\pi) \equiv \chi_\pi(q) \pmod q,$$
donc
$$\chi_q(\pi) = \chi_\pi(q).$$

\item[$\bullet$]  Il reste le cas o\`u  $\pi_1,\pi_2$ sont des premiers primaires tels que $p_1 = \n(\pi_1) = \pi_1 \overline{\pi_1}, p_2 = \n(\pi_2) =\pi_2 \overline{\pi_2}$ sont des premiers rationnels congrus \`a $1$ modulo $3$.
Ecrivons $\gamma_1 = \overline{\pi_1}, \gamma_2 = \overline{\pi_2}$, si bien que
$$p_1 = \pi_1 \gamma_1, \qquad p_2 = \pi_2 \gamma_2.$$
Comme $\chi_{\gamma_1}$ est un caract\`ere d'ordre $3$, et $p_2 \equiv 1 \pmod 3$, $\chi_{\gamma_1}^{p_2} = \chi_{\gamma_1} \ne \varepsilon.$ La proposition  \ref{jac_gen2} du chapitre ``Sommes de Gauss et sommes de Jacobi'' donne alors
$$g(\chi_{\gamma_1})^{p_2} = J(\chi_{\gamma_1},\ldots,\chi_{\gamma_1}) g(\chi_{\gamma_1}^{p_2}),$$
o\`u la somme de Jacobi $J(\chi_{\gamma_1},\ldots,\chi_{\gamma_1})$ a $p_2$ entr\'ees \'egales \`a $\chi_{\gamma_1}$.

Puisque $\chi_{\gamma_1}^{p_2} = \chi_{\gamma_1}$,
$$\left[g(\chi_{\gamma_1})^3\right]^{\frac{p_2 - 1}{3}} = J(\chi_{\gamma_1},\ldots,\chi_{\gamma_1}).$$
La proposition \ref{prop85} montre que $g(\chi_{\gamma_1})^3 = p_1 \gamma_1$, donc
$$(p_1 \gamma_1)^{\frac{p_2 - 1}{3}} = J(\chi_{\gamma_1},\ldots,\chi_{\gamma_1}).$$

En appliquant une nouvelle fois le lemme, avec ici $p = p_1, q = p_2$, (o\`u $p_1 \ne p_2$) et $\chi = \chi_{\gamma_1}$, nous obtenons
$$J(\chi_{\gamma_1},\ldots,\chi_{\gamma_1})\equiv \chi_{\gamma_1}^{p_2}(p_2^{-1}) \pmod {p_2}.$$
Comme $p_2 \equiv 1 \pmod 3$,
$$J(\chi_{\gamma_1},\ldots,\chi_{\gamma_1}) \equiv \chi_{\gamma_1}(p_2^{-1}) = \chi_{\gamma_1}(p_2^2) \pmod {p_2}.$$
Par cons\'equent,
$$(p_1 \gamma_1)^{\frac{p_2 - 1}{3}} \equiv  \chi_{\gamma_1}(p_2^2) \pmod {\pi_2},$$
soit encore
\begin{align}\label{eq3.8}
\chi_{\pi_2}(p_1 \gamma_1) \equiv \chi_{\gamma_1}(p_2^2) \pmod {\pi_2}.
\end{align}

En remplaçant dans les calculs pr\'ec\'edents le couple $(\gamma_1, \pi_2)$ par le couple $(\pi_2,\pi_1)$, et donc en \'echangeant $p_1$ et $p_2$, nous obtenons de m\^eme
\begin{align}\label{eq3.9}
\chi_{\pi_2}(p_1^2) = \chi_{\pi_1}(p_2 \pi_2).
\end{align}


Rappelons le r\'esultat de la proposition \ref{prop78}, qui  montre que $\overline{\chi_\pi(\alpha)} = \chi_{\overline{\pi}}(\overline{\alpha}).$ Alors

$$\chi_{\gamma_1}(p_2^2) = \chi_{\overline{\pi_1}}(p_2^2) =  \chi_{\overline{\pi_1}}\left(\overline{p_2^2}\right) = \overline{\chi_{\pi_1}(p_2^2)} = \overline{\chi_{\pi_1}(p_2)^2} = \chi_{\pi_1}(p_2),$$
et ainsi
\begin{align}\label{eq3.10}
\chi_{\gamma_1}(p_2^2) = \chi_{\pi_1}(p_2).
\end{align}
En utilisant les \'egalit\'es (\ref{eq3.8}),(\ref{eq3.9}) et (\ref{eq3.10}), nous obtenons
\begin{align*}
 \chi_{\pi_1}(\pi_2)\chi_{\pi_2}(p_1\gamma_1) &= \chi_{\pi_1}(\pi_2) \chi_{\gamma_1}(p_2^2)\qquad \text{(\'egalit\'e (\ref{eq3.8}))}\\
 &= \chi_{\pi_1}(\pi_2) \chi_{\pi_1}(p_2) \qquad \text{(\'egalit\'e (\ref{eq3.10}))}\\
 &= \chi_{\pi_1}(p_2 \pi_2)\\
 &=\chi_{\pi_2}(p_1^2)\qquad \qquad \quad \ \text{(\'egalit\'e (\ref{eq3.9}))}\\
 &=\chi_{\pi_2}(p_1 \pi_1 \gamma_1)\\
 &=\chi_{\pi_2}(\pi_1) \chi_{\pi_2}(p_1 \gamma_1)
\end{align*}
En simplifiant par $\chi_{\pi_2}(p_1 \gamma_1) \ne 0$, on obtient bien
$$\chi_{\pi_1}(\pi_2) = \chi_{\pi_2}(\pi_1) .$$


\end{proof}

\section{R\'eciprocit\'e cubique g\'en\'erale.}

Le cas o\`u $\n(\pi_1) = \n(\pi_2)$ n'est pas trait\'e dans la proposition \ref{prop86}. \'Etendons \`a ce cas la r\'eciprocit\'e cubique.

\medskip
{\bf Lemme.} {\it Soit $n\in \Z$ un entier primaire (i.e. $n \equiv -1 \pmod 3$), et soit $\pi$ un premier primaire tel que $\n(\pi) = p \equiv 1 \pmod 3$. Alors 
$$\legendre{n}{\pi}_3 = \legendre{\pi}{n}_3.$$
}

\medskip

\begin{proof}
Si $p \mid n$, alors $\pi \mid n$, donc $\legendre{n}{\pi}_3 =0 = \legendre{\pi}{n}_3.$ Nous pouvons maintenant supposer que $p\wedge n = 1$. 

Comme $n$ est primaire, il se d\'ecompose sous la forme
\begin{align*} n &= \pm p_1 \cdots p_s q_1 \cdots q_r\qquad (p_i \equiv 1 \ [3], q_j \equiv -1 \ [3])\\
&= \pm \pi_1\overline{\pi_1} \cdots \pi_s \overline{\pi}_s q_1 \cdots q_r,
\end{align*}
o\`u $\pi_i, \overline{\pi_i} (1\leq i \leq s)$ et $q_j (1 \leq j \leq r)$ sont des premiers primaires.

Puisque $\n(\pi) = p \ne p_i =\n(\pi_i)$ et $\n(\pi) = p \ne \n(q_j) =q_j^2$, la proposition \ref{prop86} (r\'eciprocit\'e cubique) montre que
\begin{align*}
\legendre{n}{\pi}_3 &=\legendre{\pi_1}{\pi}_3\legendre{\overline{\pi_1}}{\pi}_3\cdots \legendre{\pi_s}{\pi}_3\legendre{\overline{\pi_s}}{\pi}_3 \legendre{q_1}{\pi}_3  \cdots \legendre{q_r}{\pi}_3 \\
&=\legendre{\pi}{\pi_1}_3\legendre{\pi}{\overline{\pi_1}}_3\cdots \legendre{\pi}{\pi_s}_3\legendre{\pi}{\overline{\pi_s}}_3 \legendre{\pi}{q_1}_3  \cdots \legendre{\pi}{q_r}_3 \\
&= \legendre{\pi}{n}_3.
\end{align*}
\end{proof}

Nous pouvons alors supprimer l'hypoth\`ese inutile $\n(\pi_1) \ne \n(\pi_2)$ dans la proposition \ref{prop86}.

\begin{prop}
Soient $\pi_1,\pi_2$ des premiers primaires. Alors
$$\legendre{\pi_2}{\pi_1}_3 = \legendre{\pi_1}{\pi_2}_3.$$
\end{prop}

\begin{proof}
Il ne reste \`a examiner que le cas o\`u $\n(\pi_1) = \n(\pi_2)$.

Si $\pi_1 = \pi_2$, alors $\legendre{\pi_2}{\pi_1}_3 = \legendre{\pi_1}{\pi_2}_3 =0$.

Si $\pi_1 \ne \pi_2$, comme $\pi_1$ et $\pi_2$ sont primaires, alors $\pi_1, \pi_2$ sont des premiers tels que $\n(\pi_1) = \n(\pi_2) = p \equiv 1 \pmod 3$, et $\pi_2 = \overline{\pi_1}$. En notant $\pi = \pi_1$, il suffit de prouver que
$$\legendre{\overline{\pi}}{\pi}_3 =  \legendre{\pi}{\overline{\pi}}_3.$$
Utilisons la ``ruse d'Evans'' (voir [Lemmermayer]). L'\'el\'ement $n = -\pi - \overline{\pi}$ est un entier rationnel, qui est primaire. Le lemme donne alors
\begin{align*}
\legendre{\overline{\pi}}{\pi}_3 &= \legendre{\pi + \overline{\pi}}{\pi}_3\\
&= \legendre{-\pi - \overline{\pi}}{\pi}_3\\
&= \legendre{\pi}{-\pi - \overline{\pi}}_3\\
&= \legendre{-\overline{\pi}}{-\pi - \overline{\pi}}_3\\
&=\legendre{\overline{\pi}}{-\pi - \overline{\pi}}_3\\
&=\legendre{-\pi  -\overline{\pi}}{\overline{\pi}}_3\qquad (\text{lemme})\\
&=\legendre{-\pi}{\overline{\pi}}_3\\
&=\legendre{\pi}{\overline{\pi}}_3
\end{align*}
\end{proof}

Nous obtenons alors la loi de r\'eciprocit\'e cubique pour les caract\`eres g\'en\'eralis\'es.
\begin{prop}\label{prop88}
Si $\chi, \rho$ sont des \'el\'ements primaires de $A$, alors
$$\chi_\gamma(\rho) = \chi_\rho(\gamma).$$
\end{prop}
\begin{proof}
D\'ecomposons $\rho, \gamma$ en facteurs premiers primaires, sous la forme
\begin{align*}
\rho&=\pm\rho_1\rho_2\cdots\rho_l,\\
\gamma &= \pm \gamma_1 \gamma_2\cdots \gamma_m, 
\end{align*}

La loi de r\'eciprocit\'e cubique donne alors
\begin{align*}
\chi_\gamma(\rho) &= \prod_{j=1}^m \chi_{\gamma_j}(\rho)\\
& = \prod_{j=1}^m\prod_{i=1}^l \chi_{\gamma_j}(\rho_{i})\\
& = \prod_{i=1}^l\prod_{j=1}^m \chi_{\gamma_j}(\rho_{i})\\
& = \prod_{i=1}^l\prod_{j=1}^m \chi_{\rho_i}(\gamma_j)\\
&=\prod_{i=1}^l \chi_{\rho_i}(\gamma)\\
&=\chi_{\rho}( \gamma).
\end{align*}

\end{proof}



\section{R\'esidus cubiques entiers.}
Soit $p$ un premier rationnel. A quelle condition un entier $a \in \Z$, o\`u $p\nmid a$, est-il un r\'esidu cubique, i.e. existe-t-il $x\in \Z$ tel que $x^3 \equiv a \pmod p$ ?

Si $p = 3$, $a^2 \equiv 1 \pmod 3$, donc $a^3 \equiv a \pmod 3$, et donc $a$ est un r\'esidu cubique.

Supposons maintenant que $p \equiv 2 \pmod 3$. Puisque $d = 3 \wedge (p-1) = 1$,  et $a^{p-1} \equiv 1 \pmod p$, la proposition \ref{nbsols} du chapitre ``Sommes de Gauss et sommes de Jacobi'' montre qu'il existe un $x \in \Z$ tel que $x^3 \equiv a \pmod p$, et qu'il n'existe qu'une solution modulo $p$. Autrement dit l'application 
$$
\left\{
\begin{array}{ccc}
\F_p^* \to \F_p^*\\
x \mapsto x^3
\end{array}
\right.
$$
est une bijection. 

Plus int\'eressant est le cas o\`u $p\equiv 1 \pmod 3$. Alors $p = \n(\pi)$, o\`u $\pi = a + b \omega$ est un premier de $A$.

S'il existe $x \in \Z$ tel que $x^3 \equiv a \pmod p$, a fortiori $x^3 \equiv a \pmod \pi$. Alors la proposition \ref{prop77} montre que $\legendre{a}{\pi}_3 = 1$.

R\'eciproquement, si $\legendre{a}{\pi}_3 = 1$, la proposition \ref{prop77} montre l'existence de $\alpha \in A$ tel que $\alpha^3 \equiv a \pmod \pi$. De plus nous savons (voir la d\'emonstration de la proposition \ref{prop71}) qu'il existe $x \in T = \{0,1,\cdots,p-1\}$ tel que $\alpha \equiv x \pmod \pi$, donc $x^3 \equiv a \pmod \pi$, o\`u $x \in \Z$.

Alors $\pi \mid x^3 -a$, donc $p = \n(\pi) \mid \n(x^3 -a) = (x^3-a)^2$, et $p$ est un premier rationnel, donc $p \mid x^3 -a$, soit $x^3 \equiv a \pmod p$.

Notons que $0$ est toujours le cube de $0$.

Nous avons donc prouv\'e la proposition suivante.

\begin{prop}\label{prop89}
Soit $p$ un nombre premier, et $a \in \Z$.
\be
\item[$\bullet$] Si $p = 3$, ou si $p\equiv 2 \pmod 3$, il existe un $x \in \Z$ tel que $x^3 \equiv a \pmod p$.
\item[$\bullet$] Si $p \equiv 1 \pmod 3$, o\`u $p\nmid a$, alors $p = \n(\pi)$, o\`u $\pi$ est un premier de $A$, et 
$$\exists x \in \Z,\ x^3 \equiv a \pmod p \iff \legendre{a}{\pi}_3 = 1 \iff \exists \alpha \in A,\  \alpha^3 \equiv a \pmod \pi.$$
\ee
\end{prop}



\section{Le caract\`ere cubique de $2$.}
Nous \'etudions ici la question suivante. Quels sont les premiers $\pi$ de $A$ tels que l'\'equation $x^3 \equiv 2 \pmod \pi$ admet une solution dans $A$?

Notons d'abord que, si $\pi,\pi'$ sont associ\'es, l'\'equation $x^3 \equiv 2 \pmod \pi$ a des solutions si et seulement si $x^3 \equiv 2 \pmod {\pi'}$ a des solutions. Il suffit donc d'\'etudier le cas o\`u $\pi$ est un premier primaire.

Si $\pi = q$ est un premier de $\N$, o\`u $q\equiv 2 \pmod 3, q \ne 2$, alors $\chi_q(2) = 1$, donc $2$ est un r\'esidu cubique pour $q$.

Supposons maintenant que $\pi = a + b \omega$ est un premier primaire tel que $\n(\pi) = p$, o\`u $p\equiv 1 \pmod 3$ est premier. Comme $2$ et $\pi$ sont des premiers primaires, la loi de r\'eciprocit\'e cubique donne
$$\legendre{2}{\pi}_3 = \legendre{\pi}{2}_3.$$ 
Par d\'efinition de $ \legendre{\pi}{2}_3$, comme $\n(2) = 4$,
$$ \legendre{\pi}{2}_3 \equiv \pi^{\frac{\n(2) - 1}{3}} = \pi \pmod 2.$$
Ainsi $\legendre{2}{\pi}_3 = 1$ si et seulement si $\pi \equiv 1 \pmod 2$, soit $a \equiv 1 \pmod 2, b \equiv 0 \pmod 2$. En utilisant la proposition \ref{prop89}, nous avons prouv\'e la proposition suivante.
\begin{prop}\label{prop90}
 Si $\pi = a + b \omega$ est un premier primaire de $A$ tel que $\n(\pi) = p \equiv 1 \pmod 3$, alors
\begin{align*}
\exists x \in \Z,\ x^3 \equiv 2 \pmod p &\iff \exists \alpha \in A,\ \alpha^3 \equiv 2 \pmod \pi\\
&\iff 
\left\{
\begin{array}{l}
a \equiv 1 \pmod 2\\
b \equiv 0 \pmod 2.
\end{array}
\right.
\end{align*}
\end{prop}

Si nous appliquons ceci au probl\`eme de la repr\'esentation des nombres premiers par la forme $x^2 +ny^2$, nous obtenons
\begin{prop}
Soit $p$ un nombre premier. Alors

$$\exists x \in \Z,\  \exists y \in \Z,\  p = x^2 + 27 y^2 \iff
\left\{
\begin{array}{l}
p\equiv 1 \pmod 3,\\
\exists t \in \Z,\ t^3 \equiv 2 \pmod p.
\end{array}
\right.
$$
\end{prop}
Autrement dit, $p$ se d\'ecompose sous la forme $x^2 + 27 y^2$ si et seulement si $p$ est congru \`a 1 modulo 3 et si 2 est un r\'esidu cubique modulo $p$.
\begin{proof}
($\Rightarrow$) Si $p = x^2 + 27y^2,\ x,y \in \Z$, alors $p\ne 3$, et $p\equiv x^2 \pmod 3$, donc $p\equiv 1 \pmod 3$. Puisque $\omega = -\frac{1}{2} + i\frac{ \sqrt{3}}{2}$, $i\sqrt{3} = 1 + 2 \omega$, donc
\begin{align*}
p &= (x + 3i\sqrt{3} y)(x - 3 i\sqrt{3}y)\\
&=\n(x+3i\sqrt{3}y)\\
&=\n(x+ 3y + 6 y\omega ).
\end{align*}
Par cons\'equent $p = \n(\pi)$, o\`u $\pi = x+ 3y + 6 y\omega $ est un premier de $A$. Posons $a = x+3y, b = 6y$. Alors $b$ est pair, et $a \equiv x + y \equiv x^2 + 27 y^2 = p \equiv 1 \pmod 2$. La proposition \ref{prop90} montre alors que $2$ est un r\'esidu cubique modulo $p$.

\bigskip 

($\Leftarrow$) R\'eciproquement, supposons que $p\equiv 1 \pmod 3$ et que $2$ est un r\'esidu cubique modulo $p$. 

Puisque $p\equiv 1 \pmod 3$, on peut alors \'ecrire $p = \pi \overline{\pi}$, o\`u $\pi$ est un premier primaire, donc $\pi$ est de la forme $\pi = a + 3b\omega, a \equiv -1 \pmod 3$. Alors
$$4p = 4 \n(\pi) = 4(a^2 - 3ab + 9b^2) = (2a - 3b)^2 + 27b^2.$$

Sachant que $2$ est un r\'esidu cubique modulo $p$, la proposition \ref{prop90} montre que $b$ est pair. En posant $x = a-3\frac{b}{2} \in \Z, y = \frac{b}{2} \in \Z$, nous obtenons $p = x^2 + 27 y^2$.
\end{proof}



\section{Compl\'ements \`a la loi de r\'eciprocit\'e cubique.}

Donnons maintenant cette proposition, qui compl\`ete la proposition \ref{prop79}.
\begin{prop}\label{prop92}
Soit $a \equiv-1 \pmod 3$ un entier rationnel ($a \ne -1$), et $n \in \Z$ un entier premier avec $a$. Alors $\chi_a(n) = 1$.
\end{prop}
\begin{proof}
Nous savons d\'ej\`a que si $q \equiv -1 \pmod 3$ est un premier rationnel tel que $q \wedge n = 1$, alors $\chi_q(n) = 1$ (proposition \ref{prop79}).

Si $p \equiv 1 \pmod 3$ est un premier rationnel tel que $p \wedge n = 1$, alors $p = \pi \overline{\pi}$, o\`u $\pi$ est un premier primaire de $A$, ainsi que $\overline{\pi}$, non associ\'e \`a $\pi$, et par d\'efinition de $\chi_p$, $\chi_{-p}(n) = \chi_\pi(n) \chi_{\overline{\pi}}(n)$.

Comme $\chi_{\overline{\pi}}(n) = \chi_{\overline{\pi}}(\overline{n}) = \overline{\chi_\pi(n)}$ (proposition \ref{prop78}), et donc $\chi_{-p}(n) = |\chi_\pi(n)|^2= 1$.

La d\'ecomposition de $a$ en facteurs premiers primaires est de la forme
$$a = \pm q_1q_2\cdots q_k p_1p_2\cdots p_l = \pm q_1q_2\cdots q_k \pi_1 \overline{\pi_1} \pi_2 \overline{\pi_2}\cdots \pi_l \overline{\pi_l},$$
o\`u $q_i \equiv -1\pmod 3 , p_j \equiv 1 \pmod 3$, et o\`u les $\pi_k$ sont des premiers primaires. Notons que les diviseurs premiers $q_i, \pi_j, \overline{\pi_j}$ de $a$ sont premiers avec $n$.

La d\'efinition des caract\`eres g\'en\'eralis\'es donne alors
$$\chi_a(n) = \chi_{q_1}(n)\cdots \chi_{q_k}(n) \chi_{\pi_1}(n)\chi_{\overline{\pi_1}}(n)\cdots \chi_{\pi_l}(n)\chi_{\overline{\pi_l}}(n) = 1.$$


\end{proof}

Donnons le caract\`ere cubique des unit\'es, d'abord dans le cas o\`u $\pi$ est un premier de $A$ tel que $\n(\pi) \ne 3$.

Comme $-1 = (-1)^3$, puisque $\chi_\pi(-1) \in \{1,\omega,\omega^2\}$,  $\chi_\pi(-1) = \chi_\pi(-1)^3 =  1$.

Par d\'efinition, $\chi_\pi(\omega) \equiv \omega^{\frac{\n(\pi) - 1}{3}} \pmod \pi$. Comme $\chi_\pi(\omega)$ et $\omega^{\frac{\n(\pi) - 1}{3}} $sont tous deux dans l'ensemble $\{1,\omega,\omega^2\}$, et que les classes de $1,\omega,\omega^2$ sont distinctes modulo $\pi$, nous en d\'eduisons que
$$\chi_\pi(\omega) = \omega^{\frac{\n(\pi) - 1}{3}} .$$
Comme $3 \mid \n(\pi) - 1$, $\n(\pi)$ est congru \`a 1,4 ou 7 modulo 9. Ainsi,
\begin{align*}
\chi_\pi(\omega) = 1 \iff \n(\pi) \equiv 1 \pmod 9,\\
\chi_\pi(\omega) = \omega \iff \n(\pi) \equiv 4 \pmod 9,\\
\chi_\pi(\omega) = \omega^2 \iff \n(\pi) \equiv 7 \pmod 9.\\
\end{align*}
Comme $\chi_\pi = \chi_{\pi'}$ si $\pi$ et $\pi'$ sont associ\'es, on peut se limiter au cas o\`u $\pi$ est un premier primaire, de la forme $\pi = 3m-1 + 3n\omega$. Alors
\begin{align*}
\n(\pi)-1 &= (3m-1)^2+(3n)^2-3n(3m-1)-1\\
&=9m^2 - 6m + 9n^2 -9nm + 3n,\\
\frac{\n(\pi)-1}{3}&= 3m^2-2m+3n^2-3nm+n \equiv n+m \pmod 3.
\end{align*}
Ainsi, si $\pi = a+b\omega=3m-1+3n\omega$,

$$\chi_{\pi}(\omega) = \omega^{\frac{\n(\gamma)-1}{3}} = \omega^{n+m}.$$
G\'en\'eralisons ce r\'esultat \`a un \'el\'ement primaire $\gamma = 3m-1 + 3n \omega$, pas n\'ecessairement premier.

Nous v\'erifions d'abord que si $\gamma = -\gamma_1 \gamma_2$, avec
$$
\begin{array}{lll}
  \gamma = a+b\omega, & a=3m-1,  & b=3n,  \\
   \gamma_1 = a_1+b_1\omega,& a_1= 3m_1-1,  &  b_1=3n_1, \\
  \gamma_2 = a_2+b_2\omega,&  a_2= 3m_2-1, &  b_2=3n_2, 
\end{array}
$$
alors $m \equiv m_1+m_2\pmod 3,\ n \equiv n_1+n_2 \pmod 3$.
$$-\gamma_1 \gamma_2 = -a_1a_2 + b_1 b_2  + (- a_1b_2-a_2b_1+b_1b_2) \omega=a+b\omega,$$
donc
$$3m-1 = a =-a_1a_2 + b_1 b_2 \equiv 3(m_1+m_2) - 1\pmod 9,$$
et ainsi $m\equiv m_1+m_2\pmod 3.$
$$3n = b = -a_1b_2-a_2b_1+b_1b_2 \equiv 3 (n_1+n_2)\pmod 9,$$ 
et donc $n \equiv n_1+n_2 \pmod 3.$

Par r\'ecurrence, si $\gamma = \pm \gamma_1 \gamma_2\cdots \gamma_t = (-1)^{t-1} \gamma_1 \gamma_2\cdots \gamma_t$, o\`u $\gamma_i = a_i+b_i\omega,a_i= 3m_i-1,b_i=3n_i$, alors
$$m \equiv m_1+\cdots+m_t\pmod 3,\quad n \equiv n_1+\cdots + n_t \pmod 3.$$

Par d\'efinition de $\chi_\gamma$,
\begin{align*}
\chi_\gamma(\omega) &= \chi_{\gamma_1}(\omega)\cdots\chi_{\gamma_t}(\omega)\\
&=\omega^{m_1+n_1}\cdots \omega^{m_t+n_t}\\
&=\omega^{(m_1+\cdots+m_t)+(n_1+\cdots+n_t)}\\
&=\omega^{m+n}.
\end{align*}
Nous avons donc prouv\'e la proposition qui suit.
\begin{prop}\label{prop93}
Soit $\gamma \in A $ un \'el\'ement primaire, de la forme $\gamma = 3m-1 + 3n \omega, \ m,n \in \Z$, alors
$$\chi_\gamma(\omega) = \omega^{m+n}.$$
\end{prop}

Pour calculer $\chi_\gamma(\alpha)$ o\`u $\alpha = (-1)^a\omega^b \lambda^c \pi_1\cdots \pi_t$, o\`u les $\pi_i$ sont des premiers primaires, il reste donc \`a calculer $\chi_\gamma(\lambda)$, ce qui est plus d\'elicat. Ce sera l'objet de la section suivante.

\section{Caract\`ere cubique de $\lambda = 1 - \omega$.}
Commençons par ce cas particulier, avec une preuve due \`a Kronecker.
\begin{prop}
Soit $q$ un premier rationnel, $q = 3m - 1, \ m\in \N^*$. Alors
$$\chi_{q}(\lambda) =  \omega^{2m}.$$
\end{prop}
\begin{proof}
Nous savons que $q$ est premier dans $A$.

Comme $\lambda^2 = -3 \omega$, nous avons
$$\chi_q(\lambda^2) = \chi_q(-3) \chi_q(\omega).$$
La proposition \ref{prop79} montre que $\chi_q(-3) = 1$. De plus $\chi_q(\omega) = \omega^{\frac{\n(q) - 1}{3}} = \omega^{\frac{q^2-1}{3}}$ et ainsi
$$\chi_q(\lambda^2) = \omega^{\frac{q^2-1}{3}}.$$
Elevons cette \'egalit\'e au carr\'e. Comme $\chi_q(\lambda^2) =\chi_q(\lambda)^2$, \'etant donn\'e que $x= \chi_q(\lambda) \in \{1,\omega, \omega^2\}$ v\'erifie $x^4 = x$, nous obtenons
$$\chi_q(1-\omega) = \omega^{\frac{2}{3}(q^2-1)}.$$
Puisque $q^2 - 1 = (3m-1)^2 - 1=9m^2 - 6m$, $$\frac{2}{3}(q^2-1) = 6 m^2 -4m \equiv -4m \equiv 2m \pmod 3,$$ donc
$$\chi_q(1-\omega) = \omega^{2m}.$$

\end{proof}

La preuve de la proposition suivante suit les exercices 9.24 \`a 9.26 de Ireland et Rosen, reprenant une preuve de Kenneth S.Williams.

\begin{prop}{\bf Suppl\'ement \`a la loi de r\'eciprocit\'e cubique.}

Soit $\pi = 3m-1 + 3n\omega$ un \'el\'ement primaire de $A$. 
Alors
$$\chi_\pi(\lambda) = \omega^{2m}.$$
\end{prop}
\begin{proof}


 Soit $\pi = a +b \omega$ un \'el\'ement complexe primaire de $A = \Z[\omega]$, avec $a = 3m-1,b=3n$.

\begin{enumerate}

\item[(a)] Calculons d'abord $\chi_\pi(a)$. 

Supposons d'abord que $a$ n'est pas une unit\'e, ce qui permet de d\'efinir $\chi_a$.

Comme $\pi,a$ sont primaires, la proposition \ref{prop88} montre que $\chi_\pi(a) = \chi_a(\pi)$.

Puisque $\pi \equiv b\omega \pmod a$, $\chi_a(\pi) = \chi_a(b) \chi_a(\omega)$.

La proposition \ref{prop93} donne pour $a = 3m - 1$
$$\chi_a(\omega) = \omega^m.$$

 V\'erifions que $a$ est premier avec $b$ dans $\Z$. Si un premier rationnel  $r$ divise $a,b$, alors $r \mid \pi$ dans $A$, donc  $\n(r) = r^2 \mid \pi \overline{\pi} = p$ in $A$, donc $r^2 \mid p$ dans $\Z$, ce qui est absurde.

La proposition \ref{prop92} donne alors $\chi_a(b) = 1$, et $\chi_a(\omega) = \omega^m$, si bien que $$\chi_\pi(a) = \chi_a(\pi) = \chi_a(b) \chi_a(\omega) = \omega^m.$$

Si $a$ est une unit\'e, comme $a \in \Z, a \equiv -1 \pmod 3$, alors $a = -1$ et $m = 0$, donc $\chi_\pi(a) = 1 = \omega^m$.

En conclusion, dans tous les cas
 $$\chi_\pi(a) = \omega^m.$$
 
 
 \item[(b)] Puisque
 $$a+b = [(a+b) \omega] \omega^{-1},$$
et 
$$(a+b) \omega = (a+b\omega) +a\omega -a \equiv a(\omega-1)\pmod \pi,$$ alors
$$a+b \equiv -\lambda a \omega^{-1} \pmod \pi,$$
$$\chi_\pi (a+b) = \chi_\pi(\lambda) \chi_\pi(a) \chi_\pi(\omega)^{-1},$$
$\chi_\pi(a) = \omega^m$ d'apr\`es (a), et $\chi_\pi(\omega) = \omega^{m+n}$(proposition \ref{prop93}), ainsi

$$\chi_\pi(a+b) = \omega^{2n} \chi_\pi(\lambda).$$


\item[(c)] Supposons maintenant que $a+b$ n'est pas une unit\'e, ce qui permet de consid\'erer $\chi_{a+b}$. 

Comme $\pi = a + b \omega$ et $a \equiv -b \pmod {a+b}$, alors $\pi \equiv -b(1-\omega) \pmod {a+b}$. Ainsi
$$\chi_{a+b}(\pi) = \chi_{a+b}(b) \chi_{a+b}(1-\omega).$$
Puisque $a \wedge b = 1$, $(a+b) \wedge b = 1$. La proposition \ref{prop92} donne alors $\chi_{a+b}(b) = 1$, donc
$$\chi_{a+b}(\pi) =  \chi_{a+b}(\lambda).$$

\item[(d)] Puisque le caract\`ere $\chi_{a+b}$ est d'ordre 3,
\begin{align*}
\chi_{a+b}(\lambda) &= (\chi_{a+b}(\lambda^2))^2\\
&=(\chi_{a+b}(-3\omega))^2\\
&=[\chi_{a+b}(3) \chi_{a+b}(\omega)]^2
\end{align*}

$\chi_{a+b}(3) = 1$ car $(a+b) \wedge 3 = (3(m+n)-1) \wedge 3 = 1$.

$\chi_{a+b}(\omega) = \omega^{m+n}$ (proposition \ref{prop93}).

En conclusion, $$\chi_{a+b}(\lambda) = \omega^{2(m+n)}.$$

\item[(e)] Les parties (b), (c) et (d) donnent alors
\begin{align*}
\chi_\pi(a+b) &= \omega^{2n} \chi_\pi(\lambda),\\
\chi_{a+b}(\pi) &= \omega^{2(m+n)}.
\end{align*}
Comme $\pi$ et $a+b$ sont des \'el\'ements primaires de $A$, la r\'eciprocit\'e cubique (proposition \ref{prop88}) donne alors
$$\chi_\pi(a+b) = \chi_{a+b}(\pi).$$
Par cons\'equent 
$$\omega^{2n} \chi_\pi(\lambda) = \omega^{2(m+n)},$$
soit
$$\chi_\pi(\lambda) = \omega^{2m}.$$


\item[(f)] Il reste le cas o\`u $a+b$ est une unit\'e. Alors $a+b = -1$, donc $3m-1 + 3n = -1$, et ainsi $n = -m$. La partie (b) montre que
$1 = \chi_\pi(-1) = \chi_\pi(a+b) = \omega^{2n} \chi_\pi(\lambda)$, donc
$$\chi_\pi(\lambda) = \omega^{-2n} = \omega^{2m}.$$


Dans chacun des cas, $\chi_\pi(\lambda) = \omega^{2m}$.
\end{enumerate}
\end{proof}




\chapter{R\'eciprocit\'e biquadratique.}
Nous noterons dans ce chapitre $D = \Z[i]$ l'anneau des entiers de Gauss.

\section{Anneaux quotients de $\Z[i]$.}
\begin{prop}\label{prop96}
Soit $\pi$ un \'el\'ement premier dans $D$. 
Alors l'anneau quotient $D/\pi D$ est un corps \`a $\n(\pi)$ \'el\'ements.
\end{prop}
\begin{proof}
Nous prouvons cette proposition en consid\'erant les diff\'erents types d'\'el\'ements premiers de $\Z[i]$, donn\'es dans la proposition \ref{prop9} du chapitre "Entiers de Gauss".
\be
\item[$\bullet$] Supposons que $\pi = q$ est un premier rationnel, o\`u $q \equiv 3 \pmod 4,\ q>0$. V\'erifions que
$$S = \{a + b i\ | \ 0 \leq a < q, \ 0\leq b < q\}$$
est un syst\`eme complet de repr\'esentants des classes modulo $\pi$.

Si $\alpha = u + i v \in D$, alors les divisions euclidiennes de $u$ et $ v$ par $q$ donnent des entiers $a,b,s,t$ tels que $u = qs +a, v = qt +b$, o\`u $0\leq a < q, 0 \leq b < q$. Alors $\alpha \equiv a + b i \pmod q$, o\`u $a + b i \in S$.

V\'erifions que les \'el\'ements de $S$ sont dans des classes distinctes. Si $\alpha =a +b i \equiv \beta = a' + b' i \pmod q$, o\`u $\alpha, \beta \in S$, alors $q \mid (a - a')+(b-b') i$, donc $\frac{a-a'}{q} + i\frac{b-b'}{q} \in \Z[i]$, ce qui implique $q \mid a-a', q \mid b-b'$. Comme $|a-a'| < q$ et $|b-b'|<q$, il s'ensuit que $a=a', b=b'$, donc $\alpha = \beta$. Ainsi $|D/\pi D| = |S| = q^2 = \n(q) = \n(\pi)$.

\item[$\bullet$] Supposons que $\pi = a + b i$ v\'erifie $\n(\pi) = p$, o\`u $p$ est un premier rationnel, $p\equiv 1 \pmod 4$. V\'erifions que
$$T = \{0,1,\cdots,p-1\}$$
est un syst\`eme complet de repr\'esentants des classes.

Comme $\n(\pi) = p = a^2  +b^2$, il s'ensuit que $p\nmid b$, sinon $p\mid a, p\mid b$, donc $p^2 \mid a^2+b^2 = p$, donc $p\mid 1$ : c'est absurde.

Soit $\alpha = u + i v \in D$. Comme $p\nmid b$, il existe un entier $b$ tel que $cb \equiv v \pmod p$, a fortiori modulo $\pi$. Alors $\alpha -c \pi = u -ca + i(v -cb)$, donc $\alpha \equiv u -ca \pmod \pi$. Posons $n = u-ca$. Alors $n\in \Z$, et $\alpha \equiv n \pmod \pi$. La division euclidienne de $n$ par $p$ donne $n =ps +r, \ 0\leq r < p$, donc $\alpha \equiv r \pmod \pi$, o\`u $r \in T$.

Les \'el\'ements de $T$ sont dans des classes distinctes modulo $\pi$. En effet, si $r,s \in T$, et $r \equiv s \pmod \pi$, alors $\pi \mid r-s$, soit $r-s =\pi \lambda , \lambda \in D$, donc $(r-s)^2 =  \n(\pi) \n(\lambda) = p \n(\lambda)$. Ainsi $p \mid (r-s)^2$, o\`u $p$ est un premier rationnel, donc $p \mid r-s$, o\`u $|r-s|<p$, donc $r= s$.

Par cons\'equent, $ |D/\pi D| = |T| = p = \n(\pi)$.

\item[$\bullet$] Supposons que $\pi = 1 + i$. V\'erifions que
$$U = \{0,1\}$$
est un syst\`eme complet de repr\'esentant des classes modulo $\pi = 1 + i$.

Soit $\alpha =a + b i \in D$ quelconque. Comme $i \equiv -1 \pmod \pi$, $\alpha \equiv a - b \pmod \pi$. Posons $n = a -b$; alors $n\in \Z$ et $\alpha \equiv n$. La division euclidienne de $n$ par $2$ donne les entiers $q,r$ tels que $n =2q + r, r \in \{0,1\}$, donc $n \equiv r \pmod 2$, et puisque $1 + i \mid 2$, $n \equiv r \pmod \pi$, o\`u $r \in U$.

De plus, $0 \not \equiv 1 \pmod \pi$, sinon $\pi \mid 1$ : c'est absurde puisque $\pi$ est premier, et n'est donc pas une unit\'e. 

Ainsi $|D/\pi D| = |U| = 2 = \n(\pi)$.
\ee
Si $\lambda$ est un \'el\'ement premier quelconque de $D$, alors $\lambda$ est associ\'e \`a un \'el\'ement $\pi$ appartenant \`a l'un des trois types consid\'er\'es, donc v\'erifiant $\n(\pi) = |D/\pi D|$. Alors $\n(\pi) = \n(\lambda)$, et $\pi D = \lambda D$, donc $\n(\lambda) = |D/\lambda D|$.

\end{proof}

\section{Caract\`ere biquadratique.}
Si $\alpha$ est un \'el\'ement de $D$, nous noterons $[\alpha]$ sa classe dans $D/\pi D$.

L'analogue du th\'eor\`eme de Fermat dans $D$ s'\'ecrit
\begin{prop}\label{prop97}
Soit $\alpha \in D$, et $\pi$ un premier de $A$ tel que $\pi$ ne divise pas $\alpha$. Alors
$$\alpha^{\n(\pi) - 1} \equiv 1 \pmod \pi.$$
\end{prop}
\begin{proof}
Soit $K$ le corps $D/\pi D$. Le cardinal du groupe $K^*$ est $\n(\pi) - 1$, donc l'ordre de la classe $[\alpha] \in K^*$ divise $\n(\pi)-1$. Ainsi $[\alpha]^{\n(\pi)-1} = 1$, donc $\alpha^{\n(\pi)-1} \equiv 1 \pmod \pi$.
\end{proof}

\begin{prop}\label{prop98}
Si $\pi$ est un premier de $A$, et si $\n(\pi) \ne 2$, alors
$$4 \mid \n(\pi) - 1.$$
\end{prop}
\begin{proof}
Montrons que les classes de $1,i,-1,-i$ modulo $\pi$ sont distinctes. En effet, si $i^j \equiv i^k \pmod \pi,\ (0\leq j \leq k < 4)$, alors $\pi \mid i^l - 1$, o\`u $l = k-j$ v\'erifie  $0 \leq l < 4$. Si $l\ne 0$, alors $\pi$ divise $i-1$, ou $2$, ou $i+1$. Dans les trois cas, $\pi$ divise $2$. Comme $2 = -i(1+i)^2$, tout diviseur premier de $2$ est associ\'e \`a $1+i$, et v\'erifie alors $\n(\pi) = 2$, ce qui est exclu.

Par cons\'equent, le sous-groupe $\{[1],[i],[-1],[-i]\}$ de $(D/\pi D)^*$, engendr\'e par la classe de $i$, est un sous-groupe \`a 4 \'el\'ements. Le th\'eor\`eme de Lagrange montre alors que $4$ divise  $|(D/\pi D)^*| = \n(\pi) -1$.
\end{proof}

\begin{prop}\label{prop99}
Supposons que $\pi$ est un premier de $D$ tel que $\n(\pi) \ne 2$. Soit $\alpha \in D$ tel que $\pi \nmid \alpha$. Alors il existe un unique entier $m\in\{0,1,2,3\}$ tel que
$$\alpha^{\frac{\n(\pi)-1}{4}} \equiv i^m \pmod \pi.$$
\end{prop}
\begin{proof}
Posons $S = \{[1],[i],[i]^2,[i]^3\}$. La d\'emonstration pr\'ec\'edente montre que $|S| = 4$, et $S$ est inclus dans l'ensemble des racines du polynôme $x^4 - 1 \in K[x]$, o\`u $K$ est le corps $D/\pi D$. Puisqu'un polynôme de degr\'e 4 sur un corps commutatif ne peut admettre plus de 4 racines, $S$ est donc l'ensemble des racines de ce polynôme. Comme $\gamma = [\alpha]^{\frac{\n(\pi)-1}{4}} \in D/\pi D$ v\'erifie $\gamma^4 -1=0$, alors $\gamma \in S$, soit
$ [\alpha]^{\frac{\n(\pi)-1}{4}} = [i]^m,\ 0 \leq m <4$. Par cons\'equent
$$\alpha^{\frac{\n(\pi)-1}{4}} \equiv i^m \pmod \pi.$$
Un tel $m$ est unique puisque les classes $[i]^m,\ m\in\{0,1,2,3\}$ sont distinctes.
\end{proof}

Remarquons que, dans le cas o\`u $\pi \mid \alpha$, $\alpha^{\frac{\n(\pi)-1}{4}} \equiv 0 \pmod \pi$. Nous savons que les classes de $1,i,i^2,i^3$ sont distinctes dans $D/\pi D$. De plus, les classes de $0,1,i,i^2,i^3$ sont distinctes, sinon $\pi \mid i^k$, et $\pi$ serait une unit\'e. Pour tout $\alpha \in D$, il existe un et un seul $z \in \{0,1,i,i^2,i^3\}$ tel que $\alpha^{\frac{\n(\pi) - 1}{4}} \equiv z \pmod \pi$. Ceci justifie la d\'efinition suivante :

\begin{dfn}
Soit $\pi$ un \'el\'ement premier de $D = \Z[i]$ tel que $\n(\pi) \ne 2$, et soit $\alpha \in D$. Le caract\`ere biquadratique de $\alpha$, not\'e $\chi_\pi(\alpha)$, ou $\legendre{\alpha}{\pi}_4$, est l'unique valeur complexe de l'ensemble $\{0,1,i,i^2,i^3\}$ caract\'eris\'ee par
$$\chi_{\pi}(\alpha) \equiv \alpha^{\frac{\n(\pi)-1}{4}} \pmod \pi.$$
\end{dfn}
Cette d\'efinition implique que $\chi_\pi(\alpha) =0 \iff \pi \mid \alpha$.

\begin{prop}\label{prop100}
Si $\legendre{\alpha}{\pi}_4 \equiv \zeta \pmod \pi$,  o\`u $\zeta \in \{0,1,i,-1,-i\}$, alors $\chi_\pi(\alpha) = \zeta$.
\end{prop}

\begin{proof}
En effet, $\chi_\pi(\alpha)$ et $ \zeta$ sont des \'el\'ements de $\{0,1,i,i^2,i^3\}$ et les classes de ces \'el\'ements sont distinctes modulo $\pi$.
\end{proof}
Donnons les premi\`eres propri\'et\'es de ce caract\`ere biquadratique.

\begin{prop}\label{prop101}
Si $\alpha, \beta \in D$, et si $\pi$ est un premier de $D$ tel que $\n(\pi) \ne 2$, alors
\be
\item[(a)] $\chi_\pi(\alpha \beta) = \chi_\pi(\alpha) \chi_\pi(\beta)$,
\item[(b)] si $\alpha \equiv \beta \pmod \pi$, alors $\chi_\pi(\alpha) = \chi_\pi(\beta)$.
\ee
\end{prop}
\begin{proof}
\be
\item[(a)] Par d\'efinition,
$$\chi_\pi(\alpha \beta) \equiv (\alpha \beta)^{\frac{\n(\pi) - 1}{4}} = \alpha ^{\frac{\n(\pi) - 1}{4}}  \beta^{\frac{\n(\pi) - 1}{4}} \equiv \chi_\pi(\alpha)\chi_\pi(\beta) \pmod \pi.$$
Comme $\chi_\pi(\alpha)\chi_\pi(\beta) \in \{0,1,i,-1,-i\}$, la proposition \ref{prop100} montre alors que $\chi_\pi(\alpha \beta) = \chi_\pi(\alpha) \chi_\pi(\beta).$
\item[(b)] Si $\alpha \equiv \beta \pmod \pi$, alors  $\alpha ^{\frac{\n(\pi) - 1}{4}} \equiv  \beta ^{\frac{\n(\pi) - 1}{4}} \pmod \pi$, donc $\chi_\pi(\alpha) \equiv \chi_\pi (\beta) \pmod \pi$. La proposition \ref{prop100} montre alors que $\chi_\pi(\alpha) = \chi_\pi(\beta)$.
\ee
\end{proof}
Notons que le (b) assure que l'application $\chi$
$$
\left\{
\begin{array}{ccc}
(D/\pi D)^* & \to \C^*\\
{[}\alpha{]} & \mapsto \chi_\pi(\alpha)
\end{array}
\right.
$$
est bien d\'efinie, et le (a) montre que $\chi$ est un homomorphisme de groupes. Ainsi $\chi$ est un caract\`ere multiplicatif sur $(D /\pi D)^*$.

Le caract\`ere biquadratique permet de caract\'eriser les puissances quatri\`emes de $D$ modulo $\pi$
\begin{prop}\label{prop102}
Soit $\alpha \in D = \Z[i]$, et $\pi$ un premier de $D$ tel que $\n(\pi) \ne 2$ et $\pi \nmid \alpha$. Alors
$$\chi_\pi(\alpha) = 1 \iff \exists x \in D,\ x^4 \equiv \alpha \pmod \pi.$$
\end{prop}
\begin{proof}
$D/\pi D$ est un corps \`a $\n(\pi)$ \'el\'ements d'apr\`es la proposition \ref{prop96}, et $4$ divise $\n(\pi)- 1$ d'apr\`es la proposition \ref{prop98}, donc $d = 4 \wedge(\n(\pi)-1) = 4$. Alors la proposition \ref{nbsols} du chapitre``Sommes de Gauss et sommes de Jacobi'' montre que l'\'equation $[x]^4 = [\alpha]$ a une solution dans $(D/\pi D)^*$ si et seulement si $[\alpha]^{\frac{\n(\pi)-1}{4}} = 1$, ce qui \'equivaut \`a $\chi_\pi(\alpha) = 1$.
\end{proof}

\begin{prop}\label{prop103}
 Si $\alpha \in D$, et $\pi$ un premier de $D$,
$$\overline{\chi_\pi(\alpha)} = \chi_{\overline{\pi}}(\overline{\alpha}).$$
\end{prop}
\begin{proof}
La d\'efinition de $\chi_\pi$ donne la relation
$$\alpha^{\frac{\n(\pi) - 1}{4}} \equiv \chi_\pi(\alpha) \pmod \pi.$$
Le passage au conjugu\'e donne
$$\overline{\alpha}^{\, \frac{\n(\pi) - 1}{4}} \equiv \overline{\chi_\pi(\alpha)} \pmod {\overline{\pi}}. $$
Comme $\n(\pi) = \n(\overline{\pi})$,
\begin{align*}
\chi_{\overline{\pi}}(\overline{\alpha}) &\equiv  \overline{\alpha}^{\frac{\n(\overline{\pi}) - 1}{4}} \pmod {\overline{\pi}}\\
&=\overline{\alpha}^{\frac{\n(\pi) - 1}{4}} \\
& \equiv \overline{\chi_\pi(\alpha)} \pmod {\overline{\pi}}.
\end{align*}

\end{proof}

\begin{prop}\label{prop104}
Soit $q$ un nombre premier rationnel, $q \equiv 3 \pmod 4$, et $n \in \Z$ premier avec $q$. Alors
$$\chi_q(n) = 1.$$
\end{prop}

\begin{proof}
Par d\'efinition de $\chi_q$,
$$\chi_q(n) \equiv n^{\frac{\n(q) - 1}{4}} = n^{\frac{q^2 - 1}{4}} = (n^{q-1})^{\frac{q+1}{4}} \equiv 1 \pmod q,$$
d'apr\`es le petit th\'eor\`eme de Fermat.
\end{proof}

\section{El\'ements primaires de $D$.}
Introduisons la notion d'\'el\'ement primaire dans $D  = \Z[i]$.
\begin{dfn}
Soit $\alpha$ un \'el\'ement de $D$ qui n'est pas une unit\'e. Alors $\alpha$ est dit primaire si 
$$\alpha \equiv 1 \pmod {(1+i)^3}.$$
\end{dfn}

\begin{prop}\label{prop105}
Soit $\alpha = a + bi \in D, \n(\alpha)\ne 1$. Alors
$$\alpha \text{ est primaire} \iff 
\left\{
\begin{array}{l}
a\equiv1 ,\  b \equiv 0 \pmod 4,\\
\text{    ou}\\
a\equiv 3,\  b \equiv 2 \pmod 4.
\end{array}
\right.
$$
\end{prop}
\begin{proof}
Puisque $(1+i)^3 = 2i(1+i)$ est associ\'e \`a $2+2i$, , il s'ensuit que $a+bi$ est primaire si et seulement si
$$\frac{(a-1) + bi}{2+2i} =\frac{((a-1) + bi)(1-i)}{4} = \frac{a+b-1}{4} + \frac{b-a+1}{4}\, i \in D,$$
ce qui \'equivaut au syst\`eme
$$
\left\{
\begin{array}{ll}
a+b \equiv 1 &\pmod 4,\\
a-b \equiv 1 &\pmod 4.
\end{array}
\right.
$$
Alors $2a \equiv 2 \pmod 4$, donc $a$ est impair, et ainsi $a \equiv 1,3 \pmod 4$. 
Les seules solutions sont donn\'ees par $a\equiv 1, b\equiv 0 \pmod 4$, ou $a\equiv 3 ,b \equiv 2 \pmod 4$.
\end{proof}

En particulier, si $\alpha \ne 1$ v\'erifie $\alpha \equiv 1 \pmod 4$, alors $\alpha$ est primaire. De plus, si $\alpha$ est primaire, alors $1+i \nmid \alpha$. Si $q$ est un premier rationnel, o\`u $q \equiv 3 \pmod 4,\ q>0$, alors $-q$ est un premier primaire (mais pas les autres associ\'es $q, iq, -iq$).

\begin{prop}\label{prop106}
Soit $\alpha$ un \'el\'ement de $D$ qui n'est pas une unit\'e, et tel que $1+i \nmid \alpha$. Alors $\alpha$ a un et un seul associ\'e primaire.
\end{prop}

\begin{proof}
Soit $\alpha = a + ib$ tel que $1+i \nmid \alpha$. Comme $\alpha = (a-b) + b(1+i)$, alors $1 + i \nmid a-b$, donc $2 \nmid a-b$. Ainsi $a,b$ sont de parit\'e distinctes.
Si $a$ est pair et $b$ impair, alors $i\alpha = -b + ia =a' +i b'$, o\`u $a'$ est impair et $b'$ pair. Ainsi il existe une unit\'e $\varepsilon$ ($\varepsilon = 1$ ou $\varepsilon = i$) telle que $\varepsilon \alpha = a' + b'i$ v\'erifie la propri\'et\'e $a'$ impair et $b'$ pair.  

Il n'existe alors que quatre cas modulo 4 : $a' \equiv 1,b' \equiv 0$, ou $a' \equiv 3, b' \equiv 2$, ou $a' \equiv 1, b' \equiv 2$, ou $a'  \equiv 3, b' \equiv 0$ (modulo 4).

Dans les deux premiers cas, $a' + b' i$ est primaire.

Si $a' \equiv 1$ et $b' \equiv 2$ modulo 4, alors $  a'' + b''i = -a' -b' i $ v\'erifie $a'' \equiv 3, b'' \equiv 2 \pmod 4$, et si $a' \equiv 3, b' \equiv  0$, alors $ a'' + b''i$ v\'erifie $a'' \equiv 1,  b'' \equiv 0$ modulo 4. Dans ces deux cas $a'' + ib''$ est primaire. 

Si $\varepsilon_1 \alpha, \varepsilon_2 \alpha$ sont tous deux primaires, o\`u $\varepsilon_1,\varepsilon_2$ sont des unit\'es, alors $(\varepsilon_1 - \varepsilon_2) \alpha \equiv 0 \pmod {(1+i)^3}$. Comme $1+i$ est premier dans $D$ et ne divise pas $\alpha$, $(1+i)^3 \mid \varepsilon_1 - \varepsilon_2$. Alors $\n((1+i)^3) \mid \n(\varepsilon_1 - \varepsilon_2)$, soit $8 \mid  \n(\varepsilon_1 - \varepsilon_2)$. De plus $|\varepsilon_1 - \varepsilon_2| \leq |\varepsilon_1|+ |\varepsilon_2| = 2$, donc $\n(\varepsilon_1 - \varepsilon_2)\leq 4$. Ceci n'est possible que si $\n(\varepsilon_1 - \varepsilon_2) = 0$, donc $\varepsilon_1 = \varepsilon_2$. Ceci prouve l'unicit\'e de l'associ\'e primaire de $\alpha$.
\end{proof}

\begin{prop}\label{prop107}
Soit $S$ l'ensemble contenant $1+i$ et tous les premiers primaires de $D$. $S$ est un syst\`eme complet de repr\'esentants des classes d'association, soit
\be
\item[(a)] Tout premier de $D$ est associ\'e \`a un premier de $S$.
\item[(b)] Deux \'el\'ements arbitraires distincts de $S$ ne sont pas associ\'es.
\ee
\end{prop}

\begin{proof}
\be
\item[(a)] Soit $\pi$ un \'el\'ement premier de $D$. Si $\n(\pi) = 2$, $\pi$ est associ\'e \`a $1+i$. Si $\n(\pi) \ne 2$, alors $1+i \nmid \pi$ (sinon les premiers $1+i$ et $\pi$ seraient associ\'es, donc de m\^eme norme \'egale \`a 2). La proposition \ref{prop106} montre alors que $\pi$ est associ\'e \`a un premier primaire de $D$.
\item[(b)] Soient $\pi,\mu$ deux \'el\'ements de $S$ associ\'es. Alors ils ont m\^eme norme.

Si $\n(\pi) =\n(\mu) = 2$, alors $\pi = 1+i$, puisque $1+i$ est le seul \'el\'ement de $S$ de norme 2. De m\^eme, $\mu = \lambda$, donc $\pi = \mu$.

Si $\n(\pi) = \n(\mu) \ne 3$, alors $\pi,\mu$ sont des premiers primaires par d\'efinition de $S$, et associ\'es. La proposition \ref{prop106} montre qu'ils sont \'egaux.
\ee
\end{proof}

\begin{prop}\label{prop108}
Tout \'el\'ement  $\alpha \in D$ de d\'ecompose sous la forme
$$\alpha = i^a (1+i)^b \pi_1^{a_1}\cdots\pi_t^{a_t},$$
o\`u les $\pi_i$ sont des premiers primaires distincts, $b\geq 0,a_i \geq 0$,  et $0\leq a<4$. Cette d\'ecomposition est unique \`a l'ordre pr\`es des \'el\'ements $\pi_1,\ldots,\pi_t$.
\end{prop}
\begin{proof}
Puisque $D =\Z[i]$ est principal, donc factoriel, et $S$ \'etant un syst\`eme complet de repr\'esentants des classes d'association des \'el\'ements premiers, tout \'el\'ement $\alpha$ de $A$ s'\'ecrit de façon unique sous la forme
$$\alpha = u \prod_{\pi\in S} \pi^{e(\pi)},$$
o\`u $e(\pi)\geq 0$ est nul sauf sur un ensemble fini de valeurs de $\pi \in S$, et o\`u $u$ est une unit\'e, donc de la forme $u = i^k, \ k\in \{0,1,2,3\}$, o\`u $k$ est alors fix\'e. Par d\'efinition de $S$,
$$\alpha = i^a (1+i)^b \pi_1^{a_1}\cdots\pi_t^{a_t}.$$
\end{proof}

\begin{prop}\label{prop109}
Si $\gamma$ est un \'el\'ement primaire de $D$, alors $\gamma$ se d\'ecompose sous la forme
$$\gamma = \gamma_1\cdots \gamma_t,$$
o\`u $t\geq 1$, et les $\gamma_i$ sont des premiers primaires (pas n\'ecessairement distincts).
\end{prop}
\begin{proof}
D'apr\`es la proposition \ref{prop108},
$$\gamma = i^a (1+i)^b \gamma_1\cdots \gamma_t,$$
o\`u les $\gamma_i$ sont des premiers primaires, et $0 \leq a < 4$.

Comme $\gamma$ est primaire, il n'est pas divisible par $1+i$, donc $b=0$, soit
$$\gamma =  i^a \gamma_1\cdots \gamma_t,$$
o\`u pour tout indice $i$, $\gamma_i \equiv 1 \pmod { (1+i)^3}$. Par cons\'equent
$$1 \equiv i^a \pmod {(1+i)^3}.$$
Alors $(1+i)^3 \mid i^a - 1$, donc $8 = \n((1+i)^3) \mid \n(i^a - 1) \leq 4$, donc $\n(i^a - 1) = 0$, $i^a = 1$, avec $0\leq a <4$, et ainsi $a = 0$ :
$$\gamma = \gamma_1\cdots \gamma_t.$$

\end{proof}

Un premier primaire $\pi$ n'est pas associ\'e \`a $1+i$ par d\'efinition. La classification des premiers de $\Z[i]$ montre alors que, ou bien $\pi$ est associ\'e \`a un entier rationnel $q \equiv 3 \pmod 4$, auquel cas $\pi = -q$, ou bien  $\pi$ est tel que $\n(\pi) = p \equiv 1 \pmod 4$. Ainsi tout \'el\'ement primaire de $D$ s'\'ecrit sous la forme
$$\gamma = (-q_1)\cdots(-q_s)\pi_1\cdots\pi_t,$$
o\`u les $q_i \equiv 3 \pmod 4$ sont des premiers rationnels positifs, et o\`u les premiers primaires $\pi_j$ v\'erifient $\n(\pi_j) = p \equiv 1 \pmod 4$.

\section{Caract\`eres biquadratiques g\'en\'eralis\'es.}


Soit $\gamma \in D$ tel que $\gamma$ n'est pas une unit\'e, et $1+i \nmid \gamma$, et soit $\gamma = \lambda_1\cdots \lambda_t$ une d\'ecomposition de $\gamma$ en facteurs irr\'eductibles. Pour tout $\beta \in D$, le produit $\prod_{i=1}^t \chi_{\lambda_i}(\beta)$ ne d\'epend pas de cette d\'ecomposition. En effet, toute autre d\'ecomposition $\gamma = \mu_1\cdots \mu_{t'}$ en facteurs irr\'eductibles est telle que $t' = t$, et $\mu_i = \varepsilon_i \lambda_{\sigma(i)}$, o\`u $\varepsilon_i$ est une unit\'e, et $\sigma \in S_t$ est une permutation. Puisque $\mu_i$ et $\lambda_{\sigma_i}$ sont associ\'es, la d\'efinition du caract\`ere biquadratique donne $\chi_{\mu_i} = \chi_{\lambda_{\sigma_i}}$, donc $\prod_{i=1}^t \chi_{\lambda_i}(\beta) = \prod_{i=1}^t \chi_{\mu_i}(\beta)$. Ceci permet de donner la d\'efinition suivante.

\begin{dfn}  Si $\gamma \in D$ est tel que $\gamma$ n'est pas une unit\'e, et $1+i \nmid \gamma$, et si  $\gamma = \lambda_1\cdots \lambda_t$ est une d\'ecomposition de $\gamma$ en facteurs irr\'eductibles, alors $\chi_\gamma$ est d\'efini par :
$$\forall \beta \in D,\ \chi_\gamma(\beta) = \prod_{i=1}^t \chi_{\lambda_i}(\beta).$$
\end{dfn}

\begin{prop}\label{prop110}
 Soient $\lambda, \rho$ des \'el\'ements de $D$ qui ne sont pas divisibles par $1+i$, et $\alpha,\beta \in D$. Alors
\be
\item[(a)] $\alpha \equiv \beta \pmod \gamma \Rightarrow \chi_\gamma(\alpha) = \chi_\gamma(\beta)$.
\item[(b)] $\chi_\gamma(\alpha \beta) = \chi_\gamma(\alpha) \chi_\gamma(\beta)$.
\item[(c)] $\chi_\rho(\alpha) \chi_\gamma(\alpha) = \chi_{\rho \gamma}(\alpha)$.
\ee
\end{prop}

\begin{proof}
\be
\item[(a)] Soit $\gamma = \gamma_1 \cdots \gamma_t$ une d\'ecomposition de $\gamma$ en facteurs premiers dans $D$. Alors pour tout $i$, $\alpha \equiv \beta \pmod{\gamma_i}$, donc $\chi_{\gamma_i}(\alpha) =\chi_{\gamma_i}(\beta)$ (proposition \ref{prop101}(b)). Par cons\'equent 
$$\chi(\alpha) = \prod_{i=1}^t \chi_{\gamma_i}(\alpha) = \prod_{i=1}^t \chi_{\gamma_i}(\beta) =\chi_\gamma(\beta).$$
\item[(b)] La proposition \ref{prop101}(a) montre que
\begin{align*}
\chi_\gamma(\alpha \beta) &= \chi_{\gamma_1}(\alpha \beta)\cdots\chi_{\gamma_t}(\alpha \beta)\\
&=\chi_{\gamma_1}(\alpha)\cdots\chi_{\gamma_t}(\alpha)\chi_{\gamma_1}(\beta)\cdots\chi_{\gamma_t}(\beta)\\
&=\chi_\gamma(\alpha) \chi_\gamma(\beta).
\end{align*}

\item[(c)] Ecrivons une d\'ecomposition de $\rho$ en facteurs premiers sous la forme $\rho = \rho_1\cdots \rho_l$. Comme $1+i$ est premier, $1+i \nmid \rho \gamma$, et $\rho \gamma$ se d\'ecompose sous la forme $\rho \gamma = \rho_1\cdots \rho_l \gamma_1 \cdots \gamma_t$, donc
$$\chi_{\gamma \rho}(\alpha) = (\chi_{\rho_1}\cdots \chi_{\rho_l} \chi_{\gamma_1} \cdots  \chi_{\gamma_t})(\alpha) = \chi_\rho(\alpha) \chi_\gamma(\alpha).$$
\ee
\end{proof}

La proposition \ref{prop103} se g\'en\'eralise aussitôt.
\begin{prop}\label{prop111}
Si $\alpha \in D$, et $\pi \in D$ tel que $1+ i\nmid \pi$ (en particulier si $\pi$ est primaire), alors
$$\overline{\chi_\pi(\alpha)}= \chi_{\overline{\pi}}(\overline{\alpha}).$$
\end{prop}

\begin{proof}
D\'ecomposons $\pi$ en produit de premiers dans $D$ : $\pi = \pi_1\cdots\pi_t$. Alors, en utilisant la proposition \ref{prop103},
\begin{align*}
\overline{\chi_\pi(\alpha)} &=\overline{\chi_{\pi_1}(\alpha)}\cdots\overline{\chi_{\pi_1}(\alpha)}\\
&= \chi_{\overline{\pi_1}}(\overline{\alpha}) \cdots  \chi_{\overline{\pi_t}}(\overline{\alpha})\\
&=\chi_{\overline{\pi_1}\cdots \overline{\pi_t}}(\overline{\alpha})\\
&=\chi_{\overline{\pi}}(\overline{\alpha}).
\end{align*}
\end{proof}

\begin{prop}\label{prop112}
Soit $\pi = a + bi$ un \'el\'ement primaire de $D$. Alors
$$\chi_\pi(-1) = (-1)^{\frac{a-1}{2}}.$$
\end{prop}

\begin{proof}
Traitons d'abord le cas o\`u $\pi$ est un premier primaire de  $D$. Alors $a$ est impair, $b$ pair et $\n(\pi) = a^2+b^2$.
Par cons\'equent, 
$$\chi_\pi(-1) = (-1)^{\frac{\n(\pi)-1}{4}} = (-1)^{\frac{a^2-1}{4}+ \frac{b^2}{4}} = [(-1)^{\frac{a+1}{2}}]^{\frac{a-1}{2}} (-1)^{\frac{b^2}{4}}.$$
D'apr\`es la proposition \ref{prop105}, $a\equiv 1\pmod 4, b\equiv 0\pmod 4$, ou $a \equiv 3\pmod 4, b\equiv 2 \pmod 4$.
	\begin{enumerate}
	\item[$\bullet$] Si $a\equiv 1\pmod 4, b\equiv 0\pmod 4$, alors $(-1)^{\frac{a+1}{2}} = -1, (-1)^{\frac{b^2}{4}}=+1$, donc
	$$\chi_\pi(-1) =(-1)^{\frac{a-1}{2}}.$$
	\item[$\bullet$] Si $a \equiv 3 \pmod 4, b\equiv 2 \pmod 4$, alors $(-1)^{\frac{a+1}{2}} = 1, (-1)^{\frac{b^2}{4}}=-1$, donc
	$$\chi_\pi(-1) =-1 = (-1)^{\frac{a-1}{2}}.$$
	\end{enumerate}
	
Dans tous les cas, si  $\pi = a + bi$ est un premier primaire de $D$, alors
$$\chi_{\pi}(-1)=(-1)^{(a-1)/2}.$$

\bigskip

Passons au cas g\'en\'eral, o\`u $\pi$ est un \'el\'ement primaire de $D$, pas n\'ecessairement premier. Alors la proposition \ref{prop109} permet de d\'ecomposer $\pi$ sous la forme
$$\pi = \pi_1 \cdots \pi_t,$$
o\`u les $\pi_k = a_k+ i b_k$ sont des premiers primaires. D'apr\`es la premi\`ere partie de la preuve,
\begin{align*}
\chi_\pi(-1) &= \prod_{k=1}^t \chi_{\pi_k}(-1)\\
&=   \prod_{k=1}^t (-1)^{\frac{a_k-1}{2}}.
\end{align*}

Montrons que $$(-1)^{\frac{a-1}{2} }= \prod_{k=1}^t (-1)^{\frac{a_k-1}{2}}.$$
Notons $\Pi$ ce dernier produit. 
Or, pour tout entier \'el\'ement primaire $\pi = a + bi$, $ (-1)^{\frac{a-1}{2}} = -1$ \'equivaut \`a $\pi \equiv 3 + 2i \pmod 4$, et dans le cas contraire o\`u $\pi \equiv 1 \pmod 4$, alors $(-1)^{\frac{n-1}{2}} = 1$. Donc $\Pi = -1$ si et seulement si le nombre $P$ de facteurs $\pi_i$ congrus \`a 3 modulo 4 est impair. Comme les autres facteurs sont congrus \`a 1 modulo 4, et $(3 + 2i)^2 \equiv 1 \pmod 4$, $\pi = \pi_1\cdots \pi_t \equiv 3 + 2i \pmod 4$ si $P$ est impair. Ainsi
$$\Pi = -1 \iff P \equiv 1 \pmod 2 \iff \pi  \equiv 3 + 2i \pmod 4 \iff (-1)^{\frac{a-1}{2}} = -1.$$
Comme $\Pi$ et $(-1)^{\frac{a-1}{2} }$ne peuvent prendre que les valeurs $+1,-1$, nous pouvons conclure que $\Pi = (-1)^{\frac{a-1}{2}}$, et donc $\chi_\pi(-1) =(-1)^{(a-1)/2}$.

\end{proof} 



\begin{prop}\label{prop113}
Soit $n\in \Z$, et $a \in \Z$ un impair qui n'est pas une unit\'e. Si $a \wedge n = 1$, alors
$$\chi_a(n) = 1.$$
\end{prop}
\begin{proof}
Comme $\chi_a = \chi_{-a}$, on peut supposer $a>0$. D\'ecomposons $a$ sous la forme $a = \prod_{i\in I} p_i \prod_{j\in J} q_j$, o\`u les $p_i,q_j$ sont des premiers rationnels, $p_i \equiv 1 \pmod 4, q_j \equiv 3 \pmod 4$. La proposition \ref{prop104} montre que $\chi_{q_j}(n) = 1$, puisque $q_j \wedge n = 1$. Il reste \`a v\'erifier que $\chi_{p_i}(n) = 1$.  Une d\'ecomposition de $p_i$ sous la forme $p_i=\pi \overline{\pi}$, o\`u $\pi$ est premier dans $D$, donne
$$\chi_{p_i}(n) = \chi_{\pi}(n) \chi_{\overline{\pi}}(n) =  \chi_{\pi}(n) \overline{ \chi_{\pi}(n)} = 1,$$
puisque $ \chi_{\overline{\pi}}(n)  =  \chi_{\overline{\pi}}(\overline{n}) =\overline{ \chi_{\pi}(n)}$ (proposition \ref{prop104}). 
\end{proof}

{\bf Lemme.}
{\it
Soit $n \in \Z$, $n = s_1\cdots s_t, s_i\equiv 1 \pmod 4$ pour $ i = 1,\ldots,t$. Alors $$\frac{n-1}{4}\equiv \sum_{i=1}^t \frac{s_i-1}{4} \pmod 4.$$
}
\begin{proof}
Si $n = s t , s \equiv1,t\equiv1\pmod 4$, alors $s = 4k+1, t = 4 l +1,\  k,l \in \mathbb{Z}$, si bien que
$$ n= (4k+1)(4l+1) = 16 kl + 4k+4l+1, \frac{n-1}{4} = 4 kl + k + l \equiv k+l = \frac{s-1}{4}+\frac{l-1}{4} \pmod 4.$$
En raisonnant par r\'ecurrence sur  $t$, supposons que tout produit de $t$ factors $ n= s_1s_2\cdots s_t$, o\`u $s_i\equiv 1 \pmod 4$ v\'erifie
$$\frac{n-1}{4} \equiv \sum\limits_{i=1}^t \frac{s_i-1}{4} \pmod 4.$$
Si $n' = s_1 s_2 \cdots s_t s_{t+1} = n s_{t+1}, s_i \equiv 1\pmod4$, alors $n\equiv1,s_{t+1} \equiv 1 \pmod 4$, donc
$$\frac{n'-1}{4} \equiv \frac{n-1}{4} + \frac{s_{t+1}-1}{4} \equiv \sum\limits_{i=1}^t \frac{s_i-1}{4} + \frac{s_{t+1}-1}{4} \equiv \sum\limits_{i=1}^{t+1} \frac{s_i-1}{4} \pmod 4.$$

\end{proof}


\begin{prop}\label{prop114}
Si $n \ne 1$ est un entier $n\equiv 1 \pmod 4$, alors
$$\chi_n(i) = (-1)^\frac{n-1}{4}.$$
\end{prop}

\begin{proof}
Ici $n$ peut \^etre n\'egatif. Si $n$ est un premier rationnel $p \equiv 1 \pmod 4$, alors la d\'ecomposition $p = \pi \overline{\pi}$ donne
$$\chi_p(i) = \chi_\pi(i) \chi_{\overline{\pi}}(i) = (i^{\frac{p-1}{4}})^2 = (-1)^{\frac{p-1}{4}}.$$
Par ailleurs, si $n = -q, q \equiv 3 \pmod 4$, o\`u $q>0$ est un premier rationnel, alors
$$\chi_{-q}(i)= i^{\frac{q^2-1}{4}}= (i^{q-1})^{\frac{q+1}{4}} = (-1)^{\frac{q+1}{4}} = (-1)^{\frac{-q-1}{4}}.$$
Dans le cas g\'en\'eral, d\'ecomposons $n$ sous la forme $n = p_1\cdots p_t(-q_1)\cdots(-q_s)$, o\`u $p_i \equiv 1 \pmod 4, q_j \equiv 3 \pmod 4$. Alors
$$\chi_n(i) = (-1)^{\frac{p_1-1}{4}} \cdots (-1)^{\frac{p_t-1}{4}} (-1)^{\frac{-q_1-1}{4}}\cdots (-1)^{\frac{-q_s-1}{4}}.$$

En appliquant le lemme,
$$\chi_n(i)  = (-1)^{\frac{p_1\cdots p_t(-q_1)\cdots(-q_s) - 1}{4}} = (-1)^{\frac{n-1}{4}}.$$
\end{proof}


\section{La loi de r\'eciprocit\'e biquadratique.}

Cette loi n\'ecessitera plusieurs lemmes (propositions \ref{prop115} \`a \ref{prop124}). Elle s'exprime, pour des premiers primaires $\lambda, \pi$, sous la forme
$$\chi_\pi(\lambda) = \chi_\lambda(\pi)(-1)^{\frac{\n(\lambda)-1}{4} \frac{\n(\pi)-1}{4}}.$$
Rappelons qu'un premier $\pi = a + bi$ est primaire si et seulement si $a\equiv 1, b \equiv 0$, ou $a \equiv 3, b \equiv 2 \pmod 4$. Ceci \'equivaut \`a $a$ impair, $b$ pair et $\frac{a-1}{2} \equiv \frac{b}{2} \pmod 2$.

Si on note $\pi = 2m+1 + 2ni$, alors $m = \frac{a-1}{2}$ et $n = \frac{b}{2}$ sont de m\^eme parit\'e, donc
$$\frac{\n(\pi) - 1}{4} = \frac{(2m+1)^2 + (2n)^2 - 1}{4} = m^2+m+n^2\equiv m = \frac{a-1}{2} \pmod 2.$$
La loi de r\'eciprocit\'e biquadratique peut donc s'\'ecrire, pour $\pi = a +bi, \lambda = c+di$, sous la forme
$$\chi_\pi(\lambda) = \chi_\lambda(\pi)(-1)^{\frac{a-1}{2} \frac{c-1}{2}}.$$
Autrement dit $\chi_\pi(\lambda) = \chi_\lambda(\pi)$ si $\pi$ ou $\lambda$ est congru \`a 1 modulo 4, et $\chi_\pi(\lambda) = -\chi_\lambda(\pi)$ si $\pi$ et $\lambda$ sont tous deux congrus \`a $ 3 + 2i$ modulo 4.

Consid\'erons un premier primaire $\pi$ tel que $\n(\pi) = p \equiv 1 \pmod 4$, et soit $\chi_\pi$ le caract\`ere quartique associ\'e. Dans ce cas le corps $ D/\pi D$ est isomorphe \`a $\F_p$, et les \'el\'ements $\{0,1,\ldots,{p-1}\}$ de $D$ forment un syst\`eme complet de repr\'esentants des classes de $D/\pi D$. 

Nous noterons maintenant $\F_p$ ce corps \`a $p$ \'el\'ements, ensemble des classes de $0,\cdots,{p-1}$ dans $D/\pi D$. Ceci donne un sens aux sommes de Gauss $$g(\chi_\pi) = \sum_{j\in \F_p} \chi_\pi(j) \zeta^j = \sum_{j = 0}^{p-1} \chi_\pi(j) \zeta^j.$$

Comme $\chi_\pi$ est un caract\`ere d'ordre 4 dans le groupe des caract\`eres sur $F$, $\psi = \chi_\pi^2$ est un caract\`ere d'ordre 2. Puisqu'il n'existe qu'un seul caract\`ere d'ordre 2 dans le groupe des caract\`eres, $\psi$ est le caract\`ere de Legendre, donn\'e par $\psi(j) = \legendre{j}{p}$.

\begin{prop}\label{prop115}
 Les caract\`eres $\chi_\pi$ et $\psi$ \'etant d\'efinis comme ci-dessus,
$$J(\chi_\pi,\chi_\pi) =\chi_\pi(-1) J(\chi_\pi,\psi).$$
\end{prop}
\begin{proof}
La proposition \ref{lien_Jacobi_Gauss} du chapitre ``Sommes de Gauss et sommes de Jacobi'' montre que $$J(\chi_\pi,\chi_\pi) = \frac{g(\chi_\pi)^2}{g(\psi)}.$$
 La proposition \ref{conjugue} de ce m\^eme chapitre (et la remarque qui suit cette proposition) donne $$g(\psi)^2 = \psi(-1)p = (-1)^{\frac{p-1}{2}} p = p.$$
 De plus, la proposition \ref{generalisation} du chapitre pr\'ecit\'e, appliqu\'ee au caract\`ere $\chi_\pi$ d'ordre 4, donne
 $$g(\chi_\pi)^4 = \chi_\pi(-1)p J(\chi_\pi,\chi_\pi) J(\chi,\psi).$$
 Ainsi
$$J(\chi_\pi,\chi_\pi)^2 = \frac{g(\chi_\pi)^4}{g(\psi)^2} =\chi_\pi(-1)  J(\chi_\pi,\chi_\pi) J(\chi,\psi),$$
ce qui donne le r\'esultat puisque $J(\chi_\pi,\chi_\pi)$, de module $\sqrt{p}$, est non nul.
\end{proof}

\begin{prop}\label{prop116}
$$g(\chi_\pi)^4 = pJ(\chi_\pi,\chi_\pi)^2.$$
\end{prop}
\begin{proof}
La d\'emonstration pr\'ec\'edente donne $J(\chi_\pi,\chi_\pi)^2 = \frac{g(\chi_\pi)^4}{g(\psi)^2}$ et $g(\psi)^2 = p$, donc
$g(\chi_\pi)^4 = pJ(\chi_\pi,\chi_\pi)^2.$
\end{proof}

\begin{prop}\label{prop117}
L'\'el\'ement  $-\chi_\pi(-1)J(\chi_\pi,\chi_\pi)$  est primaire.
\end{prop}
\begin{proof}
La permutation de $\F_p$ donn\'ee par $t \mapsto 1-t$ a pour unique point fixe la classe de $\frac{p+1}{2}$, et laisse fixe le produit $\chi_\pi(t)\chi_\pi(1-t)$.
Puisque $ \chi_\pi(t)\chi_\pi(1-t)  = 0$ pour $t = 0$ et $t=1$,
\begin{align*}
J(\chi_\pi,\chi_\pi) &= \sum_{t=0}^{p-1} \chi_\pi(t)\chi_\pi(1-t)\\
&= \sum_{t=2}^{p-1} \chi_\pi(t)\chi_\pi(1-t)\\
&=  \sum_{t=2}^{\frac{p-1}{2}} \chi_\pi(t)\chi_\pi(1-t) + \chi_\pi\left(\frac{p+1}{2}\right)^2 + \sum_{t=\frac{p+3}{2}}^{p-1} \chi_\pi(t)\chi_\pi(1-t).\\
\end{align*}
 Le changement d'indice $s = 1-t \ (= p+1 -t)$ donne 
$$ \sum_{t=\frac{p+3}{2}}^{p-1} \chi_\pi(t)\chi_\pi(1-t) = \sum_{s=2}^{\frac{p-1}{2}} \chi_\pi(1-s)\chi_\pi(s) =\sum_{t=2}^{\frac{p-1}{2}} \chi_\pi(t)\chi_\pi(1-t) .$$
Par cons\'equent,
\begin{align*}
J(\chi_\pi,\chi_\pi) &=2  \sum_{t=2}^{\frac{p-1}{2}} \chi_\pi(t)\chi_\pi(1-t) +  \chi_\pi\left(\frac{p+1}{2}\right)^2.\\
\end{align*}
Puisque $\chi_\pi$ est d'ordre 4,
\begin{align*}
\chi_\pi\left(\frac{p+1}{2}\right)^2 &= (\chi_\pi(2^{-1}))^2 = \chi_\pi(2)^{-2} = \chi_\pi(2)^2 \\
&= \chi_\pi(-i(1+i)^2)^2 = (\chi_\pi(-i))^2 \chi_\pi^4(1+i)\\
 &= \chi_\pi((-i)^2) = \chi_\pi(-1).
\end{align*}


R\'eduisons $J(\chi_\pi,\chi_\pi)$ modulo $2 + 2i$.
Puisque $1 + i \mid 2$ et que $1-i = -i(1+i)$, les 4 unit\'es de $\Z[i]$ sont congrues \`a 1 modulo $1+i$. Par cons\'equent, 
$$2 \chi_\pi(t) \chi_\pi(1-t) \equiv 2 \pmod {2+2i},$$
et ainsi
$$J(\chi_\pi,\chi_\pi) \equiv 2\, \frac{p-3}{2} + \chi_\pi(-1)  \pmod {2+2i}.$$
De plus, puisque $p\equiv 1 \pmod 4$, a fortiori $p\equiv 1 \pmod {2+2i}$, donc
$$J(\chi_\pi,\chi_\pi) \equiv -2 + \chi_\pi(-1)  \pmod {2+2i}.$$
Enfin
\begin{align*}
-\chi_\pi(-1) J(\chi_\pi,\chi_\pi) &\equiv 2\chi_\pi(-1)- \chi_\pi(-1)^2\\
&\equiv 2\chi_\pi(-1)-1 \pmod {2+2i}
\end{align*}
Or $\chi_\pi(-1) = \pm 1$. Si $\chi_\pi(-1) = 1$, alors $2\chi_\pi(-1)-1 = 1$, et si $\chi_\pi(-1) = -1$, alors $2\chi_\pi(-1) - 1 = -3 \equiv 1 \pmod {2+2i}$. Nous avons prouv\'e que
$$-\chi_\pi(-1) J(\chi_\pi,\chi_\pi) \equiv 1 \pmod {2+2i},$$
et ainsi $-\chi_\pi(-1) J(\chi_\pi,\chi_\pi)$ est primaire.
\end{proof}

Rappelons ce lemme utile :

{\bf Lemme.}
{\it
$1^k + 2^k + . . . + (p-1)^k \equiv
\left\{
\begin{array}{ll}
 0 \pmod p& \text{si } p-1 \nmid k,\\
 -1 \pmod p& \text{si } p-1 \mid k.
\end{array}
\right.
$
}


\begin{proof}
Posons $S(k) = 1^k+2^k+\cdots+(p-1)^k$.

Soit $g$ un \'el\'ement primitif modulo $p$. Autrement dit $\overline{g}$ est un g\'en\'erateur du groupe $\F_p^*$.

Comme $(\overline{1},\overline{g},\overline{g}^{2}, \ldots, \overline{g}^{p-2}) $ est une permutation de $ (\overline{1},\overline{2}, \ldots,\overline{p-1})$,
\begin{align*}
\overline{S(k)} &= \overline{1}^k + \overline{2}^k+\cdots+ \overline{p-1}^k\\
&= \sum_{i=0}^{p-2} \overline{g}^{ki} =
\left\{
\begin{array}{ccc}
\overline{ p-1} = -\overline{1} &  \mathrm{si} &  p-1 \mid k , \\
 \frac{ \overline{g}^{(p-1)k} -1}{ \overline{g}^k -1} = \overline{0}&  \mathrm{si}  &   p-1 \nmid k,
\end{array}
\right.
\end{align*}
puisque  $p-1 \mid k \iff \overline{g}^k = \overline{1}$.

\end{proof}

\begin{prop}\label{prop118}
 Si $\pi$ est un premier primaire tel que $\n(\pi) = p \equiv 1 \pmod 4$, alors
$$-\chi_\pi(-1) J(\chi_\pi,\chi_\pi) = \pi.$$
\end{prop}
\begin{proof}
Comme il n'existe qu'un seul associ\'e primaire de $\pi$ (proposition \ref{prop106}), il suffit d'apr\`es la proposition pr\'ec\'edente de prouver que $\pi$ et $J(\chi_\pi,\chi_\pi)$ sont associ\'es.

Par d\'efinition de $\chi_\pi$, pour tout $t \in \Z$, $\chi_\pi(t) \equiv t^{\frac{p-1}{4}} \pmod \pi$, et donc
$$J(\chi_\pi,\chi_\pi) \equiv \sum_{t=1}^{p-1} t^{\frac{p-1}{4}} (1-t)^{\frac{p-1}{4}} \pmod \pi.$$
De plus,
\begin{align*}
\sum_{t=1}^{p-1} t^{\frac{p-1}{4}} (1-t)^{\frac{p-1}{4}}&=\sum_{t=1}^{p-1} t^{\frac{p-1}{4}} \sum_{j=0}^{\frac{p-1}{4}} \binom{\frac{p-1}{4}}{j}(-1)^j t^j\\
&=\sum_{j=0}^{\frac{p-1}{4}} (-1)^j \binom{\frac{p-1}{4}}{j} \sum_{t=1}^{p-1} t^{j + \frac{p-1}{4}}\\
&=\sum_{j=0}^{\frac{p-1}{4}} (-1)^j \binom{\frac{p-1}{4}}{j} S \left(j + \frac{p-1}{4}\right),
\end{align*}
o\`u, comme dans le lemme, $S(k) = 1^k+2^k+\cdots+(p-1)^k$.

Pour les indices $j$ tels que $0\leq j \leq \frac{p-1}{4}$, alors  $1 \leq j + \frac{p-1}{4} < p-1$, donc $S \left(j + \frac{p-1}{4}\right) \equiv 0 \pmod p$, a fortiori $S \left(j + \frac{p-1}{4}\right) \equiv 0 \pmod \pi$. Ainsi
$$J(\chi_\pi,\chi_\pi) \equiv 0 \pmod \pi.$$
La proposition 19 du chapitre "Sommes de Gauss et sommes de Jacobi" montre que $\n(J(\chi_\pi,\chi_\pi)) = p$, donc $J(\chi_\pi,\chi_\pi)$, comme $\pi$, est un \'el\'ement premier de $D$, et puisque que $\pi \mid J(\chi_\pi,\chi_\pi)$, ils sont associ\'es, ce qui prouve la proposition.
\end{proof}

\begin{prop}\label{prop119}
Si $\pi$ est un premier primaire tel que $\n(\pi) = p \equiv 1 \pmod 4$, alors
$$g(\chi_\pi)^4 = \pi^3 \overline{\pi}.$$
\end{prop}

\begin{proof}
Puisque $\chi_\pi(-1) = \pm 1$, les propositions \ref{prop116} et \ref{prop118} montrent que
\begin{align*}
g(\chi_\pi)^4 &= p J(\chi_\pi,\chi_\pi)^2\\
&= p \pi^2\\
&=\pi^3 \overline{\pi}.
\end{align*}
\end{proof}
Nous allons maintenant examiner deux cas particuliers de la loi de r\'eciprocit\'e biquadratique.


\begin{prop}\label{prop120}
Soit $\pi$ un premier primaire tel que $\n(\pi) = p \equiv 1 \pmod 4$, et soit $q \equiv 3 \pmod 4,\ q>0,$ un premier rationnel, premier dans $D$. Alors
$$\chi_\pi(-q) = \chi_q(\pi).$$
\end{prop}
Notons que $-q$ est un premier primaire, avec $q = 4k-1,\ k\in \Z$.

De plus $\frac{\n(-q)-1}{4} = \frac{q^2 - 1}{4} = \frac{(4k-1)^2 -1}{4} = 4k^2 -2k$ est pair. Comme $\chi_q(\pi) = \chi_{-q}(\pi)$, cette proposition s'\'ecrit
$$\chi_\pi(-q) = \chi_{-q}(\pi)(-1)^{\frac{\n(-q)-1}{4} \frac{\n(\pi)-1}{4}}.$$
C'est bien un cas particulier de la loi de r\'eciprocit\'e biquadratique.

\begin{proof}
Comme $q\equiv 3 \pmod 4$,
\begin{align*}
g(\chi_\pi)^q &\equiv \sum_{j\in \F_p} \chi_\pi(j)^q \zeta^{qj}\\
&\equiv \sum_{j\in \F_p} \chi_\pi^3(j) \zeta^{qj} \\
&=\sum_{k\in \F_p} \chi_\pi^3(q^{-1} k) \zeta^{k}\qquad (k = qj)\\
&= \chi_\pi^{-1}(q^{-1}) \sum_{k\in \F_p} \overline{\chi_\pi} ( k) \zeta^{k}\\
&\equiv \chi_\pi(q) g(\overline{\chi_\pi}) \pmod q
\end{align*}
Ainsi 
$$ g(\chi_\pi)^{q+1} \equiv \chi_\pi(q)g(\chi_\pi)g(\overline{\chi_\pi}) \pmod q.$$
La proposition \ref{conjugue} du chapitre ``Sommes de Gauss et sommes de Jacobi'' montre que $g(\overline{\chi_\pi}) = \chi_\pi(-1) \overline{g(\chi_\pi)}$, et $|g(\chi_\pi)|^2 = p$, donc
$$g(\chi_\pi)^{q+1} \equiv \chi_\pi(-q) p \pmod q.$$
Notons que
$$\pi^q = (a+bi)^q \equiv a^q+ b^q i^q  \equiv a +bi^3 = a -bi = \overline{\pi} \pmod q,$$
et donc $p = \pi \overline{\pi} \equiv \pi^{q+1}  \pmod q$. Ainsi
$$g(\chi_\pi)^{q+1} \equiv \chi_\pi(-q) \pi^{q+1} \pmod q.$$
La proposition \ref{prop119} permet d'utiliser $g(\chi_\pi)^4 = \pi^3 \overline{\pi} \equiv \pi^{q+3}\pmod q$, donc
$$ \pi^{\frac{(q+3)(q+1)}{4}} \equiv  \chi_\pi(-q) \pi^{q+1} \pmod q,$$
ce qui donne apr\`es simplification, puisque $q$ est premier avec $\pi$,
$$\pi^{\frac{q^2-1}{4}} \equiv \chi_\pi(-q) \pmod q.$$
Mais, par d\'efinition de $\chi_q$,
$$\chi_q(\pi) \equiv \pi^{\frac{q^2-1}{4}} \pmod q,$$
donc
$$\chi_q(\pi) \equiv \chi_\pi(-q) \pmod q.$$
Comme les classes des quatre unit\'es $1,i,i^2,i^3$ sont distinctes dans $D/ qD$, ceci montre que
$$\chi_q(\pi) =\chi_\pi(-q).$$ 
\end{proof}

\begin{prop}\label{prop121}
Soit $\pi$  un premier primaire tel que $\n(\pi) = p \equiv 1 \pmod 4$, et
soit $q \ne p$ un premier rationnel, $q\equiv 1 \pmod 4, q>0$. Alors $\chi_\pi(q) = \chi_q(\pi)$.
\end{prop}
(Ici $q$ n'est pas premier dans $D$, et $\chi_q$ est un caract\`ere biquadratique g\'en\'eralis\'e.)
\begin{proof}
Puisque $q \equiv 1 \pmod 4$,
\begin{align*}
g(\chi_\pi)^q &\equiv \sum_{j \in \F_p} \chi_\pi(j)^q \zeta^{qj}\\
&\equiv \sum_{j \in \F_p} \chi_\pi(j) \zeta^{qj}\\
&\equiv \sum_{k \in \F_p} \chi_\pi(q^{-1}k) \zeta^{k}\qquad (k = qj)\\
&\equiv \overline{\chi_\pi}(q) g(\chi_\pi) \pmod q.
\end{align*}
Par cons\'equent,
$$g(\chi_\pi)^{q+3} \equiv \overline{\chi_{\pi}}(q) g^4(\chi_\pi) \pmod q.$$
En utilisant la valeur de $g(\chi_\pi)^4$ donn\'ee par la proposition \ref{prop116}, nous obtenons
$$(\pi^3 \overline{\pi})^{\frac{q+3}{4}} \equiv  \overline{\chi_{\pi}}(q)\pi^3 \overline{\pi} \pmod q.$$
Puisque $q \wedge p = 1$, alors $q\wedge \pi =1$ et $q\wedge \overline{\pi} = 1$, et nous pouvons simplifier, pour obtenir
$$(\pi^3)^\frac{q-1}{4} (\overline{\pi})^{\frac{q-1}{4}} \equiv \overline{\chi_\pi}(q) \pmod q.$$
D\'ecomposons $q$ sous la forme $q = \lambda \overline{\lambda}$, o\`u $\lambda$ est premier dans $D$. Comme $\n(\lambda) = q$, l'\'egalit\'e pr\'ec\'edente implique
$$\chi_\lambda(\pi^3) \chi_\lambda(\overline{\pi}) \equiv  \overline{\chi_\pi}(q) \pmod \lambda.$$
Ces deux unit\'es \'etant congrues modulo $\lambda$ dans $D$, elles sont \'egales (proposition \ref{prop100}). Ainsi
$$\chi_\lambda(\pi^3) \chi_\lambda(\overline{\pi}) =  \overline{\chi_\pi}(q).$$
Comme $\chi_\lambda^3 = \chi_\lambda^{-1} = \overline{\chi_\lambda}$,
$$\overline{\chi_\lambda(\pi)} \chi_\lambda(\overline{\pi}) =  \overline{\chi_\pi}(q).$$
La proposition \ref{prop103} donne alors
$$\chi_{\overline{\lambda}}(\overline{\pi}) \chi_{\lambda}(\overline{\pi})=  \overline{\chi_\pi}(q).$$
Par d\'efinition du caract\`ere g\'en\'eralis\'e $\chi_q$, 
$$\chi_q(\overline{\pi})  = \overline{\chi_\pi}(q).$$
En prenant les conjugu\'es, et en utilisant \`a nouveau la proposition \ref{prop103},

$$\chi_q(\pi) = \chi_\pi(q).$$
\end{proof}

\begin{prop}\label{prop122}
Soit $a \in \Z$ tel que $a\equiv 1 \pmod 4, a \ne 1$ , et $\lambda$ un \'el\'ement primaire de $D$ tel que $\lambda \wedge a = 1$. Alors
$$\chi_a(\lambda) = \chi_\lambda(a).$$
\end{prop}
\begin{proof}
La proposition \ref{prop109} permet de d\'ecomposer le primaire $\lambda$ en produit de premiers primaires $\lambda = \lambda_1\cdots \lambda_t,$ et par d\'efinition,
$$\chi_\lambda(a) = \chi_{\lambda_1}(a) \cdots \chi_{\lambda_t}(a).$$
Comme $a \equiv 1 \pmod 4$, $a$ se d\'ecompose, quel que soit son signe, sous la forme
$$a = \prod_{i=1}^r p_i \prod_{j=1}^s(-q_j),$$
o\`u les $p_i, q_j$ v\'erifient $p_i \equiv 1 \pmod 4,\ q_j \equiv 3 \pmod 4,\ p_i>0,\ q_j>0$.

Alors
$$\chi_\lambda(a) = \prod_{k=1}^t \left(\prod_{i=1}^r \chi_{\lambda_k} (p_i) \prod_{j=1}^s\chi_{\lambda_k}(-q_j)\right).$$
La remarque suivant cette proposition \ref{prop109} montre que chaque premier primaire $\lambda_k$ est de la forme $\lambda_k= -q$, o\`u $q \equiv 3 \pmod 4$ est un premier rationnel positif, ou bien \'egal \`a un premier $\pi$ tel que $\n(\pi) = \pi \overline{\pi} = p \equiv 1 \pmod 4$.
\be
\item[$\bullet$] Si $\lambda_k = -q, q \equiv 3 \pmod 4$, alors la proposition \ref{prop104} montre que
\begin{align*} \chi_{\lambda_k}(-q_j) &= \chi_{-q}(-q_j) =\chi_q(-q_j) = 1, \text {et}\\
                      \chi_{-q_j}(\lambda_k) &= \chi_{-q_j}(-q) = \chi_{q_j}(-q) = 1,
\end{align*}
puisque $\lambda \wedge a = 1$, et donc $q \wedge q_j = \lambda_k \wedge q_j = 1$. Par cons\'equent,
$$\chi_{\lambda_k}(-q_j )= \chi_{-q_j}(\lambda_k).$$
De plus, si on \'ecrit $p_i = \pi_i \overline{\pi_i}$, alors
$$\chi_{\lambda_k}(p_i) = \chi_q(p_i) = \chi_{q}(\pi_i) \chi_{q}(\overline{\pi_i}).$$
Puisque $\pi_i \equiv 1 \pmod 4$, et $p_i \ne q$ est un premier rationnel, la proposition \ref{prop120} montre que
\begin{align*}
\chi_q(\pi_i) &= \chi_{\pi_i}(-q) = \chi_{\pi_i}(\lambda_k),\\
\chi_q(\overline{\pi_i}) &= \chi_{\overline{\pi_i}}(-q) = \chi_{\overline{\pi_i}}(\lambda_k),
\end{align*}
par cons\'equent
$$\chi_{\lambda_k}(p_i) = \chi_{\pi_i}(\lambda_k)\chi_{\overline{\pi_i}}(\lambda_k) = \chi_{p_i}(\lambda_k).$$
\item[$\bullet$] Si $\lambda_k = \pi$, o\`u $\n(\pi) = \pi \overline{\pi} = p \equiv 1 \pmod 4$, alors, puisque $q_j \equiv 3 \pmod 4$ est un premier rationnel, la proposition \ref{prop120} donne
$$\chi_{\lambda_k}(-q_j) = \chi_{\pi}(-q_j) = \chi_{-q_j}(\pi) = \chi_{-q_j}(\lambda_k).$$
De plus, puisque $p_i \equiv 1 \pmod 4$ est un premier rationnel, la proposition \ref{prop121} donne
$$\chi_{\lambda_k}(p_i) = \chi_\pi(p_i) = \chi_{p_i}(\pi) = \chi_{p_i}(\lambda_k).$$
Pour conclure,
\begin{align*}
\chi_\lambda(a) &= \prod_{k=1}^t \left(\prod_{i=1}^r \chi_{\lambda_k} (p_i) \prod_{j=1}^s\chi_{\lambda_k}(-q_j)\right)\\
&=\prod_{k=1}^t\left( \prod_{i=1}^r \chi_{p_i} (\lambda_k) \prod_{j=1}^s\chi_{-q_j}(\lambda_k)\right)\\
&=\prod_{k=1}^t  \chi_{a}(\lambda_k)\\
&=\chi_a(\lambda).
\end{align*}
\ee
\end{proof}

La restriction $a\ne 1$ conduit \`a consid\'erer de nombreux cas inutiles dans la d\'emonstration de la r\'eciprocit\'e biquadratique. Pour \'eviter cet \'ecueil, d\'efinissons $\chi_\pi$ dans la cas o\`u $\pi$ est une unit\'e par $\chi_\pi = \varepsilon$, le caract\`ere trivial. Ainsi
$$\chi_1 = \chi_{-1} = \chi_i = \chi_{-i}=\varepsilon,$$
et $\chi_{\pi}$ a un sens pour tout $\pi$ tel que $1+i \nmid \pi$. Ceci permet de lever l'exception de la proposition \ref{prop122}.

\begin{prop}\label{prop123}
Soit $a \in \Z$ tel que $a\equiv 1 \pmod 4$, et $\lambda$ un \'el\'ement primaire de $D$ tel que $\lambda \wedge a = 1$. Alors
$$\chi_a(\lambda) = \chi_\lambda(a).$$
\end{prop}

\begin{proof}
Il ne reste \`a v\'erifier que la cas $a=1$. Alors, puisque $\chi_1 = \varepsilon$,  $\chi_1(\lambda) = 1 = \chi_\lambda(1)$.
\end{proof}
D\'efinissons, pour un entier impair $n$, $$\varepsilon(n) = (-1)^{\frac{n-1}{2}}.$$
{\bf Lemme.}
{\it Soient $n,m$ deux entiers impairs. Alors
\be
\item[(a)] Si $n\equiv m \pmod 4$, alors $\varepsilon(n) = \varepsilon(m)$.
\item[(b)] $\varepsilon(nm) = \varepsilon(n) \varepsilon(m).$
\item[(c)] $\varepsilon(n) n \equiv 1 \pmod 4.$
\ee
}
\begin{proof}
 Ici $n,m$ sont des entiers impairs.
\be
\item[(a)] Si $n\equiv m \pmod 4$, alors $m = n+ 4k,\ k\in \Z$, donc $$\varepsilon(m) = (-1)^{\frac{n+4k-1}{2}} =  (-1)^{\frac{n-1}{2}} (-1)^{2k}= (-1)^{\frac{n-1}{2}} = \varepsilon(n).$$
\item[(b)]Si on note $n = 2k + 1, m = 2l+1$, alors
$$\frac{nm-1}{2} = 2kl + k + l \equiv k+l \equiv \frac{n-1}{2} + \frac{m-1}{2} \pmod 2,$$
donc $(-1)^{\frac{nm-1}{2}} = (-1)^{\frac{n-1}{2}} (-1)^{\frac{m-1}{2}}$. 
\item[(c)] Comme $\varepsilon(n) = 1$ si $n\equiv 1 \pmod 4$, et $\varepsilon(n) = -1$ si $n\equiv -1 \pmod 4$, nous avons pour tout $n$ impair
$$\varepsilon(n) n \equiv 1 \pmod 4.$$

\ee
\end{proof}


\begin{prop}\label{prop124}
Soient $\pi = a + bi$ et $\lambda = c+di$ des \'el\'ements de $D$ primaires et premiers entre eux.
Si $a\wedge b = 1$ et $c\wedge d = 1$, alors
$$ \chi_\lambda(\pi) = \chi_\pi(\lambda)(-1)^{\frac{a-1}{2} \frac{c-1}{2}}.$$
\end{prop}
Notons qu'on ne suppose pas que $\n(\pi) \ne \n(\lambda)$, ni que $\lambda, \pi$ sont premiers dans $D$.
\begin{proof}
Les hypoth\`eses impliquent que $a\wedge \pi = b \wedge \pi = c \wedge \lambda = d \wedge \lambda = 1$.
Comme $c\pi \wedge \lambda = 1$, la congruence
\begin{align*}
c\pi &=ac + bci\\
&= ac + bd +bi(c +id)\\
&\equiv ac + bd \pmod \lambda,
\end{align*}
montre que $(ac + bd) \wedge \lambda = 1$, et sym\'etriquement $(ac + bd) \wedge \pi = 1$.

Notons que $a\wedge \pi = 1$ entra\^ine l'existence de $u,v \in D$ tels que $ua + v\pi = 1$, donc $\overline{u}\, a + \overline{v}\, \overline{\pi} = 1$, ce qui prouve $a \wedge \overline{\pi} = 1$. Le m\^eme raisonnement donne  $a \wedge \overline{\pi} = b \wedge  \overline{\pi} = c \wedge \overline{\lambda} = d \wedge \overline{\lambda} = 1$, et $(ac + bd) \wedge \overline{\lambda} = (ac + bd) \wedge \overline{\pi} = 1$.

La congruence $c \pi \equiv ac + bd \pmod \lambda$, et la proposition \ref{prop110}(a), montrent que
\begin{align}\label{eq4.1}
\chi_\lambda(c) \chi_\lambda(\pi) =\chi_\lambda(ac + bd).
\end{align}

Sym\'etriquement, comme $a\lambda =ac+bd +id\pi \equiv ac  + bd \pmod \pi$,
\begin{align}\label{eq4.2}
\chi_\pi(a) \chi_\pi(\lambda) = \chi_\pi(ac + bd).
\end{align}
Puisque $a$ et $ac + bd$ sont r\'eels, le passage au conjugu\'e dans l'\'egalit\'e (\ref{eq4.2}) donne, gr\^ace \`a la proposition \ref{prop103},
\begin{align}\label{eq4.3}
\chi_{\overline{\pi}}(a)\overline{\chi_\pi(\lambda)} = \chi_{\overline{\pi}}(ac +bd).
\end{align}
Le produit de (\ref{eq4.1}) et (\ref{eq4.3}) s'\'ecrit, gr\^ace \`a la proposition \ref{prop110}(c),
$$\chi_\lambda(c) \chi_{\overline{\pi}}(a)  \chi_\lambda(\pi) \overline{\chi_\pi(\lambda)} = \chi_{\lambda\overline{\pi}}(ac + bd).$$
En utilisant \`a nouveau la proposition \ref{prop103},
$$(\chi_\lambda(c) \chi_{\overline{\pi}}(a) )^{-1} = \overline{\chi_\lambda(c) \chi_{\overline{\pi}}(a)} = \chi_\pi(a)  \chi_{\overline{\lambda}}(c).$$
Nous avons donc prouv\'e
\begin{align}\label{eq4.4}
\chi_\lambda(\pi) \overline{\chi_\pi(\lambda)} =  \chi_\pi(a) \chi_{\overline{\lambda}}(c)  \chi_{\lambda\overline{\pi}}(ac + bd).
\end{align}

 Calculons  le membre de droite de l'\'egalit\'e (\ref{eq4.4}).

Pour chaque facteur du membre de droite de l'\'egalit\'e (\ref{eq4.4}), utilisons l'\'egalit\'e suivante, vraie pour tout entier impair $x$, puisque $\varepsilon(x)^2 = 1$,
$$\chi_\alpha(x) = \chi_\alpha(\varepsilon(x)) \chi_\alpha(\varepsilon(x) x) \qquad (x \in \{a,c,ac+bd\}).$$

En appliquant cette m\'ethode, puisque $\varepsilon(a)a \equiv 1 \pmod 4$, et  $\pi \wedge a = 1$,  la proposition \ref{prop123} montre que (m\^eme si $a$ est une unit\'e)
\begin{align*}
\chi_{\pi}(a) &= \chi_{\pi}(\varepsilon(a)) \chi_{\pi}(\varepsilon(a)a)\\
&=  \chi_{\pi}(\varepsilon(a)) \chi_{\varepsilon(a) a}(\pi)\\
&= \chi_{\pi}(\varepsilon(a)) \chi_{a}(\pi),
\end{align*}
la derni\`ere \'egalit\'e vient du fait que $a$ et $\varepsilon(a) a$ \'etant associ\'es, ils d\'efinissent le m\^eme caract\`ere.

Dans le cas o\`u $\varepsilon(a) = -1$, la proposition \ref{prop112} donne 
$$\chi_{\pi}(\varepsilon(a)) = \chi_\pi(-1) = (-1)^{\frac{a-1}{2}} = \varepsilon(a)^{\frac{a-1}{2}},$$
et l'\'egalit\'e  $\chi_{\pi}(\varepsilon(a)) = \varepsilon(a)^{\frac{a-1}{2}}$ est trivialement vraie si $\varepsilon(a) = 1$. Par cons\'equent,
$$\chi_{\pi}(a) =  \varepsilon(a)^{\frac{a-1}{2}}  \chi_{a}(\pi).$$

En proc\'edant de m\^eme pour les trois facteurs du membre de droite de l'\'egalit\'e (\ref{eq4.4}), puisque $\overline{\lambda} \wedge c = 1$, et $\lambda\overline{\pi} \wedge (ac + bd) = 1$, nous obtenons les trois \'egalit\'es
\begin{align}
\chi_\pi(a) &= \varepsilon(a)^{\frac{a-1}{2}}  \chi_a(\pi),\\
\chi_{\overline{\lambda}}(c) &= \varepsilon(c)^{\frac{c-1}{2}} \chi_{c}(\overline{\lambda})\\
\chi_{\lambda\overline{\pi}}(ac + bd) &= \varepsilon(ac+bd)^{\frac{ac +bd-1}{2}} \chi_{ac+bd}(\lambda\overline{\pi}).
\end{align}
Le produit de ces trois \'egalit\'es donne
$$\chi_\lambda(\pi) \overline{\chi_\pi(\lambda)} = P\  \chi_a(\pi) \chi_{c}(\overline{\lambda}) \chi_{ac+bd}(\lambda\overline{\pi}),$$
o\`u
$$P =  \varepsilon(a)^{\frac{a-1}{2}} \varepsilon(c)^{\frac{c-1}{2}}\varepsilon(ac+bd)^{\frac{ac +bd-1}{2}}.$$
Puisque $ac + bd \equiv ac \pmod 4$, le lemme donne
\begin{align*}
P &=  \varepsilon(a)^{\frac{a-1}{2}} \varepsilon(c)^{\frac{c-1}{2}} \varepsilon(ac)^{\frac{ac - 1}{2}}\\ 
&=\varepsilon(a)^{\frac{a-1}{2}} \varepsilon(c)^{\frac{c-1}{2}} \varepsilon(ac)^{\frac{a- 1}{2}}  \varepsilon(ac)^{\frac{c- 1}{2}}\\ 
&=\varepsilon(a)^{\frac{a-1}{2}} \varepsilon(c)^{\frac{c-1}{2}}\varepsilon(a)^{\frac{a- 1}{2}}\varepsilon(c)^{\frac{a- 1}{2}}\varepsilon(a)^{\frac{c- 1}{2}}\varepsilon(c)^{\frac{c- 1}{2}}\\
&=\varepsilon(c)^{\frac{a- 1}{2}}\varepsilon(a)^{\frac{c- 1}{2}}\\
&=(-1)^{\frac{c-1}{2} \frac{a-1}{2}}(-1)^{\frac{a-1}{2} \frac{c-1}{2}}\\
&= 1.
\end{align*}


 Ainsi
$$\chi_\lambda(\pi) \overline{\chi_\pi(\lambda)} =  \chi_a(\pi) \chi_{c}(\overline{\lambda})\chi_{ac+bd}(\lambda\overline{\pi}).$$
Justifions les \'egalit\'es suivantes, donnant les trois facteurs du membre de droite. 
\begin{subequations}
\begin{align}
\chi_a(\pi) &= \chi_a(a+bi) = \chi_a(bi) = \chi_a(i),\label{eq4.8}\\ 
\chi_c(\overline{\lambda}) &= \chi_c(c-di) = \chi_c(-di) = \chi_c(i),\label{eq4.9}\\ 
\chi_{ac+bd}(\lambda\overline{\pi}) &= \chi_{ac+bd}(ac + bd + (ad-bc)i) = \chi_{ac+bd}((ad - bc)i) = \chi_{ac+bd}(i). \label{eq4.10}
\end{align}
\end{subequations}

 En effet, si $a, c$ et $ac + bd$ ne sont pas des unit\'es, ce sont des entiers impairs, v\'erifiant $a\wedge b = 1, c \wedge d = 1$ : la proposition \ref{prop113} montre qu'alors $\chi_c(-d) = \chi_a(b)  = 1$. Ceci reste vrai si $a$ est une unit\'e, puisqu'alors $\chi_a = \varepsilon$, ou si $c$ est une unit\'e.
 
 Il reste \`a v\'erifier que $(ad-bc) \wedge (ac + bd) = 1$. Si un premier $\mu$ de $D$ v\'erifie $\mu \mid ad-bc$ et $\mu \mid ac +bd$, alors $\mu \mid \lambda \overline{\pi} = ac + bd + (ad-bc)i$, donc $\mu$ divise $\lambda$ ou $\overline{\pi}$. Ceci est impossible, car nous avons prouv\'e au d\'ebut de cette d\'emonstration que $(ac + bd)\wedge \lambda = (ac + bd) \wedge \overline{\pi} = 1$. Ainsi $ad-bc$ et $ac + bd$ sont premiers entre eux dans $D$, donc aussi dans $\Z$. Par cons\'equent, la proposition \ref{prop113} montre que $ \chi_{ac+bd}(ad-bc) = 1$ (m\^eme si $ac + bd$ est une unit\'e), et les \'egalit\'es (\ref{eq4.8}),(\ref{eq4.9}),(\ref{eq4.10}) sont justifi\'ees. 
 
 En multipliant ces trois \'egalit\'es (\ref{eq4.8}),(\ref{eq4.9}),(\ref{eq4.10}), nous obtenons
\begin{align}
\chi_\lambda(\pi) \overline{\chi_\pi(\lambda)} &= \chi_{(ac+bd)ac}(i)
\end{align}
Comme $a,c$ sont impairs, et $b,d$ pairs, $(ac+bd)ac \equiv (ac)^2 \equiv 1 \pmod 4$. La proposition \ref{prop114} donne alors (m\^eme si $(ac+bd)ac = 1$)
\begin{align*}
\chi_\lambda(\pi) \overline{\chi_\pi(\lambda)} &= (-1)^{\frac{(ac+bd)ac-1}{4}}.
\end{align*}
Comme vu au d\'ebut du paragraphe 5, $\pi$ et $\lambda$ \'etant primaires, la proposition \ref{prop105} montre qu'il existe des entiers $m,n,s,t$ tels que
$$a = 2m+1, b = 2n, \qquad c = 2s+1, d=2t,
$$
tels que $m = \frac{a-1}{2}, n = \frac{b}{2}$ ont m\^eme parit\'e, et $s =\frac{s-1}{2}, t = \frac{d}{2}$ ont m\^eme parit\'e.

La r\'eduction modulo 8 de $(ac+bd)ac -1$ donne
\begin{align*}
(ac + bd)ac -1 &= [(2m+1)(2s+1) + 4nt](2m+1)(2s+1) - 1\\
&=(4ms+4nt +2m + 2s +1)(4ms + 2m + 2s +1) - 1\\
&\equiv 4ms + (4m^2 + 4ms + 2m) + (4ms + 4s^2 + 2s) + (4ms + 4nt + 2m+2s)\\
&\equiv 4m^2+4m + 4s^2 + 4m +4s + 4 nt \pmod 8,
\end{align*}
donc la r\'eduction modulo 2 de l'exposant donne
\begin{align*}
\frac{(ac+bd)ac - 1}{4} &\equiv m(m+1) + s(s+1) + nt \\
&\equiv nt\\
&\equiv ms \pmod 2,\\
\end{align*}
puisque $m,n$ d'une part, $t,s$ d'autre part, ont m\^eme parit\'e. Ainsi
$$(-1)^{\frac{(ac+bd)ac - 1}{4}} = (-1)^{\frac{a-1}{2} \frac{c-1}{2}},$$
et nous avons prouv\'e dans ce cas que
$$\chi_\lambda(\pi) \overline{\chi_\pi(\lambda)} = (-1)^{\frac{a-1}{2} \frac{c-1}{2}}.$$
ce qui est \'equivalent \`a la formule de l'\'enonc\'e, puisque $ \overline{\chi_\pi(\lambda)}  = \chi_\pi(\lambda)^{-1}$.

\end{proof}

Nous pouvons maintenant prouver la loi de r\'eciprocit\'e biquadratique.

\begin{prop}\label{prop125}{\bf Loi de R\'eciprocit\'e Biquadratique.}

Si $\lambda, \pi$ sont des \'el\'ements primaires de $\Z[i]$, alors
$$\chi_\pi(\lambda) = \chi_\lambda(\pi)(-1)^{\frac{\n(\lambda)-1}{4} \frac{\n(\pi)-1}{4}}.$$
\end{prop}
\begin{proof}

Si $\lambda$ et $\pi$ ne sont pas premiers entre eux, alors $\chi_\pi(\lambda) = \chi_\lambda(\pi) = 0$. Nous pouvons donc supposer $\lambda \wedge \pi = 1$.

En factorisant par le pgcd des parties r\'eelles et imaginaires de $\pi,\lambda$, on peut \'ecrire
$$\pi = m(a+bi), \lambda = n (c+di), \text{ o\`u } a\wedge b = 1, c \wedge d = 1.$$
Puisque les \'el\'ement primaires $\pi, \lambda$ ne sont pas divisibles par 2, $m,n$ sont impairs. Quitte \`a remplacer $m$ par $-m$( et $a+bi$ par $-a-bi$), on peut supposer $m\equiv 1 \pmod 4$, et aussi $n \equiv 1 \pmod 4$.

Nous savons que $n \equiv 1 \pmod 4$, et aussi que $a+bi \wedge n = 1$, puisque $\pi \wedge \lambda = 1$. La proposition \ref{prop122} montre alors que 
$\chi_{a+bi}(n) = \chi_n(a+bi)$, et sym\'etriquement, $\chi_{c+di}(m) = \chi_m(c+di)$. De plus, la proposition \ref{prop113} montre que $\chi_m(n) = \chi_n(m) = 1$, et ceci reste vrai si $m=1$, ou si $n=1$, puisque $\chi_1 = \varepsilon$.

Comme $\pi \equiv 1\pmod{(1+i)^3}$, et $m \equiv 1 \pmod {(1+i)^3}$ (puisque $(1+i)^3 = -2(1+i)$ divise 4), l'\'egalit\'e $\pi = m(a+bi)$ montre que $a+bi \equiv 1 \pmod{ (1+i)^3}$, donc $a+bi$ est primaire, et de m\^eme $c+di$ est primaire. Alors, en utilisant les propositions \ref{prop123} et \ref{prop124},
\begin{align*}
\chi_\lambda(\pi) &= \chi_\lambda(m) \chi_\lambda(a+bi)\\
&=\chi_m(\lambda) \chi_n(a+bi) \chi_{c+di}(a+bi)\\
&=\chi_m(\lambda) \chi_{a+bi}(n) \chi_{a+bi}(c+di)(-1)^{\frac{a-1}{2}\frac{c-1}{2}}\\
&= \chi_m(\lambda) \chi_{a+bi}(\lambda)(-1)^{\frac{a-1}{2}\frac{c-1}{2}}\\
&= \chi_\pi(\lambda)(-1)^{\frac{a-1}{2}\frac{c-1}{2}}.\\
\end{align*}
Notons le primaire $a+bi$ sous la forme $a + bi= 2k+1 + 2l i$, o\`u $k =\frac{a-1}{2} \equiv l = \frac{b}{2} \pmod 2$.

Puisque $m\equiv 1 \pmod 4$, $m^2 \equiv 1 \pmod 8$.
\begin{align*}
\n(\pi) - 1  &= m^2[(2k+1)^2 + 4 l^2 )-1\\
&=m^2(4k^2+4k+4l^2+1) - 1\\\
&\equiv 4(k^2+k+l^2) \pmod 8,
\end{align*}
et puisque $k \equiv l \equiv \frac{a-1}{2} \pmod 2$,
\begin{align*}
\frac{\n(\pi) - 1}{4} &\equiv k^2 + k  + l^2 \\
&\equiv \frac{a-1}{2} \pmod 2,
\end{align*}
si bien que
$$\chi_\pi(\lambda) = \chi_\lambda(\pi)(-1)^{\frac{\n(\lambda)-1}{4} \frac{\n(\pi)-1}{4}}.$$

\end{proof}




\section{R\'esidus biquadratiques entiers.}
Si $p\equiv 3 \pmod 4$,  la proposition \ref{nbsols} du chapitre ``Sommes de Gauss et sommes de Jacobi" montre que pour tout $\alpha \in \F_p^*$ qui est un carr\'e de $\F_p$, l'\'equation $x^4 =\alpha$ admet deux solutions dans $\F_p$, puisque $d = (p-1)\wedge 4 = 2$.

Par exemple, pour $p= 19$, l'\'equation  $x^4 = 5$ \'equivaut \`a $x^2 = 9$ ou $x^2 = -9$. La premi\`ere \'equation a deux solutions $3$ et $-3$, mais la deuxi\`eme n'en a pas, puisque $\legendre{-9}{19} = \legendre{-1}{19} \legendre{9}{19} =  \legendre{-1}{19} = -1$.

Supposons maintenant que $p\equiv 1 \pmod 4$. Alors $d = 4 \wedge (p-1) = 4$, et cette m\^eme proposition prouve que $x^4 = \alpha$ admet une solution dans $\F_p$ si et seulement si $\alpha^{\frac{p-1}{4}} = 1$, et dans ce cas, elle en admet quatre.

Comme $p \equiv 1 \pmod 4$, $p = \pi \overline{\pi}$, o\`u $\pi$ est premier dans $D$.

Soit $a \in \Z$. Supposons que la congruence $x^4 \equiv a \pmod p$ admet une solution dans $\Z$. Alors $x^4 \equiv a \pmod \pi$, et la proposition \ref{prop102} montre que $\chi_\pi(\alpha) = 1$.

R\'eciproquement, si $\chi_\pi(\alpha) = 1$, alors cette m\^eme proposition montre l'existence de $\alpha \in D$ tel que $\alpha^4 \equiv a \pmod \pi$. De plus, $D/\pi D \simeq \F_p$, et il existe un repr\'esentant $x \in\{0,1,\cdots,p-1\}$ de $\alpha$ modulo $\pi$. Ainsi $x^4 \equiv a \pmod \pi$, o\`u $x \in \Z$.

Comme $\pi \mid x^4 -a$, alors $p = \n(\pi) \mid (x^4 -a)^2$, et $p$ est un premier rationnel, donc $p \mid x^4 - a$, soit $x^4 \equiv a \pmod p$.

 Nous avons ainsi prouv\'e cette proposition :

\begin{prop}\label{prop126}
Soit $a \in \Z$, et $p \equiv 1 \pmod 4$ est un premier rationnel. Alors $p = \n(\pi)$, o\`u $\pi$ est premier dans $D$, et
$$\exists x \in \Z, \ x^4 \equiv a \pmod p \iff \chi_\pi(a) = 1 \iff \exists \alpha \in D,\ \alpha^4 \equiv a \pmod \pi.$$
\end{prop}




\section{Loi suppl\'ementaire \`a la loi de r\'eciprocit\'e biquadratique.}
Chaque \'el\'ement premier de $\Z[i]$ qui n'est pas divisible par $1+i$ est associ\'e \`a un premier primaire $\lambda$, et la loi de r\'eciprocit\'e biquadratique permet d'\'evaluer $\chi_\pi(\lambda)$. Il reste \`a conna\^itre le caract\`ere biquadratique des unit\'es, et de $1+i$. 

Pour les unit\'es, la d\'efinition donne

$\chi_\pi(i) = i^{\frac{p-1}{4}}$ si $\n(\pi) = p$ est un premier rationnel congru \`a 1 modulo 4.

$\chi_{-q}(i)  = \chi_{q}(i) = i^{\frac{q^2-1}{4}}$ si $q>0$ est un premier rationnel congru \`a 3 modulo 4.

Nous pouvons donner une formule commune simple, qui fera partie de la loi suppl\'ementaire.
\begin{prop}\label{prop127}
Si $\pi = a + bi$ est un premier primaire, alors
$$\chi_\pi(i) = i^{\frac{-a+1}{2}}.$$
\end{prop}
\begin{proof}
Soit $\pi = a +bi$ un premier primaire de $\Z[i]$.
\be
\item[$\bullet$] Si $\pi = -q$, o\`u $q \equiv 3 \pmod 4, q>0,$ est un premier rationnel, alors $a= -q, b=0$.

Notons $-q = a = 4k+1,\ k \in \Z$. Alors
\begin{align*}
\frac{q^2-1}{4} &= 4k^2 + 2k\\
&\equiv 2k  =\frac{a-1}{2}\pmod 4.
\end{align*}
Donc $$\chi_{-q}(i)  = \chi_{q}(i) = i^{\frac{q^2-1}{4}} = i^\frac{a-1}{2} = \left(\frac{1}{i}\right)^\frac{-a+1}{2}= (-i)^\frac{-a+1}{2} =  (-1)^\frac{-a+1}{2} i ^\frac{-a+1}{2} = i ^\frac{-a+1}{2},$$
puisque $(-1)^\frac{-a+1}{2} = (-1)^{-2k} = 1$.

\item[$\bullet$] Supposons maintenant que $\n(\pi) = p$, o\`u $p\equiv 1 \pmod 4$ est un premier rationnel. $\pi = a + bi$ \'etant primaire, alors $a$ est impair, et $b$ pair, et
$$\pi = 2m+1 +2n i, \qquad \text{o\`u } m = \frac{a-1}{2} \equiv n = \frac{b}{2} \pmod 2.$$
Comme $m \equiv n \pmod 2$, $m^2 \equiv n^2 \pmod 4$.
Alors $p = \pi \overline{\pi} = (2m+1)^2 + (2n)^2$, donc 
$$\frac{p-1}{4} = m^2+n^2+m \equiv 2m^2 +m =4 \frac{m(m+1)}{2} - m \equiv -m \pmod 4.$$
Par cons\'equent
$$\chi_\pi(i) = i^{\frac{\n(\pi) - 1}{4}} = i ^\frac{p-1}{4} = i^{-m} = i^{\frac{-a+1}{2}}.$$

L'\'egalit\'e $\chi_\pi(i) =  i^{\frac{-a+1}{2}}.$ a donc \'et\'e v\'erifi\'ee pour tous les premiers primaires $\pi$.
\ee
\end{proof}


Nous aurons besoin de la valeur de $\chi_a(i)$ pour un entier impair $a$. En g\'en\'eralisant la proposition \ref{prop114}, nous obtenons
\begin{prop}\label{prop128}
Si $a$ est un entier impair, alors
$$\chi_a(i) = (-1)^{\frac{a^2-1}{8}}.$$
\end{prop}
\begin{proof}
Si $a\equiv 1 \pmod 4$, la proposition \ref{prop114} donne $\chi_a(i) = (-1)^\frac{a-1}{4}$. Notons $a = 4A + 1,\ A\in \Z$. Alors
 $$(-1)^{\frac{a^2-1}{8}} = (-1)^{2A^2+A} = (-1)^A = (-1)^{\frac{a-1}{4}}= \chi_a(i).$$
 
Si $a \equiv -1 \pmod 4$, alors $\chi_a(i) = \chi_{-a}(i) = (-1)^{\frac{-a-1}{4}}$ par la m\^eme proposition. Notons $a = 4A-1,\ A \in \Z$. Alors
 $$(-1)^{\frac{a^2-1}{8}} = (-1)^{2A^2 - A} =(-1)^{-A} = (-1)^{\frac{-a-1}{4}}= \chi_a(i).$$
Dans les deux cas, $$\chi_a(i) = i^{\frac{a^2-1}{8}}.$$

Si $a =\pm 1$ est une unit\'e, alors $ (-1)^{\frac{a^2-1}{8}} = (-1)^0 = 1 =\chi_a(i)$.
\end{proof}


Il reste le calcul de $\chi_\pi(1+i)$. Commençons par le calcul de $\chi_q(1+i)$. 
\begin{prop}\label{prop129}
Si $q \equiv 3 \pmod 4,\ q>0,$ est un premier rationnel, alors
$$\chi_q(1+i) = i^{\frac{-q-1}{4}}.$$
\end{prop}
\begin{proof}
Notons $q = 4k + 3, k \in \N$.

Comme $(1+i)^2 = 2i$, alors $(1+i)^{q-1} =  (2i)^{\frac{q-1}{2}}$. De plus,
$$2^{\frac{q-1}{2}} \equiv \legendre{2}{q} =  (-1)^{\frac{q^2-1}{8}} = (-1)^\frac{(4k+3)^2 - 1}{8} =  (-1)^{2k^2+3k+1} = (-1)^{k+1} \pmod q,$$
et $i^{\frac{q-1}{2} }= i^{2k+1} = (-1)^k i$, si bien que
$$ (1+i)^{q-1} \equiv -i \pmod q.$$
Comme $\n(q) = q^2$, 
 $$\chi_q(1+i) \equiv (1+i)^{\frac{q^2-1}{4} }= [(1+i)^{q-1}]^{\frac{q+1}{4}} \equiv (-i)^{\frac{q+1}{4}} \pmod q,$$
et ainsi
$$\chi_q(1+i) =(-i)^{\frac{q+1}{4}} = i^{\frac{-q-1}{4}}.$$
\end{proof}


\begin{prop}\label{prop130}
Soit $p$ un premier rationnel , $p \equiv 1 \pmod 4$ . Alors
$$\chi_p(1+i) = i^{\frac{p-1}{4}}.$$
\end{prop}
\begin{proof}
Soit $p = \pi \overline{\pi}, \pi \in \Z[i]$ une d\'ecomposition de $p$. Alors
\begin{align*}
\chi_p(1+i) &= \chi_\pi(1+i) \chi_{\bar{\pi}}(1+i) \\
&= \chi_\pi(1+i) \overline{\chi_\pi(1-i)} \qquad ( \text{proposition } \ref{prop111})\\
& =\frac{\chi_\pi(1+i)}{\chi_\pi(1-i) }= \chi_\pi(i) \qquad (\mathrm{puisque}\  (1-i)i = 1+i)\\
&=i^{\frac{p-1}{4}}.
\end{align*}
\end{proof}

G\'en\'eralisons les propositions \ref{prop129} et \ref{prop130} \`a un entier quelconque.
\begin{prop}\label{prop131}
Soit $n \in \Z$ un entier, $n \equiv 1 \pmod 4$. Alors
$$\chi_n(1+i) = i^{\frac{n-1}{4}}.$$
\end{prop}
\begin{proof}
Soit  $n \in \mathbb{Z}, n\equiv 1 \pmod 4$.

Si $n=1$, alors $\chi_1(1+i) = 1 = i^{\frac{n-1}{4}}$. Supposons maintenant que $n \ne 1$.

Si $n>0$, $n = q_1q_2\cdots q_kp_1p_2\cdots p_l$, 
o\`u les $p_i,q_i$ sont des premiers rationnels positifs v\'erifiant $q_i \equiv -1 \pmod 4, p_i \equiv 1 \pmod 4$, avec $k$ pair, puisque $n\equiv 1 \pmod 4$.

Si $n<0$, $n = -q_1q_2\cdots q_kp_1p_2\cdots p_l$, avec $k$ impair.

Dans les deux cas, 
$$n = (-q_1)(-q_2)\cdots(-q_k)p_1p_2\cdots p_l,$$
si bien que nous pouvons \'ecrire
$$n = s_1s_2\cdots s_m, \qquad \mathrm{where}\ s_i = -q_i, 1\leq i \leq k, s_i = p_{i-k}, \ k+1 \leq i \leq k+l = m,$$
o\`u $s_i \equiv 1 \pmod 4$ pour $1\leq i \leq N$. Alors
\begin{align*}
\chi_n(1+i)&=  \chi_{-q_1}(1+i)\cdots\chi_{-q_k}(1+i)\chi_{p_1}(1+i)\cdots\chi_{p_l}(1+i)\\
&=i^{\frac{-q_1-1}{4}}\cdots i^{\frac{-q_k-1}{4}}  i^{\frac{p_1-1}{4}} \cdots i^{\frac{p_l-1}{4}} \\
&=i^{\frac{s_1-1}{4}}\cdots  i^{\frac{s_m-1}{4}} \\
&=i^{\sum_{i=1}^m \frac{s_i-1}{4}}\\
&=i^{\frac{n-1}{4}},
\end{align*}
o\`u la derni\`ere \'egalit\'e r\'esulte du lemme pr\'ec\'edant la proposition \ref{prop114}.

Ainsi $\chi_n(1+i) = i^{\frac{n-1}{4}}.$

\end{proof}


\begin{prop}\label{prop132}
Soit $\pi = a + bi$ un premier primaire de $\Z[i]$, tel que $\n(\pi) = p \equiv 1 \pmod 4$, o\`u $p$ est un premier rationnel. Alors 
\be
\item[(a)] $a \equiv (-1)^{\frac{p-1}{4}} \pmod 4$,
\item[(b)] $b \equiv (-1)^{\frac{p-1}{4}} - 1 \pmod 4$.
\ee
\end{prop}

\begin{proof}
\item[(a)]
L'hypoth\`ese faite sur $\pi$ s'\'ecrit
$$p = \pi \bar{\pi}=a^2+b^2\equiv 1 \pmod 4.$$
Comme dans la preuve de la proposition \ref{prop127}, \'ecrivons $\pi$ sous la forme
$$\pi = 2m+1 +2n i, \qquad \text{o\`u } m = \frac{a-1}{2} \equiv n = \frac{b}{2} \pmod 2.$$
Comme $m \equiv n \pmod 2$, $m^2 \equiv n^2 \pmod 4$.
Alors $p = \pi \overline{\pi} = (2m+1)^2 + (2n)^2$, donc 
$$\frac{p-1}{4} = m^2+n^2+m \equiv 2m^2 +m =4 \frac{m(m+1)}{2} - m \equiv -m \pmod 4.$$
Ainsi $(-1)^{\frac{p-1}{4}} = (-1)^m$.

Si $m$ est pair, alors $a \equiv 1 = (-1)^m \pmod 4$, et si $m$ est impair, alors $a \equiv -1 = (-1)^m \pmod 4$.
Dans les deux cas, 
	$$ a \equiv (-1)^{\frac{p-1}{4}}  \pmod 4.$$
\item[(b)] Dans chacun de ces cas, $b \equiv a-1 \pmod 4$, donc
$$ b \equiv(-1)^{\frac{p-1}{4}} -1 \pmod 4.$$


\end{proof}

En d'autres termes, pour tous les premiers primaires $\pi = a + bi$ tels que $\n(\pi) = p$,
\begin{align*}
p \equiv 1\pmod 8 &\iff \pi  \equiv 1 \pmod 4,\\
p \equiv 5 \pmod 8 &\iff \pi  \equiv 3 + 2i \pmod 4.
\end{align*}




\begin{prop}\label{prop133}
Soit $\pi = a + bi$ un premier primaire de $\Z[i]$, tel que $\n(\pi) = p \equiv 1 \pmod 4$, o\`u $p$ est un premier rationnel. Alors
$$\chi_\pi(a(-1)^{\frac{p-1}{4}}) = (-1)^{\frac{a^2-1}{8}}.$$
\end{prop}
\begin{proof}
La proposition \ref{prop132}(a) montre que $a \equiv (-1)^{\frac{p-1}{4}}\pmod 4$, donc $a  (-1)^{\frac{p-1}{4}} \equiv 1\pmod 4$. Par cons\'equent $a  (-1)^{\frac{p-1}{4}}$ est soit une unit\'e, soit un \'el\'ement primaire.

Si $a $ est une unit\'e, $a = \pm 1$, alors $a  (-1)^{\frac{p-1}{4}} = 1$ et dans ce cas $\chi_\pi(a  (-1)^{\frac{p-1}{4}}) = 1 = (-1)^{\frac{a^2-1}{8}}$, et la conclusion est v\'erifi\'ee. Nous pouvons supposer maintenant que $a$ n'est pas une unit\'e.

Comme $a  (-1)^{\frac{p-1}{4}} \equiv 1 \pmod 4$, la loi de r\'eciprocit\'e biquadratique (proposition \ref{prop125}) donne
\begin{align*}
\chi_\pi(a(-1)^{\frac{p-1}{4}}) &= \chi_{a  (-1)^{\frac{p-1}{4}}}(\pi) \\
&= \chi_a(\pi) \qquad (a \text{ et } a  (-1)^{\frac{p-1}{4}} \text{ sont associ\'es })\\
&=\chi_a(a+bi)\\
&=\chi_a(bi)\\
&=\chi_a(b) \chi_a(i).
\end{align*}

Comme $a \wedge b=1$ (puisque $p = a^2+b^2$), $\chi_a(b) = 1$ (proposition \ref{prop113}), et la proposition \ref{prop128} donne $\chi_a(i) = (-1)^{\frac{a^2-1}{8}}$. Ainsi
  $$\chi_\pi(a (-1)^{\frac{p-1}{4}}) =  (-1)^{\frac{a^2-1}{8}}.$$
\end{proof}


\begin{prop}\label{prop134}
Soit $\pi = a + bi$ un premier primaire de $\Z[i]$, tel que $\n(\pi) = p \equiv 1 \pmod 4$, o\`u $p$ est un premier rationnel. Alors
\be
\item[(a)] Si $\pi \equiv 1 \pmod 4$, alors $\chi_\pi(a) = i^{\frac{a-1}{2}}$.
\item[(b)] Si $\pi \equiv 3 + 2i \pmod 4$, alors $\chi_\pi(a) = -i^{\frac{-a-1}{2}}$.
\ee
\end{prop}

\begin{proof}

Comme $p = \n(\pi) = a^2+b^2$, ici $a\wedge b = 1$.
La proposition \ref{prop133} donne
 $$\chi_\pi(a (-1)^{\frac{p-1}{4}}) =  (-1)^{\frac{a^2-1}{8}}.$$
Comme $\chi_\pi(-1) = (-1)^{(a-1)/2}$ (proposition \ref{prop112}), 
$$\chi_\pi(a) = (-1)^{\frac{a-1}{2} \frac{p-1}{4}}(-1)^{\frac{a^2-1}{8}},$$
o\`u $p = \n(\pi) = a^2+b^2$.
\be
\item[(a)] Supposons que  $\pi \equiv 1 \pmod 4$. Ici $a\equiv 1\pmod 4, b\equiv 0 \pmod 4$, soit $a = 4A+1,b=4B,\ A,B \in \mathbb{Z}$.
Alors
$$ (-1)^{\frac{p-1}{4}} = (-1)^{\frac{a^2-1}{4}+\frac{b^2}{4}} = (-1)^{4A^2+2A+4B^2}=1,$$
et ainsi $(-1)^{\frac{a-1}{2} \frac{p-1}{4}}=1$.
$$\chi_\pi(a) = (-1)^{\frac{a^2-1}{8}} = (-1)^{2A^2+A} = (-1)^A = (-1)^{\frac{a-1}{4}} = i^{\frac{a-1}{2}}.$$
Conclusion : si $\pi \equiv 1 \pmod 4$, $\chi_\pi(a) =  i^{\frac{a-1}{2}}$.
\item[(b)] Supposons maintenant que $\pi \equiv 3 + 2i \pmod 4$.

Alors $a\equiv 3 \pmod 4, b \equiv 2\pmod 4,a = 4A+3,b=4B+2,\ A,B\in\mathbb{Z}$. 

Comme dans la partie (a),
$$\chi_\pi(a) = (-1)^{\frac{a-1}{2} \frac{p-1}{4}}(-1)^{\frac{a^2-1}{8}},$$
o\`u $$p-1 = a^2+b^2-1 = 16 A^2+24A+16B^2+16B+12 \equiv 4 \pmod 8,$$ si bien que $\frac{p-1}{4} \equiv 1 \pmod 2$, et ainsi $(-1)^{\frac{p-1}{4}}= -1$.

$$ (-1)^{\frac{a-1}{2} \frac{p-1}{4}} = (-1)^{\frac{a-1}{2}} = (-1)^{2A+1} = -1,$$

$$\frac{a^2-1}{8} = 2A^2+3A+1,$$
$$ (-1)^\frac{a^2-1}{8} = (-1)^{3A+1} = (-1)^{A+1}=(-1)^\frac{a+1}{4}.$$
Par cons\'equent,
$$\chi_\pi(a)= -(-1)^\frac{a+1}{4} = -i^\frac{a+1}{2}.$$

De plus,  $$\frac{a+1}{2} \equiv \frac{-a-1}{2} \ [4] \iff a+1 \equiv -a-1\ [8] \iff 2a\equiv -2 \ [8] \iff a\equiv 3 \ [4],$$
par cons\'equent $i^{\frac{a+1}{2}}= i ^{\frac{-a-1}{2}}$.

Conclusion : si $\pi \equiv 3+2i \pmod 4$, $\chi_\pi(a) = - i ^{\frac{-a-1}{2}}$.
\ee
\end{proof}

\begin{prop}\label{prop135}
Soit $\pi = a + bi$ un premier primaire de $\Z[i]$, tel que $\n(\pi) = p \equiv 1 \pmod 4$, o\`u $p$ est un premier rationnel. Alors
$$\chi_\pi(a)\chi_\pi(1+i) = i^{\frac{3(a+b-1)}{4}}.$$
\end{prop}

\begin{proof}
Soit $\pi = a+bi$ un premier primaire. Comme $a(1+i) = a+b + i(a+bi)$, $a(1+i) \equiv a+b \mod \pi$, si bien que
$$\chi_{\pi}(a) \chi_{\pi}(1+i) = \chi_{\pi}(a+b).$$
Puisque $\pi =a +bi$ est primaire, $a+b \equiv 1 \pmod 4$.

Si $a+b = 1$, alors $\chi_{\pi}(a) \chi_{\pi}(1+i) = \chi_{\pi}(a+b)=1 = i^{3(a+b-1)/4}$. 

Sinon, la loi de r\'eciprocit\'e biquadratique (proposition \ref{prop125}) donne
$$\chi_\pi(a+b) = \chi_{a+b}(\pi).$$
De plus, $b \equiv -a\pmod{a+b}$, donc $\pi =  a + bi \equiv a(1-i) \equiv -i a (1+i) \pmod{a+b}$. 

Par cons\'equent,
$$\chi_{a+b}(\pi) = \chi_{a+b}(-1) \chi_{a+b}(i) \chi_{a+b}(a) \chi_{a+b}(1+i).$$
Comme $a+b \equiv 1 \pmod 4$ est primaire, la proposition \ref{prop112} donne $\chi_{a+b}(-1) = (-1)^{\frac{a+b-1}{2}} = 1$, et la proposition \ref{prop114} donne $\chi_{a+b}(i) = (-1)^{\frac{a+b-1}{4}}$.

De plus $a\wedge b = 1$, puisque $p = a^2+b^2$. Donc $(a+b) \wedge a = 1$, et par cons\'equent $\chi_{a+b}(a) = 1$ (proposition \ref{prop113}).

La proposition \ref{prop131} donne $\chi_{a+b}(1+i) = i^{\frac{a+b-1}{4}}$, si bien que
\begin{align*}
 \chi_{a+b}(\pi) &= \chi_{a+b}(-1) \chi_{a+b}(i) \chi_{a+b}(a) \chi_{a+b}(1+i)\\
 &=(-1)^{\frac{a+b-1}{4}} i ^{\frac{a+b-1}{4}}\\
 &=i^{\frac{a+b-1}{2}} i ^{\frac{a+b-1}{4}}\\
 &=i^{\frac{3(a+b-1)}{4}}.
 \end{align*}
 Dans tous les cas, 
$$\chi_\pi(a)\chi_\pi(1+i) = i^{\frac{3(a+b-1)}{4}}.$$
\end{proof}


Nous pouvons maintenant donner le caract\`ere biquadratique de $1+i$.


\begin{prop}\label{prop136}{\bf Suppl\'ement \`a la loi de r\'eciprocit\'e biquadratique.}

Si $\pi = a+bi$ est un premier primaire de $\Z[i]$, alors
\be
\item[(a)] $\chi_\pi(i) =  i^{\frac{-a+1}{2}}.$
\item[(b)] $\chi_\pi(1+i) = i^{\frac{a-b-b^2-1}{4}}.$
\ee
\end{prop}
\begin{proof}
Soit $\pi = a + ib$ un premier primaire de $\Z[i]$. La partie (a) est l'objet de la proposition \ref{prop127}. Passons \`a la partie (b).
\be
\item[$\bullet$] Si $b = 0$, alors $\pi = a \in \Z$.
Comme $\pi$ est primaire, $\pi = -q, q\equiv 3 \pmod 4$, o\`u $q$ est un premier rationnel positif, donc $a=-q, b = 0$.

La proposition \ref{prop129} donne alors,
 $$\chi_\pi(1+i) = \chi_{-q}(1+i) = i^\frac{-q-1}{4} = i^{\frac{a-b-b^2-1}{4}}.$$
 
Si $b \ne  0$, alors $\pi$ n'est pas associ\'e \`a un premier rationnel $q \equiv 3 \pmod 4$ (puisque le seul associ\'e primaire de $q$ est $-q$). La classification des premiers de $\Z[i]$ montre que $\pi$ v\'erifie $\n(\pi) = p$, o\`u $p\equiv 1 \pmod 4$ est un premier rationnel. La proposition \ref{prop135} donne alors
 
  $$\chi_\pi(a) \chi_\pi(1+i) = i^\frac{3(a+b-1)}{4}.$$


  \item[$\bullet$]  Si $\pi \equiv 1\pmod 4$, alors $a \equiv 1\pmod 4, b \equiv 0 \pmod 4$, donc $$a=4A+1,b=4B,\ A,B\in \mathbb{Z}.$$
	
En appliquant la proposition \ref{prop134}(a),
$$\chi_\pi(a) = i^{\frac{a-1}{2}}, \qquad \chi_\pi(a)^{-1} = (-i)^{\frac{a-1}{2}} = i^{\frac{a-1}{2}}.$$
Par cons\'equent,
\begin{align*}
\chi_{\pi}(1+i) &= i^{3 \frac{a+b-1}{4} - 2 \frac{a-1}{4}}\\
&=i^{\frac{a+3b-1}{4}}\\
&=i^{\frac{a-b-b^2-1}{4}},
\end{align*}
puisque $\left( \frac{a+3b-1}{4} \right)- \left( \frac{a-b-b^2-1}{4}\right) = b + \frac{b^2}{4} = 4B+4B^2 \equiv 0 \pmod 4$.

\bigskip

 \item[$\bullet$] Si $\pi \equiv 3+2i \pmod 4$, alors $a \equiv 3 \pmod 4, b \equiv 2 \pmod 4$, soit $$a=4A-1,b=4B+2,\ A,B\in\mathbb{Z}.$$
	
Dans ce cas, la proposition \ref{prop134}(b) donne
$$\chi_\pi(a) =- i^{\frac{-a-1}{2}},\qquad  \chi_\pi(a)^{-1} = -i^{\frac{a+1}{2}} = i^{\frac{a-3}{2}},$$
donc
$$\chi_\pi(1+i) = i^{\frac{3a+3b-3+2a-6}{4}} = i^{\frac{5a+3b-9}{4}}.$$

De plus,  
\begin{align*}
\frac{1}{4}[(a-b-b^2-1) - (5a+3b-9)] &= \frac{1}{4}(-4a-4b-b^2+8)\\
 &= -a-b+2 -\frac{b^2}{4}\\
 &= -4A+1-4B-2+2 -(2B+1)^2\\
  &\equiv 0 \pmod 4,
\end{align*}
donc $\chi_\pi(1+i) = i^{\frac{a-b-b^2-1}{4}}$.
\ee

Dans tous les cas

$$\chi_\pi(1+i) = i^{\frac{a-b-b^2-1}{4}}.$$

\end{proof}

\section{Caract\`ere biquadratique de 2.}

\begin{prop}\label{prop137}
Si $\pi = a + bi$ est un premier primaire de $\Z[i]$, alors
$$\chi_\pi(2) = i^{\frac{ab}{2}}.$$
\end{prop}

\begin{proof}
Puisque $2 = i^3(1+i)^2$, le suppl\'ement \`a la loi de r\'eciprocit\'e biquadratique (proposition \ref{prop136}) donne
\begin{align*}
\chi_\pi(2) &= \chi_\pi(i)^3 \chi_\pi(1+i)^2\\
&=i^\frac{3(-a+1)}{2} i ^\frac{a-b-b^2-1}{2}\\
&=i^{1-a -(b+1)\frac{b}{2}}
\end{align*}
Comme $\pi$ est primaire, $a\equiv b+1 \equiv -b+1\pmod 4$, donc
\begin{align*}
1-a -(b+1)\frac{b}{2} &\equiv - b -(b+1)\frac{b}{2}\\
&\equiv \frac{b}{2}(-b-3)\\
&\equiv \frac{b}{2}(-b+1)\\
&\equiv \frac{ab}{2} \qquad \pmod 4,
\end{align*}
donc $\chi_\pi(2) = i^\frac{ab}{2} $.
\end{proof}

Notons que, puisque $a$ est impair, $i^{a} = \pm i$, donc $\chi_\pi(2) = (\pm i)^\frac{b}{2}$, si bien que $\chi_\pi(2) = 1$ \'equivaut \`a $8 \mid b$. Ceci donne l'id\'ee de la proposition suivante.


\begin{prop}
Si $p$ est un nombre premier, $p$ se d\'ecompose sous la forme $p = A^2 + 64 B^2$ si et seulement si $p\equiv 1 \pmod 4$ et si la congruence $x^4 \equiv 2 \pmod p$ admet une solution dans $\Z$.
 $$\exists (A,B) \in \Z^2,\ p = A^2+64B^2 \iff (p\equiv 1 \pmod 4 \text{ et }\ \exists x \in \Z, \ x^4 \equiv 2 \pmod p).$$
\end{prop}
\begin{proof}
($\Rightarrow$)  Si $p = A^2 + 64 b^2 = A^2 + (8B)^2$, alors le nombre premier $p$ est somme de deux carr\'es, et $p\ne 2$, donc $p\equiv 1 \pmod 4$.
Comme  $p = A^2 + 64 b^2$, $A$ est impair. Posons $b = 8B$. Si $A\equiv 1 \pmod 4$, posons $a = A$, et si $A\equiv -1 \pmod 4$, posons $a = -A$. Alors $\pi = a + bi$ v\'erifie $\n(\pi) = a^2 + b^2 =p$, et $a \equiv 1 \pmod 4, b \equiv 0 \pmod 4$, donc $\pi$ est un premier primaire.

Le caract\`ere biquadratique de 2 (proposition \ref{prop137}) donne
$$\chi_\pi(2) = i^{\frac{ab}{2}} = i^{4aB} = 1.$$
Par cons\'equent, il existe $x\in \Z$ tel que $x^4 \equiv 2 \pmod p$ (proposition \ref{prop125}).

\bigskip

($\Leftarrow$) R\'eciproquement, supposons que $p\equiv 1 \pmod 4$ et que 2 est un r\'esidu biquadratique modulo $p$. Comme $p\equiv 1 \pmod 4$, $p$ se d\'ecompose sous la forme $p = \pi \overline{\pi}$, o\`u $\pi$ est un premier primaire. Puisque $2 \equiv x^4 \pmod p$, alors $2 \equiv x^4 \pmod \pi$, et donc $\chi_\pi(2) = 1$. La proposition \ref{prop137} montre que
$$1 =\chi_\pi(2)  =  i^\frac{ab}{2}.$$
Puisque $a$ est impair, ceci montre que $b$ est un multiple de $8$, donc $p =A^2 + 64B^2$, o\`u $A = a, B = b/8$.
\end{proof}





\part{FORMES QUADRATIQUES, CORPS QUADRATIQUES.}




\chapter{Formes quadratiques binaires enti\`eres.}

Source : Gaëtan Chenevier, cours de l'\'Ecole Polytechnique, Th\'eorie Alg\'ebrique des Nombres.

\begin{verbatim}
http://gaetan.chenevier.perso.math.cnrs.fr/TAN_chenevier.pdf
\end{verbatim}


\section{Repr\'esentation d'un entier par une forme quadratique.}\label{section5.1}

\begin{dfn}
Une forme quadratique binaire enti\`ere est un polynôme homog\`ene $f \in \Z[X,Y]$ \`a coefficients dans $\mathbb{Z}$ :
$$f(X,Y) = aX^2+bXY+cY^2.$$
\end{dfn}

On le notera de façon abr\'eg\'ee $f=(a,b,c)$. L'ensemble de ces formes quadratiques sera d\'esign\'e par ${\cal Q}(\mathbb{Z}^2)$.

On peut associer \`a $f$ la fonction $\tilde{f}$ de $\mathbb{Z}^2 \to \mathbb{Z}$ d\'efinie par $\tilde{f}(x,y) = a x^2+bxy + cy^2$. La correspondance $f \mapsto \tilde{f}$ est bijective puisque $a=\tilde{f}(1,0), c=\tilde{f}(0,1), b=\tilde{f}(1,1) - \tilde{f}(1,0)-\tilde{f}(0,1)$. Nous noterons par la m\^eme lettre $f$  la forme quadratique et la fonction associ\'ee.

\begin{dfn}


\item[$\bullet$] $f$ repr\'esente l'entier $n \in \mathbb{Z}^*$ s'il existe $(x,y) \in \mathbb{Z}^2$ tel que $f(x,y)=n$.

\item[$\bullet$]  $f$ repr\'esente 0 s'il existe $(x,y) \in \mathbb{Z}^2$ tel que $f(x,y)=0$ et $(x,y)\neq (0,0)$.

\item[$\bullet$]  $f$ repr\'esente primitivement $n\in \mathbb{Z}$ si de plus $x\wedge y = 1$.

\end{dfn}

Si on conna\^it les entiers $n$ primitivement repr\'esent\'es par $f$, alors les entiers repr\'esent\'es par $f$ s'obtiennent en multipliant ces nombres par un carr\'e arbitraire.

Une forme $f=(a,b,c)$ est dite primitive si $a\wedge b\wedge c=1$.
\begin{dfn}
Le discriminant de la forme $f=(a,b,c)$ est $\mathrm{disc}(f) = b^2-4ac$.
\end{dfn}

Si $D = \mathrm{disc}(f)$, la mise sous forme canonique de $f$ donne
\begin{align}\label{canonique}
4af(x,y) = (2ax+by)^2 -Dy^2.
\end{align}

\begin{prop}
$D\leq0$ si et seulement si les entiers non nuls repr\'esent\'es par $f$ sont tous de m\^eme signe.
\end{prop}

\begin{proof}

\item[($\Rightarrow$)] Supposons $D\leq 0$. Soit $n=f(x,y)\neq 0$. Si $a\neq 0$, alors d'apr\`es (\ref{canonique}) $a f(x,y)\geq 0$, donc $n=f(x,y)$ est toujours du signe de $a$, et si $a=0$, $D=b^2\leq 0$ entra\^ine $b=0$, donc $n=f(x,y)=cy^2$ est du signe de $c$.

\item[($\Leftarrow$)] Supposons $D>0$. Si $a\neq 0$ alors $f(-b,2a) = -aD$ et $f(1,0)=a$ sont de signes contraires. Si $a=0$, $f(x,y)=(bx+cy)y$ et $b\neq 0$ puisque $D=b^2>0$.  Si de plus $c\neq 0$, alors $q(2c,b) = 3cb^2$ et $q(2c,-b) = -cb^2$ sont de signes contraires. Enfin si $a=c=0$, $f(x,y) = bxy$, avec $b\neq 0$ , alors $f(1,1)=b$ et $f(1,-1)=-b$ sont de signes contraires.
\end{proof}
\begin{prop}\label{represente_zero}
Une forme $f$ repr\'esente 0 si et seulement si $D$ est un carr\'e.
\end{prop}
\begin{proof} Soit $f=(a,b,c)$.

($\Leftarrow$) Supposons que  $D$ soit un carr\'e : $D=d^2, d \in \mathbb{N}$.

Si $a\neq 0$, $$4a f(x,y) = (2ax + by)^2 -d^2 y^2 = (2ax+(b-d)y)(2ax+(b+d)y).$$

Alors $f(b+d,-2a)=0$, avec $a\neq 0$, donc $f$ repr\'esente 0.

Si $a=0$, alors $f(1,0)=0$ avec $(1,0)\neq (0,0)$.


($\Rightarrow$) Supposons que $f$ repr\'esente 0. Il existe $(x,y)\in \mathbb{Z}^2, (x,y)\neq (0,0)$ tel que $f(x,y)=0$. D'apr\`es (\ref{canonique}), 
$$(2ax + by)^2 -D y^2=0.$$

Si $y=0$, alors $x\neq 0$, et $ax^2=0$, donc $a=0$, et $D=b^2$ est un carr\'e.

Si $y\neq 0$, $D=\left(\frac{2ax+by}{y}\right)^2$ est un entier qui est le carr\'e d'un rationnel  : c'est donc le carr\'e d'un entier.

Rappel : si $\frac{p}{q}$ est la fraction irr\'eductible repr\'esentant ce rationnel, $D = \left(\frac{p}{q}\right)^2$, o\`u $p\wedge q=1,q>0$, donc $p^2 = D q^2$. Comme $q^2\wedge p^2=1$ et $q^2 \mid p^2$, alors $q^2=1,q>0$, donc $q=1$ et $D=p^2$ est le carr\'e d'un entier.
\end{proof}

Les formes de discriminant $D<0$ ne repr\'esentent donc pas 0, et les valeurs repr\'esent\'ees par $f$ sont toutes de m\^eme signe. En effet, si $D<0$, $a\ne 0$ (sinon $f(1,0) = 0$), et la relation (1) montre que $f(x,y)$ est du signe de $a$. Comme  l'involution $f\mapsto -f$ \'echange les formes \`a valeurs positives en formes \`a valeurs n\'egatives (ayant le m\^eme discriminant), on pourra n'\'etudier que celles qui prennent des valeurs positives, qui sont celles pour lesquelles $a>0$. Nous ferons d\'esormais cette hypoth\`ese dans le cas $D<0$.

\section{Equivalence de formes}\label{section5.2}
Soit $M \in {\cal M}_2(\mathbb{Z}),
M = 
\left(
\begin{array}{cc}
 \alpha&   \beta  \\
 \gamma&   \delta   
\end{array}
\right)
$, et $f=(a,b,c)$ une forme quadratique binaire enti\`ere.

Identifions le couple $(x,y)\in \mathbb{Z}^2$ et 
$
X=
\left(
\begin{array}{c}
x   \\
y   
\end{array}
\right)
\in {\cal M}_{2,1}(\mathbb{Z})$. 

On peut alors noter
$f(X) =  f\left(
\begin{array}{c}
x   \\
y   
\end{array}
\right)  = f(x,y)
$.

Nous noterons $g = f \cdot M$ la forme quadratique d\'efinie pour tout $X \in {\cal M}_{2,1}(\mathbb{Z})$ par

$$ (f\cdot M)(X)=f( MX),$$

soit explicitement

$$(f \cdot M)(x,y) = f(\alpha x + \beta y, \gamma x + \delta y).$$

Si $u = \left(
\begin{array}{c}
\alpha   \\
\gamma  
\end{array}
\right)
$ et
$v = \left(
\begin{array}{c}
\beta   \\
\delta   
\end{array}
\right)
$ 
sont les vecteurs colonnes de $M$, on peut encore noter
$(f \cdot M)(x,y) = f(xu+yv)$

\begin{prop} Pour tout $f \in {\cal Q}(\mathbb{Z}^2)$, tout couple $(M,N) \in {\cal M}_2(\mathbb{Z})^2$

(i) $f\cdot I _2= f$,

(ii) $f\cdot (MN) = (f\cdot M)\cdot N$.

\end{prop}
\begin{proof}
Pour tout $X \in {\cal M}_{2,1}(\mathbb{Z})$, $$(f\cdot(MN))(X) = f(MNX) = (f\cdot M)(NX) =( (f \cdot M)\cdot N)(X),$$ donc $f\cdot(MN) = (f\cdot M)\cdot N$.
\end{proof}

Si on restreint cette application au groupe $\mathrm{GL}_2(\mathbb{Z})$ (groupe des matrices \`a coefficients entiers de d\'eterminant $\pm1$), ou \`a son sous-groupe $\mathrm{SL}_2(\mathbb{Z})$ (groupe des matrices de d\'eterminant $+1$), (i) et (ii) signifient que ces groupes op\`erent \`a droite sur l'ensemble ${\cal Q}(\mathbb{Z}^2)$.

\begin{dfn}
Deux formes $f,g$ sont dites \'equivalentes si elles sont dans une m\^eme orbite de l'op\'eration de $\mathrm{GL}_2(\mathbb{Z})$ sur ${\cal Q}(\mathbb{Z}^2)$, c'est \`a dire s'il existe une matrice inversible $P \in \mathrm{GL}_2(\mathbb{Z})$ telle que $g=f \cdot P$.

Elles sont dites proprement \'equivalentes si $P \in \mathrm{SL}_2(\mathbb{Z})$.
\end{dfn}
Ceci revient \`a dire qu'il existe une base $(u,v)$ de $\Z^2$ (respectivement une base directe $(u,v)$) telle que
$$g(x,y) = f(xu+yv).$$

On notera $f \sim g$ si $f,g$ sont \'equivalentes, et $f \overset{+}{\sim} g$ si $f,g$ sont proprement \'equivalentes.

\begin{prop}{\bf \'Equivalences \'el\'ementaires.}

Pour tout $(a,b,c) \in \mathbb{Z}^3$,

(i)  {\phantom{9}}\, $(a,b,c) \sim (a,-b,c)$,

(ii) {\phantom{1}}  $(a,b,c) \overset{+}{\sim} (c,-b,a) \overset{+}{\sim} (a,b+2a,c+b+a) \overset{+}{\sim}(a,b-2a,c-b+a)$.
\end{prop}
\begin{proof}
(i) Le changement $(x,y) \mapsto (x,-y)$, de d\'eterminant $-1$, transforme $(a,b,c)$ en $(a,-b,c)$.

(ii) Soit $f = (a,b,c) : f(x,y) = ax^2+bxy+cy^2$.

$\bullet$ $(x,y)\mapsto (y,-x)$, de matrice 
$S = \begin{pmatrix}
0&1\\
-1 & 0
\end{pmatrix}
$, de d\'eterminant $1$,
donne $$(f\cdot S)(x,y) = f(y,-x) = cx^2 -bxy+ay^2 : f\cdot S = (c,-b,a).$$

$\bullet$ $(x,y)\mapsto (x+y,y)$, de matrice 
$T = \begin{pmatrix}
1&1\\
0& 1
\end{pmatrix}
$, de d\'eterminant $1$,
donne $$(f\cdot T)(x,y) = f(x+y,y) = ax^2 +(b+2a)xy+(c+b+a)y^2 : f\cdot T = (a,b+2a,c+b+a).$$

$\bullet$ $(x,y)\mapsto (x-y,y)$, de matrice 
$T^{-1}= \begin{pmatrix}
1&-1\\
0& 1
\end{pmatrix}
$, de d\'eterminant $1$,
donne $$(f\cdot T^{-1})(x,y) = f(x-y,y) = ax^2 +(b-2a)xy+(c-b+a)y^2 : f \cdot T^{-1}= (a,b-2a,c-b+a).$$
\end{proof}

Comme nous le verrons, $\{S,T\}$ est un syst\`eme de g\'en\'erateurs de $\mathrm{SL}_2(\mathbb{Z})$ : ces transformations de $(a,b,c)$ suffisent \`a engendrer toutes les autres. Les deux derni\`eres sont des cas particuliers de la transformation $(x,y)\mapsto (x+ky,y), k \in \mathbb{Z}$,  de matrice $T^k$, qui donne :

$(f \cdot T^k)(x,y) = f(x+ky,y) = ax^2+(b+2ak)xy + (ak^2+bk+c) y^2$,
$$f\cdot T^k = (a,b+2ak,ak^2+bk+c).$$

Exemple : 

$$f=(29,24,5) \underset{S}{\overset{+}{\sim}}(5,-24,29) \underset{T^2}{\overset{+}{\sim}}(5,-4,1)\underset{S}{\overset{+}{\sim}}(1,4,5)\underset{T^{-2}}{\overset{+}{\sim}}(1,0,1),$$
donc $f \cdot P = (1,0,1)$, o\`u $P=ST^2ST^{-2}=
\begin{pmatrix}
-1&2\\
2 & -5
\end{pmatrix}
$.

V\'erification :$$ f(-x+2y,2x-5y)= 29(-x+2y)^2+24(-x+2y)(2x-5y)+5(2x-5y)^2 = x^2+y^2.$$
Il reste \`a d\'ecrire un processus pour obtenir la forme \'equivalente la plus simple possible.

\begin{prop}
(i) Deux formes \'equivalentes repr\'esentent les m\^emes entiers, et ce le m\^eme nombre de fois.

(ii) Deux formes \'equivalentes repr\'esentent primitivement les m\^emes entiers, l\`a aussi le m\^eme nombre de fois.
\end{prop}
\begin{proof}


(i) Supposons que $g = f \cdot M, M =
\begin{pmatrix}
\alpha&\beta\\
\gamma & \delta
\end{pmatrix}
 \in \mathrm{GL}_2(\mathbb{Z})$, donc 
 $$g(x,y) = f(\alpha x + \beta y, \gamma x + \delta y),\qquad (x,y) \in \Z^2.$$
 Soit $n \in \Z$ un entier fix\'e. Consid\'erons les deux ensembles
$$A  = \{(x',y')\in \Z^2 \ \vert \  f(x',y') = n\},\qquad B = \{(x,y) \in \Z \ \vert \ g(x,y) = n\}.$$
Il s'agit de prouver que $A$ et $B$ ont m\^eme cardinal. 

Si $(x,y) \in B$, alors $(x',y') = (\alpha x + \beta y, \gamma x + \delta y) \in A$, puisque $f(\alpha x + \beta y,\gamma x + \delta y) = g(x,y) = n$. Ceci permet de d\'efinir l'application
$$\varphi 
\left\{
\begin{array}{lll}
 B &\to& A\\
(x,y) & \mapsto &(\alpha x + \beta y, \gamma x + \delta y),
\end{array}
\right.
$$
autrement dit, si on note $X = \begin{pmatrix} x \\ y \end{pmatrix}, X'= \begin{pmatrix} x' \\ y' \end{pmatrix}, X''= \begin{pmatrix} x'' \\ y'' \end{pmatrix}$, alors pour tout $(x,y) \in B$,

$$(x',y') = \varphi(x,y) \iff X' = MX.$$

Inversement, comme $f=g \cdot M^{-1}$, le m\^eme raisonnement appliqu\'e \`a $M^{-1} = \begin{pmatrix}
\alpha'&\beta'\\
\gamma' & \delta'
\end{pmatrix}
$ montre qu'il existe une application 
$$\psi 
\left\{
\begin{array}{lll}
 A &\to& B\\
(x',y') & \mapsto &(\alpha' x' + \beta' y', \gamma' x' + \delta' y'),
\end{array}
\right.
$$
et, pour tout $(x',y') \in A$,
$$(x'',y'') = \psi(x',y') \iff X'' = M^{-1}X'.$$
Si $(x'',y'') =( \psi \circ \varphi)(x,y)$, alors $X'' = M^{-1}M X = X$, donc $ (\psi \circ \varphi)(x,y) = (x,y)$ pour tout $(x,y) \in \Z^2$. Ainsi $\psi \circ \varphi = \mathrm{id}_B$, et de m\^eme $\varphi \circ \psi = \mathrm{id}_A$. Donc $\varphi$ est une bijection. Par cons\'equent $|A| = |B|$.

(ii) Gardons les m\^emes notations. Il faut maintenant prouver l'\'egalit\'e des cardinaux des ensembles
$$A'  = \{(x',y')\in \Z^2 \ \vert \  f(x',y') = n \text{ et } x' \wedge y' = 1\},\quad B' = \{(x,y) \in \Z \ \vert \ g(x,y) = n \text{ et } x\wedge y = 1\}.$$
Si $(x,y) \in B'$, alors $(x',y') = (\alpha x + \beta y, \gamma x + \delta y) \in A'$, puisque d'une part $f(\alpha x + \beta y,\gamma x + \delta y) = g(x,y) = n$, d'autre part $x\wedge y = 1$ montre qu'il existe $u,v \in \Z$ tels que $ux + vy = 1$, ce qui donne 
$$(\delta u - \gamma v)(\alpha x + by) + (-\beta u + \alpha v)(\gamma x + \delta y) = (\alpha \delta - \beta \gamma )(ux + vy) = \pm 1,$$
prouvant ainsi $x' \wedge y ' = (\alpha x + \beta y) \wedge ( \gamma x + \delta y) = 1$, et donc $(x',y') \in B'$. Ceci permet de d\'efinir 
$$\varphi'
\left\{
\begin{array}{lll}
 B' &\to& A'\\
(x,y) & \mapsto &(\alpha x + \beta y, \gamma x + \delta y),
\end{array}
\right.
$$
En inversant les rôles de $f$ et $g$, on construit de m\^eme 
$$\psi'
\left\{
\begin{array}{lll}
 A' &\to& B'\\
(x',y') & \mapsto &(\alpha' x' + \beta' y', \gamma' x' + \delta' y'),
\end{array}
\right.
$$
et on prouve comme dans (i) que $\varphi'$ et $\psi'$ sont bijectives et r\'eciproques l'une de l'autre. Alors $|A'| = |B'|$ et la proposition est d\'emontr\'ee.
\end{proof}

Exemple : reprenons le calcul ci-dessus.

 L'entier $29$ est repr\'esent\'e par la forme $f=(29,24,5)$ puisque $29=f(1,0)$. Il doit donc l'\^etre aussi par la forme \'equivalente $g(x,y)=x^2+y^2$.

$29 = f(1,0) = (g\cdot P^{-1})(1,0)=g\left(
 \begin{pmatrix}
-5&-2\\
-2& -1
\end{pmatrix}
 \begin{pmatrix}
1\\
0
\end{pmatrix}
\right) = g(-5,-2) = 5^2+2^2
$.


Nous verrons comment g\'en\'eraliser cette m\'ethode aux nombres premiers de la forme $4k+1$.

\bigskip

Repr\'esentation matricielle d'une forme quadratique : si $(x,y) \in \Z^2$,

$$f(x,y) = ax^2+bxy+cy^2 = 
\begin{pmatrix}
x & y
\end{pmatrix}
\begin{pmatrix}
a&b/2\\
b/2& c
\end{pmatrix}
\begin{pmatrix}
x\\
y
\end{pmatrix}
=\,^tXAX
.$$
Si $A,B$ sont des matrices sym\'etriques de ${\cal M}_2(\Q)$, alors
$$\forall X \in {\cal M}_{2,1}(\mathbb{Z}),\  \,^tX A X = \,^tXB X \Rightarrow A=B.$$ 
En effet, on peut \'ecrire une telle matrice sym\'etrique $A$ sous la forme $A = \begin{pmatrix} a&b/2\\b/2& c\end{pmatrix}$, alors on obtient $a =  \,^tX_1 A X_1$ pour $X_1 = \begin{pmatrix}1\\0\end{pmatrix}$, $c =  \,^tX_2 A X_2$ pour $X_2 = \begin{pmatrix}0 \\1\end{pmatrix}$, et $a+b+c =  \,^tX_3 A X_3$ pour $X_3 = \begin{pmatrix}1\\1\end{pmatrix}$.
Il existe donc une et une seule matrice sym\'etrique $A \in {\cal M}_2(\Q)$ telle que, pour tout $X \in {\cal M}_{2,1}(\mathbb{Z})$, $f(X) = \,^tX A X$.

Appelons $A = \mathrm{Mat}(f)$ cette matrice sym\'etrique associ\'ee \`a $f$. Si $P \in {\cal M}_2(\Z)$, alors,  pour tout $X\in {\cal M}_{2,1}(\mathbb{Z})$,

\begin{align*}
(f\cdot P)(X) &= f(P X)\\
&= \,^t(PX) A (PX)\\ 
&= \,^tX (\,^tP A P) X, 
\end{align*}
donc
$$\mathrm{Mat}(f \cdot P) = \,^tP A P.$$
 
 De plus, $\det(\mathrm{Mat}(f)) = ac - (b/2)^2 = -\frac{1}{4} \mathrm{disc}(f)$. Si $P \in \mathrm{GL}_2(\mathbb{Z})$, 
 $$ \mathrm{disc}(f\cdot P) = -4 \det(\mathrm{Mat}(f\cdot P)) =-4  \det(P)^2 \det(A) = \det(P)^2 \mathrm{disc}(f).$$
 Si de plus $P \in \mathrm{GL}_2(\Z)$, alors $\det(P) = \pm 1$, donc $\mathrm{disc}(f\cdot P) = \mathrm{disc}(f)$.
Nous avons prouv\'e :
 
 \begin{prop}
 \be Si $f \in {\cal Q}(\Z^2)$ est une forme quadratique, et $P \in {\cal M}_2(\Z)$,
  \item[(i)] $\mathrm{disc}(f\cdot P) = \det(P)^2  \mathrm{disc}(f)$.
 \item[(ii)] Si $P \in \mathrm{GL}_2(\Z)$, alors  $\mathrm{disc}(f\cdot P) = \mathrm{disc}(f)$. 
 
 Ainsi deux formes \'equivalentes ont m\^eme discriminant.
  \ee
 \end{prop}
 
 
  \begin{prop}\label{primitive}
 Si $f \in {\cal Q}(\Z^2)$ est une forme primitive, toute forme \'equivalente \`a $f$ est primitive.
 \end{prop}
 \begin{proof}
Supposons que $f = (a,b,c)$ est primitive, si bien que $a\wedge b \wedge c = 1$. Soit $g = (a',b,c')$ une forme \'equivalente \`a $f$. Il existe une matrice $P \in \mathrm{GL}_2(\Z)$ telle que $f\cdot P = g$. Alors $f = g \cdot P^{-1}$. Notons $P^{-1} = \begin{pmatrix} r & s\\ t & u\end{pmatrix}$.
Alors $f(x,y) = g(rx + s y, tx + u,y)$, soit
$$ax^2 + bxy + cy^2 = a' (rx + sy)^2 + b'(rx+sy)(tx+uy) + c'(tx+uy)^2,$$
donc
\begin{align*}
a &= a'r^2 +b'rt +c't^2\\
b&= 2a'rs + b'(ru + st) + 2c'tu\\
c&= a's^2 + b'su + c' u^2.
\end{align*}
Si $d \in \Z$ divise les entiers $a',b',c'$, alors d divise $a,b,c$, donc $d \mid a\wedge b \wedge c = 1$. Ceci montre que $a'\wedge b' \wedge c' = 1$, et ainsi $g$ est primitive.
 \end{proof}
 
 Une classe d'\'equivalence (ou d'\'equivalence propre) de formes est donc compos\'ee de formes qui sont toutes primitives, ou toutes non primitives.
 
  \begin{dfn}\label{def16}
\item[$\bullet$] Si $D \geq 0$, on d\'esigne par $\mathrm{Cl}(D)$ l'ensemble des classes d'\'equivalence propre de formes de discriminant $D$, et $\mathrm{P}(D)$ l'ensemble des classes d'\'equivalence propre de formes primitives.

\item[$\bullet$] Si $D<0$, on d\'esigne par $\mathrm{Cl}(D)$ l'ensemble des classes d'\'equivalence propre de formes positives de discriminant $D$, et $\mathrm{P}(D)$ l'ensemble des classes d'\'equivalence propre de formes positives  primitives de discriminant $D$.
 
\end{dfn}

Nous prouverons dans ce chapitre que les ensembles $\mathrm{Cl}(D)$ et $\mathrm{P}(D)$ sont finis pour tout discriminant $D$.
 

 \section{Equivalence et \'equivalence propre.}
  Nous pr\'ecisons dans ce paragraphe les liens entre \'equivalence et \'equivalence propre.


 On d\'efinit l'oppos\'e $q^{\mathrm{opp}}$ de la forme $q = (a,b,c)$ comme \'etant la forme de m\^eme discriminant d\'efinie par
 $$q^{\mathrm{opp}} = (a,-b,c) = q \cdot \begin{pmatrix}1 &0\\0 & -1\end{pmatrix}.$$
 Alors $(q^{\mathrm{opp}})^{\mathrm{opp}} = q$. V\'erifions l'implication
 $$q \overset{+}{\sim} q' \Rightarrow q^{\mathrm{opp}} \overset{+}{\sim} (q')^{\mathrm{opp}}.$$
Notons $g_0 = \begin{pmatrix}1 &0\\0 & -1\end{pmatrix} \in \mathrm{GL}_2(\Z)$. Si on suppose $q \overset{+}{\sim} q'$, alors il existe $g\in \mathrm{SL}_2(\Z)$ tel que $q' = q \cdot g$. Alors 
$$(q')^{\mathrm{opp}} = (q\cdot g) \cdot g_0= (q\cdot g_0) \cdot (g_0^{-1} g g_0) = q^{\mathrm{opp}} \cdot (g_0^{-1} g g_0). $$

Comme $\mathrm{SL}_2(\Z)$ est distingu\'e dans $\mathrm{GL}_2(\Z)$, $g_0^{-1} g g_0 \in \mathrm{SL}_2(\Z)$, donc $q^{\mathrm{opp}} \overset{+}{\sim} (q')^{\mathrm{opp}}$.

Si $C$ est une classe d'\'equivalence propre, d\'efinissons $C^{\mathrm{opp}} = \{q^{\mathrm{opp}}, q \in C\}$. Alors $C^{\mathrm{opp}}$ est une classe d'\'equivalence propre. En effet,  fixons $q_0$ dans la classe (non vide) $C$. Alors, d'apr\`es l'implication pr\'ec\'edente,
\begin{align*}
q'\in C^{\mathrm{opp}} \iff &\ q' = q^{\mathrm{opp}},\  q \in C\\
\iff &\ q' = q^{\mathrm{opp}},\ q \overset{+}{\sim} q_0\\
\Rightarrow &\ q' \overset{+}{\sim} q_0^{\mathrm{opp}}
\end{align*}
R\'eciproquement, si $q' \overset{+}{\sim} q_0^{\mathrm{opp}}$, comme $q_0 \in C$, $q' \in C^{\mathrm{opp}}$ par d\'efinition de $C^{\mathrm{opp}}$. Par cons\'equent $C^{\mathrm{opp}}$ est la classe de $q_0^{\mathrm{opp}}$ pour la relation $\overset{+}{\sim} $ : c'est une classe d'\'equivalence propre.

\begin{prop} \label{involution}
Soit $f$ l'application d\'efinie par
$$
f
\left\{
\begin{array}{ccl}
\mathrm{Cl}(D)&\to &\mathrm{Cl}(D)\\
C &\mapsto &C^{\mathrm{opp}}\\
\end{array}
\right.
$$
 Alors $f$ est une involution, et l'ensemble $\{ C \cup f(C) \mid C \in \mathrm{Cl}(D)\}$ est l'ensemble des classes d'\'equivalence de formes de discriminant $D$.
\end{prop}

\begin{proof}
Soit $C \in \mathrm{Cl}(D)$, et $q_0$ une forme fix\'ee dans $C$. Alors $q_0^{\mathrm{opp}} \in C^{\mathrm{opp}}$, donc $q_0 = (q_0^{\mathrm{opp}})^{\mathrm{opp}} \in (C^{\mathrm{opp}})^{\mathrm{opp}}$. Les deux classes $C$ et $(C^{\mathrm{opp}})^{\mathrm{opp}}$ ne sont pas disjointes, elles sont donc \'egales : $C = (C^{\mathrm{opp}})^{\mathrm{opp}}$.

Le sous-groupe $\mathrm{SL}_2(\Z)$ est d'indice 2 dans le groupe $\mathrm{GL}_2(\Z)$, et $g_0 = \begin{pmatrix}1 &0\\0 & -1\end{pmatrix} \in \mathrm{GL}_2(\Z) \setminus \mathrm{SL}_2(\Z)$, donc
$$\mathrm{GL}_2(\Z) = \mathrm{SL}_2(\Z) \cup \begin{pmatrix}1 &0\\0 & -1\end{pmatrix} \mathrm{SL}_2(\Z),$$
la r\'eunion \'etant disjointe.

Soit $q$ une forme de discriminant $D$ quelconque, et $C$ sa classe d'\'equivalence propre. D'apr\`es la remarque pr\'ec\'edente, pour tout \'el\'ement $g \in \mathrm{GL}_2(\Z)$, il existe $h \in \mathrm{SL}_2(\Z)$ tel que $g = h$, ou bien $g = g_0h$. Par cons\'equent, pour toute forme $q'$ de discriminant $D$,
\begin{align*}
q' \sim q &\iff \exists g \in \mathrm{GL}_2(\Z),\ q' = q\cdot g\\
&\iff \exists h \in \mathrm{SL}_2(\Z),\ q' = q\cdot h \ \mathrm{ou} \ \exists h \in \mathrm{SL}_2(\Z),\ q' = q\cdot g_0h\\
&\iff q' \overset{+}{\sim} q  \ \mathrm{ou} \ q' \overset{+}{\sim} q\cdot g_0= q^{\mathrm{opp}}\\
&\iff q' \in C \cup C^{\mathrm{opp}}
\end{align*}

Ainsi, si $C$ est la classe d'\'equivalence propre d'une forme $q$, $C \cup C^{\mathrm{opp}}$ est sa classe d'\'equivalence de formes, et $\{ C \cup C^{\mathrm{opp}} \mid C \in \mathrm{Cl}(D)\}$ est bien l'ensemble des classes d'\'equivalence de formes de discriminant $D$.
\end{proof}
 Notons que $C$ et $C^{\mathrm{opp}}$ peuvent \^etre \'egales : c'est le cas des classes ambigües qui seront \'etudi\'ees dans un chapitre ult\'erieur.



 \section{Entiers repr\'esent\'es par une forme quadratique.}
 
 \begin{prop}\label{representation}
 
 Soit $n\in \mathbb{Z}$. Si $D$ est un carr\'e modulo $4n$, alors $n$ est primitivement repr\'esent\'e par au moins une forme quadratique de discriminant $D$.
 \end{prop}
 \begin{proof}
 Puisque $D$ est un carr\'e modulo $4n$, il existe $b,c\in \mathbb{Z}$ tels que $D = b^2-4nc$. La forme $f =(n,b,c)$ a pour discriminant $D$ et repr\'esente primitivement $n = f(1,0)$.
 \end{proof}
 
 Exemple : $p=29$ est premier. Puisque $p=29\equiv 1 \pmod{4}$, alors $\legendre{-1}{29} = (-1)^{14} = 1 $, et ainsi $-1$ est un carr\'e modulo $29$. Explicitement, $-1\equiv 12^2 \pmod{29}$, car $-1 = 12^2-5\times 29$ donc $D=-4 \equiv 24^2\pmod{29}$ est un carr\'e modulo $4p$ : $D = -4 = 24^2 - 4\times5\times29$.
 
 L'entier 29 est donc repr\'esent\'e primitivement par la forme $f(x,y) = 29 x^2+24 xy+5y^2$ de discriminant $-4$, utilis\'ee ci-dessus en exemple, et donc aussi par la forme \'equivalente $g(x,y)=x^2+y^2$.
 
 \medskip
 La r\'eciproque de la proposition \ref{representation} est vraie, mais demande deux lemmes :
 
 \begin{prop}\label{completion}
 Tout vecteur $u=(x,y) \in \mathbb{Z}^2$  suppos\'e primitif (i.e. $x\wedge y = 1$) se compl\`ete en une $\mathbb{Z}$-base directe de $\mathbb{Z}^2$.
 \end{prop}
 \begin{proof}
 Il existe $s,t\in \mathbb{Z}$ v\'erifiant l'\'egalit\'e de B\'ezout $sx+ty=1$. Comme
 $\begin{vmatrix}
 x&-t\\
 y& s
 \end{vmatrix}
 =1$, alors $(u,v) = ((x,y),(-t,s))$ est une base directe.
  \end{proof}
 
 \begin{prop}{\bf Lemme clef.}\label{clef}
 
 \item[(i)] Un entier $n \in \mathbb{Z}$ est primitivement repr\'esent\'e par la forme $f$ si et seulement s'il existe $b,c \in \mathbb{Z}$ tels que $f \overset{+}{\sim} (n,b,c)$.
 
 \item[(ii)]Si $n\ne 0$, on peut choisir $b$ de façon \`a ce que $-\vert n \vert < b \leq \vert n \vert$ si $n\neq 0$.
 \end{prop}
 \begin{proof}
 
\item[(i)]

($\, \Leftarrow$) Supposons que $f \sim f_0 = (n,b,c)$, o\`u $b,c \in \Z$. Alors $f_0=(n,b,c)$ repr\'esente primitivement $n$, puisque $n=f_0(1,0)$, ainsi que la forme $f$ \'equivalente \`a $f_0$.
 
($\Rightarrow$) Supposons que $n = f(x,y)$, o\`u $x \wedge y= 1$. Le vecteur $u=(x,y)$ peut \^etre compl\'et\'e en une base $(u,v)$ directe de $\mathbb{Z}^2$ (proposition \ref{completion}).
 
 Posons $g(x,y) = f(xu+yv)$ : alors $g \overset{+}{\sim} f$, et $g(1,0) = f(u) = f(x,y) = n$, donc $g$ est de la forme $g=(n,b',c'),b',c' \in \mathbb{Z}$.
 
 \item[(ii)] 
 
Si $n\neq 0$, il existe $k \in \mathbb{Z}$ tel que $-\vert n \vert < b'-2nk\leq \vert n \vert$.
 La r\'ep\'etition de $k$ op\'erations \'el\'ementaires $T^{-1}$ sur $g$ donne
 
 $g \cdot T^{-k} = (n,b'-2nk,nk^2-b'k+c') = (n,b,c)$, avec $-\vert n \vert < b\leq \vert n \vert$.
 \end{proof}
 
 On peut alors \'enoncer :
 \begin{prop}\label{lagrange} {\rm (Lagrange)}
 
 Soit $D \in \mathbb{Z}, n \in \mathbb{Z}$.
 Il y a \'equivalence entre
 
 \item[(i)] $D$ est un carr\'e modulo $4n$.
 
 \item[(ii)] Il existe une forme de discriminant $D$ qui repr\'esente primitivement $n$.
 \end{prop}
 
 \begin{proof}
 \item[(i)] $\Rightarrow$ (ii) : d\'ej\`a prouv\'e (proposition \ref{completion}).
 
 \item[(ii)] $ \Rightarrow$ (i) : soit $f$ une forme de discriminant $D$ qui repr\'esente primitivement $n$. D'apr\`es la proposition \ref{clef}, $f \overset{+}{\sim} (n,b,c)$ pour des entiers $b,c\in \mathbb{Z}$, donc $\mathrm{disc}(f) = b^2 - 4nc$ est un carr\'e modulo $4n$.
 \end{proof}
 
 Ce th\'eor\`eme peut \^etre pr\'ecis\'e dans le cas o\`u $n$ est un nombre premier. Remarquons que si un nombre premier est repr\'esent\'e par une forme, elle le repr\'esente primitivement.
 
 \begin{prop}\label{repr_premier}
 Soit $D \equiv 0,1 \pmod 4$, et $p$ un nombre premier impair tel que $D$ est un carr\'e modulo $p$.
 
 Alors, \`a \'equivalence pr\`es, $p$ est repr\'esent\'e par une unique forme de discriminant $D$.
 \end{prop}
 \begin{proof}
 Si $D\equiv 0,1 \ [4]$, alors $D$ est un carr\'e modulo 4, et par hypoth\`ese un carr\'e modulo $p$ : c'est donc un carr\'e modulo $4p$. En effet, si $D \equiv a^2\ [4], D \equiv b^2 \ [p]$, alors il existe $c\in \mathbb{Z}$ tel que $c \equiv a\ [4], c \equiv b\ [p]$ d'apr\`es le lemme chinois qui s'applique ici puisque  $4 \wedge p = 1$, donc $D\equiv c^2\ [4], D \equiv c^2\ [p]$, donc $D\equiv c^2\ [4p]$.
 
 Les propositions \ref{clef} et  \ref{lagrange} montrent l'existence d'une forme $f=(p,b,c), -p<b \leq p$, de discriminant $D$ qui repr\'esente primitivement $p$.
 
 De plus $(p,b,c) \sim (p,-b,c)$ : $p$ est donc repr\'esent\'e par une forme $f=(p,b,c), 0\leq b \leq p$, de discriminant $D=b^2-4pc$.
 
 Soit $g$ une autre forme de discriminant $D$ repr\'esentant $p$. Alors $p$ est repr\'esent\'e primitivement par $g$, et le m\^eme argument montre que $g \sim (p,b',c'), 0\leq b'\leq p$.
 
 Comme $D = b^2-4pc = b'^2-4pc'$, $b^2 \equiv b'^2\ [p]$, donc $b'\equiv \pm b \ [p]$, $p$ \'etant premier. Puisque $0\leq b \leq p, 0 \leq b' \leq p$, alors $b'=b$ ou $b' = p-b$. Comme $b'\equiv b \ [2]$, $b' =p-b$ est impossible, donc $b'=b$. Enfin $c'=\frac{b'^2-D}{4p} = \frac{b^2-D}{4p}=c$.
 
 Si deux formes $f,g$ de discriminant $D$ repr\'esentent $p$, elles sont donc \'equivalentes.
  \end{proof}
  
  
  
 \section{Formes r\'eduites.}
 Si $D=b^2-4ac$ est le discriminant d'une forme $f=(a,b,c)$, alors $D\equiv b^2\ [4]$, donc $D\equiv 0,1 \ [4]$.
 
 Inversement, si $D\equiv 0,1\ [4]$, alors $D$ est le discriminant d'au moins une forme :
 $$
\left\{
\begin{array}{lc}
 x^2-\frac{D}{4} y^2 &,\  \mathrm{si} \ D\equiv 0\ [4]   \\
  x^2+xy+\frac{1-D}{4} y^2& ,\ \mathrm{si}\  D \equiv 1 \ [4]     
\end{array}
 \right.
 $$
 Cette forme s'appelle forme principale de discriminant $D$.
 
 \begin{prop}\label{forme_principale}
 Une forme repr\'esente $1$ si et seulement si elle est proprement \'equivalente \`a la forme principale de m\^eme discriminant.
 \end{prop}
\begin{proof}

 La forme principale $f_0$ repr\'esente $1 = f_0(1,0)$, et donc aussi les formes \'equivalentes \`a la forme principale.

R\'eciproquement, soit $f$ une forme de discriminant $D$ repr\'esentant $1$. Elle le repr\'esente primitivement et d'apr\`es la proposition \ref{clef}, $f \sim (1,b,c), b \in \{0,1\}$. Or $D\equiv b\ [2]$, il n'y a donc qu'une seule possibilit\'e pour $b$, et aussi pour $c=\frac{b^2-D}{4}$ : c'est donc la forme principale.
\end{proof}

\begin{prop}[r\'eduction de Lagrange]\label{reduite_lagrange}

Soit $f$ une forme quadratique de discriminant $D$, o\`u $D$ n'est pas un carr\'e parfait.

Elle est proprement \'equivalente \`a une forme quadratique $(a,b,c)$, dite r\'eduite au sens de Lagrange, v\'erifiant
$$-\vert a \vert < b \leq \vert a \vert \leq \vert c \vert .$$

Une telle forme v\'erifie alors $1\leq \vert a \vert \leq \sqrt{\frac{\vert D \vert}{3}}$.
\end{prop}
\begin{proof}
Soit $${\cal V} = \{n\in \mathbb{N} \mid   \exists (x,y)\in \mathbb{Z}^2,\ x\wedge y = 1\ \mathrm{et} \ n = \vert f(x,y) \vert\}.$$

C'est l'ensemble des valeurs absolues des entiers repr\'esent\'es primitivement par $f$. Comme $D$ n'est pas un carr\'e, $0$ n'est pas repr\'esent\'e, donc $0\not \in {\cal V}$, et ${\cal V} \neq \varnothing$. L'ensemble ${\cal V}$ admet donc un plus petit \'el\'ement $n_0$, o\`u $0<n_0 = \vert a \vert$, $a =f(x,y),\ x\wedge y = 1$. La proposition \ref{clef} (lemme clef) appliqu\'e \`a $a\neq 0$ montre que $f \overset{+}{\sim} (a,b,c)$, avec $-\vert a \vert<b\leq \vert a \vert$.

Comme $c$ est repr\'esent\'e primitivement par $(a,b,c)$, et donc aussi par $f \overset{+}{\sim} (a,b,c)$, $\vert c \vert \in {\cal V}$, donc $\vert a \vert = \mathrm{min}({\cal V }) \leq \vert c \vert$.

Enfin $4a^2 \leq 4 \vert ac\vert = \vert b^2 - D \vert \leq a^2 + \vert D \vert$, donc $3a^2\leq \vert D \vert$,  $1\leq \vert a \vert \leq \sqrt{\frac{\vert D \vert}{3}}$.
\end{proof}


Pr\'ecisons un algorithme permettant \`a partir d'une forme $f$ d'obtenir une forme r\'eduite au sens de Lagrange et proprement \'equivalente \`a $f$, dans le cas o\`u $D$ n'est pas un carr\'e.

Supposons que $(a,b,c)$ proprement \'equivalente \`a $f$ ne v\'erifie pas l'une des deux  in\'egalit\'es

\begin{align}
\vert b \vert \leq \vert a \vert  \leq \vert c \vert .
\end{align}

On en d\'eduit une forme proprement \'equivalente $(a',b',c')$ \`a l'aide d'une op\'eration \'el\'ementaire $S,T$, et v\'erifiant de surcroit $\vert a' \vert + \vert b' \vert <\vert a\vert + \vert b \vert$.

$\bullet$ Si $\vert c \vert<\vert a\vert$, on pose $(a',b',c') = (c,-b,a) = (a,b,c) \cdot S$.

Alors $\vert a'\vert + \vert b'\vert = \vert c\vert + \vert b \vert < \vert a\vert + \vert b \vert$.

$\bullet$ Si $\vert c \vert\geq \vert a \vert$ et $\vert b \vert > \vert a \vert$, on pose $(a',b',c') = (a,b-\varepsilon 2a,c+a-\varepsilon b)=(a,b,c).T^{-\varepsilon}$, o\`u $\varepsilon = \mathrm{sgn}(ab) \in\{-1,1\}$.

En effet, $a\neq 0$, sinon $D = b^2$ serait un carr\'e (et $b\neq 0$ car $\vert b \vert > \vert a \vert$).

V\'erifions alors $\vert b - 2 \varepsilon a \vert < \vert b \vert$ :

$-$ Si $b>0$, $\varepsilon = \mathrm{sgn}(a), \varepsilon a = \vert a \vert$, donc
$$
\left\{
\begin{array}{ccccc}
  b-\varepsilon 2a<\vert b \vert&  \iff & b-2 \vert a \vert<b   & \iff  &\vert a \vert >0\\
  -b+\varepsilon 2a<\vert b \vert&  \iff & -b+2\vert a \vert <b  &\iff & \vert a \vert < \vert b \vert
\end{array}
\right.
$$
et donc $\vert b - \varepsilon 2a \vert < \vert b \vert$.

$-$ Si $b<0$, $\varepsilon = -\mathrm{sgn}(a), \varepsilon a = -\vert a \vert$, donc
$$
\left\{
\begin{array}{ccccc}
  b-\varepsilon 2a<\vert b \vert&  \iff & b+2 \vert a \vert<-b   & \iff  &\vert a \vert <\vert b \vert\\
  -b+\varepsilon 2a<\vert b \vert&  \iff & -b-2\vert a \vert  <-b  &\iff & \vert a \vert >0
\end{array}
\right.
$$
et donc $\vert b - \varepsilon 2a \vert < \vert b \vert$. Alors $\vert a'\vert + \vert b'\vert  < \vert a\vert + \vert b \vert$.

Si, en r\'ep\'etant ces transformations, on n'obtenait jamais de triplet $(a,b,c)$ v\'erifiant les in\'egalit\'es (2), alors la suite des valeurs $\vert a \vert + \vert b \vert$ serait une suite strictement d\'ecroissante d'entiers naturels : c'est impossible. On aboutit apr\`es un nombre fini d'\'etape \`a un triplet $(a,b,c)$ v\'erifiant les in\'egalit\'es (2).

Si $-\vert a \vert <b$, c'est termin\'e, sinon il reste \`a modifier une derni\`ere fois ce triplet dans le cas o\`u  $b = -\vert a \vert$ :

$\bullet$ Si $\vert c \vert \geq \vert a \vert $ et $b = -\vert a \vert$, en prenant $\varepsilon = \mathrm{sgn}(a)$ on pose $(a',b',c') =(a,b,c)\cdot T^{\varepsilon}=(a, b+\varepsilon 2a, a+\varepsilon b +c) =  (a,\vert a \vert,c)$, car $a+\varepsilon b + c = a -\mathrm{sgn}(a) \vert a \vert + c = \mathrm{sgn}(a)(\vert a \vert - \vert a \vert)+ c= c$.

Dans les deux cas, on obtient une forme $(a,b,c)$ r\'eduite au sens de Lagrange :
$$-\vert a \vert < b \leq \vert a \vert \leq \vert c \vert .$$
Ceci donne donc une deuxi\`eme d\'emonstration constructive de la proposition \ref{reduite_lagrange}.



\bigskip
Avant d'aborder la finitude du nombre de classes, il reste \`a \'etudier le cas plus simple des formes de discriminant carr\'e.

\begin{prop}\label{discr_carre}
\item[(i)] Soit $f$ une forme de discriminant $D = d^2$ avec $d \in \N^*$. Alors $f$ est \'equivalente \`a une forme
$$f_1 = (0,d,e),\qquad 0 \leq e < d.$$
\item[(ii)] Soit $f$ une forme de discriminant $D = 0$. Alors $f$ est \'equivalente \`a une forme
$$f_0 = (0,0,e),\qquad e \in \Z.$$
\end{prop}

\begin{proof}
 Soit $f = (a,b,c)$ une forme quadratique. Supposons que $D = \mathrm{disc}(f) = d^2$, o\`u $d\geq 0$. Alors $f$ repr\'esente $0$ (proposition \ref{represente_zero}). 
V\'erifions alors que $f$ repr\'esente $0$ primitivement. 
Si $a = 0$, $0 = f(1,0)$ est repr\'esent\'e primitivement par $f$.

Si $a \ne 0$, la mise sous forme canonique de $f$ donne
$$4a f(x,y) = (2ax + by)^2 -d^2 y^2 = (2ax+(b-d)y)(2ax+(b+d)y).$$
Comme $a \ne 0$, $(2a) \wedge (b+d) \ne 0$. Posons $(x_0,y_0) = \left( \frac{b+d}{(2a) \wedge (b+d)}, \frac{-2a}{(2a) \wedge (b+d)}\right)$. Alors $x_0\wedge y_0 = 1$ et $ax_0 + (b+d)y_0 = 0$, donc $f(x_0,y_0) = 0$. Dans tous les cas $f$ repr\'esente primitivement $0$.
La proposition \ref{clef} (lemme clef) montre alors que $f \overset{+}{\sim} (0, h,g),\ h,g \in \Z$. L'\'egalit\'e des discriminants montre que $h^2 = d^2$, donc $h = \pm d$. Si $h = -d$, l'\'equivalence \'el\'ementaire $(0,h,g) \overset{+}{\sim} (0,-h,g)$ montre que $f \sim (0,d,g)$.
\item[(i)] Si $d \ne 0$, la division euclidienne de $g$ par $d$ donne $g = dk + c, \ 0 \leq c < d$. Alors $(0,d,g)\cdot T^{-k} = (0, d- 2\cdot0 \cdot k, 0\cdot k^2 - dk +g) = (0,d,c)$. Par cons\'equent $f \sim f_1 = (0,d,c)$, o\`u $0\leq c < d$.
\item[(ii)] Si $d = 0$, $f \sim (0,0,c),\ c \in \Z$.
\end{proof}

Remarque : deux formes $f = (0,0,c)\ne 0$ et $f' = (0,0,c')\ne 0$, o\`u $c\ne c'$, ont m\^eme discriminant $0$ et ne sont pas \'equivalentes. En effet, si $f \sim f'$, alors $f(x,y) = cy^2$ et $f'(x,y) = c'y^2 $ repr\'esentent les m\^emes entiers, donc
\begin{align*}
|c| &= \min \{t \in \N^* \mid \exists x \in \Z, \exists y \in \Z, \ t = |f(x,y)| \}\\
 &= \min \{t \in \N^* \mid \exists x \in \Z, \exists y \in \Z, \ t = |f'(x,y)| \}\\
  &= |c'|.
\end{align*}
De plus $f,f'$ sont toutes deux positives, ou toutes deux n\'egatives, donc $c, c'$ sont de m\^eme signe, donc $c = c'$, ce qui contredit l'hypoth\`ese. Il y a donc une infinit\'e de classes d'\'equivalence de formes de discriminant nul.

Il en va autrement si $D \ne 0$.
\begin{prop}
A \'equivalence pr\`es, l'ensemble des classes de formes de discriminant $D \ne 0$ est fini, que ce soit pour pour l'\'equivalence des formes ou pour l'\'equivalence propre.
\end{prop}
\begin{proof}
\item[$\bullet$] Si $D$ n'est pas un carr\'e, $f$ est dans la classe d'\'equivalence de $(a,b,c)$ v\'erifiant les in\'egalit\'es de la proposition \ref{reduite_lagrange} : les valeurs de $\vert a\vert, \vert b \vert$ sont born\'es par $\sqrt{\frac{\vert D \vert}{3}}$, et pour un couple $(a,b)$ fix\'e, $c =\frac{b^2-D}{4a}$. L'ensemble des classes d'\'equivalence de formes de discriminant $D$ est donc fini. 

\item[$\bullet$] Si $D=d^2$ est un carr\'e, avec $d>0$, la proposition \ref{discr_carre}, montre que  $f \sim (0,d,c),\ 0 \leq c < d$, et il n'y a qu'un nombre fini $d$ de telles formes. L'ensemble des classes de formes de discriminant $D = d^2\ne 0$ est donc fini.

La proposition \ref{involution} montre que toute classe d'\'equivalence est la r\'eunion de d'une ou deux classes propres. Par cons\'equent, l'ensemble des classes propres de formes de discriminant $D$ est aussi fini. 
\end{proof}

Ceci montre que $\mathrm{Cl}(D)$ et $\mathrm{P}(D)$ sont finis. Notons 
$$h(D) = \vert \mathrm{P}(D) \vert.$$

$h(D)$ n'est d\'efini que pour les valeurs de $D$ qui sont des discriminants, c'est \`a dire pour $D\equiv0,1\ [4]$.

En particulier, $h(D) = 1$ si et seulement si toute forme primitive de discriminant $D$ est \'equivalente \`a la forme principale.
\begin{prop}\label{nbclasses1}
Supposons $h(D)=1$. Alors tout nombre premier impair $p$ tel que $\legendre{D}{p}=1$ est repr\'esent\'e par la forme principale de discriminant $D$.
\end{prop}

\begin{proof}
D'apr\`es la proposition \ref{repr_premier}, $p$ est repr\'esent\'e par une forme $f=(a,b,c)$ de discriminant $D$, donc $p=f(x,y), (x,y)\in \mathbb{Z}^2$. Si $D<0$, les valeurs prises par $f$ sont toutes de m\^eme signe, et cette forme est positive puisque $p>0$.

$f$ est primitive, car  $k=a\wedge b \wedge c \mid p =ax^2+bxy+cy^2$, donc $k=1$ ou $k=p$. Si $k=p$, alors $p\mid a,p\mid b, p \mid c$, donc $p \mid D=b^2-4ac$ , ce qui contredit $\legendre{D}{p}=1$. Donc $k=a\wedge b \wedge c = 1$ : la forme $f$ est primitive.

$h(D)=1$ donc par d\'efinition toute forme primitive de discriminant $D$ (positive si $D<0$) est proprement \'equivalente \`a la forme principale. Le nombre premier $p$ est donc repr\'esent\'e par la forme principale de discriminant $D$.
\end{proof}

Pr\'ecisons quelques valeurs de $D$ pour lesquelles $h(D)=1$ :

\begin{prop}\label{nbclasses2}
Si $\vert D \vert \leq 11$, et $D$ n'est pas un carr\'e, alors $h(D)=1$.
\end{prop}

\begin{proof}
Puisque $D$ n'est pas un carr\'e, et $D\equiv 0,1\ [4]$, l'hypoth\`ese \'equivaut \`a $D \in \{-11,-8,-7,-4,-3,5,8 \}$.

Comme $D<12$, $\sqrt{\frac{\vert D \vert}{3}}<2$. Toute forme quadratique  $f$ de discriminant $D$ (positive si $D<0$) est proprement \'equivalente \`a une forme r\'eduite de Lagrange $(a,b,c)$, v\'erifiant $1\leq \vert a \vert \leq \sqrt{\frac{\vert D \vert}{3}}<2$ (proposition \ref{reduite_lagrange}). Donc $a=1$ ou $a=-1$.

Si $a=1$. Une telle forme repr\'esente 1 : d'apr\`es la proposition \ref{forme_principale}, elle est proprement \'equivalente \`a la forme principale.

Si $D<0$, la forme $f$ est positive, donc $a>0 : a=1$. Il ne reste donc qu'\`a traiter les cas $D=5,8$.

$\bullet$ $D=5$ : la forme $(a,b,c)$ v\'erifie $-1<b\leq 1 \leq \vert c \vert$ : $b=0$ ou $b=1$, et $D=b^2-4ac=5$, donc $b$ est impair : $b=1$, et $c = \frac{b^2-D}{4a}$ : 

$$(a,b,c) = (1,1,-1)\text{ ou } (a,b,c)=(-1,1,1).$$
 Mais ces deux formes sont proprement \'equivalentes :
$$(1,1,-1) \underset{S}{\overset{+}{\sim}} (-1,-1,1) \underset{T^{-1}}{\overset{+}{\sim}} (-1,1,1).$$

Par cons\'equent $h(5)=1$.

$\bullet$ $D=8$ : la forme $(a,b,c)$ v\'erifie $-1<b\leq 1 \leq \vert c \vert$ : $b=0$ ou $b=1$, et $D=b^2-4ac=8$, donc $b$ est pair : $b=0$, et $c = \frac{b^2-D}{4a} = -\frac{2}{a}$ : 

$(a,b,c)  = (1,0,-2)$ ou $(a,b,c) = (-1,0,2)$, elles aussi proprement \'equivalentes :

$(-1,0,2) \underset{T}{\overset{+}{\sim}} (-1,-2,1) \underset{S}{\overset{+}{\sim}} (1,2,-1) \underset{T^{-1} }{\overset{+}{\sim}} (1,0,-2)$.

Donc $h(8)=1$.
\end{proof}

{\bf Exemple.} Nous avons obtenu $h(-4) = 1$. Pour tout nombre premier impair, 
$$1 = \legendre{-4}{p} = \legendre{-1}{p} \iff (-1)^{(p-1)/2} = 1 \iff p\equiv 1 \pmod 4.$$  Les propositions \ref{nbclasses1}  et \ref{nbclasses2} prouvent \`a nouveau la proposition \ref{prop6} :

{\it Soit $p$ un nombre premier impair. Alors $p\equiv1 \pmod 4$ si et seulement s'il existe  un couple d'entiers $(x,y)$ tel que $p = x^2+y^2$. }

De m\^eme $h(-8) = 1$ donne une nouvelle preuve de la proposition \ref{prop14} :

{\it Soit $p$ un nombre premier impair . Alors
 $$\exists x \in \Z,\  \exists y \in \Z, \ p = x^2 + 2 y^2  \iff p \equiv 1 \text{ ou } p \equiv 3 \pmod 8.$$
 }
 
 En effet,
 $$\legendre{D}{p} = 1 \iff \legendre{-2}{p} = 1 \iff p \equiv 1 \text{ ou } p \equiv 3 \pmod 8.$$
 
 L'\'egalit\'e $h(-3) = 1$ montre que tout nombre impair $p$ v\'erifiant $\legendre{-3}{p} = 1$, soit $p\equiv 1 \pmod 3$, est repr\'esent\'e par la forme principale $x^2 + xy + y^2$ de discriminant $D = -3$, donc aussi par la forme \'equivalente $x^2 - xy + y^2$. D'apr\`es le paragraphe \ref{section1_8}, ceci \'equivaut \`a ce que $p$ soit repr\'esent\'e par la forme $x^2 + 3y^2$ (bien que les formes (1,1,1) et (1,0,3) ne soient pas \'equivalentes, d'apr\`es le paragraphe suivant). Nous retrouvons ainsi la proposition \ref{prop19}.
 
 Pour donner un exemple avec $D>0$, puisque $h(8) = 1$, un nombre premier impair est repr\'esent\'e par la forme $x^2 - 2y^2$ si et seulement si $\legendre{2}{p} =1$, soit $p \equiv 1$ ou $p\equiv 7 \pmod 8$.
 
 \section{Classes d'\'equivalence propre de formes positives.}
 
 Soit $f = (a,b,c)$ une forme de discriminant $D<0$. Comme une telle forme est suppos\'ee positive, alors $a>0 ,c>0$.
 \begin{dfn}
 Une forme $(a,b,c)$ de discriminant n\'egatif est dite r\'eduite (au sens de Gauss) si $-a<b\leq a < c$, ou si $0\leq b \leq a = c$.
 \end{dfn}
 La proposition \ref{reduite_lagrange} appliqu\'ee \`a une forme (positive) $f$ de discriminant n\'egatif montre que 
 $$f  \overset{+}{\sim} (a,b,c),\qquad \text{o\`u } -a<b<a\leq c.$$
 Comme $$(a,b,a) \overset{+}{\sim} (a,-b,a) = (a,b,a)\cdot S$$ par \'equivalence \'el\'ementaire, la proposition \ref{reduite_lagrange} montre que toute forme de discriminant n\'egatif est proprement \'equivalente \`a une forme r\'eduite. Il reste \`a prouver l'unicit\'e d'une telle forme r\'eduite.
 
 Le lemme suivant permet de prouver cette unicit\'e, en donnant les deux premi\`eres valeurs repr\'esent\'ees par une forme r\'eduite.
 
 A titre d'exemple pr\'ealable, consid\'erons la forme r\'eduite $(a,b,c)$ d\'efinie par $q(x,y) = x^2 + 5 y^2$. Alors $a=1 = q(1,0)$ est la plus petite valeur repr\'esent\'ee par $q$, et $4 = q(2,0)$ la suivante, mais $(2,0)$ n'est pas primitif, si bien que $c= 5 = q(0,1)$ est la seconde valeur primitivement repr\'esent\'ee par $q$. Ceci explique qu'on ne consid\`ere dans la proposition suivante que les repr\'esentations primitives.
 
 \begin{prop}\label{entiers_representes}
 Soit $q = (a,b,c)$ une forme r\'eduite de discriminant n\'egatif. L'entier $a$ est le plus petit entier repr\'esent\'e par $q$ (et il est alors primitivement repr\'esent\'e par $q$).
 
 De plus,
 \be
 \item[(i)] Si $a<c$, alors l'\'egalit\'e $a = q(u)$ est v\'erifi\'ee par exactement deux vecteurs $u\in \Z^2$, les vecteurs $u = \pm(1,0)$. Dans ce cas, $c$ est la seconde valeur primitivement repr\'esent\'ee  par $q$. De plus l'\'egalit\'e $c = q(v)$ est v\'erifi\'ee par exactement deux vecteurs  primitifs $v \in \Z^2$ si $b \ne a$. Dans le cas $b =a$, elle est v\'erifi\'ee par quatre tels vecteurs. 
 \item[(ii)] Si $a=c$, alors l'\'egalit\'e $a = q(u)$ est v\'erifi\'ee par exactement quatre vecteurs primitifs $u \in \Z^2$ si $a\ne b$, et par six si $a=b$.
 \ee

 \end{prop}

 \begin{proof} 
 Notons que les seuls vecteurs primitifs $(x,y)$ tels que $y=0$ sont $(1,0)$ et $(-1,0)$,  et que $a$ est repr\'esent\'e primitivement par ces vecteurs.
 
 Partons de l'\'egalit\'e, v\'erifi\'ee par tout $(x,y) \in \Z^2$,
 $$4aq(x,y) = (2ax + by)^2 - D y^2.$$
Si $|y| \geq 2$, puisque $D<0$, nous obtenons $a q(x,y) \geq -D = 4ac-b^2$. La forme $q$ \'etant r\'eduite, $b^2 \leq a^2 \leq ac$, donc $aq(x,y) \geq 3ac$, soit $q(x,y) \geq 3c >c$ (donc $q(x,y)>a$).

Reste le cas $y = \pm 1$. 

Si $y=1$, $4aq(x,1) = (2ax+b)^2 - D$. Comme $-a <b \leq a$, $a \geq |b|$.

Si $x=0$, $|2ax + b | = |b|$, et si $|x|\geq 1$,
\begin{align}\label{eq6.3}
|2ax + b| \geq |2ax| - |b| \geq 2a - |b| \geq |b|.
\end{align}
Par cons\'equent, pour tout $x \in \Z$, $|2ax +b | \geq |b|$, et donc
$$q(x,1) \geq \frac{b^2 - D}{4a} = c.$$
En remplaçant $b$ par $-b$, on obtient de m\^eme $q(x,-1) \geq c$.

Comme $a\leq c$, $a$ est le plus petit entier repr\'esent\'e par $q$.

V\'erifions l'\'equivalence
 $$q(x,1) = c\iff x=0 \text{ ou }(x=-1 \text{ et } a=b).$$

Supposons $q(x,1) = c$ et $x \ne 0$. Alors $|x| \geq 1$, et 
$$4a q(x,1) = (2ax + b)^2 - (b^2 - 4ac) = 4ac,$$
donc $|2ax +b| = |b|$, ce qui implique que les in\'egalit\'es dans (\ref{eq6.3}) sont toutes des \'egalit\'es, soit
\begin{align}\label{eq6.4}
|2ax + b| = |2ax| - |b| = 2a - |b| = |b|, 
\end{align}
par cons\'equent $|x|= 1$.

Si $x= 1$, alors $2ax + b = 2a +b >0$, donc les \'egalit\'es (\ref{eq6.4}) donnent $2a + b = 2a -|b|$, soit $b = -|b|$, et donc $b\leq 0$, et aussi $2a +b = -b$, donc $a = -b$, ce qui est impossible pour une forme r\'eduite.

Si $x = -1$, $2ax + b = -2a +b <0$. Les \'egalit\'es (4) donnent alors $2a - b = 2a -|b|$, soit $b = |b| \geq 0$, ce qui donne $2a - b = b$ , et $a=b$.

R\'eciproquement, si $x = 0$, alors $q(0,1) = c$, et si $x = -1$ et $a = b$, $q(-1,1) = a - b + c = c$.

Ainsi l'\'egalit\'e $q(x,1) = c$ \'equivaut \`a $x = 0$, ou $x = -1$ et $a=b$. De m\^eme, en remplaçant $b$ par $-b$, $q(x,-1) = c$ \'equivaut \`a $x = 0$, ou $x = 1$ et $a=b$.

Traitons alors les deux cas de la proposition \ref{entiers_representes}.
\be
\item[(i)] Si $a<c$, alors pour tout $y\ne 0$, $q(x,y) \geq c >a$, donc $q(x,y) = a$ n'est possible que si $y=0$, et $q(x,0) = ax^2 = a$ donne $x= \pm 1$. Ainsi l'\'egalit\'e $a = q(u)$ est v\'erifi\'ee par exactement deux vecteurs $u\in \Z^2$, les vecteurs $u = \pm(1,0)$. Comme $q(x,y) \geq c$ si $y\ne 0$, $c$ est la seconde valeur repr\'esent\'ee primitivement par $q$ (les nombres strictement compris entre $a$ et $c$ sont de la forme $q(x,0), |x|>1$ et ne sont sont pas primitivement repr\'esent\'es par $q$), et elle est repr\'esent\'ee primitivement par les vecteurs $(0,\pm1)$. De plus, si $(x,y)$ est primitif, $q(x,y) = c$ n'est possible que si $y =\pm 1$. Dans le cas $a \ne b$, alors $x = 0$, et donc $c$ est repr\'esent\'e uniquement par les deux vecteurs $(0,1),(0,-1)$. Si $a = b$, alors $c$ est repr\'esent\'e par les quatre vecteurs $(0,1),(0,-1),(1,-1),(-1,1)$, et par aucun autre vecteur.
\item[(ii)] Supposons maintenant $a= c$. L'\'egalit\'e $a = c = q(x,y)$ n'est possible que si $y \in\{0,1,-1\}$. Si $y = 0$, $x = \pm 1$, et si $y = \pm1$, il n'y a pas d'autre solution que $x = 0$ si $a\ne b$. Enfin dans le cas $a=b=c$, on obtient les solutions suppl\'ementaires $(1,-1),(-1,1)$. Ainsi $a =c$ est repr\'esent\'e par quatre vecteurs $(\pm 1, 0),(0, \pm1)$ si $b \ne a = c$, et par six vecteurs $(0,1),(0,-1),(1,0)(-1,0),(1,-1),(-1,1)$ si $a=b=c$.
\ee
 \end{proof}
 

 
 \begin{prop}
 Une forme de discriminant n\'egatif est proprement \'equivalente \`a une unique forme r\'eduite.
 \end{prop}
 
\begin{proof}
Supposons que $q=(a,b,c)$ et $q'=(a',b',c')$ soient des formes de discriminant $D<0$, r\'eduites et proprement \'equivalentes. Deux formes \'equivalentes repr\'esentent primitivement les m\^emes valeurs, et chacune le m\^eme nombre de fois. Par cons\'equent elles ont le m\^eme minimum, donc $a = a'$. Montrons que $c= c'$. Si $a =a'$ est repr\'esent\'e deux fois, par $q$ aussi bien que par $q'$, alors $c$ est la seconde valeur repr\'esent\'ee primitivement par $q$, et $c'$ la seconde valeur repr\'esent\'ee primitivement par $q'$. Comme les valeurs primitivement repr\'esent\'ees par $q$ et $q'$ sont les m\^emes, alors $c= c'$. Dans le cas restant $a = a'$ est repr\'esent\'e $4$ ou $6$ fois par $q$ et $q'$, ce qui par la proposition \ref{entiers_representes} implique que $a = c$ et $a' = c'$, donc $c=c'$. Dans les deux cas, $a=a'$ et $c=c'$. Enfin $D = b^2 - 4ac = b'^2-4a'c'$, donc $b^2 = b'^2$, et donc $b = \pm b'$.

Si $a =c$, alors $a' = c'$, et la d\'efinition d'une forme r\'eduite montre que $b>0$ et $b'>0$, donc $b=b'$.

Si $a<c$, d'apr\`es la proposition \ref{entiers_representes}(i), $a = b$ si et seulement si $a' = b'$.

Si $a = b$, alors $a' = b'$ d'apr\`es la proposition \ref{entiers_representes}(i). Puisque $a = a'$, alors $b = b'$.

Enfin si $a\ne b$, alors $a' \ne b'$, donc $a$ et $c$ sont repr\'esent\'es exactement deux fois primitivement, $a = q(\pm(1,0))$ et $c =q(\pm(0,1))$. Comme $q \overset{+}{\sim} q'$, $q'(x,y) = q(xu+yv)$ avec $\det(u,v) = 1$. Alors
$$a = a' = q'(1,0) = q(u), c =c' = q'(0,1) = q(v),$$
par cons\'equent $u= \pm(1,0), v = \pm(0,1)$. Puisque $\det(u,v) = 1$, les signes sont les m\^emes : $u = (1,0),v = (0,1)$, ou $u = (-1,0), v = (0,-1)$, ce qui donne $q'(x,y) = q(x,y)$ dans le premier cas, $q'(x,y) = q(-x,-y)$ dans le deuxi\`eme cas. Comme $q(-x,-y) = q(x,y)$, la conclusion est $q= q'$.
\end{proof}

Ainsi pour calculer $\mathrm{Cl}(D)$ pour $D<0$ donn\'e, il suffit de d\'eterminer le nombre de triplets $(a,b,c) \in \Z^3$ d\'efinissant une forme r\'eduite de discriminant $D$. Pour chaque $b \in \Z$ v\'erifiant $b \equiv D \pmod 2$ et  $b\ \leq \sqrt{\frac{-D}{3}}$, on factorisera $\frac{b^2 - D}{4}$ sous la forme $ac$ avec $|b| \leq a \leq c$.
 
 
 \section{Repr\'esentation d'un nombre premier par la forme $x^2 + 5y^2$.}\label{section6.7}
A titre d'exemple, cherchons les nombres repr\'esent\'es par la forme $x^2 + 5y^2$, de discriminant $-20$.

Calculons $h(D)$ pour $D = -20$. Alors $|b| \leq \sqrt{\frac{-D}{3}} <3$, donc $|b| \leq 2$, et $b \equiv D \pmod 2$ est pair : $b \in \{-2,0,2\}$.
 
 Si $b = 0$, $\frac{b^2-D}{4} = 5 = ac, a \leq c$ donne l'unique factorisation $a=1, c = 5$ : on obtient la forme principale $(1,0,5)$.
 
 Si $b = 2$, $\frac{b^2-D}{4} = 6 = ac, |b| \leq a \leq c$ donne $a = 2, c = 3$, soit la forme $(2,2,3)$.
 
 Si $b = -2$, $\frac{b^2-D}{4} = 6 = ac, |b| \leq a \leq c$ donne $a = 2,c = 3$, soit la forme $(2,-2,3)$. Mais cette forme n'est pas r\'eduite car elle ne v\'erifie pas $-a < b$.
 
 Les deux formes $(1,0,5), (2,2,3)$ sont r\'eduites et distinctes : elles ne sont donc pas \'equivalentes. Ainsi $\mathrm{Cl}(-20)$ est constitu\'e de deux classes distinctes, les classes de $x^2+5y^2$ et de $2x^2 + 2xy + 3 y^2$. Ces formes sont primitives, donc $h(-20) = 2$.
 
 La proposition \ref{repr_premier} montre que tout nombre premier impair $p$ tel que $-20$ est un carr\'e modulo $p$ (autrement dit tel que $-5$ est un carr\'e modulo $p$) est repr\'esent\'e par une unique forme de discriminant $-20$, donc $p$ est de la forme $p = x^2 + 5 y^2$ ou $p = 2x^2 + 2xy + 3y^2$, ces deux cas s'excluant mutuellement. 
 
 En utilisant la loi de r\'eciprocit\'e quadratique, on obtient pour $p$ premier impair l'\'equivalence $\legendre{-5}{p} = 1 \iff p\equiv 1,3,7,9 \pmod{20}$.
 
 Ainsi les nombres premiers $p$ tels que $p\equiv 1,3,7,9 \pmod{20}$ sont de la forme $p = x^2 + 5 y^2$ ou $p = 2x^2 + 2xy + 3y^2$, ces deux cas s'excluant mutuellement.
 
 Notons que si $p = 2x^2 + 2xy + 3y^2$, alors $2p = 4x^2 + 4xy + 6 y^2 = (2x + y)^2 + 5 y^2 = a^2 + 5b^2$, o\`u $a =  2x + y, b = y$.
 
 Inversement, si $2p = a^2 + 5b^2$, ($p$ premier impair), alors la r\'eduction modulo 4 montre que $a,b$ sont impairs : on peut donc poser $a = b + 2c, c \in \Z$. Alors $2p = (b + 2c)^2 + 5 b^2 = 2(2c^2 + 2bc +3b^2)$, et $p = 2c^2 + 2bc +3b^2$ est repr\'esent\'e par la forme $2x^2 + 2xy + 3y^2$. On a ainsi prouv\'e :
 
 {\it Si $p$ est un nombre premier impair, $p$ est repr\'esent\'e par la forme $2x^2 + 2y^2 + 3y^2$ si et seulement si $2p$ est repr\'esent\'e par la forme $x^2 + 5y^2$. }
 
 Si $p$ est un nombre premier tel que $p \equiv 1,3,7,9 \pmod{20}$, alors soit $p$ soit $2p$ est repr\'esent\'e par la forme $x^2 + 5y^2$, ces deux cas s'excluant mutuellement.
 
R\'eciproquement, notons que si $p$ ou $2p$ est repr\'esent\'e par la forme $x^2 + 5 y^2$ ($p$ premier impair diff\'erent de $5$), alors $-5$ est un carr\'e modulo $p$, donc $p \equiv 1,3,7,9 \pmod{20}$.
 
 On peut s\'eparer ces deux cas en examinant les congruences modulo 4. Si $2p = x^2 + 5y^2$, on a vu que $x,y$ sont impairs, donc $x^2 = (2k +1)^2 = 8 \frac{k(k+1)}{2} + 1 \equiv 1 \pmod 8$, donc $2p \equiv 6 \pmod 8$, soit $p\equiv 3 \pmod 4$, et donc $p \equiv 3,7 \pmod{20}$. Si $p = x^2 + 5 y^2$, alors $p,q$ sont de parit\'e oppos\'ees, $p =x^2 + 5y^2 \equiv x^2 + y^2 \equiv 1 \pmod 4$, et donc $p \equiv 1,9 \pmod 8$.
 
 Le r\'esultat prouv\'e dans ce paragraphe (et conjectur\'e par Euler) peut donc s'\'enoncer:
 
 \begin{prop}
 Soit $p\ne 5$ un nombre premier impair. Alors
 
 $p$ est de la forme $x^2 + 5y^2$ si et seulement si $p\equiv 1,9 \pmod{20}$,
 
 $2p$ est de la forme $x^2 + 5y^2$ si et seulement si $p\equiv 3,7 \pmod{20}$.
 
 \end{prop}
 
 
\begin{subappendices}

\section{R\'ecr\'eation informatique.}
\subsection{Calcul de la forme r\'eduite d'une forme quadratique.}
Donnons d'abord une mini-classe donn\'ee dans le module {\bf matrices.py} pour manipuler les matrices $2\times2$.
\begin{verbatim}
class Matrice:

    def __init__(self, m =[[1,0],[0,1]]):
        self.m = m
    
    def __repr__(self):
        return "\n" + f"{self.m[0]}"+  "\n" +  f"{self.m[1]}" + "\n"
        
    def __add__(self, other):
        A = self.m
        B = other.m
        return Matrice([[A[0][0] + B[0][0], A[0][1] + B[0][1]],
                        [A[1][0] + B[1][0], A[1][1] + B[1][1]]])
                        
    def __mul__(self, other):
        A = self.m
        B = other.m
        return Matrice([[A[0][0] * B[0][0] + A[0][1] * B[1][0],
                         A[0][0] * B[0][1] + A[0][1] * B[1][1]],
                        [A[1][0] * B[0][0] + A[1][1] * B[1][0],
                         A[1][0] * B[0][1] + A[1][1] * B[1][1]]])
                         
    def det(self):
        A = self.m
        return A[0][0] * A[1][1] - A[1][0] * A[0][1]
    
    def tableau(self):
        return self.m
                        
if __name__ == "__main__":
    A = Matrice([[2, 3], [5, 7]])
    B = Matrice([[-1, 4], [2, 8]])
    print(A * B)
\end{verbatim}

Alors la fonction {\bf reduce} du module {\bf quadratic.py} retourne la forme r\'eduite d'une forme quadratique $f = (a,b,c)$, ainsi que la matrice $S \in \mathrm{SL}_2(\Z)$ permettant de passer de $f$ \`a la forme r\'eduite.

\begin{verbatim}
from matrices import Matrice

def is_reduced(a,b,c):
    """ determine si la forme q = (a, b, c) est reduite (D < 0)
    """
    if not(abs(b) <= a and a <= c):
        return False
    if abs(b) == a or a == c:
        return b >= 0
    return True

def discriminant(q):
    (a,b,c) = q
    return(b*b - 4*a*c)
    
def reduce(q, s = 0):
    """
    retourne la forme r\'eduite de q (D < 0),
    ainsi que la matrice de SL_2(Z) qui transforme l'entree
    en forme reduite.
    Faire s = 1 pour afficher les r\'esultats intermediaires.
    """
    a, b, c = q
    G = Matrice([[1,0],[0,1]])
    while not is_reduced(a, b, c):
        if c < a:
            (a, b, c) = (c, -b, a)
            G = G * Matrice([[0, 1],[-1, 0]])
        elif abs(b) > a or -b == a:
            k = (a - b) // (2 * a)
            c = a * k * k + b * k + c
            b = b + 2 * k * a
            G = G * Matrice([[1, k ],[0, 1]])
        if s:
            print( (a, b, c), G)
    return (a, b, c), G
    
if __name__ == '__main__':
    f = (55,24,7)
    g, G = reduce(f,1)
    print(g)
    print('G = ', G)
\end{verbatim}

\subsection{D\'ecomposition d'un nombre premier en somme de deux carr\'es.}
La fonction  {\bf reduce} donne un novel algorithme efficace de d\'ecomposition en somme de deux carr\'es d'un nombre premier $p\equiv 1 \pmod 4$.

\begin{verbatim}
from random import randint
from quadratic import reduce
from matrices import *
from numtheory import isprime, jacobi


def racine_de_moins_un(p):
    pas_trouve = True
    while pas_trouve:
        a = randint(2, p - 2)
        b = pow(a, (p - 1)//4, p)
        if (b * b) % p == p-1:
            pas_trouve = False
    if 2 * b > p:
        b = b - p
    return b    
    
def decomposition(p):
    assert isprime(p), "p non premier"
    assert p % 4 == 1, "p premier non congru \`a 1 modulo 4"
    k = racine_de_moins_un(p)
    q = p, 2*k, (k**2 + 1) //p
    f, G = reduce(q)
    g = G.tableau()
    return abs(g[1][0]), abs(g[1][1])


if __name__ == "__main__":
    ttest = [13, 101, 10009, 11213,  100049, 1000000009,
             1234567891234567891234567909, 10**50 + 577, 10**100 + 949]
    for p in ttest:
        a,b = decomposition(p)
        assert p == a**2 + b**2, "erreur test"
        print(p,'=>', a, b)

\end{verbatim}

\subsection{Nombre de classes.}
Le programme suivant du module  {\bf nombreDeClasses} permet d'obtenir les formes r\'eduites de discriminant $D<0$, ainsi que le nombre de classes $h(D)$.
\begin{verbatim}
from math import sqrt
from numtheory import pgcd, isprime, ifactors

def divisors_naif(n):
    l = []
    for d in range(1, n + 1):
        if n % d == 0:
            l.append(d)
    return l
    
def formes_reduites(D):
    assert (D % 4 == 0 or D % 4 == 1) and D < 0
    maxi = int(sqrt(-D/3.0))
    lformes =[]
    for b in range(-maxi, maxi + 1):
        if (D - b)  % 2 == 0:
            n = (b * b - D) //  4
            ldiv = divisors_naif(n)
            for a in ldiv:
                c = n // a
                if -a < b <= a <= c:
                    if a != c or (a == c and b >=0):
                        if pgcd(a,pgcd(b,c)) == 1:
                            lformes.append((a,b,c))
    return lformes
    
def h(D):
    return len(formes_reduites(D))
    
if __name__ == "__main__": 
    for k in range(1,2001):
        D = -4*k+1
        u = h(D)
        if u !=1:
            print(D,'\t=>',u)
        D = -4*k
        u = h(D)
        if u != 1:
            print(D,'\t=>',u)
\end{verbatim}
\end{subappendices}


\chapter{Le groupe des classes.}

Sources : [Cox2] (chapitre 1),[ Flath] (chapitre 5).

\medskip

Donnons une premi\`ere pr\'esentation de la composition des classes de formes quadratiques, th\'eoris\'ee par Gauss, en suivant les sources pr\'ecit\'ees. Une autre approche sera d\'evelopp\'ee dans le chapitre ``Formes quadratiques et id\'eaux''.

\section{Composition des formes.}\label{composition}
\begin{dfn}
Soient $q$ et $q'$ deux formes positives primitives de discriminant $D$. Une compos\'ee de $q$ et $q'$ est une forme primitive $q''$ de discriminant $D$ telle qu'il existe deux applications $f,g : \Z^2 \times \Z^2 \to \Z$ satisfaisant l'\'egalit\'e entre polynômes formels
$$q(x,y) q'(x',y') = q''(f((x,y),(x',y')), g((x,y),(x',y'))),$$
o\`u $f,g$ sont $\Z$-bilin\'eaires, i.e.
\begin{align*}
f((x,y),(x',y')) &= a_1 xx'+b_1xy'+ c_1 yx'+ d_1 yy',\\
g((x,y),(x',y')) &= a_2 xx'+b_2xy'+ c_2 yx'+ d_2 yy'\\
\end{align*}
avec $a_1,b_1,c_1,d_1,a_2,b_2,c_2,d_2 \in \Z$.
\end{dfn}

Donnons pour exemple cette formule utilis\'ee par Lagrange dans l'\'etude des nombres repr\'esent\'es par la forme $x^2 + 5y^2$ :
$$(x^2 + 5y^2)(2x'^2 + 2x'y' + 3y'^2) = 2X^2 + 2XY + 3Y^2,$$
o\`u
$$
\left\{
\begin{array}{cccl}
X &= &f((x,y),(x',y'))  &= xx' - yx' - 3yy',\\
Y&= &g((x,y),(x',y'))&= xy' + 2yx' + yy'.
\end{array}
\right.
$$

\begin{prop}
\item[(i)] Si $q''$ est une compos\'ee de $q$ et $q'$, alors toute forme \'equivalente \`a $q''$ est aussi une compos\'ee de $q,q'$.

\item[(ii)] $q''$ est une compos\'ee de toute forme \'equivalente \`a $q$ et de toute forme \'equivalente \`a $q'$. 

\end{prop} 

\begin{proof}
\item[(i)] Ecrivons la composition de $q,q'$ sous la forme
$$q(X) q'(X') = q''(f(X,X'), g(X,X')),\qquad X = (x,y), X' = (x',y') \in \Z^2.$$

Si $q''' \sim q''$, alors il existe $a,b,c,d \in \Z$ v\'erifiant $ad-bc =\pm 1$ et $${q''(x,y) = q'''(ax+by,cx+dy)}.$$
 Par cons\'equent, pour tout $X,Y \in \Z^2$,
$$q(X) q'(X') = q'''(F(X,X'),G(X,X')),$$
o\`u $F,G$ d\'efinies, pour $X, X'\in \Z^2$ par
$$F(X,X') = af(X,X') +bg(X,X'),\quad G(X,X') = cf(X,X') +dg(X,X')$$
sont $\Z$-bilin\'eaires.

\item[(ii)]Si $q_1\sim q, q_2 \sim q'$, alors $q(PX_1) = q_1(X_1), q'(QX_2) =q_2(X_2)$, o\`u  $P,Q$  sont unimodulaires. Nous obtenons, en remplaçant $X,X'$ par $PX_1,QX_2$,
$$q_1(X_1) q_2(X_2) = q''(f(PX_1,QX_2), g(PX_1,QX_2)) = q''(F(X_1,X_2),G(X_1,X_2)),$$
o\`u $F,G$ d\'efinies par $F(X_1,X_2) = f(PX_1,QX_2), G(X_1,X_2) = g(PX_1,QX_2)$ sont $\Z$-bilin\'eaires, ce qui prouve que $q''$ est bien une compos\'ee de $q_1,q_2$.

\end{proof}

Nous prouverons que deux formes primitives $q,q'$ de m\^eme discriminant $D \ne 0$ admettent toujours une compos\'ee.



\section{L'identit\'e de base.}
Partons d'une composition de formes particuli\`eres, qui nous permettra de composer des formes quelconques en utilisant l'\'equivalence de formes.
\begin{prop} 
{\bf Identit\'e de base.}\label{basic_identity}

Soient $a,a',b,c \in \Z$, et $x,y,x',y'$ des ind\'etermin\'ees. Alors
\begin{align}\label{eq7.1}
(a x^2 + b xy + a'c y^2)(a'x'^2 + b x'y' + ac y'^2) = aa'X^2 + b XY + c Y^2,
\end{align}
o\`u
$$
\left\{
\begin{array}{rl}
X &= xx' -c yy',\\
Y &= axy' +a' yx' + b yy'.
\end{array}
\right.
$$
\end{prop}

\begin{proof}
Notons que les trois formes quadratiques 
\begin{align*}
f(x,y) &= a x^2 + b xy + a'c y^2,\\
g(x',y') &= a'x'^2 + b x'y' + ac y'^2,\\
h(X,Y) &= aa'X^2 + b XY + c Y^2.
\end{align*}
figurant dans la formule \ref{eq7.1} ont m\^eme discriminant $D = b^2 - 4aa'c$.
Notons $\sqrt{D}$ une racine dans $\C$ du discriminant $D$. La mise sous forme canonique de $f$ et $g$ donne
\begin{align*}
af(x,y) &=\left(ax + \frac{b}{2}y\right)^2 - \frac{D}{4} y^2\\
&=\left(a x + \frac{b + \sqrt{D}}{2}y \right)\left(a x + \frac{b - \sqrt{D}}{2}y \right)\\
&=( ax+ \tau y) (a x + \tau' y),
\end{align*}
o\`u
$$\tau =  \frac{b + \sqrt{D}}{2},\qquad  \tau' =  \frac{b - \sqrt{D}}{2}.$$
De m\^eme,
$$a'g(x',y') = (a'x'+ \tau y')(a'x'+\tau' y').$$
Alors
\begin{align*}
aa'f(x,y) g(x',y') &= [( ax+ \tau y) (a'x'+ \tau y')]\,  [(a x + \tau' y)(a'x'+\tau' y')]\\
&= P Q,
\end{align*}
o\`u
$$P = (ax+ \tau y)(a'x'+ \tau y'), Q = (a x + \tau' y)(a'x'+\tau' y').$$
Calculons les produits $P,Q$.
\begin{align*}
P &= \left(a x + \frac{b + \sqrt{D}}{2}y \right) \left(a' x' + \frac{b + \sqrt{D}}{2}y \right)\\
&=aa' xx' + \frac{b + \sqrt{D}}{2} a'x'y +\frac{b + \sqrt{D}}{2} axy' + \left(\frac{b + \sqrt{D}}{2}\right)^2 yy'\\
&=aa'xx' + \frac{b}{2} (a'x'y + axy') + \frac{b^2+D}{4}yy' + \frac{\sqrt{D}}{2} (a'x'y +a xy' +byy')\\
&=aa'xx' + \frac{b}{2} (a'x'y + axy'+byy') + \frac{-b^2+D}{4}yy' + \frac{\sqrt{D}}{2} (a'x'y +a xy' +byy')\\
&=aa'(xx' -cyy') + \frac{b+\sqrt{D}}{2} (a'x'y +a xy' +byy')\\
&= aa' X + \tau Y.
\end{align*}
En remplaçant dans ce calcul $\sqrt{D}$ par l'autre racine $-\sqrt{D}$, nous obtenons ${Q= aa' X + \tau' Y}$. Ainsi
\begin{align*}
aa'f(x,y) g(x',y') &= (aa' X + \tau Y)(aa' X + \tau' Y)\\
&=\left( aa' X + \frac{b+\sqrt{D}}{2} Y \right)\left( aa' X + \frac{b-\sqrt{D}}{2} Y \right)\\
&= \left(aa'X + \frac{b}{2}Y\right)^2 - \frac{D^2}{4} Y^2\\
&=a^2a'^2 X^2 + baa' XY + \left[\frac{b^2}{4} - (b^2 - 4aa'c)\right] Y^2\\
&= aa'(aa'X^2 + bXY + cY^2).
\end{align*}
Ainsi, dans le cas o\`u $aa' \ne 0$,
\begin{align*}
f(x,y) g(x',y') &= aa'X^2 + bXY + cY^2.
\end{align*}
Si $a =0$, alors
\begin{align*}
f(x,y) g(x',y') = (bxy +a'c y^2)(a'x'^2 + b x'y') & = x'y (bx + a'cy) (a'x' +by'),
\end{align*}
et $Y = y(a'x' + by')$, donc
\begin{align*}
h(X,Y) = bXY + cY^2 &= Y(bX + cY)\\
&= y(a'x'+by') (bxx' - bc yy' + cy(a'x' + by'))\\
&= y(a'x' + b' y')(bxx'+cya'x')\\
&= x' y (ax'+b'y)(bx +a'cy)\\
&=f(x,y) g(x',y').
\end{align*}
Par sym\'etrie, l' \'egalit\'e \ref{eq7.1} est vraie si $a' = 0$. Elle est donc vraie dans tous les cas.
\end{proof}

Remarque : l'\'egalit\'e \ref{eq7.1} est en fait une identit\'e dans $\Q[a,a',b,c,x,y,x',y']$, comme on le v\'erifie avec les instructions Sage suivantes.
\begin{verbatim}
R.<a,b,c,a1,b1,x,y,x1,y1> = QQ[]
A = (a*x^2 + b*x*y + a1*c*y^2)*(a1*x1^2 + b*x1*y1 + a*c* y1^2)
X,Y = x*x1 - c*y*y1, a*x*y1 + a1*y*x1 + b*y*y1
B = a*a1*X^2 + b*X*Y + c*Y^2; B
\end{verbatim}
$$a a_{1} c^{2} y^{2} y_{1}^{2} + a_{1}^{2} c y^{2} x_{1}^{2} + a_{1} b c
y^{2} x_{1} y_{1} + a^{2} c x^{2} y_{1}^{2} + a b c x y y_{1}^{2} + a
a_{1} x^{2} x_{1}^{2} + a_{1} b x y x_{1}^{2} + a b x^{2} x_{1} y_{1} +
b^{2} x y x_{1} y_{1}$$
\begin{verbatim}
A==B
\end{verbatim}
\begin{center}
True
\end{center}
Le calcul donn\'e dans la d\'emonstration de la proposition \ref{basic_identity} montre comment on parvient \`a mettre en \'evidence une telle identit\'e.

\section{Formes concordantes.}
Nous nous int\'eressons dans la suite aux formes quadratiques enti\`eres de m\^eme discriminant $D$. Si $f = (a,b,c)$ est une telle forme v\'erifiant $a\ne 0$, alors $c$ est d\'etermin\'e par $a,b$, puisque $c = \frac{b^2-D}{4a}$. Nous noterons alors $f = (a,b,*)$.
\begin{dfn}
Deux formes $f_1=(a_1,b_1,c_1)$ et $f_2 = (a_2,b_2,c_2)$ de discriminant $D$ sont dites concordantes si les trois conditions suivantes sont v\'erifi\'ees.
\item[(i)] $a_1 a_2 \ne 0$.
\item[(ii)] $b_1 = b_2$.
\item[(iii)] $a_2 \mid c_1$ et $a_1 \mid c_2$.
\end{dfn}

Si $f_1,f_2$ sont concordantes, leur compos\'ee directe $f_1 * f_2$ est d\'efinie par $f_1 * f_2 = (a_1a_2,b,c)$, o\`u $b = b_1 = b_2$ et $c = \frac{b-D^2}{4a_1a_2}$. Puisque le discriminant de $f_1 * f_2$ est \'egal \`a $D$, on peut noter
\begin{align}\label{def_comp}
(a_1,b,*) * (a_2,b,*) = (a_1a_2, b, *).
\end{align}

Alors $f = f_1*f_2$ est bien une composition de formes, au sens du paragraphe \ref{composition}. Notons $b = b_1 = b_2$ et $c = c_1/a_2$. Alors $c = c_2/a_1$, puisque $D = b^2 - 4a_1c_1 = b_2 - 4 a_2c_2$. Ainsi,  d'apr\`es la proposition \ref{basic_identity},
\begin{align*}
f_1(x,y) f_2(x',y') &= (a_1 x^2 + b_1 xy +c_1 y^2)(a_2 x'^2 + b_2 x'y' +c_2 y'^2)\\
&= (a_1 x^2 + b xy +a_2c y^2)(a_2 x'^2 + b x'y' +a_1c y'^2)\\
&= a_1a_2 X^2 + b XY + c Y^2\\
&= (f_1 * f_2)(X,Y),
\end{align*}
o\`u
$$
\left\{
\begin{array}{rl}
X &= xx' -c yy',\\
Y &= axy' +a' yx' + b yy'.
\end{array}
\right.
$$
Ainsi, si l'entier $m$ est repr\'esent\'e par $f_1$, et l'entier $n$ par $f_2$, alors $m = f(x_1,y_1)$, o\`u $ (x_1,y_1) \in \Z^2$, et $n = f_2(x'_1,y'_1)$, o\`u $(x'_1,y'_1) \in \Z^2$. 

Par cons\'equent $mn =(f_1*f_2)(X_1,Y_1),\ (X_1,Y_1) \in \Z^2$, est repr\'esent\'e par $f_1 * f_2$. Nous avons prouv\'e la proposition suivante.
\begin{prop}
Si deux formes concordantes $f_1$ et $f_2$ repr\'esentent les entiers $m$ et $n$ respectivement, alors la compos\'ee $f_1 * f_2$ repr\'esente le produit $mn$.
\end{prop}

\begin{prop}\label{primitive2}
Si $f_1, f_2$ sont des formes concordantes primitives, alors $f_1 * f_2$ est primitive.
\end{prop}
\begin{proof}
Soient $f_1 = (a_1,b_1,c_1), f_2 = (a_2,b_2,c_2)$ des formes concordantes primitives. Alors il existe $b,c \in \Z$ tel que
$$f_1 = (a_1,b,a_2c),\qquad f_2 = (a_2,b,a_1c),\qquad f_1* f_2 = (a_1a_2,b,c).$$
Si $f_1*f_2$ n'\'etait pas primitive, il existerait un nombre premier $p$  v\'erifiant $p \mid a_1a_2,\ p\mid b,\ p \mid c$, alors $p\mid a_1$ ou $p\mid a_2$.

Si $p\mid a_1$, alors $p \mid a_1,\ p \mid b_1 = b$, et aussi $p \mid c_1 = a_2c$, puisque $p\mid c$. C'est impossible puisque $a_1 \wedge b_1 \wedge c_1 = 1$.

Si $p\mid a_2$, alors $p \mid a_2, p \mid b_2 = b$, et aussi $p \mid c_2 = a_1c$. C'est impossible puisque $f_2$ est primitive.

Cette contradiction montre que $f_1*f_2$ est primitive.
\end{proof}

\section{Structure de groupe sur $P(D)$.}
Rappelons que selon la d\'efinition \ref{def16}, on d\'esigne par $\mathrm{P}(D)$ l'ensemble des classes d'\'equivalence propre de formes primitives (ces formes \'etant positives si $D<0$).

 Le lemme suivant est dû \`a une remarque de Gauss.
 
 \begin{prop}\label{prop180}
 Soit $M\geq 1$ un entier, et $f(x,y)$ une forme primitive. Alors $f$ repr\'esente primitivement au moins un entier non nul premier \`a $M$.
 \end{prop}
 \begin{proof}
 Notons $f =(a,b,c)$, o\`u $a \wedge b \wedge c = 1$. Etablissons d'abord que, si $M = p$ est un nombre premier, alors $f$ repr\'esente au moins un entier qui n'est pas un multiple de $p$. Dans le cas contraire, $f(u,v) = au^2 + buv +cv^2 \equiv 0 \pmod p$ pour tout $u$, tout $v$ de $\Z$. Alors $a = f(1,0) \equiv 0 \pmod p$, $c = f(0,1) \equiv 0 \pmod p$, et $a+b+c = f(1,1) \equiv 0 \pmod c$, donc $b = (a+b+c) -a -c \equiv 0 \pmod p$, ce qui contredit le fait que $f = (a,b,c)$ est primitive. Donc $f$ repr\'esente un entier premier avec $p$.
 
 Maintenant soit $M$ est un entier arbitraire. 
 Si $M= 1$, n'importe quel nombre non nul primitivement repr\'esent\'e par $f$ convient. Supposons maintenant $M>1$.
La d\'ecomposition en facteurs premiers s'\'ecrit $M = \prod_{i=1}^l p_i^{a_i}$. 
 
 Pour tout diviseur premier $p_i$ de $M$, il existe $(u_i,v_i) \in \Z^2$ tel que $f(u_i,v_i) \not \equiv 0 \pmod {p_i}$. Le lemme chinois permet d'obtenir un entier $u \in \Z$ tel que $u\equiv u_i \pmod {p_i}\ (1\leq i \leq l)$, et un entier $v \in \Z$ tel que $v \equiv v_i \pmod {p_i}\ (1\leq i \leq l)$. Alors pour tout diviseur premier $p_i$ de $M$, 
 $$f(u,v) \equiv f(u_i,v_i) \not \equiv 0 \pmod{p_i},$$
 ce qui prouve que $m = f(u,v)$ est premier avec $M$ (et $M \ne 0$ puisque $p_1 \nmid n$).
 
 Rien ne prouve que cette repr\'esentation est primitive. N\'eanmoins, posons $d = u \wedge v$. Alors $u = d u', v = dv'$, et $u'\wedge v' = 1$. Alors $d^2 f(u',v') = m$, donc $d^2 \mid m$. Ainsi l'entier $m' = m/d^2$ est premier avec $M$, et $m' = f(u',v')$ est primitivement repr\'esent\'e par $f$.
 \end{proof}
 

Montrons maintenant que deux formes quadratiques quelconques de $\mathrm{P}(D)$ peuvent \^etre associ\'ees \`a des formes concordantes pour permettre leur composition.

\begin{prop}\label{lemme_composition}
Soient $\mathscr{C}_1$ et $\mathscr{C}_2$ deux classes d'\'equivalence propre de formes primitives de discriminant $D\ne 0$. Soit $M \in \Z^*$ un entier. Alors il existe un couple $f_1 = (a_1,b,*) \in \mathscr{C}_1 , f_2 = (a_2,b,*) \in \mathscr{C}_2$ de formes concordantes v\'erifiant $a_1 \wedge a_2 = 1$ et $a_1a_2 \wedge M = 1.$
\end{prop}

\begin{proof}
Soit $f$ une forme arbitraire de $\mathscr{C}_1$. D'apr\`es la proposition \ref{prop180}, $f$ repr\'esente primitivement au moins un entier $a_1\ne 0$ premier avec $M$. Alors la proposition \ref{clef} (lemme clef) montre que $f$ est proprement \'equivalente \`a une forme $F_1 = (a_1,b_1,c_1)$, et $a_1 \wedge M = 1$.

Le m\^eme argument montre qu'on peut trouver une forme $F_2 = (a_2,b_2,*) \in \mathscr{C}_2$ telle que $a_2 \ne 0$ et $a_2 \wedge a_1M = 1$.

Ensuite, nous pouvons trouver des entiers $n_1,n_2$ v\'erifiant $b_1 + 2a_1n_1 = b_2 + 2a_2n_2$. En effet, $D = b_1^2 - 4a_1c_1 = b_2^2 - 4a_2c_2$, donc $b_1 \equiv b_2 \pmod 2$, et ainsi l'\'equation $b_1 + 2a_1n_1 = b_2 + 2a_2n_2$ \'equivaut \`a $a_1n_1 -a_2n_2 = \frac{b_2-b_1}{2}$, o\`u $a_1 \wedge a_2 = 1$, et une telle \'equation a toujours une solution.

Posons $b = b_1 + 2a_1n_1 = b_2 + 2a_2n_2$. Les \'equivalences \'el\'ementaires montrent que 
\begin{align*}
 & F_1=(a_1,b_1,c_1) \overset{+}{\sim} f_1 = F_1 \cdot T^{n_1} = (a_1, b_1 + 2n_1,*) = (a_1,b,*),\\
 &F_2 =(a_2,b_2,c_2) \overset{+}{\sim} f_2 = F_2 \cdot T^{n_2} = (a_2, b_2 + 2n_2,*) = (a_2,b,*).
 \end{align*}
Notons $f_1 = (a_1,b,C_1)$ et $f_2 = (a_2,b,C_2)$. Ces deux formes sont concordantes. En effet, $b^2 - a_1C_1 = b^2 - a_2 C_2$, donc $a_1 C_1 = a_2 C_2$. Puisque $a_1 \wedge a_2 = 1$, alors $a_1 \mid C_2$ et $a_2 \mid C_1$.

Enfin $a_1 \wedge M = 1$, et $a_2 \wedge a_1 M = 1$, donc $a_1a_2 \wedge M = 1$.
\end{proof}

\begin{prop}\label{compatibilite}
Soient $\mathscr{C}_1$ et $\mathscr{C}_2$ deux classes d'\'equivalence propre de formes primitives de discriminant $D\ne 0$. Soient $(f_1,f_2) \in \mathscr{C}_1 \times \mathscr{C}_2$ un couple des formes concordantes, et $(g_1,g_2) \in \mathscr{C}_1 \times \mathscr{C}_2$ un autre couple de formes concordantes. Alors $f_1 * f_2$ est proprement \'equivalent \`a $g_1 * g_2$.
\end{prop}

\begin{proof} Notons $f_j = (a_j,b,c_j)$ et $g_j (a'_j,b',c'_j),\ j=1,2$.

Proc\'edons par \'etapes, en suivant [Flath].
\item[{\bf \'Etape 1.}]  Supposons que $f_1 =  g_1$, et $a_1 \wedge a'_2 = 1$. 

Alors $b = b'$.

Il s'agit de prouver que $f_1 * f_2 \overset{+}{\sim} f_1 * g_2$, sachant que $f_2 \overset{+}{\sim} g_2$. 

Soit $\gamma = \begin{pmatrix} r & t \\s &u \end{pmatrix} \in \mathrm{SL}_2(\Z)$ tel que $f_2 \cdot \gamma = g_2$.
Nous avons vu au paragraphe \ref{section5.2} qu'en notant $\mathrm{Mat}(f)$ la matrice associ\'ee \`a une forme quadratique $f$, alors
$$\mathrm{Mat}(f \cdot \gamma) = \,^t\gamma\, \mathrm{Mat}(f)\,  \gamma.$$
Ainsi
$$\mathrm{Mat}(f_2)\,  \gamma = (\,^t\gamma)^{-1} \mathrm{Mat}(g_2),$$
soit explicitement
\begin{align}\label{eq7.2}
\begin{pmatrix} a_2 &b/2 \\ b/2 & c_2 \end{pmatrix}  \begin{pmatrix} r & t \\s &u \end{pmatrix} 
=\begin{pmatrix} u& -s \\-t &r \end{pmatrix} \begin{pmatrix} a'_2 &b/2 \\ b/2 & c'_2 \end{pmatrix}.
\end{align}
Le coefficient sous la diagonale donne $r b/2 +s c_2 = -ta'_2 + r b/2$, soit $sc_2 = -ta'_2$. Comme $f_1$ et $g_2$ sont concordantes, $a_1 \mid c_2$, donc $a_1 \mid ta'_2$, o\`u $a_1 \wedge a'_2 = 1$, donc $a_1 \mid t$.

Notons l'identit\'e matricielle, pour tout $\lambda \ne 0$,
\begin{align}\label{eq7.3}
\begin{pmatrix} 1 &0 \\ 0  & 1/\lambda \end{pmatrix}\begin{pmatrix} A &B \\ B & C \end{pmatrix} \begin{pmatrix} \lambda &0 \\ 0 & 1 \end{pmatrix} = \begin{pmatrix} \lambda A &B \\ B & C/\lambda \end{pmatrix}.
\end{align}
L'\'egalit\'e \ref{eq7.2} implique
\begin{align*}
&\left[\begin{pmatrix} 1 &0 \\ 0  & 1/a_1 \end{pmatrix}\begin{pmatrix} a_2 &b/2 \\ b/2 & c_2 \end{pmatrix} \begin{pmatrix} a_1 &0 \\ 0 & 1 \end{pmatrix}\right]\left[\begin{pmatrix} 1/a_1 &0 \\ 0 & 1 \end{pmatrix} \begin{pmatrix} r & t \\s &u \end{pmatrix} \begin{pmatrix} a_1 &0 \\ 0 & 1 \end{pmatrix}\right]\\
&=\left[\begin{pmatrix} 1 &0 \\ 0  & 1/a_1 \end{pmatrix}\begin{pmatrix} u& -s \\-t &r \end{pmatrix} \begin{pmatrix} 1 &0 \\ 0 & a_1 \end{pmatrix}\right]
\left[\begin{pmatrix} 1 &0 \\ 0 & 1/a_1 \end{pmatrix}  \begin{pmatrix} a'_2 &b/2 \\ b/2 & c'_2 \end{pmatrix} \begin{pmatrix} a_1 &0 \\ 0 & 1 \end{pmatrix}\right].
\end{align*}
En appliquant deux fois l'identit\'e \ref{eq7.3}, ceci donne
\begin{align*}
\begin{pmatrix} a_1a_2 &b/2 \\ b/2 & c_2/a_1 \end{pmatrix} \begin{pmatrix} r &t/a_1 \\ sa_1 & u \end{pmatrix} = \begin{pmatrix} u &-a_1s \\ -t/a_1  & r \end{pmatrix} \begin{pmatrix} a_1a'_2 &b/2 \\ b/2 & c'_2/a_1 \end{pmatrix}
\end{align*}
Puisque $a_1 \mid t$, et $ru -(sa_1)(t/a_1) = 1$, la matrice $\gamma' = \begin{pmatrix} r &t/a_1 \\ sa_1 & u \end{pmatrix} \in \mathrm{SL}_2(\Z)$, et $\,(^t\gamma')^{-1} = \begin{pmatrix} u &-a_1s \\ -t/a_1  & r \end{pmatrix}$. De plus
$$\mathrm{Mat}(f_1 *f_2) = \begin{pmatrix} a_1a_2 &b/2 \\ b/2 & c_2/a_1 \end{pmatrix}, \qquad
\mathrm{Mat}(f_1 * g_2) = \begin{pmatrix} a_1a'_2 &b/2 \\ b/2 & c'_2/a_1 \end{pmatrix}.
$$
Par cons\'equent, $\mathrm{Mat}(f_1 * g_2) = \,^t\gamma' \, \mathrm{Mat}(f_1*f_2)\,  \gamma'$, donc $(f_1 * f_2)\cdot \gamma' = f_1 *g_2$, o\`u $\gamma' \in \mathrm{SL}_2(\Z)$. 

Nous avons prouv\'e, pour tout couple $(f_1,f_2) \in \mathscr{C}_1 \times \mathscr{C}_2$, et tout couple $(g_1,g_2) \in \mathscr{C}_1 \times \mathscr{C}_2$ de formes concordantes, l'implication
$$(a_1 \wedge a'_2 = 1 \text{ et } g_1  \overset{+}{\sim} g_2) \Rightarrow f_1 * f_2  \overset{+}{\sim} f_1 * g_2.$$
\item[{\bf \'Etape 2.}] Supposons que $b = b'$ et $a_1 \wedge a'_2 = 1$.

Alors $f_1$ et $g_2$ sont concordantes, si bien que $f_1 * g_2$ est d\'efini. 

Notons que la d\'efinition \ref{def_comp} de la composition de formes concordantes est commutative. Par hypoth\`ese, $f_1 \overset{+}{\sim} g_1$ et $f_2 \overset{+}{\sim} g_2$. En appliquant deux fois le r\'esultat de l'\'etape 1, nous obtenons
$$ f_1 * f_2  \overset{+}{\sim} f_1 * g_2 = g_2 * f_1  \overset{+}{\sim} g_2 * g_1 = g_1  * g_2.$$
Nous avons prouv\'e, pour tout couple $(f_1,f_2) \in \mathscr{C}_1 \times \mathscr{C}_2$, et tout couple $(g_1,g_2) \in \mathscr{C}_1 \times \mathscr{C}_2$ de formes concordantes, l'implication
$$(b = b' \text{ et } a_1 \wedge a'_2 = 1) \Rightarrow (f_1  \overset{+}{\sim} f_2 \text{ et } g_1  \overset{+}{\sim} g_2 \Rightarrow f_1* f_2  \overset{+}{\sim} g_1 * g_2).$$

\item[{\bf \'Etape 3.}] Supposons maintenant seulement que $a_1 a_2 \wedge a'_1a'_2 = 1$.

Comme $b\equiv b' \pmod 2$, il existe des entiers $n,n' \in \Z$ tels que $b + 2a_1a_2n = b' + 2a'_1a'_2n'$. Posons $B = b + 2a_1a_2n = b' + 2a'_1a'_2n'$. Alors
\begin{align*}
F_1 &= f_1 \cdot T^{a_2n} =  (a_1,b_1, *) \cdot \begin{pmatrix} 1 & na_1\\ 0 & 1 \end{pmatrix}= (a_1,B,*) \in \mathscr{C}_1,\\
F_2 &= f_2 \cdot T^{a_1n} =  (a_2, b_2,*) \cdot  \begin{pmatrix} 1 & na_2\\ 0 & 1 \end{pmatrix} = (a_2,B,*) \in \mathscr{C}_2.
\end{align*}
Notons $F_1 = (a_1,B,C_1)$, o\`u $C_1 = \frac{B^2 - D}{4a_1}$, et $F_2 = (a_2,B,C_2)$, o\`u $C_2 = \frac{B^2 - D}{4a_2}$.

Puisque $f_1,f_2$ sont concordantes, $f_1 * f_2 = (a_1a_2,b,*)$. Posons 
$$H_1 = (f_1*f_2) \cdot T^{n} = (a_1a_2, b , *)\cdot \begin{pmatrix} 1 & n\\ 0 & 1 \end{pmatrix} = (a_1a_2,b+2a_1a_2n,*) = (a_1a_2, B,C').$$
Comme $D$ est le discriminant de $H_1$, alors $D = B^2 - 4a_1a_2 C'$, donc $a_1a_2 \mid \frac{B^2 - D}{4}$.

Par cons\'equent, 
$$a_2 \mid C_1= \frac{B^2 - D}{4a_1}, \qquad a_1 \mid  C_2 = \frac{B^2 - D}{4a_2},$$
 ce qui prouve que $F_1,F_2$ sont concordantes, et ainsi $H_1 = (a_1a_2, B,*) =F_1*F_2 \overset{+}{\sim} f_1*f_2$.
 
 De façon similaire, les formes $G_1 = (a'_1,B,*) \in \mathscr{C}_1$ et $G_2 = (a'_2,B,*)\in \mathscr{C}_2$ sont concordantes, et $H_2 = G_1 * G_2 = (a'_1a'_2,B,*) \overset{+}{\sim} g_1 * g_2$.
 
 Puisque
 \begin{align*}
 &F_1 = (a_1,B,*) \overset{+}{\sim} G_1 = (a'_1,B,*),\\
 &F_2 = (a_2,B,*) \overset{+}{\sim} G_2 = (a'_2,B,*),
 \end{align*}
 o\`u $a_1 \wedge a'_2 = 1$, l'\'etape 2 permet de conclure que $F_1*F_2 \overset{+}{\sim} G_1*G_2$.
 Alors
 $$f_1 * f_2 \overset{+}{\sim} F_1*F_2 \overset{+}{\sim}G_1*G_2 \overset{+}{\sim} g_1*g_2.$$
Nous avons prouv\'e, pour tout couple $(f_1,f_2) \in \mathscr{C}_1 \times \mathscr{C}_2$, et tout couple $(g_1,g_2) \in \mathscr{C}_1 \times \mathscr{C}_2$ de formes concordantes, l'implication
 $$( a_1 a_2 \wedge a'_1a'_2 = 1) \Rightarrow (f_1  \overset{+}{\sim} f_2 \text{ et } g_1  \overset{+}{\sim} g_2 \Rightarrow f_1* f_2  \overset{+}{\sim} g_1 * g_2).$$
 \item[{\bf \'Etape 4.}] (finale.)
 
Maintenant on suppose seulement que $f_1 \overset{+}{\sim} g_1, f_2 \overset{+}{\sim} g_2$, o\`u $f_1, f_2$ sont concordantes, ainsi que $g_1,g_2$.

 La proposition \ref{lemme_composition}, o\`u on pose $M = a_1a_2a'_1a'_2$, montre qu'il existe un couple de formes concordantes $F_1,F_2$, o\`u $F_1 \overset{+}{\sim} f_1, F_2 \overset{+}{\sim} f_2$, et $F_1 = (A_1,B',*), F_2 = (A_2,B',*)$ v\'erifient $A_1 \wedge A_2 = 1$ et $A_1 A_2 \wedge a_1a_2a'_1a'_2 = 1$.
 
Comme $a_1a_2 \wedge A_1A_2 = 1$,  l'\'etape 3 montre
 $$f_1 * f_2 \overset{+}{\sim} F_1 * F_2. $$
 De m\^eme $A_1 A_2 \wedge a'_1a'_2 = 1$, donc
$$F_1 * F_2  \overset{+}{\sim} g_1 * g_2.$$
Ainsi $f_1f_2  \overset{+}{\sim} g_1g_2$.
\end{proof}

Les propositions \ref{lemme_composition} et \ref{compatibilite} permettent de d\'efinir la composition de deux classes de formes arbitraires de m\^eme discriminant.
\begin{dfn}
Soient $\mathscr{C}_1$ et $\mathscr{C}_2$ des classes d'\'equivalence propres de formes primitives de discriminant $D \ne 0$. Il existe un couple $(f_1,f_2)\in \mathscr{C}_1\times \mathscr{C}_2$ de formes concordantes, et la classe d'\'equivalence propre $\overline{f_1 * f_2}$ de $f_1*f_2$ ne d\'epend pas du choix d'un tel couple. Alors la composition $\mathscr{C}_1\mathscr{C}_2$ de ces deux classes est d\'efinie par
$$\mathscr{C}_1\mathscr{C}_2 = \overline{f_1 * f_2}.$$
\end{dfn}

\medskip
Montrons maintenant le r\'esultat principal.

\begin{prop}
$P(D)$, o\`u $D \ne 0$, muni de la composition des classes de formes, est un groupe ab\'elien.
\end{prop}

\begin{proof}
\item[$\bullet$ {\bf Loi interne.}] La compos\'ee $\mathscr{C}_1\mathscr{C}_2$ de deux classes d'\'equivalence propre $\mathscr{C}_1 = \overline{f_1},\mathscr{C}_2 = \overline{f_2}$ (o\`u $f_1,f_2$ sont concordantes) est une classe d'\'equivalence propre par d\'efinition. 

Si $\mathscr{C}_1,\mathscr{C}_2 \in P(D)$, alors $f_1,f_2$ sont primitives (proposition \ref{primitive}), et leur compos\'ee $f_1*f_2$ est primitive (proposition \ref{primitive2}), donc $\mathscr{C}_1\mathscr{C}_2 = \overline{f_1*f_2}$ est une classe de formes primitives. 

Si $D<0$, ceci suffit pour prouver que $\mathscr{C}_1\mathscr{C}_2 \in P(D)$.

De plus, si $D<0$, toute classe $\mathscr{C} = \overline{f}$ d'une forme primitive $f = (a,b,c)$ appartient \`a $P(D)$ si $f$ est d\'efinie positive, ce qui \'equivaut \`a $a>0$. Ainsi la compos\'ee de deux formes concordantes positives $f_1 = (a_1,b,*), f_2 = (a_2,b,*)$ est $f = (a_1a_2,b,*)$, o\`u $a_1a_2>0$, donc la compos\'ee $\mathscr{C}_1\mathscr{C}_2 = \overline{f_1 * f_2} \in P(D)$. Ainsi
$$(\mathscr{C}_1, \mathscr{C}_2) \in P(D)^2 \Rightarrow \mathscr{C}_1 \mathscr{C}_2 \in P(D).$$

\item[$\bullet$ {\bf Commutativit\'e.}] Si $(f_1,f_2)$ est un couple de formes concordantes telle que $\mathscr{C}_1 = \overline{f_1}, \mathscr{C}_2 = \overline{f_2}$, o\`u $f_1 = (a_1,b,*), f_2 = (a_2,b,*)$, alors
$$f_1* f_2 = (a_1a_2,b,*) = (a_2a_1,b,*) = f_2 * f_1,$$
donc
$$\mathscr{C}_1 \mathscr{C}_2 = \overline{f_1 * f_2} = \overline{f_2 * f_1} = \mathscr{C}_2 \mathscr{C}_1.$$

\item[$\bullet$ {\bf Associativit\'e.}] Soient $\mathscr{C}_1, \mathscr{C}_2, \mathscr{C}_3 \in P(D)$.
Soit $g_3 = (a_3,b_3,c_3) \in \mathscr{C}_3$, o\`u $a_3 \ne 0$
 
La proposition \ref{lemme_composition} montre qu'il existe un couple de formes concordantes  $(g_1,g_2) =  ( (a_1,b_1,c_1),(a_2,b_2,c_2)) \in \mathscr{C}_1 \times \mathscr{C}_2$ de formes concordantes (v\'erifiant donc $a_1a_2 \ne 0$) telles que $a_1 \wedge a_2 = 1$ et $a_1a_2 \wedge a_3 = 1$.

Alors $g_1,g_2,g_3$ v\'erifient $a_1a_2a_3 \ne 0$, et $a_1 \wedge a_2 = a_2 \wedge a_3 = a_1 \wedge a_3 = 1$.

Puisque $D = b_1^2 - 4a_1c_1 = b_2^2 - 4a_2c_2 = b_3^2 - 4a_3c_3$, $b_1,b_2,b_3$ ont m\^eme parit\'e, qui est celle de $D$.
\be
\item[$\bullet$] Si $b_1, b_2,b_3$ sont pairs, \'etant donn\'e que $a_1,a_2,a_3$ sont premiers entre eux deux \`a deux, il existe d'apr\`es le lemme chinois un entier $b \in \Z$ tel que
$$b \equiv b_1/2 \pmod{a_1}, \qquad b \equiv b_2/2 \pmod {a_2}, \qquad b \equiv b_3/2 \pmod {a_3}.$$
Alors $B = 2b$ v\'erifie
$$B \equiv b_1 \pmod {2a_1}, \qquad B \equiv b_2 \pmod {2a_2}, \qquad B \equiv b_3 \pmod {2a_3}.$$

\item[$\bullet$] Si $b_1, b_2,b_3$ sont impairs, par le m\^eme argument, il existe $b \in \Z$ tel que
$$b \equiv (b_1-1)/2 \pmod{a_1}, \qquad b \equiv (b_2 - 1)/2 \pmod {a_2}, \qquad b \equiv (b_3-1)/2 \pmod {a_3}.$$
Alors $B = 2b+1$ v\'erifie
$$B \equiv b_1 \pmod {2a_1}, \qquad B \equiv b_2 \pmod {2a_2}, \qquad B \equiv b_3 \pmod {2a_3}.$$
\ee
Dans les deux cas, il existe un entier $B$ et des entiers $n_1,n_2,n_3$ tels que
$$B = b_1 + 2n_1a_1 = b_2 + 2n_2a_2 = b_3 + 2n_3 a_3.$$
Alors les formes $f_1 = g_1\cdot T^{n_1}, f_2 = g_2 \cdot T^{n_2}, f_3 = g_3 \cdot T^{n_3}$ v\'erifient $(f_1,f_2,f_3) \in \mathscr{C}_1 \times \mathscr{C}_2 \times \mathscr{C}_3$, et 
$$f_1 = (a_1,B,*), f_2 = (a_2,B,*), f_3 = (a_3,B,*),\qquad a_1 \wedge a_2 = a_2 \wedge a_3 = a_1 \wedge a_3 = 1.$$
Alors les formes $f_1*f_2 = (a_1a_2,B,*)$ et $f_3 = (a_3,B,*)$ sont concordantes, ainsi que les formes $f_1$ et $f_2*f_3$, et
$$(f_1 * f_2)*f_3 = ((a_1,B,*) *(a_2,B,*)] *(a_3,B,*) = (a_1a_2,B,*)* (a_3,B,*) = (a_1a_2a_3,B,*).$$
De m\^eme $f_1*(f_2*f_3) = (a_1a_2a_3,B,*)$, donc $(f_1 * f_2)*f_3  = f_1*(f_2*f_3)$, ce qui prouve
$$\mathscr{C}_1( \mathscr{C}_2 \mathscr{C}_3)  = (\mathscr{C}_1 \mathscr{C}_2) \mathscr{C}_3 .$$

\item[$\bullet$ {\bf Neutre.}] Soit $\mathscr{C}_0$ la classe de la forme principale $f_0$ de discriminant $D$, qui est un \'el\'ement de $P(D)$. Montrons que $\mathscr{C}_0$ est \'el\'ement neutre dans $P(D)$. Alors 
$$
f_0 = (1,0,*)\text{ si } D \equiv 0 \pmod 4, \qquad f_0 = (1,1,*) \text{ si } D \equiv 1 \pmod 4.
$$
Soit $\mathscr{C} \in P(D)$. Choisissons un repr\'esentant $f = (a,b,*)$ de $\mathscr{C}$ tel que $a \ne 0$, ce qui est toujours possible. Alors $b \equiv D \pmod 2$. Posons $b = 2k$ si $D \equiv 0 \pmod 4$, et $b = 2k+1$ si $D \equiv 1 \pmod 4$. Alors
$$f_0\overset{+}{\sim} f\cdot T^k = (1,b,*).$$
De plus $a\wedge 1 = 1$, donc les formes $(a,b,*)$ et $(1,b,*)$ sont concordantes. 

Ainsi $(a,b,*)* (1,b,*) = (a,b,*)$, donc
$$\mathscr {C} \mathscr {C}_0 = \mathscr {C}.$$

\item[$\bullet$ {\bf Sym\'etrique.}] Soit $\mathscr{C}\in P(D)$. Il existe une forme $f = (a,b,c) \in \mathscr{C}$ telle que $ac\ne 0$. En effet, il existe $f_1 = (a,b_1,c_1) \in \mathscr{C}$ tel que $a \ne 0$ d'apr\`es la proposition \ref{prop180} et le lemme clef. Pour tout $k \in \Z$, $(a,b_1,c_1) \cdot T^k = (a,b_1+2ak,ak^2+b_1k+c_1)$. Comme $(a,b_1,c_1) \ne (0,0,0)$, il existe un entier $k_0$ tel que $ak^2+b_1k+c_1 \ne 0$ ($ak^2+b_1k+c_1$ s'annule pour au plus deux valeurs de $k$). Alors $f = (a,b,c) = f_1\cdot T^{k_0}$ v\'erifie $ac \ne 0$ et $f \in\mathscr{C}$. 

Posons $g = (c,b,a)$. Ces deux formes sont concordantes, puisque $ac \ne 0, a\mid a$ et $c \mid c$. Alors 
$$f * g =(a,b,c)*(c,b,a) = (ac,b,*) = (ac, b,1),$$
puisque $D = b^2 - 4ac$.

Comme $f*g$ repr\'esente $1 = (f*g)(0,1)$, alors $f*g \overset{+}{\sim} f_0$, o\`u $f_0$ est la forme principale de discriminant $D$ (proposition \ref{forme_principale}).

Si $\mathscr{C'}$ est la classe d'\'equivalence propre de $g$, alors $\mathscr{C}\mathscr{C}' = \mathscr{C}_0$.

$(P(D),\cdot)$ est un groupe ab\'elien.
\end{proof}


\begin{subappendices}
\section{R\'ecr\'eation informatique.}
\subsection{Compositions de deux classes propres.}
Donnons l'algorithme issu de ce chapitre permettant de composer deux classes propres de d\'eterminant $D >0$. Une classe sera repr\'esent\'ee par son unique forme r\'eduite au sens de Gauss.

\begin{verbatim}
from numtheory import bezout, pgcd
from quadratic import discriminant, reduce
from nombreDeClasses import formes_reduites

def normalize(q,M):
    """
    input : primitive quadratic form q and integer M.
    output : quadratic form f = (a,b,c) properly equivalent to q
    such that a != 0 and gcd(a,M) = 1.
    """
    (a,b,c) = q
    if M==1:
        if a == 0:
            if c !=0:
                (a,b,c) = (c,-b,a)
            else:
                (a,b,c) = (b,b,0)
    else:
        (a,b,c) = q
        D = discriminant(q)
        k = 0
        while pgcd(a*k*k + b*k +c, M) != 1:
            k += 1
        (a,b,c) = (a*k*k + b*k + c, -b -2*k*a, a)
    return(a,b,c)
    
def concordantes(q1,q2):
    """ 
    input : two primitive quadratic  forms with same discriminant.
    output: two concordant forms (f1,f2),
        where fi properly equivalent to qi, i = 1,2.
    """
    D = discriminant(q1)
    (a1,b1,c1) = normalize(q1,1)
    (a2,b2,c2) = normalize(q2,a1)
    n1,n2,_ = bezout(a1,-a2)
    n1 *= (b2-b1) // 2
    n2 *= (b2-b1) // 2
    b  = b1 + 2*a1*n1 
    assert b == b2 + 2*a2*n2
    f1 = (a1, b, (b*b - D) // (4*a1))
    f2 = (a2, b, (b*b - D) // (4*a2))
    return f1,f2
    
def compose(q1,q2):
    """
    input  : two primitive quadratic forms q1,q2 with same discriminant D<0.
    output : composition of these two forms.
    """
    D ,D2 = discriminant(q1), discriminant(q2)
    assert D2 == D
    f1,f2 = concordantes(q1,q2)
    (a1,b,_) = f1
    (a2,_,_) = f2
    f = (a1*a2, b, (b*b - D) // (4*a1*a2))
    g,_ = reduce(f)
    return g
    
if __name__ == "__main__":
    D = -4 *17
    l = formes_reduites(D)
    print('*',end = '\t\t|')
    for f in l:
        print(f, end ='\t' )
    print()
    print('_'*75)
    for q1 in l:
        print(q1, end ='\t|' )
        for q2 in l:
            print(compose(q1,q2), end = '\t')
        print()

\end{verbatim}

Le programme d'essai donne la table du groupe $P(D)$, o\`u $D = -4\times 17 = -68$.

\begin{verbatim}
*             |(3, -2, 6)   (1, 0, 17)  (2, 2, 9)   (3, 2, 6)   
_______________________________________________________________
(3, -2, 6)    |(2, 2, 9)    (3, -2, 6)  (3, 2, 6)   (1, 0, 17)  
(1, 0, 17)    |(3, -2, 6)   (1, 0, 17)  (2, 2, 9)   (3, 2, 6)   
(2, 2, 9)     |(3, 2, 6)    (2, 2, 9)   (1, 0, 17)  (3, -2, 6)  
(3, 2, 6)     |(1, 0, 17)   (3, 2, 6)   (3, -2, 6)  (2, 2, 9)
\end{verbatim}
Ainsi $P(-68) \simeq \Z/4\Z$ est engendr\'e par la classe d'\'equivalence propre de $3 x^2 + 2xy+6y^2$.
\end{subappendices}


\chapter{Th\'eorie du genre.}

Source : David A.Cox, Primes of the Form $x^2+ny^2$.

\section{Symbole de Jacobi.}
Soit $n = \prod\limits_{i=1}^l p_i^{k_i}$ un entier impair $n>1$, d\'ecompos\'e en facteurs premiers.
\begin{dfn} Soit $a \in \Z$, et $n\geq 1$, $n$ impair.
D\'efinissons le symbole de Jacobi $\legendre{a}{n}$.
 
Si $n=1$, $ \legendre{a}{1} = 1$ (produit vide).

Si $n>1$, $n$ impair, o\`u  $n = \prod\limits_{i=1}^l p_i^{k_i}$ est la d\'ecomposition de $n$ en facteurs premiers, alors  
$$\legendre{a}{n} = \legendre{a}{p_1}^{k_1}\cdots \legendre{a}{p_l}^{k_l},$$
o\`u $\legendre{a}{p_i}$ est la valeur du symbole de Legendre de $a$ relative au nombre premier $p_i$.
\end{dfn}
Si on \'ecrit la d\'ecomposition de $n>1$, $n$ impair, en facteurs premiers sous la forme $n = n_1\cdots n_k$, o\`u les $n_i$ sont des nombres premiers non n\'ecessairement distincts, alors
$$\legendre{a}{n} = \legendre{a}{n_1}\cdots \legendre{a}{n_k}.$$

La valeur du symbole de Jacobi ne permet pas de savoir si un \'el\'ement est r\'esidu quadratique modulo $n$ : par exemple $\legendre{2}{15} = \legendre{2}{3} \legendre{2}{5} = (-1)(-1) = 1$, mais $2$ n'est pas un carr\'e de $\Z/15\Z$.

D'autres propri\'et\'es du symboles de Legendre se g\'en\'eralisent au symbole de Jacobi.

\begin{prop}\label{prop166}
Si $a,b \in \Z$, et $n\in \N$ impair, alors 
$$\legendre{a}{n}\legendre{b}{n} =\legendre{ab}{n}.$$
\end{prop}
\begin{proof}
Si $n=1$, les deux membres sont \'egaux \`a $1$. Si $n>1$, $n = \prod_{i=1}^k n_i$, o\`u les $n_i$ sont des nombres premiers, alors, en utilisant la multiplicativit\'e du symbole de Legendre,
\begin{align*}
\legendre{ab}{n} &= \prod_{i=1}^k \legendre{ab}{n_i}\\
&= \prod_{i=1}^k \legendre{a}{n_i} \legendre{b}{n_i}\\
&= \prod_{i=1}^k \legendre{a}{n_i} \prod_{i=1}^k \legendre{b}{n_i}\\
&= \legendre{a}{n}\legendre{b}{n}
\end{align*}
\end{proof}

\begin{prop}\label{prop167}
Si $n,n' \in \Z$, et $m \in \N$, $m$ impair, alors
$$ n\equiv n' \pmod m \Rightarrow \legendre{n}{m} =\legendre{n'}{m}.$$
\end{prop}

\begin{proof}
D\'ecomposons $m$ sous la forme  $m =\prod_{i=1}^l m_i$, o\`u les $m_i$ sont premiers.

 Si $ n\equiv n' \pmod m$, alors $ n\equiv n' \pmod {m_i},\ 1\leq i \leq l$, donc pour chaque indice $i$, $\legendre{n}{m_i} =\legendre{n'}{m_i}$. Le produit de ces \'egalit\'es donne $\legendre{n}{m} =\legendre{n'}{m}$.
\end{proof}

\begin{prop}\label{prop168}
Si $a \in \Z$, et $n,m \in \N$ sont des entiers naturels impairs,
$$\legendre{a}{n}\legendre{a}{m} = \legendre{a}{nm}.$$
\end{prop}
\begin{proof}
D\'ecomposons $n$ et $m$ en produits de nombres premiers $n = \prod_{i=1}^k n_i, m =\prod_{i=1}^l m_i$. Alors $nm =\prod_{i=1}^{k+l} n_i$, o\`u on d\'efinit $n_i = m_{i-k}$ si $ k < i \leq k+l$.
\begin{align*}
\legendre{a}{nm} &= \prod_{i=1}^{k+l} \legendre{a}{n_i}\\
&= \prod_{i=1}^k \legendre{a}{n_i} \prod_{i=k+1}^{k+l} \legendre{a}{n_i}\\
&=\prod_{i=1}^k \legendre{a}{n_i} \prod_{j=1}^{l} \legendre{a}{m_j}\qquad (j =i-k)\\
&=\legendre{a}{n}\legendre{a}{m}
\end{align*}
\end{proof}

\begin{prop}\label{prop169}
Soit $a\in \Z$, $n \in \N$, $n$ impair. Si $a \wedge n >1$, alors 
$\legendre{a}{n} = 0.$
\end{prop}
\begin{proof}
Comme  $a \wedge n >1$, il existe un nombre premier impair $p$ tel que $p\mid a, p \mid n$. Si la d\'ecomposition de $n$ en produit de facteurs premiers s'\'ecrit $n = n_1\cdots n_k$, alors $p$ est l'un des $n_i$ : $p = n_j$ pour un indice $j, \ 1\leq j \leq n$, et puisque $p\mid a$,  $\legendre{a}{n_j} =\legendre{a}{p} = 0$, donc $\legendre{a}{n} =\prod_{i=1}^k \legendre{a}{n_i} = 0$.
\end{proof}

\begin{prop}\label{prop170}
Si $n\in \Z$ et $m\in \N$, $m$ impair, alors
$$\legendre{n^2}{m} = 1, \qquad \legendre{n}{m^2} = 1.$$
\end{prop}

\begin{proof}
Si $m =\prod_{i=1}^l m_i$, o\`u les $m_i$ sont premiers, alors
$$\legendre{n^2}{m} = \prod_{i=1}^m \legendre{n^2}{n_i} = 1.$$
D'apr\`es la proposition \ref{prop168},
$$\legendre{n}{m^2} = \legendre{a}{m}^2 = 1.$$
\end{proof}




\begin{prop} {\rm(Loi de r\'eciprocit\'e quadratique pour le symbole de Jacobi.)}\label{prop171}

Si $n\geq 1$ et $m\geq 1$ sont deux entiers {\bf impairs, positifs}, alors
$$\legendre{m}{n} = (-1)^{\frac{(n-1)}{2} \frac{(m-1)}{2}} \legendre{n}{m}.$$
\end{prop}
\begin{proof}
Si $n$ et $m$ ne sont pas premiers entre eux, ils ont un facteur premier $p$ en commun, pour lequel $\legendre{n}{p} = 0$ et $\legendre{m}{p}=0$, donc $\legendre{m}{n} = \legendre{n}{m}=0$.

Si $n = 1$ ou $m=1$, les deux membres sont \'egaux \`a 1.

Supposons maintenant que $n\wedge m = 1$, o\`u $n = \prod_{i=1}^k n_i, m=\prod_{j=1}^l m_j$ sont les d\'ecompositions de $m,n$ en facteurs premiers, distincts ou non. Alors la multiplicativit\'e du symbole de Legendre donne
$$\legendre{m}{n} = \prod_{1\leq i \leq k,1\leq j \leq l} \legendre{m_i}{n_j}, \qquad \legendre{n}{m} = \prod_{1\leq i \leq k,1\leq j \leq l} \legendre{n_i}{m_j}.$$
En appliquant la loi de r\'eciprocit\'e quadratique \`a chaque couple $(n_i,m_j)$, on obtient
$$\legendre{m}{n} \legendre{n}{m} = \prod_{1\leq i \leq k,1\leq j \leq l} (-1)^{\frac{(n_i-1)}{2}\frac{(m_j-1)}{2}}.$$
Notons $\Pi$ ce dernier produit. Il faut prouver que
$$ \Pi = \prod_{1\leq i \leq k,1\leq j \leq l}  (-1)^{\frac{(n_i-1)}{2}\frac{(m_j-1)}{2}} = (-1)^{\frac{(n-1)}{2} \frac{(m-1)}{2}}.$$
Notons que $(-1)^{\frac{(n_i-1)}{2}\frac{(m_j-1)}{2}}  = -1$ si et seulement si $n_i \equiv 3 \pmod 4,m_j \equiv 3 \pmod 4$.
Ainsi $\Pi = -1$ si et seulement si le nombre $P$  de couples $(n_i,m_j)$ tels que $n_i \equiv 3 \pmod 4,m_j \equiv 3 \pmod 4$ est impair. Comme ce nombre est le produit du nombre $N$  de $n_i$ tels que $n_i \equiv 3 \pmod 4$, avec le nombre $M$ de $m_j$ tels que $m_j \equiv 3 \pmod 4$, $\Pi=-1$ \'equivaut \`a ce que chacun de ces deux nombres soit impair. Or
$$n \equiv 3 \pmod 4 \iff N \equiv 1 \pmod 2.$$
En effet, chaque $n_i$ est congru \`a $\pm 1$ modulo $4$. Si leur nombre $N$ est impair, alors $n =\prod_{i=1}^k n_i \equiv -1 \pmod 4$, et $n \equiv 1 \pmod 4$ sinon. Ainsi
\begin{align*}
\Pi = -1 &\iff N \equiv 1 \pmod 2 \text{ et } M \equiv 1 \pmod 2\\
&\iff n \equiv 3 \pmod 4 \text{ et } m \equiv 3 \pmod 4\\
&\iff (-1)^{\frac{(n-1)}{2} \frac{(m-1)}{2}} = -1.
\end{align*}
Comme $\Pi$ ne prend que les valeurs $1,-1$,  $\Pi = (-1)^{\frac{(n-1)}{2} \frac{(m-1)}{2}},$ ce qui ach\`eve la d\'emonstration.
\end{proof}

\begin{prop} {\rm (Loi compl\'ementaire 1.)} \label{prop172}

Si $ n\in \N$, $n$ impair, alors
$$\legendre{-1}{n} = (-1)^{\frac{n-1}{2}}.$$
\end{prop}

\begin{proof}
En utilisant la d\'ecomposition usuelle de $n = \prod_{i=1}^k n_i$,
\begin{align*}
\legendre{-1}{n} &= \prod_{i=1}^k \legendre{-1}{n_i}\\
&=\prod_{i=1}^k (-1)^{\frac{n_i - 1}{2}}
\end{align*}
Notons $\Pi$ ce dernier produit. Il reste \`a prouver que
$$ \Pi = \prod_{i=1}^k (-1)^{\frac{n_i - 1}{2}} = (-1)^{\frac{n-1}{2}} .$$
Or, pour tout entier impair $n$, $ (-1)^{\frac{n-1}{2}} = -1$ \'equivaut \`a $n \equiv 3 \pmod 4$, sinon $(-1)^{\frac{n-1}{2}} = 1$. Donc $\Pi = -1$ si et seulement si le nombre $P$ de facteurs $n_i$ congrus \`a 3 modulo 4 est impair. Comme les autres facteurs, impairs, sont congrus \`a 1 modulo 4, 
$$\Pi = -1 \iff P \equiv 1 \pmod 2 \iff n  \equiv 3 \pmod 4 \iff (-1)^{\frac{n-1}{2}} = -1.$$
Comme $\Pi$ ne peut prendre que les valeurs $+1,-1$, $\Pi = (-1)^{\frac{n-1}{2}}$.
\end{proof}

\begin{prop}{\rm (Loi compl\'ementaire 2.)}\label{prop173}

Pour tout entier $n\geq 1$ impair,
$$\legendre{2}{n} = (-1)^{\frac{n^2-1}{8}}.$$
\end{prop}

\begin{proof}
Cette formule a bien un sens : $n = 2k + 1$ \'etant impair, $n^2 - 1 = (2k+1)^2 - 1 = 8 \frac{k(k+1)}{2}$ est bien un multiple de $8$. De plus $(-1)^{\frac{n^2-1}{8}}$ne d\'epend que de la classe de $n$ modulo $8$ : 
$$ (-1)^{\frac{(n+ 8k)^2-1}{8}} =  (-1)^{\frac{n^2-1}{8} + 2nk + 8k^2} =  (-1)^{\frac{n^2-1}{8}}.$$
Enfin 
\begin{align*}
(-1)^{\frac{n^2-1}{8}} = 1 & \iff n \equiv 1,7 \pmod 8,\\
(-1)^{\frac{n^2-1}{8}} = -1 & \iff n \equiv 3,5 \pmod 8.\\
\end{align*}

La loi compl\'ementaire du symbole de Legendre montre que la loi compl\'ementaire est vraie pour tout nombre premier impair. D'autre par, la d\'efinition du symbole de Jacobi donne
$$\legendre{2}{uv} = \legendre{2}{u} \legendre{2}{v} ,$$
si $u,v$ sont des entiers impairs.  De plus
$$(-1)^{\frac{(uv)^2 - 1}{8}} = (-1)^{\frac{u^2 -1}{8}}  (-1)^{\frac{v^2 -1}{8}}.$$
En effet, 
\begin{align*}
(-1)^{\frac{u^2 -1}{8}}  (-1)^{\frac{v^2 -1}{8}} = -1 \iff &((-1)^{\frac{u^2 -1}{8}} =1 \text { et } (-1)^{\frac{v^2 -1}{8}} =-1) \\
& \text{ ou }  ((-1)^{\frac{u^2 -1}{8}} =-1 \text { et } (-1)^{\frac{v^2 -1}{8}} =1))\\
\iff &(u \equiv 1,7 \pmod 8 \text{ et } v \equiv 3,5\pmod 8)\\
&\text { ou } (u \equiv 3,5  \pmod 8 \text{ et } v \equiv 1,7\pmod 8)\\
\iff &uv \equiv 3,5 \pmod 8\\
\iff & (-1)^{\frac{(uv)^2 - 1}{8}} = -1.
\end{align*}
Soit $n = n_1\cdots n_k$ est la d\'ecomposition de $n$ en facteurs premiers. Si on pose l'hypoth\`ese de r\'ecurrence, pour $1\leq i <k$,
$$\legendre{2}{n_1\cdots n_i} = (-1)^{\frac{(n_1\cdots n_i)^2-1}{8}},$$
alors
\begin{align*}
\legendre{2}{n_1\cdots n_i n_{i+1}} &=\legendre{2}{n_1\cdots n_i }  \legendre{2}{n_{i+1}},\\
&=(-1)^{\frac{(n_1\cdots n_i)^2-1}{8}} (-1)^{\frac{n_{i+1}^2-1}{8}}\\
&=(-1)^{\frac{(n_1\cdots n_i n_{i+1})^2-1}{8}}
\end{align*}
Pour $i = k$, on obtient la conclusion
$$\legendre{2}{n} = (-1)^{\frac{n^2-1}{8}}.$$
\end{proof}



\section{Diviseurs d'une forme quadratique.}
Soit $n \in \Z, n \ne 0$ un entier fix\'e. 
On s'int\'eresse dans ce paragraphe aux nombres premiers impairs $p$ tels que $p \mid x^2 + n y^2$.

\begin{prop}\label{prop174}
Soit $n$ un entier non nul, et soit $p$ un nombre premier impair qui ne divise pas $n$. Alors
$$\exists (x,y) \in \Z^2,\ x\wedge y = 1 \text{ et } p \mid x^2 + n y^2 \iff \legendre{-n}{p} = 1.$$
\end{prop}

\begin{proof}
Notons $[x],[y],[n]$ les classes de $x,y,n$ modulo $p$.

$(\Rightarrow)$ Si $p \mid x^2 + n y^2$, $x\wedge y = 1$, alors  $p \nmid y$, sinon $p\mid x^2$, donc $p \mid x$, et ainsi $p\mid x\wedge y$, ce qui contredit $x\wedge y = 1$. Par cons\'equent $[y]\ne[0]$, et $[x]^2 + [n] [y]^2 = [0]$, donc $-[n] = ([x][y]^{-1})^2$, ce qui prouve que $\legendre{-n}{p} = 1$.

$(\Leftarrow)$ Si $\legendre{-n}{p} = 1$, alors il existe $x\in \Z$ tel que $-n \equiv x^2 \pmod p$. En posant $y = 1$, on obtient que $p \mid x^2 + ny^2$, avec $x \wedge y = x\wedge 1 = 1$.
\end{proof}

Exemple : Si $p$ est un nombre premier diff\'erent de $2$ et $5$, $p \mid x^2 + 5 y^2, x\wedge y = 1$ si et seulement si $\legendre{-5}{p} = 1$. La loi de r\'eciprocit\'e quadratique donne
$$\legendre{5}{p} = (-1)^{\frac{5-1}{2} \frac{p-1}{2}} \legendre{p}{5} = \legendre{p}{5},$$
donc
\begin{align*}
\legendre{-5}{p} = 1 \iff& \legendre{-1}{p} \legendre{5}{p} =1\\
\iff&\left (\legendre{-1}{p} = 1 \text{ et } \legendre{p}{5} = 1\right) \text{ ou } \left(\legendre{-1}{p} = -1 \text{ et } \legendre{p}{5} = -1\right)\\
\iff& 
\left\{
\begin{array}{ccc}
p &\equiv &1 \pmod 4\\
p & \equiv &1 \pmod 5
\end{array}
\right.
\ \ \text { ou } 
\left\{
\begin{array}{ccc}
p &\equiv &1 \pmod 4\\
p & \equiv &-1 \pmod 5
\end{array}
\right.
 \text{ ou}\\
&
\left\{
\begin{array}{ccc}
p &\equiv &-1 \pmod 4\\
p & \equiv &-2 \pmod 5
\end{array}
\right.
\text{ ou }
\left\{
\begin{array}{ccc}
p &\equiv &-1 \pmod 4\\
p & \equiv &2 \pmod 5
\end{array}
\right.\\
\iff& p\equiv 1, 9, 3,7 \pmod{20}.
\end{align*} 
Le but est de caract\'eriser, pour un entier $n\ne 0$, la liste des $\alpha, \beta,\gamma,\ldots  \in \Z$ tels que $$\legendre{-n}{p} = 1 \iff p \equiv \alpha, \beta,\gamma,\ldots \pmod {4n}.$$
Le caract\`ere d\'efini dans la proposition \ref{prop176} suivante joue un rôle crucial. Ceci n\'ecessite un lemme pr\'ealable (proposition \ref{prop175}).


Montrons, dans le cas o\`u $D$ est un discriminant, le pendant de la proposition \ref{prop167}.
\begin{prop}\label{prop175}
Si $D \equiv 0,1 \pmod 4$, et si $m,n$ sont des entiers positifs impairs,
$$m\equiv n \pmod D \Rightarrow \legendre{D}{m} = \legendre{D}{n}.$$
\end{prop}

\begin{proof}
Si $D = 0$, alors $\legendre{D}{m} = \legendre{D}{n} = 0$. Nou pouvons donc supposer $D\ne 0$.
\item[$\bullet$] Si $D \equiv 1 \pmod 4$ et $D>0$, 
$$\legendre{D}{m} = (-1)^{\frac{D-1}{2}\frac{m-1}{2}} \legendre{m}{D} = \legendre{m}{D},$$
et
$$\legendre{D}{n} = (-1)^{\frac{D-1}{2}\frac{m-1}{2}} \legendre{n}{D} = \legendre{n}{D}.$$
Si $m\equiv n \pmod D$, la proposition \ref{prop167} montre que $\legendre{m}{D} = \legendre{n}{D}$, donc $\legendre{D}{m} = \legendre{D}{n}$.

\item[$\bullet$] Si $D \equiv 1 \pmod 4$ et $D<0$, alors $D = -D'$, avec $D'$ positif, $D' \equiv 3 \pmod 4$, donc
\begin{align*}
\legendre{D}{m} &= \legendre{-1}{m} \legendre{D'}{m}\\
&=(-1)^{\frac{m-1}{2}} (-1)^{\frac{D'-1}{2}\frac{m-1}{2}} \legendre{m}{D'} \\
&=(-1)^{\frac{m-1}{2} \frac{D'+1}{2}}  \legendre{m}{D'} \\
&=\legendre{m}{D'},
\end{align*}
et il en va de m\^eme pour l'entier $n$.
Si $m \equiv n \pmod D$, alors $m\equiv n \pmod{D'}$, donc
 $$\legendre{D}{m} = \legendre{m}{D'} = \legendre{n}{D'} = \legendre{D}{n}.$$
 
\item[$\bullet$] Si $D \equiv 0 \pmod 4$ et $D>0$, alors $D = 2^{2k} d$, ou $D = 2^{2k+1} d$, avec $k\geq 1$ et $d$ impair positif. 
 
 Dans le premier cas ($D = 2^{2k}d$),
 \begin{align*}
 \legendre{D}{m} &= \legendre{d}{m}
 = (-1)^{\frac{d-1}{2}\frac{m-1}{2}}\legendre{m}{d},\\
 \legendre{D}{n} &= \legendre{d}{n}
 = (-1)^{\frac{d-1}{2}\frac{n-1}{2}}\legendre{n}{d}.
 \end{align*}
 
 Comme $m\equiv n \pmod D$, alors $m\equiv n \pmod d$, donc $\legendre{m}{d} = \legendre{n}{d}$.
 
 Puisque $k\geq 1$, la congruence $m\equiv n \pmod D$ implique que $m\equiv n \pmod 4$, donc $(-1)^{\frac{m-1}{2}} = (-1)^{\frac{n-1}{2}} $, et aussi
 $$(-1)^{\frac{d-1}{2}\frac{m-1}{2}}= [ (-1)^{\frac{m-1}{2}}]^{\frac{d-1}{2}} =  [ (-1)^{\frac{n-1}{2}}]^{\frac{d-1}{2}} = (-1)^{\frac{d-1}{2}\frac{n-1}{2}},$$
ce qui montre que $ \legendre{D}{m} = \legendre{D}{n}$.
 
 Dans le deuxi\`eme cas ($D = 2^{2k+1} d$),
 \begin{align*}
  \legendre{D}{m} &= \legendre{2d}{m}\\
  &= \legendre{2}{m} \legendre{d}{m}\\
  &= (-1)^{\frac{m^2-1}{8}} (-1)^{\frac{d-1}{2}\frac{m-1}{2}} \legendre{m}{d}
 \end{align*}
 Comme $m\equiv n \pmod D$, et $k\geq 1$, $m \equiv n \pmod 8$, donc $(-1)^{\frac{m^2-1}{8}} = (-1)^{\frac{n^2-1}{8}}$, et comme ci-dessus $(-1)^{\frac{d-1}{2}\frac{m-1}{2}}=  (-1)^{\frac{d-1}{2}\frac{n-1}{2}}$, donc $ \legendre{D}{m} = \legendre{D}{n}$.
 
\item[$\bullet$] Si $D \equiv 0 \pmod 4$ et $D <0$, alors $D = -2^{2k} d$, ou $D = -2^{2k+1} d$, avec $k\geq 1$ et $d$ impair positif. 

Supposons que $m \equiv n \pmod D$.

Dans le premier cas, 
$$ \legendre{D}{m} = (-1)^{\frac{m-1}{2}} (-1)^{\frac{d-1}{2}\frac{m-1}{2}}\legendre{m}{d},$$
o\`u $m\equiv n \pmod 4$, donc  $(-1)^{\frac{m-1}{2}} = (-1)^{\frac{n-1}{2}}$, ce qui entraine $\legendre{D}{m} = \legendre{D}{n}$.

Dans le deuxi\`eme cas,
$$\legendre{D}{m} =(-1)^{\frac{m-1}{2}} (-1)^{\frac{m^2-1}{8}} (-1)^{\frac{d-1}{2}\frac{m-1}{2}} \legendre{m}{d},$$
o\`u $m\equiv n \pmod 8$, donc $(-1)^{\frac{m-1}{2}} = (-1)^{\frac{n-1}{2}}$ et $(-1)^{\frac{m^2-1}{8}} = (-1)^{\frac{n^2-1}{8}}$, ce qui permet de conclure comme pr\'ec\'edemment que $\legendre{D}{m} = \legendre{D}{n}$.
\end{proof}
Notons que ce r\'esultat ne s'\'etend pas \`a des valeurs de $D$ qui ne sont pas des discriminants. Ainsi, si $D = 7$, $3 \equiv 17 \pmod 7$, mais 
$$1 = \legendre{7}{3} \ne \legendre{7}{17} = -1.$$

\begin{prop}\label{prop176}
Soit $D\ne 0$ un discriminant, i.e. un nombre $D \equiv 0,1 \pmod 4$. Alors il existe un unique homomorphisme $\chi : (\Z/D\Z)^{\times} \to \{-1,1\}$ tel que $\chi([p]) = \legendre{D}{p}$ pour tout nombre premier impair qui ne divise pas $D$. De plus
$$
\chi([-1]) = 
\left\{
\begin{array}{cc}
1 & \text{ si } D>0,\\
-1 &\text{ si } D<0.
\end{array}
\right.
$$
\end{prop}
\begin{proof}
Soit $x = [u] \in (\Z/D\Z)^{\times}$ la classe d'un entier $u \in \Z$. V\'erifions qu'il existe un entier $m>0$, $m$ impair tel que $x = [m]$.

Si $D \equiv 0 \pmod 4$, $u$ est impair puisque $u \wedge D = 1$, et ainsi l'entier $m = u + 2k D$ est toujours impair, et il existe $k \in \Z$ tel que $m>0$ d'apr\`es la propri\'et\'e d'Archim\`ede.

Si $D \equiv 1 \pmod 4$, il existe un entier $k_0 \in \{0,1\}$ tel que $u + k_0 D$ soit impair ($k_0 = 0$ si $u$ est impair, $k_0 = 1$ si $u$ pair). Alors $ m = u + (k_0 + 2k) D$ est impair, et positif pour certaines valeurs de $k \in \Z$.

La valeur de $\legendre{D}{m}$ ne d\'epend pas du choix d'un tel $m>0$ impair d'apr\`es la proposition \ref{prop175}. Nous pouvons donc d\'efinir  l'application $\chi : (\Z/D\Z)^{\times} \to \{-1,1\}$ par  
$$\chi(x) = \chi([m]) =   \legendre{D}{m}, \qquad \text{o\`u } x = [m], m>0, m\text{ impair}.$$ 
Comme le symbole de Jacobi prolonge le symbole de Legendre, $\chi([p]) = \legendre{D}{p}$ pour tout nombre premier impair qui ne divise pas $D$.

L'application $\chi$ est bien un homomorphisme de groupes : si  $x,y$ sont des classes de $(\Z/D\Z)^{\times}$, et $m,n$ des repr\'esentants  positifs impairs de ces classes, alors $mn$ est un repr\'esentant positif impair de la classe $xy$, donc,  en utilisant la proposition \ref{prop168},
$$\chi(x) \chi(y) = \chi([m]) \chi([n]) = \legendre{D}{m} \legendre{D}{n} = \legendre{D}{mn} = \chi([mn]) = \chi(xy).$$
Calculons $\chi([-1])$.

\item[$\bullet$] Si $D>0, D \equiv 1 \pmod 4$,

$D$ est impair positif, ainsi que $2D-1$, donc la loi de r\'eciprocit\'e quadratique pour le symbole de Jacobi donne
\begin{align*}
\chi([-1]) &= \chi([2D-1])\\
&= \legendre{D}{2D-1}\\
&= (-1)^{\frac{D-1}{2} \frac{2D-2}{2}} \legendre{2D-1}{D}\\
&=\legendre{-1}{D}\\
&= (-1)^{\frac{D-1}{2}}\\
&= 1
\end{align*}

\item[$\bullet$] Si $D>0, D \equiv 0 \pmod 4$, alors $D = 2^{2k+1} d$, ou $D = 2^{2k} d$ avec $k\geq 1, d>0$, $d$ impair.

Si $D = 2^{2k+1}d\ (k\geq 1)$, alors $D-1 \equiv -1 \pmod 8$, donc $\legendre{2}{D-1} = 1$. Ainsi
\begin{align*}
\chi([-1]) &= \chi([D-1])\\
&= \legendre{D}{D-1}\\
&= \legendre{2^{2k+1}d}{2^{2k+1}d -1}\\
&=  \legendre{2d}{2^{2k+1}d -1}\\
&= \legendre{2}{D-1} \legendre{d}{2^{2k+1}d - 1}\\
&=\legendre{d}{2^{2k+1}d - 1}\\
&=(-1)^{\frac{d-1}{2} (2^{2k}d -1)} \legendre{2^{2k+1}d - 1}{d}\\
&=(-1)^{\frac{d-1}{2} } \legendre{-1}{d}\\
&= 1.
\end{align*}

Si $D = 2^{2k}d,\ k\geq 1$,
\begin{align*}
\chi([-1]) &= \chi([D-1])\\
&= \legendre{D}{D-1}\\
&= \legendre{2^{2k}d}{2^{2k}d - 1}\\
&= \legendre{d}{2^{2k}d - 1}\\
&= (-1)^{\frac{d-1}{2} (2^{2k-1}d - 1)} \legendre{2^{2k}d - 1}{d}\\
&=(-1)^{\frac{d-1}{2}} \legendre{-1}{d}\\
&=1.
\end{align*}


\item[$\bullet$] Si $D<0, D\equiv 1 \pmod 4$, alors $D = -D'$, avec $D'>0$, $D'$ impair, $D' \equiv 3 \pmod 4$. Alors
\begin{align*}
\chi([-1]) &= \chi([2D' - 1])\\
&=\legendre{-D'}{2D' - 1}\\
&= \legendre{-1}{2D'-1} \legendre{D'}{2D'-1}\\
&=(-1)^{D'-1} (-1)^{\frac{D'-1}{2}(D'-1)} \legendre{2D'-1}{D'}\\
&=\legendre{-1}{D'}\\
&=(-1)^{\frac{D'-1}{2}}\\
&= -1.
\end{align*}

\item[$\bullet$] Si $D<0, D \equiv 0 \pmod 4$, alors $D = -2^{2k} d$ ou $D = -2^{2k+1} d$, avec $k\geq 1, d>0$, $d$ impair.

Si $D = -2^{2k} d$,
\begin{align*}
\chi([-1]) &= \chi([-2D-1])\\
&= \chi([2^{2k+1}d -1])\\
&=\legendre{-2^{2k}d}{2^{2k+1} d - 1}\\
&= \legendre{-1}{2^{2k+1} d - 1} \legendre{d}{2^{2k+1} d - 1}\\
&=(-1)^{2^{2k}d - 1} (-1)^{\frac{d-1}{2}(2^{2k}d-1)} \legendre{2^{2k+1} d - 1}{d}\\
&= (-1) (-1)^{\frac{d-1}{2}} \legendre{-1}{d}\\
&= -1.
\end{align*}

Si $D = -2^{2k+1}d$, alors $-2D-1 = 2^{2k+2}d -1 \equiv -1 \pmod 8$, donc
\begin{align*}
\chi([-1]) &= \chi([-2D-1])\\
&=\chi([2^{2k+2}d - 1])\\
&=\legendre{-2^{2k+1}d}{2^{2k+2} d -1}\\
&=\legendre{-2d}{2^{2k+2} d -1}\\
&= \legendre{-1}{2^{2k+2}d -1} \legendre{2}{2^{2k+2}d -1} \legendre{d}{2^{2k+2}d -1}\\
&= - (-1)^{\frac{d-1}{2} (2^{2k+1} d -1)} \legendre{2^{2k+2} d - 1}{d}\\
&= - (-1)^{\frac{d-1}{2}} \legendre{-1}{d}\\
&= -1.
\end{align*}



On a bien prouv\'e 
$$
\chi([-1]) = 
\left\{
\begin{array}{cc}
1 & \text{ si } D>0,\\
-1 &\text{ si } D<0.
\end{array}
\right.
$$

Il n'existe qu'un seul homomorphisme de groupes $(\Z/D\Z)^{\times} \to \{-1,1\}$ tel que $\chi([p]) = \legendre{D}{p}$ pour tout nombre premier impair qui ne divise pas $D$. En effet, nous avons vu que toute classe $x \in (\Z/D\Z)^{\times} $ contient un entier impair positif, qui est produit de nombres premiers impairs premiers avec $D$. La connaissance de $\chi([p])$ pour ces valeurs de $p$ d\'etermine donc $\chi$.
\end{proof}

Remarque : on peut calculer $\chi([2])$ dans le cas o\`u $D \equiv 1 \pmod 4$ (alors $2 \wedge D = 1$, et donc $[2] \in (\Z/D\Z)^{\times}$). 

Si $D>0$,
\begin{align*}
\chi([2]) &= \chi([D+2])\\
&= \legendre{D}{D+2}\\
&=(-1)^{\frac{D-1}{2} \frac{D+1}{2}} \legendre{D+2}{D}\\
&=\legendre{2}{D}\\
&=  (-1)^{\frac{D^2-1}{8}}\\
\end{align*}
Si $D<0$, posons $D' = -D$. Alors $D'>0,D'\equiv 3 \pmod 4$,
\begin{align*}
\chi([2])&= \chi([-D+2])\\
&= \legendre{D}{-D+2}\\
&= \legendre{-D'}{D'+2}\\
&=(-1)^{\frac{D'+1}{2}} \legendre{D'}{D'+2}\\
&=  (-1) ^{\frac{D'-1}{2}\frac{D'+1}{2}}\legendre{D'+2}{D'}\\
&= \legendre{2}{D'}\\
&= (-1)^{\frac{D'^2 - 1}{8}}\\
&=(-1)^{\frac{D^2 - 1}{8}}
\end{align*}
On a ainsi prouv\'e, quel que soit le signe de $D$, que
$$
\chi([2]) = 
\left\{
\begin{array}{cc}
1 & \text{ si } D\equiv 1 \pmod 8,\\
-1 &\text{ si } D \equiv 5 \pmod 8.
\end{array}
\right.
$$

La proposition \ref{prop176} permet de trouver les diviseurs premiers de la forme $x^2 + n y^2$.

\begin{prop}\label{prop177}
Soit $n$ un entier non nul, et $D = -4n$ le discriminant de la forme $x^2+ny^2$, et soit $\chi : (\Z/4n \Z)^{\times} \to \{-1,1\}$ l'unique homomorphisme tel que $\chi([p]) = \legendre{D}{p}$ pour tout nombre premier impair premier avec $n$. Alors, pour ces nombres premiers,
$$\exists (x,y) \in \Z^2,\ p\mid x^2 + n y^2 \text{ et } x\wedge y = 1 \iff [p] \in \ker(\chi).$$
\end{prop}

\begin{proof}
D'apr\`es la proposition \ref{prop174}, si $p$ est un nombre premier impair premier avec $n$, 
$$\exists (x,y) \in \Z^2,\ x\wedge y = 1 \text{ et } p \mid x^2 + n y^2 \iff \legendre{-n}{p} = 1.$$
Comme $\legendre{D}{p} = \legendre{-4n}{p} = \legendre{-n}{p}$, pour de tels $p$, $$\legendre{-n}{p} = 1 \iff \chi([p]) = 1 \iff [p] \in \ker(\chi).$$
\end{proof}

Si on note $\ker(\chi) = \{[\alpha],[\beta],[\gamma],\ldots\}$, alors
$$p\in \ker(\chi) \iff p \equiv \alpha,\beta,\gamma,\ldots \pmod {4n}  \iff p \mid x^2+ny^2, x\wedge y = 1.$$
Ainsi l'\'etape ``r\'eciprocit\'e'' dans la repr\'esentation d'un nombre premier par la forme $x^2+ny^2$ est enti\`erement r\'esolu.

\section{Th\'eorie \'el\'ementaire du genre.}
A titre d'exemple, nous avons vu (§ \ref{section6.7}. du chapitre ``Formes quadratiques'') que, pour tout nombre premier impair diff\'erent de $5$,
\begin{align*}
p\equiv 1,3,7,9 \pmod{20} &\iff \legendre{-5}{p} = 1\\
&\iff \exists (x,y)\in\Z^2,\ p=x^2+5y^2 \text{ ou } p = 2x^2 + 2xy + 3y^2.
\end{align*}
Dans ce m\^eme paragraphe, nous avons d\'ej\`a s\'epar\'e ces deux cas en utilisant des congruences modulo 4. Plus g\'en\'eralement, nous allons, en suivant Lagrange, classer les formes de m\^eme discriminant $D$ en utilisant des congruences modulo $D$.

Soit $u\in (\Z/D\Z)^{\times}$. On dit qu'une forme $f(x,y)$ de discriminant $D$ repr\'esente $u$ dans $(\Z/D\Z)^{\times}$ s'il existe $x_0,y_0 \in \Z$ tels que $[f(x_0,y_0)] = u$. Ainsi $H$, l'ensemble des \'el\'ements de $(\Z/D\Z)^{\times}$ repr\'esent\'es par $f$ est
$$H = \{u\in (\Z/D\Z)^{\times} \ | \ \exists x_0,y_0 \in \Z, \ u = [f(x_0,y_0)]\}.$$
Si on note $\overline{f}(x,y) = [a]x^2 + [b] xy + [c]y^2$, alors
$$H = \{u \in (\Z/D\Z)^{\times}\ | \ \exists (s,t) \in (\Z/D\Z)^{\times}, \ u = \overline{f}(s,t) \}.$$
Par exemple, pour $D = -20$,
$$
\begin{array}{clll}
x^2 + 5y^2 & \text{repr\'esente} &1,9 & \text{dans } (\Z/20\Z)^{\times},\\
2x^2 + 2xy + 3y^2& \text{repr\'esente} &3,7 & \text{dans } (\Z/20\Z)^{\times},\\
\end{array}
$$
et pour $D = -56$,
$$
\begin{array}{clll}
x^2 + 14y^2, \ 2x^2+7y^2 & \text{repr\'esentent} &1,9,15,23,25,39 & \text{dans } (\Z/56\Z)^{\times},\\
3x^2 + 2xy+5y^2,\ 3x^2 - 2xy+5y^2& \text{repr\'esentent} &3,5,13,19,27,45 & \text{dans } (\Z/56\Z)^{\times}.\\
\end{array}
$$
Comme ces r\'esultats sont purement calculatoires, nous les confions au programme {\bf genre1} donn\'e dans l'annexe informatique du chapitre.

Pour g\'en\'eraliser, donnons la d\'efinition suivante.
\begin{dfn}
Deux formes primitives d\'efinies positives de discriminant $D$ appartiennent au m\^eme genre si elle repr\'esentent les m\^eme valeurs dans $(\Z/D\Z)^{\times}$.
\end{dfn}

Ceci revient \`a d\'efinir le genre d'une forme (primitive, d\'efinie positive) de discriminant $D$, comme l'ensemble des formes de discriminant $D$ qui repr\'esentent les m\^emes \'el\'ements de $(\Z/D\Z)^{\times}$.

Deux formes \'equivalentes repr\'esentent les m\^emes entiers, donc sont dans le m\^eme genre. Ainsi chaque genre est une r\'eunion finie de classes de formes. Dans les exemples pr\'ec\'edents, pour $D = -20$, il existe deux genres, chacun ne contenant qu'une classe de formes, et pour $D = -56$, il existe aussi deux genres, mais contenant chacun deux classes. 

Si $\legendre{-5}{p} = 1, \ p\ne 5, p \ne 2$, $p$ est de la forme $p = x^2+5y^2$ ou $p = 2x^2+2xy+3y^2$. Dans le premier cas, dans $\Z/20\Z$, $[p] = [x]^2 + [5][y]^2, \ [x],[y] \in \Z/20\Z$, donc $[p] \in  (\Z/20\Z)^{\times}$ est repr\'esent\'e par la forme $x^2 + 5y^2$. Ainsi, si $p\ne 2,p \ne 5$,
$$\begin{array} {rcl}
p =x^2+5y^2,\ x,y\in \Z & \iff & p\equiv 1,9 \pmod{20},\\
p = 2x^2 + 2xy + 3y^2,\ x,y\in \Z &\iff & p \equiv 3,7 \pmod{20}.
\end{array}
$$
De m\^eme, si $p \ne 2, p\ne 7$,
$$\begin{array} {rcl}
p =x^2+14y^2 \text{ ou } p = 2x^2+7y^2,\ x,y\in \Z & \iff & p\equiv 1,9,15,23,25,39 \pmod{56},\\
p = 3x^2 \pm 2xy + 5y^2,\ x,y\in \Z &\iff & p \equiv 3,5,13,19,27,45 \pmod{56}.
\end{array}
$$

Dans les exemples pr\'ec\'edents, les valeurs de $(\Z/DZ)^{\times}$ repr\'esent\'ees par une forme de discriminant $D$ sont dans $\ker(\chi)$. Ceci est g\'en\'eral :

\begin{prop}\label{prop178}
Soit $f$ une forme binaire de discriminant $D$. Soit $H$ l'ensemble des valeurs de $(\Z/D\Z)^{\times}$ repr\'esent\'ees par $f$. Alors $$H \subset \ker(\chi),$$ o\`u $\chi : (\Z/D \Z)^{\times} \to \{-1,1\}$ est l'unique homomorphisme tel que $\chi([p]) = \legendre{D}{p}$ pour tout nombre premier impair qui ne divise pas $D$.
\end{prop}

\begin{proof}
Ici $f = (a,b,c)$ et une forme de discriminant $D$, et $H$ est l'ensemble des valeurs de $(\Z/D\Z)^{\times}$ repr\'esent\'ees par $f$. 

Soit $u \in H$ . Alors $u = [m] \in (\Z/D\Z)^{\times}$, o\`u $m$ est repr\'esent\'e par $f$. 

 Alors 
 $m = ax^2 + bxy +cy^2$, o\`u $x,y \in \Z$, et $m$ est premier avec $D$. Si $d= x\wedge y$, $x = d x', y =dy',\ x',y' \in \Z,\ x'\wedge y'=1$, et $m= d^2 m'$, o\`u $m' =f(x',y')$ est primitivement repr\'esent\'e par $f$. Alors $\chi([m]) = \chi([d^2 m']) = \chi([d])^2 \chi([m']) = \chi([m'])$, et ainsi $m\in \ker(\chi) \iff m'\in \ker(\chi)$. On peut donc supposer que $m$ est primitivement repr\'esent\'e par $f(x,y)$. La proposition \ref{lagrange} du chapitre ``Formes quadratiques'' montre alors que $D$ est un carr\'e modulo $4m$. Il existe donc $b,c \in \Z$ tels que $D = b^2 - 4m c$.
 
Cas 1 : $m$ est impair. Puisque $m \wedge D = 1$, $m$ est aussi premier avec $b$, donc $\legendre{b}{m} \ne 0$, et $m>0$. Les propri\'et\'es du symbole de Jacobi montrent que
 $$\chi([m]) =  \legendre{D}{m} = \legendre{b^2 - 4mc}{m} = \legendre{b^2}{m} = \legendre{b}{m}^2 = 1.$$
 
Cas 2 :  $m$ est pair. Comme $m\wedge D = 1$, ceci ne peut se produire que si $D \equiv 1 \pmod 4$. Comme $D = b^2 - 4mc$, $D \equiv b^2 \pmod 8$. Ici $b$ est impair, par cons\'equent $b^2 = (2k+1)^2 = 8 \frac{k(k+1)}{2} + 1 \equiv 1 \pmod 8$, et donc
$$D \equiv 1 \pmod 8.$$
Le calcul de $\chi([2])$ qui suit la proposition \ref{prop176} montre qu'alors $\chi([2]) = 1$. 

Ecrivons $m$ sous la forme $m = 2^k l$, o\`u $l$ est un entier impair positif. Comme $m \wedge b = 1$, $l$ est premier avec $b$, donc $\legendre{b}{l}\ne 0$, et ainsi
$$\chi([m]) = \chi([2])^k \chi(l) = \legendre{D}{l} =\legendre{b^2 - 4\times2^k l c}{l} = \legendre{b^2}{l} = \legendre{b}{l}^2 = 1.$$
Ainsi $H \subset \ker(\chi)$.
 \end{proof}
 
 Donnons une formule qui compl\`ete la formule classique, dite de Brahmagupta,
 $$(x^2+ny^2)(x'^2+ny'^2) = (xx'-nyy')^2 + n(xy'+yx')^2$$
  pour les formes principales de discriminants impairs.
 \begin{prop}\label{prop179}
 Si $D<0,D\equiv 1 \pmod 4$, alors
 $$\left(x^2 + xy +\left(\frac{1-D}{4}\right) y^2\right)\left(x'^2 + x'y' +\left(\frac{1-D}{4}\right) y'^2\right) = X^2 + XY +\left(\frac{1-D}{4}\right) Y^2,$$
 o\`u 
$$
\left\{
\begin{array}{ccl}
X &= &xx'  - \frac{1-D}{4} yy',\\
Y &= &xy' + yx'+ yy'.
\end{array}
\right.
$$
 \end{prop}
 \begin{proof}
Notons $\alpha = \frac{1+\sqrt{D}}{2} =  \frac{1+i\sqrt{|D|}}{2} $, et $\mathrm{N}(z) = |z|^2$ la norme d'un nombre complexe $z$.
Alors
\begin{align*}
 \mathrm{N}(x + y \alpha)
&=\left(x + \frac{y}{2} + \frac{\sqrt{D}}{2} y\right)\left(x + \frac{y}{2} - \frac{\sqrt{D}}{2} y\right)\\
&=\left(x + \frac{y}{2}\right)^2 - \frac{D}{4} y^2\\
&= x^2 + xy +\left(\frac{1-D}{4}\right) y^2
\end{align*}
Soit $P = \left(x^2 + xy +\left(\frac{1-D}{4}\right) y^2\right)\left(x'^2 + x'y' +\left(\frac{1-D}{4}\right) y'^2\right)$. Comme $\alpha^2 = \alpha +\frac{D-1}{4}$,
\begin{align*}
P&=\mathrm{N}(x + \alpha y) \mathrm{N}(x'+ \alpha y')\\
&=\mathrm{N}[(x+ \alpha y)(x'+\alpha y')]\\
&=\mathrm{N}\left[xx' +\alpha(xy'+yx') + \left(\alpha +\frac{D-1}{4}\right)yy'\right]\\
&=\mathrm{N}\left[ xx' +\frac{D-1}{4} yy' + (xy'+yx' +yy') \alpha \right]\\
&=X^2 + XY +\left(\frac{1-D}{4}\right) Y^2,
\end{align*}
o\`u 
$$
\left\{
\begin{array}{ccl}
X &= &xx'  - \frac{1-D}{4} yy',\\
Y &= &xy' + yx'+ yy'.
\end{array}
\right.
$$

\end{proof} 

  
 
 
 
 \begin{prop}\label{prop181}
Soit $D$ un entier n\'egatif, $D \equiv 0,1 \pmod 4$, et soit $\chi : (\Z/D \Z)^{\times} \to \{-1,1\}$ l'unique homomorphisme tel que $\chi([p]) = \legendre{D}{p}$ pour tout nombre premier impair qui ne divise pas $D$. Si $f(x,y)$ est une forme de discriminant $D$, alors
\be
\item[(i)] Les \'el\'ements de $(\Z/D\Z)^{\times}$ repr\'esent\'es par la forme principale de discriminant $D$ forment un sous-groupe $H \subset \ker(\chi)$.
\item[(ii)] Les \'el\'ements de $(\Z/D\Z)^{\times}$ repr\'esent\'es par la forme $f(x,y)$ forment une classe de $\ker(\varphi)$ modulo $H$.
\ee
\end{prop}
\begin{proof}
\item[(i)] Nous savons par la proposition \ref{prop178} que $H \subset \ker(\chi)$.

Si $D \equiv 0 \pmod 4$, alors $D = -4n$, et la forme principale $f_D$ de discriminant $D$ s'\'ecrit
$$f_D(x,y) = x^2 + n y^2.$$
Si $u, v \in (\Z/D\Z)^{\times}$ sont repr\'esent\'es par $f$, alors $u = x^2+ny^2, v = z^2 + n w^2$, o\`u $x,y,n,w \in \Z/D\Z$.
L'identit\'e de Brahmagupta dans $\Z/D\Z$ s'\'ecrit ici
$$(x^2 + ny^2)(z^2 + n w^2) = (xz-nyw)^2 + n (xw +yz)^2.$$
Ainsi $uv$ est repr\'esent\'e par la forme $x^2+ny^2$, et $uv \in (\Z/D\Z)^{\times}$, donc $uv \in H$.

Ainsi $H$ contient $[1] = [1]^2 + [n] [0]^2$,  $H$ est stable pour le produit, et $H$ est fini, donc $H$ est un sous-groupe de $\ker(\chi)$.

Supposons maintenant que $D \equiv 1 \pmod 4$. Si $u,v$ sont repr\'esent\'es par la forme principale de discriminant $D$
$$f_D(x,y) = x^2 + xy + \left(\frac{1-D}{4} \right) y^2,$$
alors la proposition 14 montre que le produit $uv$ l'est aussi. Comme dans le premier cas, ceci montre que $H$ est un sous-groupe de $\ker(\chi)$.

Remarque : 
\begin{align*}
4 f_D(x,y) &= 4 x^2 + 4xy +(1-D) y^2\\
&= (2x + y)^2 - D y^2\\
&\equiv (2x +y)^2 \pmod D
\end{align*}
Ici $D$ est impair, donc $[2]$ est inversible dans $\Z/D\Z$. Si $[m] \in (\Z/D\Z)^{\times}$ est repr\'esent\'e par $f_D$ , alors $[m] = [f_D(x,y)],\ x,y\in \Z$, donc $[m] = ([x] + [2]^{-1}[y])^2$ est le carr\'e d'un \'el\'ement $[m'] \in \Z/D\Z$.  Comme $m \equiv m'^2 \pmod D$, $m'$ est premier avec $D$, donc $[m]$ est un carr\'e du groupe $(\Z/D\Z)^{\times}$. R\'eciproquement, si $[m] = [a]^2 \in (\Z/D\Z)^{\times}$ est un carr\'e, alors $[m] = [f(a,0)]$ est repr\'esent\'e par $f_D$. $H$ est donc ici le groupe des carr\'es de $(\Z/D\Z)^{\times}$, ce qui prouve \`a nouveau, sans l'aide de la proposition \ref{prop179}, que $H$ est un sous-groupe.

\item[(ii)] Supposons que $D \equiv 0 \pmod 4$, soit $D = -4n$. Appliquons la proposition \ref{prop180} au nombre $M = 4n$ : il existe un entier $a\in \Z$, premier avec $4n$, et repr\'esent\'e primitivement par $f$. D'apr\`es la proposition \ref{clef} du chapitre ``Formes quadratiques binaires'', il existe $b,c\in \Z$ tels que $f \overset{+}{\sim} g = (a,b,c)$, o\`u $a$ est premier avec $4n$. Comme les formes $f$ et $g$ repr\'esentent les m\^emes valeurs enti\`eres, elles ont m\^eme discriminant $D = -4n$, et elles repr\'esentent les m\^emes valeurs dans $(\Z/D\Z)^{\times}$. Si on note $L$ l'ensemble des valeurs de  $(\Z/D\Z)^{\times}$ repr\'esent\'ees par $f$, alors 
\begin{align*}
L &=  \{u\in (\Z/D\Z)^{\times} \ | \ \exists (x_0,y_0) \in \Z^2, \ u = [g(x_0,y_0)]\}\\
\end{align*}
Comme $D \equiv 0 \pmod 4$, il s'ensuit que $b$ est pair, donc $b = 2b', b'\in \Z$, et ainsi $g(x,y) = ax^2 + 2b' xy + cy^2$, et
$$ag(x,y) = (ax + b'y)^2 + n y^2.$$

Montrons que $L = [a]^{-1}H$.

Si $[u] \in L$, alors il existe $x_0,y_0 \in \Z$ tels que $ [u]  = [g(x_0,y_0)]$.

Alors  ${[a][u]= [(a x_0 + b'y_0)^2 + ny_0^2]}$, ce qui montre que $[a] [u]$ est repr\'esent\'e par la forme principale de discriminant $D$, et ainsi que $[a][u] \in H$, soit encore $[u] \in [a]^{-1} H$.

R\'eciproquement, si $[u] \in [a]^{-1} H$, alors $au \equiv z^2 + nw^2 \pmod{4n}$ pour certains entiers $z,w$. Comme $a$ est inversible modulo $4n$, d'inverse $a'$ (i.e. $aa' \equiv 1 \pmod {4n}$), le syt\`eme d'inconnues $x_0,y_0$ modulo $p$
$$
\left\{
\begin{array}{ccrl}
z &\equiv&ax_0 + b'y_0 & (\mathrm{mod} \ 4n)\\
w & \equiv & y_0 & (\mathrm{mod} \ 4n)\\
\end{array}
\right.
$$
a une solution modulo $4n$, donn\'ee par $x_0 = a'(z - b'w), y_0 = w$. Pour ces valeurs de $x_0,y_0$, on obtient
$$au \equiv (ax_0+b'y_0)^2 + ny_0^2 = ag(x_0,y_0) \pmod {4n},$$
donc $[u]  = [ g(x_0,y_0)] \in L$. Il est bien prouv\'e que $L = [a]^{-1} H$ est une classe relative \`a $H$ dans le groupe $\ker(\chi)$.

Supposons maintenant que $D \equiv 1 \pmod 4$. La proposition \ref{prop180} donne un entier $a$ premier avec $D$ et repr\'esent\'e primitivement par $f$. La proposition \ref{clef} du chapitre ``Formes quadratiques binaires'' montre qu'il existe $b,c\in \Z$ tels que $f \overset{+}{\sim} g = (a,b,c)$, o\`u $a$ est premier avec $D$, et donc $f,g$ repr\'esentent les m\^emes valeurs dans $(\Z/D\Z)^{\times}$.

Alors $g(x,y) = ax^2 + bxy +cy^2$, donc $4ag(x,y) = (2ax +b)^2 - D y^2$. Comme $D$ est impair, $[2]$ est inversible dans $(\Z/D\Z)^{\times}$, et on obtient ainsi l'\'egalit\'e dans $\Z/D\Z$
$$[a][g(x,y)] = ([a][x] + [2]^{-1}[b])^2.$$
Montrons que l'ensemble des valeurs $L$ repr\'esent\'ees par $g$ (ou $f$) dans $(\Z/D\Z)^{\times}$ est $[a]^{-1} H$.

La remarque de la partie (i) montre que $H$ est le sous-groupe des carr\'es dans $(\Z/D\Z)^{\times}$.

Si $[u] \in L$, alors $u = [g(x_0,y_0)],\ x_0,y_0 \in \Z$, donc $$[u] =[a]^{-1} ([a][x_0] + [2]^{-1}[b])^2 \in [a]^{-1}H.$$

R\'eciproquement, si $[u] \in [a]^{-1} H$, alors $[u] = [a]^{-1} [z]^2$ pour un entier $z$. Comme $[a]$ est inversible, l'\'equation en $[x_0]$
$$[z] = [a][x_0] + [2]^{-1} [b]$$
admet une solution unique $[x_0]$ (i.e. $[x_0] = [a]^{-1}([z] -[2]^{-1}[b]$), dont on choisit un repr\'esentant $x_0$, qui v\'erifie
$$4au \equiv (2ax_0 + b)^2 = 4ag(x_0,0) \pmod D.$$
Comme $2$ et $a$ sont inversibles modulo $D$, $u \equiv g(x_0,0) \pmod D$, donc $[u] \in L$. Ainsi $L = [a]^{-1} H$ est une classe relative \`a $H$ dans le groupe $\ker(\chi)$.
\end{proof}

Ainsi un genre est l'ensemble des formes (primitives, d\'efinies positives) qui repr\'esentent les valeurs d'une classe $H'$.

On sait d\'ej\`a (proposition \ref{repr_premier} du chapitre "Formes quadratiques binaires") que tout nombre premier impair $p$ tel que $[p] \in \ker(\chi)$ est repr\'esent\'e par une des $h(D)$ formes r\'eduites primitives de discriminant $D$. On peut maintenant pr\'eciser
\begin{prop}
Supposons que $D \equiv 0,1 \pmod 4, D<0$, et soit $H$ le sous-groupe de $\ker(\chi)$ des \'el\'ements de $(\Z/D\Z)^{\times}$ repr\'esent\'es par la forme principale de discriminant $D$. Si $H'$ est une classe relative \`a $H$ dans $\ker(\chi)$ et si $p$ est un nombre premier impair qui ne divise pas $D$, alors $[p]\in H'$ si et seulement si $p$ est repr\'esent\'e par une forme r\'eduite de discriminant $D$ dans le genre associ\'e \`a $H'$.
\end{prop}
\begin{proof}
Si $[p] \in H'$, alors $[p] \in \ker(\chi)$, donc $p$ est repr\'esent\'e par une forme r\'eduite $f$ de discriminant $D$. L'ensemble des valeurs repr\'esent\'ees par $f$ dans $(\Z/D\Z)^{\times}$ est une classe $H''$ qui contient $[p]$. Comme les classes sont \'egales ou disjointes, $H''= H'$, donc $f$ est dans le genre associ\'e \`a $H'$.

Inversement, si $p$ est repr\'esent\'e par une forme r\'eduite $f$ de discriminant $D$ dans le genre associ\'e \`a $H'$, alors $H'$ est l'ensemble des valeurs repr\'esent\'ees par $f$ dans $(\Z/D\Z)^{\times}$. Puisque $[p] \in  (\Z/D\Z)^{\times}$ est repr\'esent\'e par $f$, nous concluons que $[p] \in H'$.
\end{proof}

Le genre de la forme principale s'appelle le genre principal. La classe associ\'ee $H$ est le groupe des carr\'es de $(\Z/D\Z)^{\times}$ si $D \equiv 1 \pmod 4$. Caract\'erisons $H$ si $D = -4n \equiv 0 \pmod 4$. La forme principale est $f(x,y) = x^2 + ny^2$. Si $[\alpha] \in H$, alors $\alpha  \equiv \beta^2 + n \gamma^2 \mod{D}$, o\`u $\beta, \gamma \in \Z$. Si $\gamma = 2 \delta$ est pair, alors $\alpha \equiv \beta^2 + 4 n \delta^2 \equiv \beta^2 \pmod D$, et si $\gamma = 2 \delta + 1$ est impair, $\beta^2 + n\alpha^2 = \beta^2 + (2\delta +1)^2 n  \equiv \beta^2 +n \pmod D$. R\'eciproquement, tout nombre $\alpha$ congru modulo $D$ \`a  $\beta^2$ ou $\beta^2 +n$ v\'erifie $\alpha \equiv f(\beta,0) \pmod D$, ou $\alpha \equiv f(\beta,1) \pmod D$, donc $[\alpha] \in H$. Ainsi 
\begin{align*}
H =& \{ u \in (\Z/D\Z)^{\times}\ | \ \exists v \in \Z/D\Z, \ u = v^2 \text{ ou } u = v^2 +n\}\\
&= \{ [\gamma] \in (\Z/D\Z)^{\times}\ | \ \exists \beta \in \Z, \gamma \equiv \beta^2 \text{ or } \gamma \equiv \beta^2 +n \pmod D\}
\end{align*}
On obtient donc
\begin{prop}
Soit $D<0$, $D \equiv 0,1 \pmod 4$ un discriminant et $p$ un nombre premier impair qui ne divise pas $D$. 
\be
\item[(i)] Si $D \equiv 1 \pmod 4$, alors $p$ est repr\'esent\'e par une forme de discriminant $D$ du genre principal si et seulement si pour un certain entier $\beta \in \Z$,
$$p \equiv \beta^2 \pmod D.$$

\item[(ii)]
Si $D \equiv 0 \pmod 4$, alors $p$ est repr\'esent\'e par une forme de discriminant $D = -4n$ du genre principal si et seulement si pour un certain entier $\beta \in \Z$,
$$p \equiv \beta^2, \beta^2 +n \pmod {D}.$$
\ee
\end{prop}


\begin{subappendices}
\section{R\'ecr\'eation informatique.}
\subsection{Genre d'une forme quadratique.}
Le programme suivant, du module {\bf genre1}, d\'etermine le genre principal d'une forme quadratique.

\begin{verbatim}
from numtheory import pgcd, ifactors
from nombreDeClasses import formes_reduites, h
from random import randrange

def representants(f):
    """ retourne la liste des entiers repr\'esent\'es la forme f=(a,b,c) dans (Z/DZ)^*
    """
    (a,b,c) = f
    D = b**2 - 4 * a * c
    A = set()
    N = abs(D)
    for x in range(N):
        for y in range(N):
            r = (a * x**2 + b * x * y + c * y**2) % abs(D)
            if pgcd(r,D) == 1:
                A.add(r)
    l = list(A)
    l.sort()
    return l

def coset_genre_principal(D):
    """ retourne la liste des entiers repr\'esent\'es 
        par la forme principale de discriminant D < 0
    """
    assert (D % 4 == 0 or D % 4 == 1) and D < 0
    if D % 4 == 0:
        delta = abs(D)
        n = delta // 4
        l = []
        for beta in range(2 * n):
            gamma = (beta ** 2) % delta 
            if pgcd(gamma, delta) == 1:
                l.append(gamma)
            gamma = (gamma + n) % delta
            if pgcd(gamma, delta) == 1:
                l.append(gamma)
    elif D % 4 == 1:
        delta = abs(D)
        l =[]
        for beta in range((delta - 1) // 2 + 1):
            gamma = (beta ** 2) % delta 
            if pgcd(gamma, delta) == 1:
                l.append(gamma)
    A = set(l)
    l = list(A)
    l.sort()
    return(l)

def forme_principale(D):
    """ retourne la forme principale de discriminant D
    """
    assert (D % 4 == 0 or D % 4 == 1) and D<0
    if D % 4 == 0:
        return(1,0,(-D) // 4)
    elif D % 4 == 1:
        return (1 ,1, (1 - D) // 4)
        
def appartient_genre_principal(f):
    """ d\'etermine l'appartenance de la forme binaire f
        au genre principal.
        Algorithme probabiliste
    """
    (a,b,c) = f
    D = b * b - 4 * a * c
    delta = abs(D)
    pastrouve = True
    while pastrouve:
        x = randrange(delta)
        y = randrange(delta)
        if pgcd(a * x * x + b * x * y + c * y * y, D) == 1:
            pastrouve = False
    if (a * x * x + b * x * y + c * y * y) % delta in coset_genre_principal(D):
        return(True)
    else:
        return(False)

def squarefree(n):
    l = ifactors(n)
    sqf = True
    for p,a in l:
        if a > 1:
            sqf = False
    return sqf

if __name__ == "__main__":
    D = -7559
    l = []
    for f in formes_reduites(D):
        if appartient_genre_principal(f):
            l.append(f)
    print(l)            
\end{verbatim}
\end{subappendices}

\part{TH\'EORIE ALG\'EBRIQUE DES NOMBRES.}


\chapter{Modules.}

Nous verrons que le groupe additif de l'anneau ${\cal O}_K$ des entiers d'un corps de nombres $K$ est un $\Z$-module libre de rang fini. Il nous faut donc commencer par quelques r\'esultats sur les $\Z$-modules libres, en particulier qu'un sous-module d'un $\Z$-module libre est un $\Z$-module libre.


\section{Structure de module sur un anneau.}


\begin{dfn}
Soit $R$ un anneau commutatif unitaire. Un $R$-module est un triplet $(M,+,.)$, o\`u $(+)$ est une loi de composition interne sur $M$, et $(.)$ une loi externe $R \times M \to M$, not\'ee $r,m) \mapsto rm$, v\'erifiant
\be
\item[(i)] $(M,+)$ est un groupe ab\'elien,
 et pour touts les $r,s \in R$ et $m,n \in M$,
\item[(ii)] $r(m+n)  = rm+rn$,
\item[(iii)] $(r+s)m = rm+sm$, 
\item[(iv)] $(rs)m = r(sm)$,
\item[(v)] $1.m = m$
\ee
\end{dfn}

{\bf Exemples.}
\be
\item[1.] L'ensemble $R^k$ ($k\in \N$), muni des lois
\begin{align*}
&(m_1,\ldots,m_k) + (n_1,\ldots,n_k) = (m_1+n_1,\ldots,m_k+n_k)\\ 
&r(m_1,\ldots,m_k) = (rm_1,\ldots, rm_k),
\end{align*}
est un $R$-module.

\item[2.] Tout id\'eal de $R$ est un $R$-module pour les loi induites.

\item[3.] Si $I$ est un id\'eal de $R$, alors $R/I$ est un $R$-module pour la loi $+$ de $R/I$ et la loi externe d\'efinie par $r . \overline{s} = \overline{rs}\  (r,s \in R)$.

\item[4.] L'anneau $R[T]$ est un $R$-module pour les lois usuelles.

\item[5.] L'ensemble $R^R$ est un $R$ module pour les lois $+,.$ d\'efinies par
\begin{align*}
 &(f+ g)(r) = f(r) +g(r),\\
 &(s. f)(r) = sf(r),
 \end{align*}
pour tout $r,s \in R$.
\ee

Beaucoup de propri\'et\'es des espaces vectoriels se retrouvent dans les modules. N\'eanmoins il y a quelques diff\'erences : on ne peut traduire l'ind\'ependance lin\'eaire de vecteurs en disant qu'aucun vecteur n'est combinaison lin\'eaire des autres, on ne peut pas toujours extraire une base d'un ensemble de vecteurs engendrant le module,...

Un $R$-sous-module de $M$ est un sous-groupe $N$ de $M$ pour l'addition tel que si $n \in N,r\in R$ alors $rn \in N$. $N$ est alors un $R$-module pour les lois induites.

On peut d\'efinir alors le module quotient $M/N$ comme \'etant le groupe quotient correspondant, avec la loi externe d\'efinie par
$$r(m + N) = rm + N\qquad (r\in R, m\in M).$$

Soit $X$ une partie quelconque de $M$. Le sous-module de $M$ engendr\'e par $X$, not\'e $\langle X \rangle_R$ est le plus petit sous-module de $M$ contenant $X$, i.e. l'intersection des sous-modules de $M$ contenant $X$.

Si $N = \langle x_1,\ldots,x_n\rangle_R$, on dit que $N$ est un $R$-module de type fini.

Si $R$ est un $\Z$-module, alors par d\'efinition $(R,+)$ est un groupe ab\'elien, et inversement un groupe ab\'elien est muni d'une structure de $\Z$-module pour la loi externe d\'efinie par induction :
$$ 0 m = 0, (n+1) m = nm + m , \text{ et } (-n) m = - nm \qquad (n\in \N, m \in M).$$
Les notions de $\Z$-modules et de groupes ab\'eliens sont donc interchangeables.

\section{$\Z$-modules libres.}
Soit $G$ un $\Z$-module. Supposons que la famille $(g_1,\ldots,g_n) \in G^n$ $g_1,\ldots,g_n$ soit telle que tout $g \in G$ s'\'ecrive sous la forme
$$g = m_1g_1+\cdots+m_ng_n\qquad (m_i \in \Z).$$
La famille $(g_1,\ldots,g_n)$ s'appelle une famille g\'en\'eratrice de $G$ (on dit encore que $G$ est engendr\'e par $g_1,\ldots,g_n$). S'il existe une famille g\'en\'eratrice de $G$, $G$ s'appelle alors un $\Z$-module de type fini.

On dit que $(g_1,\ldots,g_n) \in G$ est une famille libre de $G$ si, pour tout $(m_1,\ldots,m_n)\in \Z^n$,
$$m_1g_1+ \cdots + m_n g_n = 0 \Rightarrow m_1=\cdots = m_n = 0.$$
Une famille libre de vecteurs $(g_1,\ldots,g_n)$ de vecteurs de $G$ qui engendre $G$ s'appelle une $\Z$-base. Alors tout \'el\'ement $g$ de $G$ s'\'ecrit de façon unique sous la forme
$$g = m_1g_1+\cdots + m_n g_n.$$

Un groupe ab\'elien $G$ admet une base finie \`a $n$ \'el\'ements si et seulement si il est isomorphe \`a $\Z^n$ (en tant que groupes, et en tant que $\Z$-modules. Si $(g_1,\ldots,g_n)$ est une $\Z$-base de $G$, l'isomorphisme est d\'efini par
$$
\varphi
\left\{
\begin{array}{ccl}
\Z^n & \to &G\\
(m_1,\ldots,m_n) & \mapsto& m_1 g_1+ \cdots + m_ng_n.
\end{array}
\right.
$$

Un $\Z$-module ayant une base \`a $n$ \'el\'ements, o\`u $n \in \N^*$, s'appelle un $\Z$-module libre (ou groupe ab\'elien libre) de rang $n$, et $G = \{0\}$ est aussi un $\Z$-module libre, de rang $0$.

\begin{prop}
Soit $G$ un $\Z$-module libre de rang $n$. Alors toutes les bases de $G$ ont $n$ \'el\'ements.
\end{prop}
\begin{proof}
Par hypoth\`ese, $G$ admette une base \`a $n$ \'el\'ements $(g_1,\ldots,g_n)$. 

Consid\'erons le sous-groupe $2G$ de $G$ qui est l'ensemble des \'el\'ements de $G$ de la forme $2g = g+ g$. Alors $G/2G$ est un groupe fini, de cardinal $2^n$. En effet tout \'el\'ement $g =\sum_{i=1}^n m_i g_i$ de $G$ a un unique repr\'esentant modulo $2G$ de la forme $\eta_1 g_1+ \cdots + \eta_n g_n$, o\`u $\eta_i = 0$ ou $\eta_i = 1$, suivant que $m_i$ soit pair ou impair. Si $(f_1,\cdots,f_m)$ est une autre base de $G$, le m\^eme raisonnement montre que $|G/2G| = 2^m$, donc $2^m = 2^n$, et $n=m$.
\end{proof}


\begin{prop}\label{M140}
Soit $G$ un $\Z$-module libre de rang $n$, muni d'une base $(e_1,\ldots,e_n)$, et soit $(f_1,\ldots,f_n)$ une famille d'\'el\'ements de $G$ d\'efinis par
$$f_i = \sum_{j=1}^n a_{ij} e_j.$$
Alors $(f_1,\ldots,f_n)$ est une base de $G$ si et seulement si la matrice $A = (a_{ij}) _{1\leq i,j \leq n}$ est unimodulaire (i.e. $\det(A) = \pm 1$).
\end{prop}

\begin{proof}
Si $(e_1,\ldots,e_n)$ et $(f_1,\ldots,f_n)$ sont deux bases d'un groupe ab\'elien libre de rang $n$, alors il existe des entiers $a_{ij}, b_{ij} \in \Z$ tels que
$$f_i = \sum_{j=1}^n a_{ij} e_j,\qquad e_i = \sum_{j=1}^n b_{ij} f_j.$$
Consid\'erons les deux matrices $$A = (a_{ij})_{1\leq i,j\leq n},\qquad B = (b_{ij})_{1\leq i,j\leq n}.$$
Alors 
$$e_i = \sum_{j=1}^n b_{ij} f_j = \sum_{j=1}^n b_{ij} \sum_{k=1}^n a_{jk} e_k,$$
donc, en utilisant le symbole de Kronecker d\'efini par $\delta_{ij} = 0$ si $i\ne j$, $\delta_{ii} = 1 (\ 1\leq i,j \leq n)$,
$$\sum_{k=1}^n \delta_{ik} e_k = \sum_{k=1}^n \left(\sum_{j=1}^n b_{ij}  a_{jk}\right) e_k.$$
Comme $(e_1,\ldots,e_n)$ est libre,
$$\sum_{j=1}^n b_{ij}  a_{jk} = \delta_{ik},$$
soit $BA = I_n$.

Par cons\'equent,
$$\det(B)\det(A) = 1.$$
Comme $A,B \in {\cal M}_n(\Z)$, $\det(A),\det(B) \in \Z$, donc
$$\det(A) = \det(B) = \pm 1.$$

R\'eciproquement, si $det(A) = \pm 1$, alors 
$$A^{-1} = \frac{1}{\det(A)} \tilde{A} = \pm \tilde{A},$$
o\`u la matrice adjointe $\tilde{A}$ est \`a coefficient entiers. Ainsi $B = A^{-1} = (b_{ij})_{1\leq i,j\leq n} \in {\cal M}_n(\Z)$, et $e_i = \sum_{j=1}^n b_{ij} f_j \ (1\leq i \leq n)$. Ceci montre que les \'el\'ements $f_1,\ldots, f_n$ engendrent $G$. 

De plus, l'hypoth\`ese $\sum\limits_{i=1}^n m_i  f_i= 0$ donne $\sum\limits_{i=1}^n m_i \sum\limits_{j=1}^n a_{ij} e_j = 0$, donc $\sum\limits_{j=1}^n \left(\sum\limits_{i=1}^n a_{ij} m_i \right) e_j$. Puisque $(e_1,\ldots,e_n)$ est libre, $\sum\limits_{i=1}^n a_{ij} m_i =0 \ (1\leq i \leq n)$, donc $A X = 0$, o\`u $X =\,^t(m_1,\ldots,m_n)$. Comme $\det(A) \ne 0$, $X = 0$, donc $m_1 = \cdots = m_n = 0$. Ainsi $(f_1,\ldots,f_n)$ est une $\Z\,$-base de $G$.
\end{proof}

Nous noterons $\mathrm{GL}_n(\Z)$ l'ensemble des matrices unimodulaires de ${\cal M}_n(\Z)$, de determinant \'egal \`a $\pm 1$.

\begin{prop}\label{M141}
Tout sous-module $H$ d'un $\Z$-module libre $G$ de rang $n$ est libre de rang $s\leq n$. De plus, si $n>0$ et $H \ne \{0\}$, il existe une base $(u_1,\ldots,u_n)$ de $G$ et des entiers positifs $\alpha_1,\ldots,\alpha_s$ tels que $(\alpha_1u_1,\ldots,\alpha_su_s)$ est une base de $H$.
\end{prop}

\begin{proof}
Si $n = 0$, $G = H = \{0\}$, et $H$ est libre de rang $0$.

Si $n>0$, raisonnons par r\'ecurrence sur le rang $n$ de $G$. 

Si $n=1$, alors $G$ est isomorphe \`a $\Z$. Si $(g)$ est une base de $G$, alors, pour tout sous-groupe $H\ne \{0\}$ de $G$, il existe $m \in \N$ tel que $mg$ soit une base de $H$. Le th\'eor\`eme est donc v\'erifi\'e pour les groupes ab\'elien libres $G$ de rang 1. 

Supposons maintenant que $G$ est un $\Z$-module libre de rang $n>1$, et soit $(w_1,\ldots,w_n)$ une base de $G$. En particulier, tout $h\in H$ est de la forme
$$h = h_1w_1+\cdots+h_nw_n,\qquad (h_1,\ldots,h_n) \in \Z^n.$$
Soit $H \ne \{0\}$ un sous-module de $G$. Alors il existe un $h = h_1w_1+\cdots+h_nw_n \in H, h\ne 0$, et donc un indice $i$ tel que $h_i \ne 0$. Alors $h$ ou $-h$ a un coefficient strictement positif dans la base $(w_i)$.  Pour une base donn\'ee $(w_1,\ldots,w_n)$, notons $\lambda(w_1,\ldots,w_n)$ le plus petit coefficient positif $h_i$ d'un \'el\'ement $h \in H$. Fixons alors la base $(w_1,\ldots,w_n)$ telle que $\lambda(w_1,\ldots,w_n)$ soit minimale. Soit $\alpha_1>0$ cette valeur minimale. Quitte \`a renum\'eroter les $w_i$, il existe une $\Z$-base $(w_1,\ldots,w_n)$ de $G$, et un \'el\'ement $v_1 \in H$ tel que
$$v_1 = \alpha_1w_1 + \beta_2 w_2 + \cdots + \beta_n w_n.$$
La division euclidienne de $\beta_i$ par $\alpha_1$ donne un quotient $q_i$ et un reste $r_i$ tels que
$$\beta_i = \alpha_1 q_i + r_i, \ 0\leq r_i < \alpha_i \qquad (2\leq i \leq n).$$
Posons $u_1 = w_1 + q_2w_2+\cdots+q_n w_n.$ Alors $(u_1,w_2,\ldots,w_n)$ est une autre base de $G$. En effet la matrice de passage $P$ de $(w_1,w_2,\ldots,w_n)$ \`a $(u_1,w_2\ldots,w_n)$ est
$$
P = 
\begin{pmatrix}
1     & 0 & \ldots &0\\
q_2 & 1 & \ddots &\vdots\\
\vdots & &\ddots &0\\
q_n&0&&1
\end{pmatrix},
$$
et $P$ est unimodulaire.

L'expression de $v_1$ dans cette nouvelle base est donn\'ee par
\begin{align*}
v_1 &= \alpha_1 w_1+\beta_2v_2+\cdots+\beta_n v_n\\
&= \alpha_1 w_1 + (\alpha_1 q_2 + r_2)v_2 + \cdots + (\alpha_1 q_n + r_n)v_n\\
&= \alpha_1u_1 +r_2 v_2 +\cdots +  r_n v_n.
\end{align*}
 Si un $r_i$ \'etait non nul, le caract\`ere minimal de $\alpha_1$ parmi toutes les bases de $G$ montre que $\alpha_i \leq r_i$, ce qui est faux. Donc $r_i = 0,\ 2\leq i \leq n$. Ainsi
 $$v_1 = \alpha_1 u_1.$$
Relativement \`a cette nouvelle base $(u_1,w_2,\ldots,w_n)$, posons 
$$H' = \{m_1u_1+m_2w_2+\cdots+m_nw_n \in H \mid m_1 = 0\} =H \cap  \langle w_2,\ldots,w_n\rangle_\Z.$$
Notons $V_1 = \langle v_1 \rangle_{\Z} = \Z v_1 \subset H$  le sous-module engendr\'e par $v_1$.
Alors $H'\cap V_1 = \{0\}$. En effet, si $w = m_1u_1+m_2w_2+\cdots+m_nw_n \in H'\cap V_1$, alors $m_1 = 0$, et $w = \lambda v_1 = \lambda \alpha_1 u_1$. Comme $(u_1,w_2,\ldots,w_n)$ est libre, $m_2 = \cdots = m_n = 0$, et donc $w = 0$.

Montrons que $H = H' + V_1$. Soit $h\in H$. Alors
$$h = \gamma_1 u_1 + \gamma_2 w_2 + \cdots + \gamma_n w_n, \qquad (\gamma_1,\ldots,\gamma_n) \in \Z^n.$$
La division de $\gamma_1$ par $\alpha_1$ donne 
$$\gamma_1 = \alpha_1q + r_1, \ 0\leq r_1 < \alpha_1.$$
Alors $H$ contient l'\'el\'ement
\begin{align*}
h - qv_1 &= h - q \alpha_1 u_1\\
&= (\gamma_1 -q \alpha_1) u_1 + \gamma_2 w_2+\cdots + \gamma_n w_n\\
&=r_1u_1 + \gamma_2 w_2+\cdots + \gamma_n w_n,
\end{align*}
et le caract\`ere minimal de $\alpha_1$ montre que $r_1 = 0$. Ainsi $h -qv_1 \in H'$. $H = H' + V_1$ est prouv\'e.

$H$ est donc somme directe de $H'$ et $V_1$, et est isomorphe \`a $H' \times V_1$ (en tant que grtoupe ou $\Z$-module). $H'$ est un sous-groupe du groupe $G' = \langle w_2,\ldots,w_n\rangle_\Z$, qui est un groupe ab\'elien libre de rang $n-1>0$. L'hypoth\`ese de r\'ecurrence montre que $H'$ est libre de rang $r\leq n-1$, et il existe des bases $u_2,\ldots,u_n$ de $G'$ et $v_2,\ldots v_s$ de $H'$ telles que $v_i = \alpha_i u_i, \alpha_i \in \N^*$. Alors $(v_1,v_2,\cdots,v_s)$ est une base de $H$ ayant la propri\'et\'e voulue, et la r\'ecurrence est termin\'ee.
\end{proof}

Ce th\'eor\`eme a des cons\'equences sur les quotients de $G$.

Soit $H\ne \{0\}$ un sous-module du $\Z$-module libre $G$. La proposition pr\'ec\'edente donne l'existence de $\Z$-bases $(u_1,\ldots,u_n)$ de $G$ et $(v_1,\ldots,v_s)$ de $H$ telles que $v_i = \alpha_i u_i, \alpha_i \in \N^*$ pour $1\leq i \leq s$. Consid\'erons l'application
$$
\varphi
\left\{
\begin{array}{ccl}
G & \to & \Z_{\alpha_1} \times \Z_{\alpha_2}\times \cdots \times \Z_{\alpha_s} \times \Z^{n-s}\\
h = h_1u_1+\cdots + h_n u_n & \mapsto & ([h_1]_{\alpha_1}, [h_2]_{\alpha_2}, \ldots,[h_s]_{\alpha_s}, h_{s+1},\ldots,h_n) 
\end{array}
\right.
$$
Alors $\varphi$ est un morphisme de groupe. Il est surjectif, puisqu'un \'el\'ement quelconque de $ \Z_{\alpha_1} \times \Z_{\alpha_2}\times \cdots \times \Z_{\alpha_s}\cdots \times \Z^{n-s}$, qui s'\'ecrit de façon unique sous la forme 
$$([h_1]_{\alpha_1}, [h_2]_{\alpha_2}, \ldots,[h_s]_{\alpha_s}, h_{s+1}, \ldots, h_n),\ 0\leq h_i < \alpha_i \text{ si } 1\leq i \leq s,$$ est l'image de $h_1 u_1 +\cdots+h_nu_n.$

Si $h = h_1u_1+\cdots + h_n u_n \in \ker(\varphi)$, alors $h_{s+1} = \cdots = h_n = 0$, et $[h_i]_{\alpha_i} = 0$, soit $h_i = \alpha_i \delta_i,\ \delta_i \in \Z$. Ainsi $h= \delta_1 \alpha_1 u_1 + \cdots + \delta_s \alpha_s u_s = \delta_1 v_1+ \cdots + \delta_s v_s$, donc $h \in H$. 

R\'eciproquement, si $h \in H$, alors  $h =  \gamma_1v_1+\cdots + \gamma_s v_s =  \gamma_1\alpha_1 u_1 + \cdots + \gamma_s \alpha_s u_s\, \gamma_1,\ldots, \gamma_s \in \Z$, donc $h$ a une image nulle par $\varphi$. Ainsi $\ker(\varphi) = H$. On a ainsi prouv\'e que
$$G/H \simeq \Z_{\alpha_1} \times \Z_{\alpha_2}\times \cdots  \times \Z_{\alpha_s}\times \Z^{n-s}.$$

Ainsi $|G/H| = \infty$ si $s < n$, et $|G/H| = \alpha_1\cdots\alpha_n$ si $s=n$.


\begin{prop}
Soit $G$ un $\Z$-module libre de rang $n$, et $H$ un sous-module de $G$. Alors $G/H$ est fini si et seulement si les rangs de $G$ et $H$ sont \'egaux.

Dans ce cas, si $G$ et $H$ ont les bases respectives $(u_i)_{1\leq i \leq n}$ et $(w_i)_{1\leq i \leq n}$, et si $P$ est la matrice de passage entre ces deux bases, alors
$$|G/H| = |\det(P)|.$$
\end{prop}

\begin{proof}
L'isomorphisme $\varphi$ pr\'esent\'e ci-dessus montre que $|G/H| = \infty$ si $s < n$. Dans le cas $s=n$,  $$|G/H| = \alpha_1\cdots\alpha_n.$$
Notons ${\cal B} = (u_i)_{1\leq i \leq n}, {\cal B}' = (w_i)_{1\leq i \leq n}, {\cal B}'' = (v_i)_{1\leq i \leq n}$, o\`u $v_i = \alpha_i u_i$. Alors $P$ est la matrice de passage de ${\cal B}$ \`a ${\cal B}'$. Notons $D$ la matrice de passage de ${\cal B}$ \`a ${\cal B}''$ . Puisque $v_i = \alpha_i u_i, \ 1\leq i \leq n$,
$$D = \mathrm{diag}(\alpha_1,\ldots,\alpha_n).$$
Les deux bases ${\cal B}' , {\cal B}''$ sont des bases du m\^eme groupe ab\'elien libre $H$ : la matrice de passage $Q$ de ${\cal B}'$ \`a  ${\cal B}''$ est donc unimodulaire, et $D = PQ$. Par cons\'equent, $\det(P) = \pm \det(D)$, donc
$$|\det(P)| = \alpha_1\cdots\alpha_n = |G/H|.$$
 \end{proof}
 
 Inversement, si $G$ est un groupe ab\'elien de type fini, de g\'en\'erateurs $w_1,\ldots,w_n$, alors le morphisme surjectif $f : \Z^n \to G$ d\'efini par
 $$f(m_1,\ldots,m_n) = m_1w_1+ \cdots+m_n w_n$$
 donne par passage au quotient l'isomorphisme $\Z^n/H \simeq G$, o\`u $H = \ker(f)$ est un sous-groupe du groupe ab\'elien libre $\Z^n$. Nous avons prouv\'e ci-dessus qu'il existe une base $(u_1,\ldots,u_n)$ de $\Z^n$ et une base $(v_1,\ldots,v_s)$ de $H$ telle que $v_i = \alpha_i u_i, \ 1\leq i \leq s$, et que
 $$G \simeq \Z^n/H \simeq \Z_{\alpha_1} \times \Z_{\alpha_2}\times \cdots  \times \Z_{\alpha_s}\times \Z^{n-s}.$$
 En particulier, si $G$ est fini, $G \simeq \Z_{\alpha_1} \times \Z_{\alpha_2}\times \cdots  \times \Z_{\alpha_s}$.
 
 On a ainsi prouv\'e 
 \begin{prop}
 \item[(i)]
Soit  $G$ est un groupe ab\'elien de type fini. Il existe des entiers positifs $\alpha_1,\ldots,\alpha_s$, et un entier $k\in \N$ tels que
 $$G \simeq \Z_{\alpha_1} \times \Z_{\alpha_2}\times \cdots  \times \Z_{\alpha_s}\times \Z^{k}.$$
 \item[(ii)]
 En particulier, si $G$ est fini, 
 $$G \simeq \Z_{\alpha_1} \times \Z_{\alpha_2}\times \cdots  \times \Z_{\alpha_s}$$
 est un produit fini de groupes cycliques.
 \end{prop}
Nous retrouvons ainsi le th\'eor\`eme de d\'ecomposition d'un groupe ab\'elien en produit de groupes cycliques.

\medskip
Comme corollaire de la proposition \ref{M141}, prouvons cette proposition qui sera utilis\'ee dans la recherche de la structure additive de ${\cal O}_K$.

\begin{prop}\label{M144}
Soient $M$ un sous-module de $N$, o\`u $M, N$ sont deux $\Z$-modules libres de rang $n \in \N$. Si $P$ est un sous-module de $N$ v\'erifiant
$$M \subset P \subset N,$$
alors $P$ est un $\Z$-module libre de rang $n$.
\end{prop}

\begin{proof}
Comme $P \subset N$, la proposition $\ref{M141}$ montre que $P$ est un $\Z$-module libre de rang $s \leq n$. Alors l'inclusion $M \subset P$ montre que $n \leq s$, donc $s = n$.
\end{proof}

\chapter{Anneau des entiers d'un corps de nombres.}
Nous avons d\'etermin\'e l'anneau ${\cal O}_K$ des entiers alg\'ebriques d'un corps $K$ dans le cas des extensions quadratiques. Nous g\'en\'eralisons cette \'etude dans ce chapitre.

Rappelons que $\overline{\Q}$ d\'esigne le corps des nombres alg\'ebriques sur $\Q$, et $\overline{\Z}$ l'anneau des entiers alg\'ebriques.

\section{Corps de nombres}

\begin{dfn}
Un corps de nombres est un sous-corps de $\C$ de dimension finie sur $\Q$.
\end{dfn}

Donnons quelques rappels.

Comme la dimension $[K:\Q]$ est finie, tout \'el\'ement de $K$ est alg\'ebrique : $K \subset \overline{\Q}$. Si $\alpha \in K$, alors $K(\alpha) = K[\alpha]$ est aussi un corps de nombres.



Rappelons ici une preuve du th\'eor\`eme de l'\'el\'ement primitif, dans le cas particulier des corps de nombres.
\begin{prop}\label{separabilite}
Soit $K$ un sous-corps de $\C$, et $\alpha \in \C$ un nombre alg\'ebrique sur $K$. Alors les racines dans $\C$ du polynôme minimal $p(x) = \Pi_{\alpha,K}(x)$ de $\alpha$ sur $K$ sont des racines simples. 
\end{prop}

\begin{proof}
Supposons que $p(x) = x^n+a_{n-1}x^{n-1}+ \cdots+a_0$, o\`u $n = [K(\alpha):K]$,  ait une racine multiple $\beta$. Alors
$$p(x) = (x - \beta)^2 q(x),\qquad q(x) \in K[x].$$
La d\'erivation formelle de $p(x)$ est alors
$$p'(x) = (x-\beta)^2 q'(x) + 2 (x-\beta) q(x),$$
et donc $\beta$ est une racine de $p'(x)$. Puisque $p(x)$ est irr\'eductible sur $K$, c'est le polynôme minimal de $\beta$, et $p'(\beta) = 0$, donc $p$ divise $p'$. Mais $\deg(p'(x)) < \deg(p(x))$, donc $p'(x) = 0$. Mais $p'(x) = nx^{n-1} + r(x)$, o\`u $\deg(r(x))<n-1$ et $n = [K(\alpha) : K] \ne 0$, donc $p'(x) \ne 0$. Cette contradiction montre que $p(x)$ n'a que des racines simples dans $\C$.


\end{proof}
\begin{prop}\label{lemme_primitif1}
Soit $K$ un sous corps de $\C$, et $\alpha, \beta \in \C$ des nombres alg\'ebriques sur $K$.
Alors il existe $\gamma \in \C$, alg\'ebrique sur $K$, tel que
$$K(\alpha,\beta) = K(\gamma).$$
\end{prop}
\begin{proof}
Soient $p(x),q(x)$ les polynômes minimaux de $\alpha, \beta$ sur $K$.
Alors $p(x)$ se factorise dans $\C$ sous la forme
\begin{align*}
p(x) &= (x-\alpha_1)\cdots(x- \alpha_m),\\
q(x) &= (x-\beta_1)\ldots(x-\beta_n),
\end{align*}
o\`u $\alpha_1 = \alpha, \ldots,\alpha_m$ sont les conjugu\'es de $\alpha$ sur $K$, et $\beta_1 = \beta, \ldots,\beta_n$ sont les conjugu\'es de $\beta$ sur $K$.

La proposition \ref{separabilite} montre que les $\alpha_i$ sont distincts, ainsi que les $\beta_j$ :
$$\alpha_j- \alpha_i \ne 0 \text{ si } 1 \leq i<j \leq m,\qquad \beta_l - \beta_k \ne 0 \text{ si } 1 \leq k < l \leq n.$$

Consid\'erons l'ensemble 
$$S = \left\{z \in \C \mid z = \frac{\alpha_j - \alpha_i}{\beta_l - \beta_k}, 1 \leq i \leq m,\ 1 \leq j\leq m,\ 1 \leq k \leq n, 1 \leq l \leq n,\ l \ne k\right\}.$$
Alors $S$ est un ensemble fini. Nous pouvons donc choisir un rationnel $c \in \Q$ hors de l'ensemble $S$, si bien que les nombres
$$\alpha_i+ c \beta_j,\qquad 1\leq i \leq m, \ 1 \leq j \leq n,$$
sont tous distincts : en effet, si $\alpha_i+ c \beta_j = \alpha_{r}+ c \beta_{s}$, alors, dans le cas o\`u  $j \ne s$, $c =\frac{ \alpha_i - \alpha_r}{\beta_s - \beta_j} \in S$, ce qui est exclu. Par cons\'equent $j= s$, donc $\beta_j = \beta_s$, et alors $\alpha_i = \alpha_r$, ce qui montre $i = r$ puisque les $\alpha_i$ sont distincts.

Posons alors $$\gamma = \alpha_1 + c \beta_1 = \alpha + c \beta,$$
ainsi que $$p_1(x) = p(\gamma-cx).$$
Alors $p_1 \in K(\gamma)[x]$.
Etudions le pgcd $\delta(x)$ de $p_1(x)$ et $q(x)$ dans $\C[x]$.

D'abord $\beta$ est une racine commune de $p_1(x)$ et $q(x)$, puisque $p_1(\beta) = p(\gamma - c \beta) = p(\alpha) = 0$ (et $q(\beta) = 0$ par d\'efinition de $q$). Puisque $x- \beta$ divise $p_1(x)$ et $q(x)$ dans $\C[x]$, $x - \beta$ divise le pgcd $\delta(x)$.

Montrons que $p_1$ et $q$ n'ont pas de racine commune distincte de $\beta$. Dans le cas contraire, comme les racines de $q$ sont $\beta_1 = \beta,\cdots, \beta_n$, une telle racine serait \'egale \`a $\beta_i$ pour un indice $i = 2,\ldots,n$. Alors $p_1(\beta_i) = 0$, soit
$$p(\gamma -c \beta_i) = 0.$$
Par cons\'equent $\gamma - c \beta_i = \alpha_j$ pour un indice $j = 1,\ldots,m$, ce qui donne $\alpha_1+ c \beta_1 -c \beta_i = \alpha_j$, et puisque $\beta_i \ne \beta_1$,
$$c =\frac{ \alpha_j - \alpha_1}{\beta_1 - \beta_i}.$$

Cette \'egalit\'e contredit le choix de $c$. Cette contradiction montre que $p_1(x)$ et $q(x)$  ont pour unique racine commune $\beta$.
Si $\zeta \in \C$ est une racine de $\delta$, alors $x -\zeta$ divise $p_1(x)$ et $q(x)$, donc $\zeta = \beta$. Si $\deg(\delta(x))>1$, $\delta(x) = (x - \beta)^k$, o\`u $k>1$. Mais alors $(x - \beta)^k$ divise $q(x)$, ce qui contredit la proposition \ref{separabilite}. Ainsi
$$\delta(x) = \mathrm{pgcd}(p_1(x), q(x)) = x - \beta.$$

Comme $p_1(x)$ et $q(x)$ sont des polynômes de $K(\gamma)[x]$, le th\'eor\`eme de B\'ezout montre que $x- \beta = \delta(x) = a(x) p_1(x) + b(x) q(x)$ pour certains $a(x), b(x) \in K(\gamma)[x]$. Ainsi $x - \beta \in K(\gamma)[x]$, et donc $\beta \in K(\gamma)$, et aussi  $ \alpha = \gamma - c \beta \in K(\gamma)$.

Ceci montre que $K(\alpha,\beta) \subset K(\gamma)$. De plus, puisque $\gamma = \alpha + c \beta$, o\`u $c \in \Q$, $\gamma \in K(\alpha,\beta)$, donc $K(\gamma) \subset  K(\alpha,\beta)$. Nous avons prouv\'e
$$K(\alpha, \beta) = K(\gamma).$$

Enfin $\gamma = \alpha + c \beta, \ c \in \Q$, o\`u $\alpha, \beta$ sont alg\'ebriques sur $K$ (et donc $c \beta$ aussi). Par cons\'equent, le complexe $\gamma$, somme de deux nombres alg\'ebriques sur $K$, est alg\'ebrique sur $K$.
\end{proof}

\begin{prop}\label{lemme_primitif2}
Soit $K$ un sous-corps de $\C$. Si les complexes $a_1,\ldots,\alpha_n$ sont alg\'ebriques sur $K$, alors il existe un \'el\'ement $\alpha \in \C$ alg\'ebrique sur $K$ tel que 
$$K(\alpha_1,\ldots,\alpha_n) = K(\alpha).$$
\end{prop}

\begin{proof} Si $n=1$, il suffit de prendre $\alpha = \alpha_1$. En raisonnant par r\'ecurrence, supposons la propri\'et\'e vraie \`a l'ordre $n$. Si $a_1,\ldots,a_n,a_{n+1}$ sont alg\'ebriques sur $K$, l'hypoth\`ese de r\'ecurrence montre l'existence d'un nombre $\gamma$ alg\'ebrique sur $K$ tel que $K(\alpha_1,\ldots,\alpha_n) = K(\gamma)$. Ensuite, la proposition \ref{lemme_primitif1} montre qu'il existe un nombre $\alpha$ alg\'ebrique sur $K$ tel que $K(\gamma, \alpha_{n+1}) = K(\alpha)$. Alors
$$K(\alpha_1,\ldots,\alpha_n,\alpha_{n+1}) = K(\alpha_1,\ldots,\alpha_n)(\alpha_{n+1}) =K(\gamma)(\alpha_{n+1}) = K(\gamma,\alpha_{n+1}) = K(\alpha),$$
ce qui ach\`eve la r\'ecurrence.
\end{proof}


\begin{prop}\label{elt_primitif}{\bf Th\'eor\`eme de l'\'el\'ement primitif.}

Tout corps de nombres est de la forme $\Q(\alpha)$ pour un $\alpha \in \overline{\Q}$.
\end{prop}

\begin{proof} Soit $K$ un corps de nombres. Par d\'efinition la dimension $n = [K:\Q]$ est finie. If existe donc une base $(\alpha_1,\ldots,\alpha_n) \in K^n$ du $\Q$-espace vectoriel $K$. Tout \'el\'ement $\gamma \in K$ s'\'ecrit sous la forme $\gamma = a_1 \alpha_1 + \ldots + a_n \alpha_n$, o\`u $(a_1,\ldots,a_n) \in \Q^n$. Alors $\gamma \in \Q(\alpha_1,\ldots,\alpha_n)$, pour tout $\gamma \in K$, ce qui prouve l'inclusion $K \subset \Q(\alpha_1,\ldots,\alpha_n)$. Puisque $\alpha_1,\ldots,\alpha_n$ sont des \'el\'ements de $K$,  $\Q(\alpha_1,\ldots,\alpha_n) \subset K$, donc 
$$K = \Q(\alpha_1,\ldots,\alpha_n).$$

Alors la proposition \ref{lemme_primitif2} montre qu'il existe $\alpha \in \overline{\Q}$ tel que
$$K = \Q(\alpha_1,\ldots,\alpha_n) = \Q(\alpha).$$
\end{proof}



\section{Plongements complexes}

Si $\alpha \in \overline{\Q}$, nous noterons $I_{\alpha,K} = \{P \in K[x] \mid  P(\alpha) = 0\}$. C'est un id\'eal de $K[x]$, non nul puisque $\alpha$ est alg\'ebrique. Il est engendr\'e par un unique polynôme unitaire, appel\'e polynôme minimal de $\alpha$ sur $K$, not\'e $\Pi_{\alpha,K}$, et $\Pi_{\alpha,K}$ est irr\'eductible dans $K[x]$. Ainsi
$$I_{\alpha,K} = \{P \in K[x] \mid  P(\alpha) = 0\} = (\Pi_{\alpha,K}) = \Pi_{\alpha,K}\cdot K[x].$$

Soit 
$$\varphi
\left\{
\begin{array}{ccc}
K[x] & \to & K[\alpha]\\
P & \mapsto &P(\alpha)
\end{array}
\right.$$
 Alors $\varphi$ est surjectif par d\'efinition de $K[\alpha]$, et son noyau est $I_{\alpha,K} = (\Pi_{\alpha,K})$. Donc $\varphi$ induit l'isomorphisme d'anneaux
$$\overline{\varphi} : K[x]/(\Pi_{\alpha,K}) \simeq K[\alpha],$$
d\'efini par $\overline{\varphi}( P + (\Pi_{\alpha,K}) = P(\alpha)$.

Comme $\Pi_{\alpha,K}$ est irr\'eductible, $\overline{\varphi} : K[x]/(\Pi_{\alpha,K})$ est un corps, et cet isomorphisme est un isomorphisme entre deux corps. Cet isomorphisme donne une repr\'esentation abstraite de $K[\alpha]$, que nous allons utiliser dans la d\'emonstration du lemme de prolongement.

\begin{dfn}
\be
\item[(i)] Si $K$ est un corps de nombres, on note $\Sigma(K)$ l'ensemble des morphismes de corps $K \to \C$.

Un tel morphisme est n\'ecessairement injectif, et s'appelle un plongement complexe de $K$.

\item[(ii)] Si $K \subset L$ est une extension de corps de nombres, on note $\Sigma(L/K)$ l'ensemble
$$\Sigma(L/K) = \{\sigma \in \Sigma(L), \sigma \vert_K = \mathrm{id}\}.$$
Les plongements de $\Sigma(L/K)$ sont des plongements complexes $K$-lin\'eaires.
\ee
\end{dfn}


Soit $\sigma \in \Sigma(K)$, et $P  = \sum_{i=0}^m a_i x^i \in K[x]$. Par d\'efinition, nous noterons $P^\sigma$ le polynôme d\'efini par $P^{\sigma} = \sum_{i=0}^m \sigma(a_i) x^i \in \sigma(K)[x]$. Si $P,Q \in K[x]$, alors $(PQ)^\sigma = P^\sigma Q^\sigma$. L'application $P \mapsto P^\sigma$ d\'efinit un isomorphisme d'anneaux.

\begin{prop}(Lemme de prolongement)
Soit $K \subset L$ une extension de corps de nombres. L'application de restriction
$$
\xi
\left\{
\begin{array}{ccc}
\Sigma(L) &\to &\Sigma(K)\\
\sigma & \mapsto & \sigma |_K
\end{array}
\right.
$$
est surjective, et chaque \'el\'ement de $\Sigma(K)$ a exactement $[L:K]$ ant\'ec\'edents.

Autrement dit, tout plongement de $K$ se prolonge en exactement  $[L:K]$ plongements de $L$.
\end{prop}

\begin{proof}
Le th\'eor\`eme de l'\'el\'ement primitif (proposition \ref{elt_primitif}) montre qu'il existe un nombre $\alpha \in \C$ alg\'ebrique sur $K$ tel que $L = K(\alpha)$. Soit $\tau \in \Sigma(K)$ fix\'e, et $$T = \{\sigma \in \Sigma(L), \sigma |_K = \tau\}$$ l'ensemble $\xi^{-1}(\{\tau\})$ des ant\'ec\'edents de $\tau$ par $\xi$. Posons
$$
\chi
\left\{
\begin{array}{ccc}
T&\to &\C\\
\sigma & \mapsto & \sigma(\alpha).
\end{array}
\right.
$$
Alors $\chi$ est injective : supposons que $\sigma_1(\alpha) = \sigma_2(\alpha) = \beta$, o\`u $\sigma_1, \sigma_2 \in T$. Puisque $m = [K(\alpha):K] $ est fini, tout \'el\'ement $\gamma \in L=K(\alpha)$ s'\'ecrit sous la forme $\gamma = a_{m-1} \alpha^{m-1} + \cdots + a_0$, avec $a_0,\ldots,a_{m-1} \in K$, alors $\sigma_1(\gamma) = a_{m-1} \beta^{m-1} + \cdots + a_0 = \sigma_2(\gamma)$, donc $\sigma_1 = \sigma_2$.

D\'eterminons maintenant l'image de $\chi$. Si $\beta \in \C$ est dans l'image de $\chi$, alors $\beta = \sigma(\alpha)$, o\`u $\sigma \in \Sigma(L)$ v\'erifie $\sigma|_K = \tau$. Notons $\Pi_{\alpha,K}(x) =x^m+ c_{m-1} x^{m-1} + \cdots +c_0 \in K[x]$ le polynôme minimal de $\alpha$ sur $K$. En appliquant $\sigma$ \`a l'\'egalit\'e $0 = \Pi_{\alpha,K}(\alpha)$, on obtient, en utilisant $\sigma|_K = \tau$,
\begin{align*}
0 &= \sigma(\alpha)^m + \sigma(c_{m-1}) \sigma(\alpha)^{m-1} + \cdots + \sigma(c_0)
 =  \beta^m+ \tau(c_{m-1}) \beta^{m-1} + \cdots + \tau(c_0) = \Pi_{\alpha,K}^\tau(\beta).
 \end{align*}
Ainsi tout \'el\'ement $\beta$ dans l'image de $\psi$ v\'erifie $\Pi_{\alpha,K}^\tau(\beta) = 0$. 

R\'eciproquement, soit  $\beta \in \C$ une racine de $\Pi_{\alpha,K}^\tau$. Montrons qu'il existe un plongement $\sigma \in T$ tel que $\sigma(\alpha) = \beta$, en utilisant l'isomorphisme $\overline{\varphi} : K[x]/(\Pi_{\alpha,K}) \simeq K[\alpha]$ d\'ecrit dans l'introduction de ce paragraphe, qui envoie la classe de $x$ sur $\alpha$.

Notons $K^\tau = \tau(K)$ l'image de $K$ par $\tau$. L'isomorphisme $\tau : K \to K^\tau$ se prolonge en un isomorphisme d'anneaux
$$\tau' 
\left\{
\begin{array}{ccc}
 K[x] &\to &K^\tau[x]\\
 P &\mapsto &P^\tau
 \end{array}
 \right.
 .$$

V\'erifions que cet isomorphisme $\tau'$ passe au quotient pour donner un isomorphisme 
$$\overline{\tau'} : K[X]/(\Pi_{\alpha,K}) \to K^\tau[X]/(\Pi^\tau_{\alpha,K}),$$
o\`u ici $(\Pi^\tau_{\alpha,K})$ d\'esigne l'id\'eal principal $\Pi^\tau_{\alpha,K}\cdot K^\tau[x]$.

Notons que l'irr\'eductibilit\'e de $\Pi_{\alpha,K}$ entra\^ine celle de $\Pi^\tau_{\alpha,K}$.

Si $Q \equiv Q_1 \pmod {\Pi_{\alpha,K}}$, alors $Q_1 = Q + S \, \Pi_{\alpha,K}, \, S \in K[X]$, donc $Q_1^\tau = Q^\tau + S^\tau \Pi^\tau_{\alpha,K}$. Ainsi $Q^\tau \equiv Q'^\tau \pmod {\Pi_{\alpha,K}^\tau}$. Ceci permet de d\'efinir $\overline{\tau'}$ par 
$$\overline{\tau'}(Q + (\Pi_{\alpha,K})) = Q^\tau +(\Pi^\tau_{\alpha,K}), \qquad (Q \in K[X]).$$
L'application $\overline{\tau'}$ est un morphisme. De plus, si  $Q + (\Pi_{\alpha,K}) \in \ker(\overline{\tau'})$, alors $Q^{\tau} \in (\Pi^\tau_{\alpha,K})$, donc $Q^\tau = U \Pi^\tau_{\alpha,K}, U \in K^\tau[X]$, donc $Q = U^{\tau^{-1}} \Pi_{\alpha,K} \in (\Pi_{\alpha,K})$, ainsi la classe de $Q$ est nulle, le noyau de $\overline{\tau'}$ est r\'eduit \`a $\{0\}$, et $\overline{\tau'}$ est injective. De plus, tout $R + (\Pi^\tau_{\alpha,K})$ est l'image de $R^{\tau^{-1}} + (\Pi_{\alpha,K})$, donc $\overline{\tau'}$ est surjective. Ainsi $\overline{\tau'}$ est un isomorphisme d'anneaux (entre deux corps). Notons que cet isomorphisme envoie la classe de $x$ sur la classe de $x$ :
$$\overline{\tau'} ( x + (\Pi_{\alpha,K})) = x + (\Pi^\tau_{\alpha,K}).$$
Puisque $\beta$ est par hypoth\`ese racine du polynôme $\Pi_{\alpha,K}^\tau$ irr\'eductible sur $K^\tau$, ce polynôme est le polynôme minimal de $\beta$ :
$$ \Pi_{\beta, K^\tau} = \Pi^\tau_{\alpha,K}.$$
Ceci entra\^ine l'existence d'un isomorphisme 
$$\overline{\psi} : K^\tau[X]/(\Pi^\tau_{\alpha,K})  = K^\tau[X] /(\Pi_{\beta, K^\tau} )\to K^\tau(\beta),$$
qui envoie la classe de $x$ sur $\beta$.

\begin{center}
\begin{tikzpicture}
   \node (A) at (4,7) {$K$};
    \node (B) at (8,7) {$K^\tau$};
    \node (C) at (4,5) {$K[x]$};
    \node (D) at (8,5) {$K^\tau[x]$};
    \node (E) at (4,3) {$K[x]/(\Pi_{\alpha,K})$};
    \node (F) at (8,3) {$K^\tau[x]/(\Pi_{\beta,K^\tau})$};
    \node (G) at (4,1) {$K(\alpha)$};
    \node (H) at (8,1) {$K^\tau(\beta)$};
    
    \draw[->] (A) edge node[above]{$\tau$} (B)  ;
    \draw[->] (A) edge node [left]{$i$}  (C);
     \draw[->] (B) edge node [left]{$j$} (D);
     \draw[->] (C) edge node[above]{$\tau'$}(D);
     \draw[->] (C) edge node [left]{$\pi$} (E);
     \draw[->] (D) edge node [left]{$\pi'$} (F);

    \draw[->] (E) edge node[above]{$\overline{\tau'}$} node[below]{$\simeq$}(F)  ;
    \draw[->] (E) edge node [left]{$\overline{\varphi} $} node[right]{$\simeq$} (G);
     \draw[->] (F) edge node [left]{$\overline{\psi}$} node[right]{$\simeq$} (H);
     \draw[->] (G) edge node[above]{$\sigma_0$}(H);
\end{tikzpicture}
\end{center}

Posons alors $\sigma_0 = \overline{\psi} \circ \overline{\tau'} \circ \overline{\varphi}^{-1}$. Ainsi $\sigma_0 : K(\alpha) \to K^{\tau}(\beta)$, compos\'e d'isomorphismes,  est un isomorphisme. Puisque 
$$ \overline{\varphi}^{-1}(\alpha) = x + (\Pi_{\alpha,K}), \quad \overline{\tau'} ( x + (\Pi_{\alpha,K})) = x + (\Pi^\tau_{\alpha,K}), \quad \overline{\psi}(x + (\Pi^\tau_{\alpha,K})) = \beta,$$
on peut conclure que $\sigma_0(\alpha) = \beta$. Enfin, si $a \in K$, alors $\tau'(a) = \tau(a)$, donc $\overline{\tau'}(a + (\Pi_{\alpha,K})) = \tau(a) + ( \Pi^\tau_{\alpha,K})$. Puisque $\overline{\varphi}(a +  \Pi_{\alpha,K}) = a$ et $\overline{\psi}(\tau(a) + (\Pi^\tau_{\alpha,K})) = \tau(a)$, nous obtenons $\sigma_0(a) = (\overline{\psi} \circ \overline{\tau'} \circ \overline{\varphi}^{-1})(a) = \tau(a)$. 

En modifiant uniquement l'ensemble d'arriv\'ee de $\sigma_0 : K(\alpha) \to K^\tau(\beta)$, on obtient le morphisme $\sigma : K(\alpha) \to \C$ d\'efini par $\gamma \mapsto \sigma(\gamma) = \sigma_0(\gamma)$, on obtient un plongement complexe $\sigma$ v\'erifiant $\sigma|_K = \tau$. Par cons\'equent $\sigma \in T, \sigma(\alpha) = \beta$, donc $\beta$ est dans l'image $\chi(T)$, et on peut conclure que
$$\chi(T) = \{ \beta \in \C \mid \Pi^\tau_{\alpha,K}(\beta) = 0\}.$$
De plus, puisque $\Pi^\tau_{\alpha,K}$ est irr\'eductible, de m\^eme degr\'e $d$ que $\Pi_{\alpha,K}$, o\`u $d = [K(\alpha) : K]$, le cardinal de $\chi(T)$ est $[K(\alpha) : K]$. L'application $\chi$ \'etant injective, si $\tau \in \Sigma(K)$,
$$|T| = |\{\sigma \in \Sigma(K(\alpha)), \sigma |_K = \tau\}| = [K(\alpha):K].$$
Ceci prouve que tout \'el\'ement $\tau \in \Sigma(K)$ a exactement $[L:K]\geq 1$ ant\'ec\'edents pour l'application de restriction
$
\xi
\left\{
\begin{array}{ccc}
\Sigma(L) &\to &\Sigma(K)\\
\sigma & \mapsto & \sigma |_K
\end{array}
\right.
$, et le th\'eor\`eme est prouv\'e.

\end{proof}

Dans le cas particulier o\`u $\tau = \mathrm{id}_K$, on obtient qu'il existe exactement $[L:K]$ plongements de $L$ dans $\C$ dont la restriction \`a $K$ soit l'identit\'e, autrement dit
$$|\Sigma(L/K) | = [L:K].$$
De plus, en gardant les notations de la d\'emonstration de la proposition, on a dans ce cas $T = \{\sigma \in \Sigma(K(\alpha)), \sigma |_K = \mathrm{id}_K\} = \Sigma(L/K)$, et l'application
$$
\chi
\left\{
\begin{array}{ccl}
\Sigma(L/K)&\to &\{\beta \in \C,\  \Pi_{\alpha,K}(\beta) = 0\}\\
\sigma & \mapsto & \sigma(\alpha).
\end{array}
\right.
$$
est une bijection. En r\'esum\'e, on a prouv\'e
\begin{prop}\label{corollaire_plongements}
\be
Soit $K\subset L$ est une extension de corps de nombres.
\item[(i)] Alors
$$|\Sigma(L/K) | = [L:K].$$
\item[(ii)] Si $L = K[\alpha],\ \alpha \in \C$, alors
$$
\left\{
\begin{array}{ccl}
\Sigma(L/K)&\to &\{\beta \in \C,\  \Pi_{\alpha,K}(\beta) = 0\}\\
\sigma & \mapsto & \sigma(\alpha).
\end{array}
\right.
$$
est une bijection de l'ensemble des plongements de $L$ fixant $K$ dans l'ensemble des conjugu\'es de $\alpha$.
\ee
\end{prop}



\section{Trace, norme, discriminant.}

Etablissons les r\'esultats du paragraphe \ref{trace_norme_corps_finis} prouv\'es dans le contexte des corps finis, mais cette fois pour les corps de nombres.

Consid\'erons une extension $K \subset L$, o\`u $K,L$ sont des corps de nombres (un exemple important \'etant  $K = \Q$). Alors $s = [L:K] < \infty$.

Pour chaque $\alpha \in L$, d\'efinissons l'application $m_{\alpha}$ de multiplication par $\alpha$ par
$$
m_{\alpha}
\left\{
\begin{array}{ccc}
L & \to & L\\
\gamma & \mapsto & \alpha \gamma.
\end{array}
\right.
$$
Alors $m_\alpha$ est un endomorphisme du $K$-espace vectoriel $L$.

\begin{dfn}
 $\chi_{\alpha,L/K} \in F[x]$ est le polynôme caract\'eristique de $m_\alpha$ : 

$$\chi_{\alpha,L/K}(x)= \det(x\, \mathrm{id}_L - m_\alpha),$$
et la trace et la norme de $\alpha$ sont d\'efinis par
$$\mathrm{Tr}_{L/K}(\alpha) = \mathrm{tr}(m_\alpha),\qquad \mathrm{N}_{L/K}(\alpha) = \det(m_\alpha),$$
o\`u $\mathrm{tr}$ et $\det$, d\'efinis en alg\`ebre lin\'eaire, d\'esignent la trace et la norme d'un endomorphisme.
\end{dfn}

Cette d\'efinition montre que, pour tout $\alpha \in L$, $\mathrm{Tr}_{L/K}(\alpha)$ et $\mathrm{N}_{L/K}(\alpha) $ sont des \'el\'ements de $K$.
\begin{prop}
\be
Si $a,b \in F$, et $\alpha,\beta \in K$,  
\item[(i)] 
$$
\mathrm{Tr}_{L/K}(a \alpha + b \beta)  = a \mathrm{Tr}_{L/K}(\alpha) + b \mathrm{Tr}_{L/K}(\beta).
$$
Autrement dit, la trace est $F$-lin\'eaire.
\item[(ii)]
\begin{align*}
\mathrm{N}_{L/K}(\alpha\beta)  &= \mathrm{N}_{L/K}(\alpha) \mathrm{N}_{L/K}(\beta),\\
\mathrm{N}_{L/K}(a \alpha) &= a^s \mathrm{N}_{L/K}(\alpha),
\end{align*}
o\`u $s = [L:K]$.
\ee
\end{prop}

\begin{proof} 
M\^eme preuve que celle de la proposition \ref{trace_corps_finis1}.
\end{proof}

\medskip
Exemple : on a vu au chapitre pr\'ec\'edent que, si $\alpha = a + b \sqrt{d} \in \Q(\sqrt{d})$, o\`u $d \in \Q$ n'est pas un carr\'e, alors
$$\mathrm{Tr}_{\Q(\sqrt{d})/\Q}(\alpha) = 2a, \quad \mathrm{N}_{\Q(\sqrt{d})/\Q}(\alpha) =a^2 -d b^2.$$

La multiplicativit\'e de la norme s'exprime par la formule classique
$$(u^2 - d v^2)(r^2 - d s^2) = (ur +vsd)^2 - d (us+vr)^2.$$

\bigskip
Si $\alpha \in L$, la relation entre le polynôme minimal $\Pi_{\alpha,K}$ et le polynôme caract\'eristique $\chi_{\alpha,L/K}$ est donn\'ee dans la proposition suivante.

\begin{prop}\label{puissance}
Si $\alpha \in L$, alors $\chi_{\alpha,L/K} = \Pi_{\alpha,K}^r$, o\`u $r = [L:K(\alpha)]$.
\end{prop}

\begin{proof}
M\^eme preuve que celle de la proposition \ref{trace_corps_finis2}.
\end{proof}



\begin{prop}\label{calcul_trace}
Soit $K\subset L$ une extension de corps de nombres, et $\alpha \in L$. Alors
\be
\item[(i)] $\Pi_{\alpha,K}(x) = \prod\limits_{\sigma \in \Sigma(K(\alpha)/K)}(x - \sigma(\alpha)).$
\item[(ii)]  $\chi_{\alpha,L/K}(x) = \prod\limits_{\sigma\in \Sigma(L/K)}(x - \sigma(\alpha))$.
\item[(iii)] $\mathrm{Tr}_{L/K}(\alpha) = \sum\limits_{\sigma\in \Sigma(L/K)} \sigma(\alpha)$.
\item[(iv)] $\mathrm{N}_{L/K}(\alpha) = \prod\limits_{\sigma\in \Sigma(L/K)} \sigma(\alpha)$.
\ee
\end{prop}

\begin{proof}
\be
\item[(i)] Partons de la factorisation dans $\C$ du polynôme minimal de $\alpha$ sur $K$:
$$\Pi_{\alpha,K}(x) = \prod_{\gamma \in S}(x - \gamma).$$
o\`u $S$ est l'ensemble des $d$ racines de $\Pi_{\alpha,K}$, et $d = [K(\alpha):K] = \deg(\Pi_{\alpha,K})$, ces racines \'etant distinctes (proposition \ref{separabilite}).
La proposition \ref{corollaire_plongements} montre que l'application
$$
\left\{
\begin{array}{ccc}
\Sigma(K(\alpha)/K)&\to &S\\
\sigma & \mapsto & \sigma(\alpha).
\end{array}
\right.
$$
est une bijection, donc le changement d'indice $\sigma \mapsto \gamma = \sigma(\alpha)$ donne
$$\Pi_{\alpha,K}(x) = \prod_{\sigma \in \Sigma(K(\alpha)/K)}(x - \sigma(\alpha)).$$
\ee
\item[(ii)]
D'apr\`es la proposition \ref{corollaire_plongements}, il existe exactement $[L:K(\alpha)]$ \'el\'ements $\sigma \in \Sigma(L/K)$ tels que $\sigma(\alpha) = \tau(\alpha)$, pour chaque $\tau\in \Sigma(K(\alpha)/K)$ fix\'e. En regroupant les facteurs \'egaux dans $\prod_{\sigma \in \Sigma(L/K)} (x- \sigma(\alpha))$, on obtient, en utilisant la proposition \ref{puissance},
\begin{align*}
\prod_{\sigma \in \Sigma(L/K)} (x- \sigma(\alpha)) &= \prod_{\tau \in \Sigma(K(\alpha)/K))}\quad  \prod_{\sigma \in \Sigma(L/K),\ \sigma(\alpha) = \tau(\alpha)} (x- \sigma(\alpha))\\
&= \prod_{\tau \in \Sigma(K(\alpha)/K))} (x- \tau(\alpha))^{[L:K(\alpha)]}\\
&= \Pi_{\alpha,K}^{[L : K(\alpha)]}(x)\\
&= \chi_{\alpha,L/K}(x)\\
\end{align*}


\item[(iii),(iv)] Le d\'eveloppement de $\chi_{\alpha,L/K}(x) $ donne, par d\'efinition de la trace et de la norme d'un nombre alg\'ebrique :
$$\chi_{\alpha,L/K}(x) = x^n - \mathrm{Tr}_{L/K}(\alpha) x^{n-1} + \cdots + (-1)^n \mathrm{N}_{L/K}(\alpha)\quad (n = [L:K]),$$
et le d\'eveloppement de la formule (i) donne
$$\chi_{\alpha,L/K}(x) = x^n - \left(\sum\limits_{\sigma\in \Sigma(L/K)} \sigma(\alpha)\right) x^{n-1} + \cdots + (-1)^n \prod\limits_{\sigma\in \Sigma(L/K)} \sigma(\alpha).$$
Ainsi
$$\mathrm{Tr}_{L/K}(\alpha) = \sum\limits_{\sigma\in \Sigma(L/K)} \sigma(\alpha), \qquad \mathrm{N}_{L/K}(\alpha) = \prod\limits_{\sigma\in \Sigma(L/K)} \sigma(\alpha).$$
\end{proof}

Remarque : si $L$ est une extension galoisienne de $K$, ces formules s'\'ecrivent

$$\mathrm{Tr}_{L/K}(\alpha) = \sum\limits_{\sigma\in \Gal(L/K)} \sigma(\alpha),\qquad
\mathrm{N}_{L/K}(\alpha) = \prod\limits_{\sigma\in \Gal(L/K)} \sigma(\alpha).$$



\medskip

Exemple : $\Sigma(\Q(\sqrt{d})) =\Sigma(\Q(\sqrt{d})/\Q)  = \{\mathrm{id}, \sigma\}$, o\`u $\sigma : a + b \sqrt{d} \mapsto a - b \sqrt{d}$. On retrouve ainsi
$$\mathrm{Tr}_{K/\Q}(a + b\sqrt{d}) = 2a,\quad \mathrm{N}(a+ b \sqrt{d}) = a^2 -d b^2.$$

\bigskip
Passons au discriminant.
La forme lin\'eaire $\mathrm{Tr}_{K/L} : L \to K$ permet de d\'efinir une forme $K$-bilin\'eaire sym\'etrique
$$B
\left\{
\begin{array}{ccc}
L \times L & \to &K\\
(x,y) & \mapsto &B(x,y) = \mathrm{Tr}_{L/K}(xy).
\end{array}
\right.
$$
Cette forme bilin\'eaire est non d\'eg\'en\'er\'ee : si $x\in L, x \ne 0$, il existe $y \in L$ tel que $\mathrm{Tr}_{L/K}(xy) = 1$. Il suffit de prendre $y = \frac{1}{[L:K] x}$.

Soit $n = [L:K]$ et soit $(e_1,\ldots,e_n)$ une famille d'\'el\'ements de $L$. Si $\alpha \in L$ est une combinaison lin\'eaire quelconque de $e_1,\ldots,e_n$, soit $\alpha = \sum_{j=1}^n \alpha_j e_j$, alors, pour tout indice $i=1,\ldots,n$,
$$\mathrm{Tr}_{L/K}(\alpha e_i) = \sum_{j=1}^n \mathrm{Tr}_{L/K}(e_ie_j) \alpha_j,$$
ce qu'on peut r\'esumer par le produit matriciel
$$
\begin{pmatrix}
\mathrm{Tr}_{L/K}(\alpha e_1)\\
\mathrm{Tr}_{L/K}(\alpha e_2)\\
\vdots\\
\mathrm{Tr}_{L/K}(\alpha e_n)
\end{pmatrix}
=
T 
\begin{pmatrix}
\alpha_1\\
\alpha_2\\
\vdots\\
\alpha_n
\end{pmatrix}
$$
o\`u
$$
T = (\mathrm{Tr}_{L/K}(e_ie_j))_{1\leq i,j \leq n}.
$$
Le d\'eterminant de cette matrice est l'objet de la d\'efinition suivante :
\begin{dfn}
Soit $K \subset L$ une extension de corps de nombres de degr\'e $n$. Le discriminant relatif \`a $K$ d'une famille $(e_1,\ldots,e_n)$ d'\'el\'ements de $L$, not\'e $\mathrm{discr}_{L/K}(e_1,\ldots,e_n)$ est le d\'eterminant
$$
 \mathrm{discr}_{L/K}(e_1,\ldots,e_n) = \det ((\mathrm{Tr}_{L/K}(e_ie_j))_{1\leq i,j \leq n}).
$$
\end{dfn}

Donnons les propri\'et\'es essentielles de ce discriminant.

\begin{prop}\label{discriminant}
Soit $L/K$ une extension de degr\'e $n$, et soit $e_1,\ldots,e_n \in L$.
\be
\item[(i)]  $\mathrm{discr}_{L/K}(e_1,\ldots,e_n) \ne 0$ si et seulement si $(e_1,\ldots,e_n)$ est une base du $K$-espace vectoriel $L$.
\item[(ii)] Si $P = (p_{i,j})_{1\leq i,j \leq n} \in {\cal M}_n(K)$, et si $f_j = \sum\limits_{i=1}^n p_{i,j} e_i$ pour  $j=1,\ldots,n$, alors
$$
 \mathrm{discr}_{L/K}(f_1,\ldots,f_n) = \det(P)^2  \mathrm{discr}_{L/K}(e_1,\ldots,e_n).
$$
\item[(iii)] 
$$ \mathrm{discr}_{L/K}(e_1,\ldots,e_n) = \det((\sigma_i(e_j))_{1\leq i,j \leq n})^2, \text{ o\`u }\Sigma(L/K) =\{ \sigma_1,\ldots,\sigma_n\}.$$
\item[(iv)]
Si $L = K(\alpha)$, et si $\alpha_1,\ldots,\alpha_n \in \C$ sont les conjugu\'es de $\alpha$ sur $K$, alors
$$
 \mathrm{discr}_{K(\alpha)/K}(1,\alpha,\alpha^2,\ldots,\alpha^{n-1}) = \prod_{1\leq i < j \leq n} (\alpha_i - \alpha_j)^2 = \mathrm{discr}(\Pi_{\alpha,K}).
$$
\ee
\end{prop}

\begin{proof}
\be
\item[(i)] Si $(e_1,\ldots,e_n)$ n'est pas une base de $L$ sur $K$, alors cette famille est li\'ee : il existe $(\alpha_1,\ldots,\alpha_n) \in K^n\setminus\{(0,\ldots,0)\}$ tels que $\sum_{j=1}^n\alpha_j e_j=0$. Alors les \'egalit\'es
$$\mathrm{Tr}_{L/K}(\alpha e_i) = \sum_{j=1}^n \mathrm{Tr}_{L/K}(e_ie_j) \alpha_j \qquad(1\leq i \leq n),$$
appliqu\'ees \`a $\alpha = \sum_{j=1}^n\alpha_j e_j=0$, donnent
$$0 
=
T 
\begin{pmatrix}
\alpha_1\\
\alpha_2\\
\vdots\\
\alpha_n
\end{pmatrix}, \text{ o\`u } T = (\mathrm{Tr}_{L/K}(e_ie_j))_{1\leq i,j \leq n}
$$
Comme $(\alpha_1,\ldots,\alpha_n) \ne (0,\ldots,0)$, ceci entra\^ine $\det(T) = 0$, soit $\mathrm{discr}_{L/K}(e_1,\ldots,e_n) = 0$.

R\'eciproquement, supposons que $\mathrm{discr}_{L/K}(e_1,\ldots,e_n) = 0$, alors $\det(T) = 0$ : il existe un vecteur $\,^t(\alpha_1,\ldots,\alpha_n)$ non nul dans le noyau de $T$.
Alors $\alpha =  \sum_{j=1}^n\alpha_j e_j$ v\'erifie
$$\mathrm{Tr}_{L/K}(\alpha e_i) = \sum_{j=1}^n \mathrm{Tr}_{L/K}(e_ie_j) \alpha_j = 0 \qquad(1\leq i \leq n).$$

En raisonnant par l'absurde, si $(e_1, \ldots,e_n)$ \'etait une base, ces \'egalit\'es montrent que $\mathrm{Tr}_{L/K}(\alpha x) = 0$ pout tout $x\in L$, o\`u $\alpha \ne 0$, et ceci contredit le fait que $B$ est non d\'eg\'en\'er\'ee. Ainsi $(e_1,\ldots,e_n)$ n'est pas une base de $L$ sur $K$. L'\'equivalence est prouv\'ee.

\item[(ii)] Si $(e_1,\ldots,e_n)$ n'est pas une base, alors $(f_1,\ldots f_n)$ n'est pas g\'en\'eratrice, donc n'est pas une base. Les deux membres de (ii) sont nuls. On peut donc supposer que $(e_1,\ldots,e_n)$ est une base. L'expression de la  forme bin\'eaire sym\'etrique $B$, de matrice $T$, est donn\'ee par
$$B(x,y) = \,^tX T Y,$$
o\`u $X,Y$ sont les matrices colonnes repr\'esentant $x,y$ dans la base $(e_1,\ldots,e_n)$. Alors
$$
\mathrm{Tr}_{L/K}(f_i f_j) = B(f_i,f_j) = \,^tC_i T C_j,
$$
o\`u $C_i$ est la $i$-\`eme colonne de $P = (p_{i,j})$. Par cons\'equent
$$
(\mathrm{Tr}_{L/K}(f_i f_j))_{1\leq i,j \leq n} = \,^t P T P,
$$
et les d\'eterminants de ces matrices donnent
$$
\mathrm{discr}_{L/K}(f_1,\ldots,f_n) = \det(P)^2  \mathrm{discr}_{L/K}(e_1,\ldots,e_n).
$$
\item[(iii)] Le calcul de la trace donne, pour tout $\alpha \in L$,
$$\mathrm{Tr}_{L/K}(\alpha)  = \sum_{k=1}^n \sigma_k(\alpha),$$
o\`u $n = [L:K], \Sigma(L/K) = \{\sigma_1,\ldots,\sigma_n\}$.
Par cons\'equent, si $e_1,\ldots,e_n \in L$,
$$\mathrm{Tr}_{L/K}(e_ie_j) = \sum_{k=1}^n \sigma_k(e_i) \sigma_k(e_j) \qquad (1\leq i,j \leq n).$$
Ces \'egalit\'es \'equivalent \`a l'\'egalit\'e matricielle
$$(\mathrm{Tr}_{L/K}(e_ie_j) )_{1\leq i,j \leq n} = \,^t X X, \text{ o\`u }X = (\sigma_i(e_j))_{1\leq i,j\leq n}.$$
En prenant le d\'eterminant des membres de cette \'egalit\'e, on obtient
$$
 \mathrm{discr}_{L/K}(e_1,\ldots,e_n) = \det((\sigma_i(e_j))_{1\leq i,j \leq n})^2.
$$
\item[(iv)] En appliquant cette \'egalit\'e \`a $e_i = \alpha^i$, on obtient
\begin{align*}
\mathrm{discr}_{K(\alpha)/K}(1,\alpha,\alpha^2,\ldots,\alpha^{n-1}) &= \det((\alpha_i^{j-1})_{1\leq i,j \leq n})^2\\
&= \prod_{1\leq i < j \leq n}(\alpha_i - \alpha_j)^2
\end{align*}
\ee
(d\'eterminant de Vandermonde).

Rappelons que le discriminant d'un polynôme $P =(x-\alpha_1)\cdots(x-\alpha_n)$ est d\'efini par $\mathrm{disc}(P) = \prod\limits_{1\leq i < j \leq n}^n (\alpha_i-\alpha_j)^2$, ce qui donne
$$
\mathrm{discr}_{K(\alpha)/K}(1,\alpha,\alpha^2,\ldots,\alpha^{n-1})  = \mathrm{discr}(\Pi_{\alpha,K}).
$$

\end{proof}
Nous allons d\'efinir dans les paragraphes suivants le discriminant d'un corps de nombres.

\section{Entiers d'un corps de nombres}
Comme dans le cas particulier d\'ej\`a \'etudi\'e des corps quadratiques, on d\'efinit l'anneau ${\cal O}_K$ d'un corps de nombres $K$.

\begin{dfn}
L'anneau des entiers du corps de nombres $K$ est l'anneau ${\cal O}_K = K \cap \overline{\Z}$ des entiers alg\'ebriques du corps $K$.
\end{dfn}

Notons que ${\cal O}_\Q = \Z$.

\begin{prop}
Pour tout $\alpha \in K$, il existe un entier non nul $m\in \Z$ tel que $m\alpha \in {\cal O}_K$.
\end{prop}

\begin{proof}
Soit $\alpha \in K$ et $n =[\Q(\alpha):\Q]$. Alors $\alpha$ est racine d'un polynôme unitaire \`a coefficients rationnels de degr\'e $n$. En multipliant par un multiple commun des d\'enominateurs de ces coefficients, on obtient des entiers $a_0,\ldots,a_n \in \Z$ tels que $a_n\alpha^n+\cdots+a_0 = 0$. Alors, en multipliant par $a_0^{n-1}$, on obtient l'\'egalit\'e
$$(a_n\alpha)^n + \sum_{i=0}^{n-1} a_i a_n^{n-i} (a_n\alpha)^i = 0.$$
Ainsi $a_n\alpha$ est racine du polynôme $x^n+ \sum_{i=0}^{n-1} a_i a_n^{n-i} x^i \in \Z[x]$. C'est donc un entier alg\'ebrique, et il appartient \`a $K$, donc $m = a_n$ convient.
\end{proof}

Les deux propositions suivantes sont des corollaires de ce r\'esultat.

\begin{prop}
 Le $\Q$-sous espace vectoriel de $K$ engendr\'e par ${\cal O}_K$ est $K$ tout entier : $K = \mathrm{Vect}_{\Q}({\cal O}_K)$.
 \end{prop}
 
\begin{proof}
En effet, si $(e_1,\ldots,e_n)$ est une base de $K$ sur $\Q$, alors il existe des entiers $m_i \ne 0, 1\leq i \leq n$ tels que $m_ie_i \in {\cal O}_K$, donc tout \'el\'ement de $K$ est engendr\'e par la famille $(m_1e_1,\ldots, m_n e_n)$ constitu\'ee de vecteurs de ${\cal O}_K$. Ainsi $K$ est engendr\'e par ${\cal O}_K$, en tant que $\Q$-espace vectoriel.
\end{proof}



\begin{prop}
 $K$ est le corps des fractions de ${\cal O}_K$.
 \end{prop}
 
\begin{proof}
Comme ${\cal O}_K \subset K$, le corps des fractions de ${\cal O}_K $ est inclus dans $K$.

Si $\alpha \in K$, il existe un entier $m\in \Z, m \ne 0$ tel que $m\alpha = n \in {\cal O}_K$. Alors $\alpha = n/m$, o\`u $n\in {\cal O}_K, m\in \Z \subset {\cal O}_K$.
\end{proof}

Donnons une caract\'erisation des entiers alg\'ebriques de $K$.
\begin{prop}(Crit\`ere d'int\'egralit\'e) \label{integralite}

Soit $K$ un corps de nombres et $\alpha \in K$. Les propositions suivantes sont \'equivalentes :
\be
\item[(i)] $ \alpha \in {\cal O}_K$.
\item[(ii)] $\Pi_{\alpha,\Q} \in \Z[x]$.
\item[(iii)] $\chi_{\alpha,K/\Q} \in \Z[x]$.
\ee
Ceci entra\^ine que tout $\alpha \in {\cal O}_K$ v\'erifie $\mathrm{Tr}_{K/\Q}(\alpha) \in \Z$ et $\mathrm{N}_{K/\Q}(\alpha) \in \Z$.
\end{prop}
\begin{proof}

\item[(ii) $\Rightarrow$ (iii).] Si $\Pi_{\alpha,\Q} \in \Z[x]$, alors $\chi_{\alpha,K/\Q} =\Pi_{\alpha,\Q}^{[K:\Q(\alpha)]}  \in \Z[x]$.

\item[(iii) $\Rightarrow$ (i).] L'\'el\'ement $\alpha$ est racine du polynôme unitaire $\chi_{\alpha,K/\Q} \in \Z[x]$, donc $\alpha$ est un entier alg\'ebrique de $K$, et ainsi $\alpha \in {\cal O}_K$.

\item[(i) $\Rightarrow$ (ii).] Soit $ \alpha \in {\cal O}_K$. Alors, par d\'efinition, il existe des entiers $a_0,\cdots,a_{n-1}\in \Z$ tels que $\alpha^n+ a_{n-1}\alpha^{n-1} + \cdots + a_0$. Si $\sigma \in \Sigma(K)$, alors $\sigma(\alpha)^n + a_{n-1}\sigma(\alpha)^{n-1}+ \cdots + a_0$, donc $\sigma(\alpha) \in \overline{\Z}$ pour tout $\sigma \in \Sigma(K)$.

La proposition \ref{calcul_trace} montre que $$\Pi_{\alpha,\Q}(x) = \prod_{\sigma\in \Sigma(K(\alpha))} (x -\sigma(\alpha)).$$

Comme $\overline{\Z}$ est un anneau, en d\'eveloppant ce produit, on obtient les coefficients de $\Pi_{\alpha,\Q}$, qui sont donc des \'el\'ements de $\overline{\Z} \cap \Q = \Z$. Ainsi $\Pi_{\alpha,\Q} \in \Z[x]$.
\end{proof}

Rappelons la d\'efinition d'un anneau int\'egralement clos.

\begin{dfn}
Soit $A$ un anneau int\`egre de corps des fractions $K$. On dit que $A$ est int\'egralement clos si pour tout $\alpha \in K$ tel qu'il existe $P \in A[x]$ unitaire v\'erifiant $P(\alpha) = 0$, alors $\alpha \in A$.
\end{dfn}
Nous avons vu qu'un anneau factoriel est int\'egralement clos (chapitre ``Anneaux d'entiers quadratiques imaginaires'').
\begin{prop}
Soit $K$ un corps de nombres. Alors l'anneau ${\cal O}_K$ est int\'egralement clos.
\end{prop}

\begin{proof}
Soit $\alpha \in K$ (qui est le corps des fractions de ${\cal O}_K$), et $P \in {\cal O}_K[x]$ unitaire tel que $P(\alpha) = 0$. Il suffit de prouver que $\alpha \in \overline{\Z}$ (alors $\alpha \in \overline{\Z} \cap K = {\cal O}_K$).

Soit $Q = \prod\limits_{\sigma \in \Sigma(K)} P^\sigma$. Comme chaque $\sigma \in \Sigma(K)$ envoie les entiers alg\'ebriques de $K$ sur des entiers alg\'ebriques, alors $P^\sigma \in \overline{\Z}[x]$, donc $Q\in \overline{\Z}[x]$.

De plus, pour tout $t\in \Q$, $Q(t) = \mathrm{N}_{K/\Q}(P(t)) \in \Q$ (car $P(t) \in K$, et la norme d'un \'el\'ement de $K$ est dans $\Q$). Ceci prouve que le polynôme formel $Q = \sum_{i=0}^d a_i x^i$ est dans $\Q[x]$ : en effet $(a_0,\ldots,a_n)$ est la solution du syst\`eme de Cramer
$$
\begin{pmatrix}
1 & 1 & 1 &\cdots & 1\\
1 & 2 & 2^2 & \cdots & 2^n\\
\vdots&\vdots&\vdots&&\vdots\\
1 & d+1 & (d+1)^2 &\cdots &(d+1)^n
\end{pmatrix}
\begin{pmatrix}
a_0\\
a_1\\
\vdots\\
a_d
\end{pmatrix}
=
\begin{pmatrix}
Q(1)\\
Q(2)\\
\vdots\\
Q(d+1)
\end{pmatrix}.
$$
Les formules de Cramer montrent que $a_i \in \Q, 0 \leq i \leq d$, et donc $Q \in \Q[x]$.

Ainsi $Q \in (\Q \cap \overline{\Z})[x] = \Z[x]$, $Q$ est unitaire, et $Q(\alpha) = 0$, donc $\alpha \in \overline{\Z}$, et donc $\alpha \in {\cal O}_K$.
\end{proof}

Un sous-anneau $A$ de $\C$ est dit monog\`ene si $A =\Z[\alpha]$ pour un certain $\alpha \in \C$. Nous avons vu que c'est le cas des anneaux d'entiers des corps quadratiques, mais ceci n'est pas vrai pour tous les anneaux d'entiers de corps de nombres.

\begin{prop}\label{module_libre}
Si $\alpha \in \overline{\Z}$, alors le morphisme d'anneaux 
$
\varphi 
\left\{
\begin{array}{ccc}
\Z[x] & \to & \Z[\alpha]\\
P & \mapsto & P(\alpha)
\end{array}
\right.
$
induit un isomorphisme d'anneaux
$$\overline{\varphi} : \Z[x]/(\Pi_{\alpha,\Q}) \simeq \Z[\alpha].$$
En particulier $(1,\alpha,\ldots,\alpha^{n-1})$ est une $\Z$-base de $\Z[\alpha]$, o\`u $n =[\Q(\alpha):\Q]$, et $\Z[\alpha]$ est un $\Z$-module libre de rang $n$, isomorphe \`a $\Z^n$.
\end{prop}
(Ici $(\Pi_{\alpha,\Q})$ d\'esigne l'id\'eal principal $\Pi_{\alpha,\Q}\cdot  \Z[x]$ de $\Z[x]$.)
\begin{proof}
L'application $\varphi$ est surjective par d\'efinition de $\Z[\alpha]$, et son noyau est 
$$I = \{P \in \Z[x]\mid P(\alpha) = 0\}.$$
Comme $\alpha$ est un entier alg\'ebrique du corps de nombre $K = \Q(\alpha)$, $\alpha \in {\cal O}_K$, et la proposition \ref{integralite} montre que $\Pi_{\alpha,\Q} \in \Z[x]$, donc $\Pi_{\alpha,\Q} \in I$ et $(\Pi_{\alpha,\Q}) \subset I$.

R\'eciproquement, si $P \in I$, alors la propri\'et\'e du polynôme minimal montre l'existence de $Q \in \Q[x]$ tel que $P = \Pi_{\alpha,\Q}\, Q$. Le polynôme $\Pi_{\alpha,\Q}$ \'etant unitaire, la division euclidienne dans $\Q[x]$ de $P$ par $\Pi_{\alpha,\Q}$ est possible, et donne un quotient $Q_0 \in  \Z[x]$ et un reste $R \in \Z[x]$ tels que $P = \Pi_{\alpha,\Q}\, Q_0 + R, \deg(R) < n$. L'unicit\'e du quotient et du reste de la division euclidienne dans $\Q[x]$ montre que $R = 0$ et $Q = Q_0 \in \Z[x]$. Par cons\'equent $P \in (\Pi_{\alpha,\Q})$, et en conclusion $I = (\Pi_{\alpha,\Q})$. 

Ainsi l'application $\overline{\varphi}$, d\'efinie par $\overline{\varphi}(P  +  I) = \varphi(\alpha) = P(\alpha)$ est un isomorphisme d'anneaux de $\Z[x]/I = \Z[x]/(\Pi_{\alpha,\Q})$ dans $\Z[\alpha]$.

Tout polynôme de $\Z[x]$ est congru modulo $\Pi_{\alpha,\Q}$ \`a un unique polynôme de degr\'e inf\'erieur \`a $n$. Ainsi $(1+I,x + I, \ldots,x^{n-1} + I)$ est une $\Z\,$-base de $\Z[x]/I$, et son image par $\overline{\varphi}$ est $(1,\alpha,\ldots,\alpha^{n-1})$, qui est donc une $\Z\,$-base de $\Z[\alpha]$. Ainsi $\Z[\alpha]$ est un $\Z$-module libre de rang $n$, isomorphe \`a $\Z^n$.

\end{proof}

\section{Structure additive de ${\cal O}_K$ et discriminant de $K$.}
Soit $K$ un corps de nombres.
\begin{prop}(Dedekind)
Le groupe additif de ${\cal O}_K$ admet une $\Z$-base \`a $n = [K:\Q]$ \'el\'ements. Ainsi il existe $e_1,\ldots e_n \in {\cal O}_K$ tels que ${\cal O}_K = \bigoplus\limits_{i=1}^n \Z e_i$.
\end{prop}
\begin{proof}
Le th\'eor\`eme de l'\'el\'ement primitif montre l'existence d'un $\beta \in K$ tel que $K = \Q(\beta)$. Il existe $m\in \Z\setminus\{0\}$ tel que $m\beta\in {\cal O}_K$. Puisque $\Q(m\beta) = \Q(\beta)$, en posant $\alpha=m\alpha$, nous obtenons $K = \Q(\alpha), \alpha \in {\cal O}_K$. Alors $\Z[\alpha] \subset {\cal O}_K$. 

Ainsi ${\cal O}_K$ contient un $\Z$-module libre de rang $n$. Pour compl\'eter l'encadrement, montrons que ${\cal O}_K$ est inclus dans un autre $\Z$-module libre de rang $n$.

Soit $\gamma \in {\cal O}_K$. Soit $n = [K : \Q] = [\Q(\alpha):\Q]$. Comme $(e_1,\cdots,e_n) = (1,\alpha,\ldots,\alpha^{n-1})$ est une base de $\Q(\alpha)$ sur $\Q$, alors $\gamma = \sum_{i=0}^{n-1} z_i \alpha^i$, o\`u $z_i \in \Q$ pour tous les indices $i$. Alors $(z_1,\ldots,z_n)$ est solution du syst\`eme
$$
\begin{pmatrix}
\mathrm{Tr}_{L/K}(\gamma . 1)\\
\mathrm{Tr}_{L/K}(\gamma . \alpha)\\
\vdots\\
\mathrm{Tr}_{L/K}(\gamma .  \alpha^{n-1})
\end{pmatrix}
=
T 
\begin{pmatrix}
z_0\\
z_1\\
\vdots\\
z_{n-1}
\end{pmatrix}
$$
o\`u
$$
T = (\mathrm{Tr}_{L/K}(\alpha^i\alpha^j))_{0\leq i,j \leq n-1}.
$$
Puisque $\gamma,\alpha \in {\cal O}_K$, $\mathrm{Tr}_{L/K}(\gamma .  \alpha^{i}) \in \Z, 0 \leq i \leq n-1$, et $T \in {\cal M}_n(\Z)$. Les formules de Cramer montrent que $z_i \in \frac{1}{d}\, \Z$, o\`u $d = \det(T) = \mathrm{disc}_{K/\Q}(1,\alpha,\ldots,\alpha^{n-1})$, et ainsi $\gamma \in  \frac{1}{d}\, \Z[\alpha]$. Par cons\'equent,
$$\Z[\alpha] \subset {\cal O}_K \subset \frac{1}{d}\, \Z[\alpha].$$
Le chapitre ``Modules'' (proposition \ref{M144}) montre que ${\cal O}_K$ est alors un $\Z$-module libre de rang $n$, et ainsi ${\cal O}_K$ admet une $\Z\,$-base $(e_1,\ldots,e_n)$, soit ${\cal O}_K = \bigoplus\limits_{i=1}^n \Z e_i$.
\end{proof}

Ceci donne une m\'ethode pour calculer ${\cal O}_K$. Partant d'un $\alpha\in \overline{\Z}$ tel que $K = \Q(\alpha)$ (o\`u $\alpha$ est un multiple entier d'un \'el\'ement primitif), on calcule l'entier $d = \mathrm{disc}_{K/\Q}(1,\alpha,\ldots,\alpha^{n-1}) = \mathrm{discr}(\Pi_{\alpha,\Q}) \in \Z$.  Alors
$${\cal O}_K/\Z[\alpha] \subset \left(\frac{1}{d}\, \Z[\alpha] \right) / \Z[\alpha] \simeq (\Z/d\Z)^n,$$
si bien que ${\cal O}_K/\Z[\alpha]$ est groupe ab\'elien fini, qu'on cherche \`a d\'eterminer.

Pour chacun des $d^n$ repr\'esentants $z$ du groupe quotient $\left(\frac{1}{d}\, \Z[\alpha] \right) / \Z[\alpha]$, on d\'etermine si $z \in {\cal O}_K$ en v\'erifiant que son polynôme caract\'eristique est dans $\Z[x]$. Alors ${\cal O}_K$ est le groupe ab\'elien engendr\'e par $\Z[\alpha]$ et l'ensemble des repr\'esentants de $\left(\frac{1}{d}\, \Z[\alpha] \right) / \Z[\alpha]$ qui sont des \'el\'ements de ${\cal O}_K$.

Une famille d'\'el\'ements $(e_1,\ldots,e_n)$ qui est une $\Z\,$-base de ${\cal O}_K$ sera appel\'ee une base enti\`ere de $K$.

\begin{prop}
Soit $(e_1,\ldots,e_n)$ et $(f_1,\ldots,f_n)$ deux bases enti\`eres de $K$. Alors
$$\mathrm{discr}_{K/\Q}(e_1,\ldots,e_n) =  \mathrm{discr}_{K/\Q}(f_1,\ldots,f_n).$$
\end{prop}


\begin{proof}
Soit $P$ la matrice de passage de la base $(e_i)_{1\leq i \leq n}$ \`a la base $(f_i)_{1\leq i \leq n}$, et $Q$ la matrice de passage de la base $(f_i)_{1\leq i \leq n}$ \`a la base $(e_i)_{1\leq i \leq n}$. Par d\'efinition d'une base enti\`ere, $P,Q$ sont \`a coefficients entiers, et $PQ = I_n$, donc $\det(P) = \pm 1$. La formule de la proposition 7 (ii) 
$$
 \mathrm{disc}_{L/K}(f_1,\ldots,f_n) = \det(P)^2  \mathrm{discr}_{L/K}(e_1,\ldots,e_n).
$$
donne le r\'esultat.
\end{proof}

\begin{dfn}
Ce discriminant commun \`a toutes les base enti\`eres s'appelle de discriminant du corps de nombres $K$ (not\'e $\mathrm{disc}_{\Q}(K)$).
\end{dfn}

Dans le cas des corps quadratiques $K = \Q(\sqrt{d})$ ($d \ne 0, 1, d$ sans facteurs carr\'es), calculons le discriminant $D = \mathrm{disc}_{\Q}(K)$.

D'apr\`es la proposition 3 du chapitre (Anneaux d'entiers quadratiques", une base enti\`ere $(e_1,e_2)$ de $K$ est $(1,\sqrt{d})$ si $d\equiv 2,3 \pmod 4$, et $(1,\frac{1+\sqrt{d}}{2})$ si $d\equiv 1 \pmod 4$.

Dans le premier cas, 
\begin{align*}
D &= 
\begin{vmatrix}
\mathrm{Tr}_{K/\Q} (e_1^2) & \mathrm{Tr}_{K/\Q} (e_1e_2)\\
\mathrm{Tr}_{K/\Q} (e_2e_1) & \mathrm{Tr}_{K/\Q} (e_2^2)
\end{vmatrix}
=
\begin{vmatrix}
\mathrm{Tr}_{K/\Q} (1) & \mathrm{Tr}_{K/\Q} (\sqrt{d}) \\
\mathrm{Tr}_{K/\Q} (\sqrt{d}) & \mathrm{Tr}_{K/\Q} (d)
\end{vmatrix}\\
&=
\begin{vmatrix}
2 & 0\\
0 & 2d
\end{vmatrix}\\
&=4d.
\end{align*}
Dans le deuxi\`eme cas,
\begin{align*}
D &= 
\begin{vmatrix}
\mathrm{Tr}_{K/\Q} (1) & \mathrm{Tr}_{K/\Q} (\frac{1+\sqrt{d}}{2}) \\
\mathrm{Tr}_{K/\Q} (\frac{1+\sqrt{d}}{2}) & \mathrm{Tr}_{K/\Q} (\frac{1+\sqrt{d}}{2})^2
\end{vmatrix}
=
\begin{vmatrix}
2 & 1\\
1 & \frac{1}{2}(1+d)
\end{vmatrix}\\
&= d.
\end{align*}
Dans chacun de ces deux cas, on retrouve bien le discriminant $D$ de la forme $\mathrm{N}(x + y \alpha)$ qui nous avait servi de d\'efinition provisoire.




\end{document}